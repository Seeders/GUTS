/*!
 * GUTS Game Engine - Client Bundle
 * Project: HelloWorld
 * Built: 2025-12-28T01:00:38.797Z
 * Mode: development
 */

// Setup globals for browser environment BEFORE any imports execute
if (typeof window !== 'undefined') {
    if (!window.GUTS) window.GUTS = {};
}

/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "./build/.temp/HelloWorld/client-entry.js":
/*!************************************************!*\
  !*** ./build/.temp/HelloWorld/client-entry.js ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("{/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* unused harmony exports Libraries, Systems */\n/* harmony import */ var C_projects_GUTS_engine_BaseEngine_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./engine/BaseEngine.js */ \"./engine/BaseEngine.js\");\n/* harmony import */ var C_projects_GUTS_engine_BaseEngine_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(C_projects_GUTS_engine_BaseEngine_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var C_projects_GUTS_engine_Engine_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./engine/Engine.js */ \"./engine/Engine.js\");\n/* harmony import */ var C_projects_GUTS_global_collections_scripts_libraries_js_BaseECSGame_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./global/collections/scripts/libraries/js/BaseECSGame.js */ \"./global/collections/scripts/libraries/js/BaseECSGame.js\");\n/* harmony import */ var C_projects_GUTS_global_collections_scripts_libraries_js_SceneManager_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./global/collections/scripts/libraries/js/SceneManager.js */ \"./global/collections/scripts/libraries/js/SceneManager.js\");\n/* harmony import */ var C_projects_GUTS_global_collections_scripts_libraries_js_BaseSystem_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./global/collections/scripts/libraries/js/BaseSystem.js */ \"./global/collections/scripts/libraries/js/BaseSystem.js\");\n/* harmony import */ var C_projects_GUTS_global_collections_scripts_libraries_js_BaseLoader_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./global/collections/scripts/libraries/js/BaseLoader.js */ \"./global/collections/scripts/libraries/js/BaseLoader.js\");\n/* harmony import */ var C_projects_GUTS_projects_HelloWorld_collections_scripts_systems_js_HelloSystem_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./projects/HelloWorld/collections/scripts/systems/js/HelloSystem.js */ \"./projects/HelloWorld/collections/scripts/systems/js/HelloSystem.js\");\n/* harmony import */ var C_projects_GUTS_projects_HelloWorld_collections_data_scenes_hello_json__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./projects/HelloWorld/collections/data/scenes/hello.json */ \"./projects/HelloWorld/collections/data/scenes/hello.json\");\n/* harmony import */ var C_projects_GUTS_projects_HelloWorld_collections_scripts_systems_data_HelloSystem_json__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./projects/HelloWorld/collections/scripts/systems/data/HelloSystem.json */ \"./projects/HelloWorld/collections/scripts/systems/data/HelloSystem.json\");\n/* harmony import */ var C_projects_GUTS_projects_HelloWorld_collections_settings_configs_game_json__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./projects/HelloWorld/collections/settings/configs/game.json */ \"./projects/HelloWorld/collections/settings/configs/game.json\");\n/* harmony import */ var C_projects_GUTS_projects_HelloWorld_collections_settings_configs_state_json__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./projects/HelloWorld/collections/settings/configs/state.json */ \"./projects/HelloWorld/collections/settings/configs/state.json\");\n/* harmony import */ var C_projects_GUTS_projects_HelloWorld_collections_settings_objectTypeCategories_data_json__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./projects/HelloWorld/collections/settings/objectTypeCategories/data.json */ \"./projects/HelloWorld/collections/settings/objectTypeCategories/data.json\");\n/* harmony import */ var C_projects_GUTS_projects_HelloWorld_collections_settings_objectTypeCategories_scripts_json__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./projects/HelloWorld/collections/settings/objectTypeCategories/scripts.json */ \"./projects/HelloWorld/collections/settings/objectTypeCategories/scripts.json\");\n/* harmony import */ var C_projects_GUTS_projects_HelloWorld_collections_settings_objectTypeCategories_ui_json__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./projects/HelloWorld/collections/settings/objectTypeCategories/ui.json */ \"./projects/HelloWorld/collections/settings/objectTypeCategories/ui.json\");\n/* harmony import */ var C_projects_GUTS_projects_HelloWorld_collections_settings_objectTypeDefinitions_interfaces_json__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./projects/HelloWorld/collections/settings/objectTypeDefinitions/interfaces.json */ \"./projects/HelloWorld/collections/settings/objectTypeDefinitions/interfaces.json\");\n/* harmony import */ var C_projects_GUTS_projects_HelloWorld_collections_settings_objectTypeDefinitions_scenes_json__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./projects/HelloWorld/collections/settings/objectTypeDefinitions/scenes.json */ \"./projects/HelloWorld/collections/settings/objectTypeDefinitions/scenes.json\");\n/* harmony import */ var C_projects_GUTS_projects_HelloWorld_collections_settings_objectTypeDefinitions_systems_json__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./projects/HelloWorld/collections/settings/objectTypeDefinitions/systems.json */ \"./projects/HelloWorld/collections/settings/objectTypeDefinitions/systems.json\");\n/* harmony import */ var C_projects_GUTS_projects_HelloWorld_collections_ui_interfaces_data_main_json__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./projects/HelloWorld/collections/ui/interfaces/data/main.json */ \"./projects/HelloWorld/collections/ui/interfaces/data/main.json\");\n/* harmony import */ var C_projects_GUTS_projects_HelloWorld_collections_ui_interfaces_html_main_html__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./projects/HelloWorld/collections/ui/interfaces/html/main.html */ \"./projects/HelloWorld/collections/ui/interfaces/html/main.html\");\n/* harmony import */ var C_projects_GUTS_projects_HelloWorld_collections_ui_interfaces_css_main_css__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./projects/HelloWorld/collections/ui/interfaces/css/main.css */ \"./projects/HelloWorld/collections/ui/interfaces/css/main.css\");\n/**\n * GUTS Game Client Bundle\n * Generated: 2025-12-28T01:00:38.726Z\n * Project: HelloWorld\n */\n\n// ========== ENGINE ==========\n\n\n\n// ========== LIBRARIES ==========\n\n\n\n\nconst Libraries = {\n  BaseECSGame: C_projects_GUTS_global_collections_scripts_libraries_js_BaseECSGame_js__WEBPACK_IMPORTED_MODULE_2__.BaseECSGame || C_projects_GUTS_global_collections_scripts_libraries_js_BaseECSGame_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"] || C_projects_GUTS_global_collections_scripts_libraries_js_BaseECSGame_js__WEBPACK_IMPORTED_MODULE_2__,\n  SceneManager: C_projects_GUTS_global_collections_scripts_libraries_js_SceneManager_js__WEBPACK_IMPORTED_MODULE_3__.SceneManager || C_projects_GUTS_global_collections_scripts_libraries_js_SceneManager_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"] || C_projects_GUTS_global_collections_scripts_libraries_js_SceneManager_js__WEBPACK_IMPORTED_MODULE_3__,\n  BaseSystem: C_projects_GUTS_global_collections_scripts_libraries_js_BaseSystem_js__WEBPACK_IMPORTED_MODULE_4__.BaseSystem || C_projects_GUTS_global_collections_scripts_libraries_js_BaseSystem_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"] || C_projects_GUTS_global_collections_scripts_libraries_js_BaseSystem_js__WEBPACK_IMPORTED_MODULE_4__,\n  BaseLoader: C_projects_GUTS_global_collections_scripts_libraries_js_BaseLoader_js__WEBPACK_IMPORTED_MODULE_5__.BaseLoader || C_projects_GUTS_global_collections_scripts_libraries_js_BaseLoader_js__WEBPACK_IMPORTED_MODULE_5__[\"default\"] || C_projects_GUTS_global_collections_scripts_libraries_js_BaseLoader_js__WEBPACK_IMPORTED_MODULE_5__\n};\n\n// ========== SYSTEMS ==========\n\nconst Systems = {\n  HelloSystem: C_projects_GUTS_projects_HelloWorld_collections_scripts_systems_js_HelloSystem_js__WEBPACK_IMPORTED_MODULE_6__.HelloSystem || C_projects_GUTS_projects_HelloWorld_collections_scripts_systems_js_HelloSystem_js__WEBPACK_IMPORTED_MODULE_6__[\"default\"] || C_projects_GUTS_projects_HelloWorld_collections_scripts_systems_js_HelloSystem_js__WEBPACK_IMPORTED_MODULE_6__\n};\n\n// ========== DATA COLLECTIONS ==========\n// scenes data\n\nconst scenesData = {\n  \"hello\": {\n    ...C_projects_GUTS_projects_HelloWorld_collections_data_scenes_hello_json__WEBPACK_IMPORTED_MODULE_7__,\n    id: \"hello\",\n    collection: \"scenes\"\n  }\n};\n\n// systems data\n\nconst systemsData = {\n  \"HelloSystem\": {\n    ...C_projects_GUTS_projects_HelloWorld_collections_scripts_systems_data_HelloSystem_json__WEBPACK_IMPORTED_MODULE_8__,\n    id: \"HelloSystem\",\n    collection: \"systems\"\n  }\n};\n\n// configs data\n\n\nconst configsData = {\n  \"game\": {\n    ...C_projects_GUTS_projects_HelloWorld_collections_settings_configs_game_json__WEBPACK_IMPORTED_MODULE_9__,\n    id: \"game\",\n    collection: \"configs\"\n  },\n  \"state\": {\n    ...C_projects_GUTS_projects_HelloWorld_collections_settings_configs_state_json__WEBPACK_IMPORTED_MODULE_10__,\n    id: \"state\",\n    collection: \"configs\"\n  }\n};\n\n// objectTypeCategories data\n\n\n\nconst objectTypeCategoriesData = {\n  \"data\": {\n    ...C_projects_GUTS_projects_HelloWorld_collections_settings_objectTypeCategories_data_json__WEBPACK_IMPORTED_MODULE_11__,\n    id: \"data\",\n    collection: \"objectTypeCategories\"\n  },\n  \"scripts\": {\n    ...C_projects_GUTS_projects_HelloWorld_collections_settings_objectTypeCategories_scripts_json__WEBPACK_IMPORTED_MODULE_12__,\n    id: \"scripts\",\n    collection: \"objectTypeCategories\"\n  },\n  \"ui\": {\n    ...C_projects_GUTS_projects_HelloWorld_collections_settings_objectTypeCategories_ui_json__WEBPACK_IMPORTED_MODULE_13__,\n    id: \"ui\",\n    collection: \"objectTypeCategories\"\n  }\n};\n\n// objectTypeDefinitions data\n\n\n\nconst objectTypeDefinitionsData = {\n  \"interfaces\": {\n    ...C_projects_GUTS_projects_HelloWorld_collections_settings_objectTypeDefinitions_interfaces_json__WEBPACK_IMPORTED_MODULE_14__,\n    id: \"interfaces\",\n    collection: \"objectTypeDefinitions\"\n  },\n  \"scenes\": {\n    ...C_projects_GUTS_projects_HelloWorld_collections_settings_objectTypeDefinitions_scenes_json__WEBPACK_IMPORTED_MODULE_15__,\n    id: \"scenes\",\n    collection: \"objectTypeDefinitions\"\n  },\n  \"systems\": {\n    ...C_projects_GUTS_projects_HelloWorld_collections_settings_objectTypeDefinitions_systems_json__WEBPACK_IMPORTED_MODULE_16__,\n    id: \"systems\",\n    collection: \"objectTypeDefinitions\"\n  }\n};\n\n// interfaces data\n\n\n\nconst interfacesData = {\n  \"main\": {\n    ...C_projects_GUTS_projects_HelloWorld_collections_ui_interfaces_data_main_json__WEBPACK_IMPORTED_MODULE_17__,\n    id: \"main\",\n    collection: \"interfaces\",\n    html: C_projects_GUTS_projects_HelloWorld_collections_ui_interfaces_html_main_html__WEBPACK_IMPORTED_MODULE_18__,\n    css: C_projects_GUTS_projects_HelloWorld_collections_ui_interfaces_css_main_css__WEBPACK_IMPORTED_MODULE_19__\n  }\n};\n\n// ========== COMBINED COLLECTIONS ==========\nconst DataCollections = {\n  scenes: scenesData,\n  systems: systemsData,\n  configs: configsData,\n  objectTypeCategories: objectTypeCategoriesData,\n  objectTypeDefinitions: objectTypeDefinitionsData,\n  interfaces: interfacesData\n};\n\n// ========== GLOBAL SETUP ==========\n\n// Setup window.GUTS for backwards compatibility\nif (!window.GUTS) {\n  window.GUTS = {};\n}\n\n// Register all libraries in window.GUTS\nObject.assign(window.GUTS, Libraries);\n\n// Library windowContext metadata (generated at build time)\nconst _libraryWindowContexts = {};\n\n// Setup window.THREE if it exists in libraries\nif (Libraries.THREE) {\n  window.THREE = Libraries.THREE;\n\n  // Add libraries with windowContext=\"THREE\" to window.THREE namespace\n  Object.keys(Libraries).forEach(key => {\n    const windowContext = _libraryWindowContexts[key];\n    if (windowContext === 'THREE' && key !== 'THREE') {\n      const addon = Libraries[key];\n      window.THREE[key] = addon;\n      // Also flatten exported functions/classes for direct access\n      if (typeof addon === 'object' && addon !== null) {\n        Object.assign(window.THREE, addon);\n      }\n    }\n  });\n}\nObject.assign(window.GUTS, {\n  systems: Systems\n});\n\n// Assign all individual classes directly to window.GUTS for direct access\nObject.assign(window.GUTS, Systems);\n\n// Setup COMPILED_GAME namespace\nwindow.COMPILED_GAME = {\n  ready: Promise.resolve(),\n  initialized: false,\n  libraryClasses: Libraries,\n  systems: Systems,\n  collections: DataCollections,\n  init: function (gutsEngine) {\n    if (this.initialized) return;\n    this.initialized = true;\n    window.GUTS.engine = gutsEngine;\n    console.log(\"âœ… COMPILED_GAME initialized\");\n  }\n};\n\n// ========== EXPORTS ==========\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (window.COMPILED_GAME);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9idWlsZC8udGVtcC9IZWxsb1dvcmxkL2NsaWVudC1lbnRyeS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUMrRDtBQUNSOztBQUV2RDtBQUMyRztBQUNFO0FBQ0o7QUFDQTtBQUV6RyxNQUFNTSxTQUFTLEdBQUc7RUFDaEJDLFdBQVcsRUFBR0wsK0dBQTJCLElBQUlBLDhHQUF1QixJQUFJQSxtR0FBZ0I7RUFDeEZPLFlBQVksRUFBR04saUhBQTZCLElBQUlBLCtHQUF3QixJQUFJQSxvR0FBaUI7RUFDN0ZPLFVBQVUsRUFBR04sNkdBQXlCLElBQUlBLDZHQUFzQixJQUFJQSxrR0FBZTtFQUNuRk8sVUFBVSxFQUFHTiw2R0FBeUIsSUFBSUEsNkdBQXNCLElBQUlBLGtHQUFjQTtBQUNwRixDQUFDOztBQUVEO0FBQ3NIO0FBRXRILE1BQU1RLE9BQU8sR0FBRztFQUNkQyxXQUFXLEVBQUdGLDBIQUEyQixJQUFJQSx5SEFBdUIsSUFBSUEsOEdBQWVBO0FBQ3pGLENBQUM7O0FBRUQ7QUFDQTtBQUN3RztBQUN4RyxNQUFNSSxVQUFVLEdBQUc7RUFDakIsT0FBTyxFQUFFO0lBQ1AsR0FBR0QsbUdBQWlCO0lBQ3BCRSxFQUFFLEVBQUUsT0FBTztJQUNYQyxVQUFVLEVBQUU7RUFDZDtBQUNGLENBQUM7O0FBRUQ7QUFDOEg7QUFDOUgsTUFBTUUsV0FBVyxHQUFHO0VBQ2xCLGFBQWEsRUFBRTtJQUNiLEdBQUdELGtIQUF3QjtJQUMzQkYsRUFBRSxFQUFFLGFBQWE7SUFDakJDLFVBQVUsRUFBRTtFQUNkO0FBQ0YsQ0FBQzs7QUFFRDtBQUM0RztBQUNFO0FBQzlHLE1BQU1LLFdBQVcsR0FBRztFQUNsQixNQUFNLEVBQUU7SUFDTixHQUFHRix1R0FBaUI7SUFDcEJKLEVBQUUsRUFBRSxNQUFNO0lBQ1ZDLFVBQVUsRUFBRTtFQUNkLENBQUM7RUFDRCxPQUFPLEVBQUU7SUFDUCxHQUFHSSx5R0FB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M0I7QUFDWCxDQUFDLENBQUM7O0FBRUY7QUFDQWtDLE1BQU0sQ0FBQ0MsTUFBTSxDQUFDSCxNQUFNLENBQUNDLElBQUksRUFBRWpDLE9BQU8sQ0FBQzs7QUFFbkM7QUFDQWdDLE1BQU0sQ0FBQ1csYUFBYSxHQUFHO0VBQ3JCQyxLQUFLLEVBQUVDLE9BQU8sQ0FBQ0MsT0FBTyxDQUFDLENBQUM7RUFDeEJDLFdBQVcsRUFBRSxLQUFLO0VBQ2xCQyxjQUFjLEVBQUV2RCxTQUFTO0VBQ3pCa0MsT0FBTyxFQUFFM0IsT0FBTztFQUNoQmlELFdBQVcsRUFBRXhCLGVBQWU7RUFDNUJ5QixJQUFJLEVBQUUsU0FBQUEsQ0FBU0MsVUFBVSxFQUFFO0lBQ3pCLElBQUksSUFBSSxDQUFDSixXQUFXLEVBQUU7SUFDdEIsSUFBSSxDQUFDQSxXQUFXLEdBQUcsSUFBSTtJQUN2QmYsTUFBTSxDQUFDQyxJQUFJLENBQUNtQixNQUFNLEdBQUdELFVBQVU7SUFDL0JFLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLDZCQUE2QixDQUFDO0VBQzVDO0FBQ0YsQ0FBQzs7QUFFRDtBQUtTO0FBR1QsaUVBQWV0QixNQUFNLENBQUNXLGFBQWEiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90b3dlcmRlZmVuc2UvLi9idWlsZC8udGVtcC9IZWxsb1dvcmxkL2NsaWVudC1lbnRyeS5qcz82ZTZlIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogR1VUUyBHYW1lIENsaWVudCBCdW5kbGVcbiAqIEdlbmVyYXRlZDogMjAyNS0xMi0yOFQwMTowMDozOC43MjZaXG4gKiBQcm9qZWN0OiBIZWxsb1dvcmxkXG4gKi9cblxuLy8gPT09PT09PT09PSBFTkdJTkUgPT09PT09PT09PVxuaW1wb3J0IEJhc2VFbmdpbmUgZnJvbSAnQzovcHJvamVjdHMvR1VUUy9lbmdpbmUvQmFzZUVuZ2luZS5qcyc7XG5pbXBvcnQgRW5naW5lIGZyb20gJ0M6L3Byb2plY3RzL0dVVFMvZW5naW5lL0VuZ2luZS5qcyc7XG5cbi8vID09PT09PT09PT0gTElCUkFSSUVTID09PT09PT09PT1cbmltcG9ydCAqIGFzIGxpYl9CYXNlRUNTR2FtZSBmcm9tICdDOi9wcm9qZWN0cy9HVVRTL2dsb2JhbC9jb2xsZWN0aW9ucy9zY3JpcHRzL2xpYnJhcmllcy9qcy9CYXNlRUNTR2FtZS5qcyc7XG5pbXBvcnQgKiBhcyBsaWJfU2NlbmVNYW5hZ2VyIGZyb20gJ0M6L3Byb2plY3RzL0dVVFMvZ2xvYmFsL2NvbGxlY3Rpb25zL3NjcmlwdHMvbGlicmFyaWVzL2pzL1NjZW5lTWFuYWdlci5qcyc7XG5pbXBvcnQgKiBhcyBsaWJfQmFzZVN5c3RlbSBmcm9tICdDOi9wcm9qZWN0cy9HVVRTL2dsb2JhbC9jb2xsZWN0aW9ucy9zY3JpcHRzL2xpYnJhcmllcy9qcy9CYXNlU3lzdGVtLmpzJztcbmltcG9ydCAqIGFzIGxpYl9CYXNlTG9hZGVyIGZyb20gJ0M6L3Byb2plY3RzL0dVVFMvZ2xvYmFsL2NvbGxlY3Rpb25zL3NjcmlwdHMvbGlicmFyaWVzL2pzL0Jhc2VMb2FkZXIuanMnO1xuXG5jb25zdCBMaWJyYXJpZXMgPSB7XG4gIEJhc2VFQ1NHYW1lOiAobGliX0Jhc2VFQ1NHYW1lLkJhc2VFQ1NHYW1lIHx8IGxpYl9CYXNlRUNTR2FtZS5kZWZhdWx0IHx8IGxpYl9CYXNlRUNTR2FtZSksXG4gIFNjZW5lTWFuYWdlcjogKGxpYl9TY2VuZU1hbmFnZXIuU2NlbmVNYW5hZ2VyIHx8IGxpYl9TY2VuZU1hbmFnZXIuZGVmYXVsdCB8fCBsaWJfU2NlbmVNYW5hZ2VyKSxcbiAgQmFzZVN5c3RlbTogKGxpYl9CYXNlU3lzdGVtLkJhc2VTeXN0ZW0gfHwgbGliX0Jhc2VTeXN0ZW0uZGVmYXVsdCB8fCBsaWJfQmFzZVN5c3RlbSksXG4gIEJhc2VMb2FkZXI6IChsaWJfQmFzZUxvYWRlci5CYXNlTG9hZGVyIHx8IGxpYl9CYXNlTG9hZGVyLmRlZmF1bHQgfHwgbGliX0Jhc2VMb2FkZXIpXG59O1xuXG4vLyA9PT09PT09PT09IFNZU1RFTVMgPT09PT09PT09PVxuaW1wb3J0ICogYXMgc3lzX0hlbGxvU3lzdGVtIGZyb20gJ0M6L3Byb2plY3RzL0dVVFMvcHJvamVjdHMvSGVsbG9Xb3JsZC9jb2xsZWN0aW9ucy9zY3JpcHRzL3N5c3RlbXMvanMvSGVsbG9TeXN0ZW0uanMnO1xuXG5jb25zdCBTeXN0ZW1zID0ge1xuICBIZWxsb1N5c3RlbTogKHN5c19IZWxsb1N5c3RlbS5IZWxsb1N5c3RlbSB8fCBzeXNfSGVsbG9TeXN0ZW0uZGVmYXVsdCB8fCBzeXNfSGVsbG9TeXN0ZW0pXG59O1xuXG4vLyA9PT09PT09PT09IERBVEEgQ09MTEVDVElPTlMgPT09PT09PT09PVxuLy8gc2NlbmVzIGRhdGFcbmltcG9ydCBzY2VuZXNfanNvbl9oZWxsbyBmcm9tICdDOi9wcm9qZWN0cy9HVVRTL3Byb2plY3RzL0hlbGxvV29ybGQvY29sbGVjdGlvbnMvZGF0YS9zY2VuZXMvaGVsbG8uanNvbic7XG5jb25zdCBzY2VuZXNEYXRhID0ge1xuICBcImhlbGxvXCI6IHtcbiAgICAuLi5zY2VuZXNfanNvbl9oZWxsbyxcbiAgICBpZDogXCJoZWxsb1wiLFxuICAgIGNvbGxlY3Rpb246IFwic2NlbmVzXCJcbiAgfVxufTtcblxuLy8gc3lzdGVtcyBkYXRhXG5pbXBvcnQgc3lzdGVtc19qc29uX0hlbGxvU3lzdGVtIGZyb20gJ0M6L3Byb2plY3RzL0dVVFMvcHJvamVjdHMvSGVsbG9Xb3JsZC9jb2xsZWN0aW9ucy9zY3JpcHRzL3N5c3RlbXMvZGF0YS9IZWxsb1N5c3RlbS5qc29uJztcbmNvbnN0IHN5c3RlbXNEYXRhID0ge1xuICBcIkhlbGxvU3lzdGVtXCI6IHtcbiAgICAuLi5zeXN0ZW1zX2pzb25fSGVsbG9TeXN0ZW0sXG4gICAgaWQ6IFwiSGVsbG9TeXN0ZW1cIixcbiAgICBjb2xsZWN0aW9uOiBcInN5c3RlbXNcIlxuICB9XG59O1xuXG4vLyBjb25maWdzIGRhdGFcbmltcG9ydCBjb25maWdzX2pzb25fZ2FtZSBmcm9tICdDOi9wcm9qZWN0cy9HVVRTL3Byb2plY3RzL0hlbGxvV29ybGQvY29sbGVjdGlvbnMvc2V0dGluZ3MvY29uZmlncy9nYW1lLmpzb24nO1xuaW1wb3J0IGNvbmZpZ3NfanNvbl9zdGF0ZSBmcm9tICdDOi9wcm9qZWN0cy9HVVRTL3Byb2plY3RzL0hlbGxvV29ybGQvY29sbGVjdGlvbnMvc2V0dGluZ3MvY29uZmlncy9zdGF0ZS5qc29uJztcbmNvbnN0IGNvbmZpZ3NEYXRhID0ge1xuICBcImdhbWVcIjoge1xuICAgIC4uLmNvbmZpZ3NfanNvbl9nYW1lLFxuICAgIGlkOiBcImdhbWVcIixcbiAgICBjb2xsZWN0aW9uOiBcImNvbmZpZ3NcIlxuICB9LFxuICBcInN0YXRlXCI6IHtcbiAgICAuLi5jb25maWdzX2pzb25fc3RhdGUsXG4gICAgaWQ6IFwic3RhdGVcIixcbiAgICBjb2xsZWN0aW9uOiBcImNvbmZpZ3NcIlxuICB9XG59O1xuXG4vLyBvYmplY3RUeXBlQ2F0ZWdvcmllcyBkYXRhXG5pbXBvcnQgb2JqZWN0VHlwZUNhdGVnb3JpZXNfanNvbl9kYXRhIGZyb20gJ0M6L3Byb2plY3RzL0dVVFMvcHJvamVjdHMvSGVsbG9Xb3JsZC9jb2xsZWN0aW9ucy9zZXR0aW5ncy9vYmplY3RUeXBlQ2F0ZWdvcmllcy9kYXRhLmpzb24nO1xuaW1wb3J0IG9iamVjdFR5cGVDYXRlZ29yaWVzX2pzb25fc2NyaXB0cyBmcm9tICdDOi9wcm9qZWN0cy9HVVRTL3Byb2plY3RzL0hlbGxvV29ybGQvY29sbGVjdGlvbnMvc2V0dGluZ3Mvb2JqZWN0VHlwZUNhdGVnb3JpZXMvc2NyaXB0cy5qc29uJztcbmltcG9ydCBvYmplY3RUeXBlQ2F0ZWdvcmllc19qc29uX3VpIGZyb20gJ0M6L3Byb2plY3RzL0dVVFMvcHJvamVjdHMvSGVsbG9Xb3JsZC9jb2xsZWN0aW9ucy9zZXR0aW5ncy9vYmplY3RUeXBlQ2F0ZWdvcmllcy91aS5qc29uJztcbmNvbnN0IG9iamVjdFR5cGVDYXRlZ29yaWVzRGF0YSA9IHtcbiAgXCJkYXRhXCI6IHtcbiAgICAuLi5vYmplY3RUeXBlQ2F0ZWdvcmllc19qc29uX2RhdGEsXG4gICAgaWQ6IFwiZGF0YVwiLFxuICAgIGNvbGxlY3Rpb246IFwib2JqZWN0VHlwZUNhdGVnb3JpZXNcIlxuICB9LFxuICBcInNjcmlwdHNcIjoge1xuICAgIC4uLm9iamVjdFR5cGVDYXRlZ29yaWVzX2pzb25fc2NyaXB0cyxcbiAgICBpZDogXCJzY3JpcHRzXCIsXG4gICAgY29sbGVjdGlvbjogXCJvYmplY3RUeXBlQ2F0ZWdvcmllc1wiXG4gIH0sXG4gIFwidWlcIjoge1xuICAgIC4uLm9iamVjdFR5cGVDYXRlZ29yaWVzX2pzb25fdWksXG4gICAgaWQ6IFwidWlcIixcbiAgICBjb2xsZWN0aW9uOiBcIm9iamVjdFR5cGVDYXRlZ29yaWVzXCJcbiAgfVxufTtcblxuLy8gb2JqZWN0VHlwZURlZmluaXRpb25zIGRhdGFcbmltcG9ydCBvYmplY3RUeXBlRGVmaW5pdGlvbnNfanNvbl9pbnRlcmZhY2VzIGZyb20gJ0M6L3Byb2plY3RzL0dVVFMvcHJvamVjdHMvSGVsbG9Xb3JsZC9jb2xsZWN0aW9ucy9zZXR0aW5ncy9vYmplY3RUeXBlRGVmaW5pdGlvbnMvaW50ZXJmYWNlcy5qc29uJztcbmltcG9ydCBvYmplY3RUeXBlRGVmaW5pdGlvbnNfanNvbl9zY2VuZXMgZnJvbSAnQzovcHJvamVjdHMvR1VUUy9wcm9qZWN0cy9IZWxsb1dvcmxkL2NvbGxlY3Rpb25zL3NldHRpbmdzL29iamVjdFR5cGVEZWZpbml0aW9ucy9zY2VuZXMuanNvbic7XG5pbXBvcnQgb2JqZWN0VHlwZURlZmluaXRpb25zX2pzb25fc3lzdGVtcyBmcm9tICdDOi9wcm9qZWN0cy9HVVRTL3Byb2plY3RzL0hlbGxvV29ybGQvY29sbGVjdGlvbnMvc2V0dGluZ3Mvb2JqZWN0VHlwZURlZmluaXRpb25zL3N5c3RlbXMuanNvbic7XG5jb25zdCBvYmplY3RUeXBlRGVmaW5pdGlvbnNEYXRhID0ge1xuICBcImludGVyZmFjZXNcIjoge1xuICAgIC4uLm9iamVjdFR5cGVEZWZpbml0aW9uc19qc29uX2ludGVyZmFjZXMsXG4gICAgaWQ6IFwiaW50ZXJmYWNlc1wiLFxuICAgIGNvbGxlY3Rpb246IFwib2JqZWN0VHlwZURlZmluaXRpb25zXCJcbiAgfSxcbiAgXCJzY2VuZXNcIjoge1xuICAgIC4uLm9iamVjdFR5cGVEZWZpbml0aW9uc19qc29uX3NjZW5lcyxcbiAgICBpZDogXCJzY2VuZXNcIixcbiAgICBjb2xsZWN0aW9uOiBcIm9iamVjdFR5cGVEZWZpbml0aW9uc1wiXG4gIH0sXG4gIFwic3lzdGVtc1wiOiB7XG4gICAgLi4ub2JqZWN0VHlwZURlZmluaXRpb25zX2pzb25fc3lzdGVtcyxcbiAgICBpZDogXCJzeXN0ZW1zXCIsXG4gICAgY29sbGVjdGlvbjogXCJvYmplY3RUeXBlRGVmaW5pdGlvbnNcIlxuICB9XG59O1xuXG4vLyBpbnRlcmZhY2VzIGRhdGFcbmltcG9ydCBpbnRlcmZhY2VzX2pzb25fbWFpbiBmcm9tICdDOi9wcm9qZWN0cy9HVVRTL3Byb2plY3RzL0hlbGxvV29ybGQvY29sbGVjdGlvbnMvdWkvaW50ZXJmYWNlcy9kYXRhL21haW4uanNvbic7XG5pbXBvcnQgaW50ZXJmYWNlc19odG1sX21haW4gZnJvbSAnQzovcHJvamVjdHMvR1VUUy9wcm9qZWN0cy9IZWxsb1dvcmxkL2NvbGxlY3Rpb25zL3VpL2ludGVyZmFjZXMvaHRtbC9tYWluLmh0bWwnO1xuaW1wb3J0IGludGVyZmFjZXNfY3NzX21haW4gZnJvbSAnQzovcHJvamVjdHMvR1VUUy9wcm9qZWN0cy9IZWxsb1dvcmxkL2NvbGxlY3Rpb25zL3VpL2ludGVyZmFjZXMvY3NzL21haW4uY3NzJztcbmNvbnN0IGludGVyZmFjZXNEYXRhID0ge1xuICBcIm1haW5cIjoge1xuICAgIC4uLmludGVyZmFjZXNfanNvbl9tYWluLFxuICAgIGlkOiBcIm1haW5cIixcbiAgICBjb2xsZWN0aW9uOiBcImludGVyZmFjZXNcIixcbiAgICBodG1sOiBpbnRlcmZhY2VzX2h0bWxfbWFpbixcbiAgICBjc3M6IGludGVyZmFjZXNfY3NzX21haW5cbiAgfVxufTtcblxuLy8gPT09PT09PT09PSBDT01CSU5FRCBDT0xMRUNUSU9OUyA9PT09PT09PT09XG5jb25zdCBEYXRhQ29sbGVjdGlvbnMgPSB7XG4gIHNjZW5lczogc2NlbmVzRGF0YSxcbiAgc3lzdGVtczogc3lzdGVtc0RhdGEsXG4gIGNvbmZpZ3M6IGNvbmZpZ3NEYXRhLFxuICBvYmplY3RUeXBlQ2F0ZWdvcmllczogb2JqZWN0VHlwZUNhdGVnb3JpZXNEYXRhLFxuICBvYmplY3RUeXBlRGVmaW5pdGlvbnM6IG9iamVjdFR5cGVEZWZpbml0aW9uc0RhdGEsXG4gIGludGVyZmFjZXM6IGludGVyZmFjZXNEYXRhXG59O1xuXG4vLyA9PT09PT09PT09IEdMT0JBTCBTRVRVUCA9PT09PT09PT09XG5cbi8vIFNldHVwIHdpbmRvdy5HVVRTIGZvciBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eVxuaWYgKCF3aW5kb3cuR1VUUykge1xuICB3aW5kb3cuR1VUUyA9IHt9O1xufVxuXG4vLyBSZWdpc3RlciBhbGwgbGlicmFyaWVzIGluIHdpbmRvdy5HVVRTXG5PYmplY3QuYXNzaWduKHdpbmRvdy5HVVRTLCBMaWJyYXJpZXMpO1xuXG4vLyBMaWJyYXJ5IHdpbmRvd0NvbnRleHQgbWV0YWRhdGEgKGdlbmVyYXRlZCBhdCBidWlsZCB0aW1lKVxuY29uc3QgX2xpYnJhcnlXaW5kb3dDb250ZXh0cyA9IHt9O1xuXG4vLyBTZXR1cCB3aW5kb3cuVEhSRUUgaWYgaXQgZXhpc3RzIGluIGxpYnJhcmllc1xuaWYgKExpYnJhcmllcy5USFJFRSkge1xuICB3aW5kb3cuVEhSRUUgPSBMaWJyYXJpZXMuVEhSRUU7XG4gIFxuICAvLyBBZGQgbGlicmFyaWVzIHdpdGggd2luZG93Q29udGV4dD1cIlRIUkVFXCIgdG8gd2luZG93LlRIUkVFIG5hbWVzcGFjZVxuICBPYmplY3Qua2V5cyhMaWJyYXJpZXMpLmZvckVhY2goa2V5ID0+IHtcbiAgICBjb25zdCB3aW5kb3dDb250ZXh0ID0gX2xpYnJhcnlXaW5kb3dDb250ZXh0c1trZXldO1xuICAgIGlmICh3aW5kb3dDb250ZXh0ID09PSAnVEhSRUUnICYmIGtleSAhPT0gJ1RIUkVFJykge1xuICAgICAgY29uc3QgYWRkb24gPSBMaWJyYXJpZXNba2V5XTtcbiAgICAgIHdpbmRvdy5USFJFRVtrZXldID0gYWRkb247XG4gICAgICAvLyBBbHNvIGZsYXR0ZW4gZXhwb3J0ZWQgZnVuY3Rpb25zL2NsYXNzZXMgZm9yIGRpcmVjdCBhY2Nlc3NcbiAgICAgIGlmICh0eXBlb2YgYWRkb24gPT09ICdvYmplY3QnICYmIGFkZG9uICE9PSBudWxsKSB7XG4gICAgICAgIE9iamVjdC5hc3NpZ24od2luZG93LlRIUkVFLCBhZGRvbik7XG4gICAgICB9XG4gICAgfVxuICB9KTtcbn1cblxuT2JqZWN0LmFzc2lnbih3aW5kb3cuR1VUUywge1xuICBzeXN0ZW1zOiBTeXN0ZW1zLFxufSk7XG5cbi8vIEFzc2lnbiBhbGwgaW5kaXZpZHVhbCBjbGFzc2VzIGRpcmVjdGx5IHRvIHdpbmRvdy5HVVRTIGZvciBkaXJlY3QgYWNjZXNzXG5PYmplY3QuYXNzaWduKHdpbmRvdy5HVVRTLCBTeXN0ZW1zKTtcblxuLy8gU2V0dXAgQ09NUElMRURfR0FNRSBuYW1lc3BhY2VcbndpbmRvdy5DT01QSUxFRF9HQU1FID0ge1xuICByZWFkeTogUHJvbWlzZS5yZXNvbHZlKCksXG4gIGluaXRpYWxpemVkOiBmYWxzZSxcbiAgbGlicmFyeUNsYXNzZXM6IExpYnJhcmllcyxcbiAgc3lzdGVtczogU3lzdGVtcyxcbiAgY29sbGVjdGlvbnM6IERhdGFDb2xsZWN0aW9ucyxcbiAgaW5pdDogZnVuY3Rpb24oZ3V0c0VuZ2luZSkge1xuICAgIGlmICh0aGlzLmluaXRpYWxpemVkKSByZXR1cm47XG4gICAgdGhpcy5pbml0aWFsaXplZCA9IHRydWU7XG4gICAgd2luZG93LkdVVFMuZW5naW5lID0gZ3V0c0VuZ2luZTtcbiAgICBjb25zb2xlLmxvZyhcIuKchSBDT01QSUxFRF9HQU1FIGluaXRpYWxpemVkXCIpO1xuICB9XG59O1xuXG4vLyA9PT09PT09PT09IEVYUE9SVFMgPT09PT09PT09PVxuZXhwb3J0IHtcbiAgQmFzZUVuZ2luZSxcbiAgRW5naW5lLFxuICBMaWJyYXJpZXMsXG4gIFN5c3RlbXNcbn07XG5cbmV4cG9ydCBkZWZhdWx0IHdpbmRvdy5DT01QSUxFRF9HQU1FOyJdLCJuYW1lcyI6WyJCYXNlRW5naW5lIiwiRW5naW5lIiwibGliX0Jhc2VFQ1NHYW1lIiwibGliX1NjZW5lTWFuYWdlciIsImxpYl9CYXNlU3lzdGVtIiwibGliX0Jhc2VMb2FkZXIiLCJMaWJyYXJpZXMiLCJCYXNlRUNTR2FtZSIsImRlZmF1bHQiLCJTY2VuZU1hbmFnZXIiLCJCYXNlU3lzdGVtIiwiQmFzZUxvYWRlciIsInN5c19IZWxsb1N5c3RlbSIsIlN5c3RlbXMiLCJIZWxsb1N5c3RlbSIsInNjZW5lc19qc29uX2hlbGxvIiwic2NlbmVzRGF0YSIsImlkIiwiY29sbGVjdGlvbiIsInN5c3RlbXNfanNvbl9IZWxsb1N5c3RlbSIsInN5c3RlbXNEYXRhIiwiY29uZmlnc19qc29uX2dhbWUiLCJjb25maWdzX2pzb25fc3RhdGUiLCJjb25maWdzRGF0YSIsIm9iamVjdFR5cGVDYXRlZ29yaWVzX2pzb25fZGF0YSIsIm9iamVjdFR5cGVDYXRlZ29yaWVzX2pzb25fc2NyaXB0cyIsIm9iamVjdFR5cGVDYXRlZ29yaWVzX2pzb25fdWkiLCJvYmplY3RUeXBlQ2F0ZWdvcmllc0RhdGEiLCJvYmplY3RUeXBlRGVmaW5pdGlvbnNfanNvbl9pbnRlcmZhY2VzIiwib2JqZWN0VHlwZURlZmluaXRpb25zX2pzb25fc2NlbmVzIiwib2JqZWN0VHlwZURlZmluaXRpb25zX2pzb25fc3lzdGVtcyIsIm9iamVjdFR5cGVEZWZpbml0aW9uc0RhdGEiLCJpbnRlcmZhY2VzX2pzb25fbWFpbiIsImludGVyZmFjZXNfaHRtbF9tYWluIiwiaW50ZXJmYWNlc19jc3NfbWFpbiIsImludGVyZmFjZXNEYXRhIiwiaHRtbCIsImNzcyIsIkRhdGFDb2xsZWN0aW9ucyIsInNjZW5lcyIsInN5c3RlbXMiLCJjb25maWdzIiwib2JqZWN0VHlwZUNhdGVnb3JpZXMiLCJvYmplY3RUeXBlRGVmaW5pdGlvbnMiLCJpbnRlcmZhY2VzIiwid2luZG93IiwiR1VUUyIsIk9iamVjdCIsImFzc2lnbiIsIl9saWJyYXJ5V2luZG93Q29udGV4dHMiLCJUSFJFRSIsImtleXMiLCJmb3JFYWNoIiwia2V5Iiwid2luZG93Q29udGV4dCIsImFkZG9uIiwiQ09NUElMRURfR0FNRSIsInJlYWR5IiwiUHJvbWlzZSIsInJlc29sdmUiLCJpbml0aWFsaXplZCIsImxpYnJhcnlDbGFzc2VzIiwiY29sbGVjdGlvbnMiLCJpbml0IiwiZ3V0c0VuZ2luZSIsImVuZ2luZSIsImNvbnNvbGUiLCJsb2ciXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./build/.temp/HelloWorld/client-entry.js\n\n}");

/***/ }),

/***/ "./build/.temp/HelloWorld/combined-entry.js":
/*!**************************************************!*\
  !*** ./build/.temp/HelloWorld/combined-entry.js ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __unused_webpack___webpack_exports__, __webpack_require__) => {

"use strict";
eval("{/* harmony import */ var _engine_entry_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./engine-entry.js */ \"./build/.temp/HelloWorld/engine-entry.js\");\n/* harmony import */ var _client_entry_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./client-entry.js */ \"./build/.temp/HelloWorld/client-entry.js\");\n/**\n * GUTS Combined Bundle (Engine + Game)\n * Generated: 2025-12-28T01:00:38.727Z\n * Project: HelloWorld\n */\n\n\n\n/* unused harmony default export */ var __WEBPACK_DEFAULT_EXPORT__ = (_client_entry_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9idWlsZC8udGVtcC9IZWxsb1dvcmxkL2NvbWJpbmVkLWVudHJ5LmpzIiwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFMkI7QUFFbUI7QUFFOUMsc0VBQWVBLHdEQUFhIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdG93ZXJkZWZlbnNlLy4vYnVpbGQvLnRlbXAvSGVsbG9Xb3JsZC9jb21iaW5lZC1lbnRyeS5qcz85ZDMyIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogR1VUUyBDb21iaW5lZCBCdW5kbGUgKEVuZ2luZSArIEdhbWUpXG4gKiBHZW5lcmF0ZWQ6IDIwMjUtMTItMjhUMDE6MDA6MzguNzI3WlxuICogUHJvamVjdDogSGVsbG9Xb3JsZFxuICovXG5cbmltcG9ydCAnLi9lbmdpbmUtZW50cnkuanMnO1xuXG5pbXBvcnQgQ09NUElMRURfR0FNRSBmcm9tICcuL2NsaWVudC1lbnRyeS5qcyc7XG5cbmV4cG9ydCBkZWZhdWx0IENPTVBJTEVEX0dBTUU7Il0sIm5hbWVzIjpbIkNPTVBJTEVEX0dBTUUiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./build/.temp/HelloWorld/combined-entry.js\n\n}");

/***/ }),

/***/ "./build/.temp/HelloWorld/engine-entry.js":
/*!************************************************!*\
  !*** ./build/.temp/HelloWorld/engine-entry.js ***!
  \************************************************/
/***/ ((__unused_webpack_module, __unused_webpack___webpack_exports__, __webpack_require__) => {

"use strict";
eval("{/* harmony import */ var C_projects_GUTS_engine_BaseEngine_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./engine/BaseEngine.js */ \"./engine/BaseEngine.js\");\n/* harmony import */ var C_projects_GUTS_engine_BaseEngine_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(C_projects_GUTS_engine_BaseEngine_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var C_projects_GUTS_engine_Engine_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./engine/Engine.js */ \"./engine/Engine.js\");\n/**\n * GUTS Engine Bundle\n * Generated: 2025-12-28T01:00:38.726Z\n */\n\n\n\nwindow.Engine = C_projects_GUTS_engine_Engine_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"];\nwindow.BaseEngine = (C_projects_GUTS_engine_BaseEngine_js__WEBPACK_IMPORTED_MODULE_0___default());\n\n/* unused harmony default export */ var __WEBPACK_DEFAULT_EXPORT__ = (C_projects_GUTS_engine_Engine_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9idWlsZC8udGVtcC9IZWxsb1dvcmxkL2VuZ2luZS1lbnRyeS5qcyIsIm1hcHBpbmdzIjoiOzs7QUFBQTtBQUNBO0FBQ0E7QUFDQTs7QUFFK0Q7QUFDUjtBQUV2REUsTUFBTSxDQUFDRCxNQUFNLEdBQUdBLHdFQUFNO0FBQ3RCQyxNQUFNLENBQUNGLFVBQVUsR0FBR0EsNkVBQVU7QUFFQTtBQUM5QixzRUFBZUMsd0VBQU0iLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90b3dlcmRlZmVuc2UvLi9idWlsZC8udGVtcC9IZWxsb1dvcmxkL2VuZ2luZS1lbnRyeS5qcz9hZTA2Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogR1VUUyBFbmdpbmUgQnVuZGxlXG4gKiBHZW5lcmF0ZWQ6IDIwMjUtMTItMjhUMDE6MDA6MzguNzI2WlxuICovXG5cbmltcG9ydCBCYXNlRW5naW5lIGZyb20gJ0M6L3Byb2plY3RzL0dVVFMvZW5naW5lL0Jhc2VFbmdpbmUuanMnO1xuaW1wb3J0IEVuZ2luZSBmcm9tICdDOi9wcm9qZWN0cy9HVVRTL2VuZ2luZS9FbmdpbmUuanMnO1xuXG53aW5kb3cuRW5naW5lID0gRW5naW5lO1xud2luZG93LkJhc2VFbmdpbmUgPSBCYXNlRW5naW5lO1xuXG5leHBvcnQgeyBCYXNlRW5naW5lLCBFbmdpbmUgfTtcbmV4cG9ydCBkZWZhdWx0IEVuZ2luZTsiXSwibmFtZXMiOlsiQmFzZUVuZ2luZSIsIkVuZ2luZSIsIndpbmRvdyJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./build/.temp/HelloWorld/engine-entry.js\n\n}");

/***/ }),

/***/ "./engine/BaseEngine.js":
/*!******************************!*\
  !*** ./engine/BaseEngine.js ***!
  \******************************/
/***/ ((module, exports) => {

eval("{class BaseEngine {\n  constructor() {\n    this.plugins = {};\n    this.currentTime = Date.now();\n    this.lastTime = Date.now();\n    this.deltaTime = 0;\n    this.accumulator = 0;\n    this.engineClasses = [];\n    this.appClasses = {};\n    this.libraries = {};\n    this.running = false;\n    this.collections = null;\n    this.gameInstance = null;\n  }\n  async loadCollections(projectName) {\n    // This method will be overridden by client and server implementations\n    throw new Error('loadCollections must be implemented by subclass');\n  }\n  getCollections() {\n    return this.collections;\n  }\n  resetAccumulator() {\n    this.accumulator = 0;\n  }\n  start() {\n    this.running = true;\n    this.lastTime = this.getCurrentTime();\n  }\n  stop() {\n    this.running = false;\n  }\n  getCurrentTime() {\n    return Date.now();\n  }\n}\nif (typeof BaseEngine != 'undefined') {\n  if (typeof window !== 'undefined') {\n    window.BaseEngine = BaseEngine;\n  }\n\n  // Make available as ES module export (new for server)  \n  if ( true && module.exports) {\n    module.exports = BaseEngine;\n  }\n\n  // Make available as ES6 export (also new for server)\n  if (true) {\n    exports[\"default\"] = BaseEngine;\n    exports.BaseEngine = BaseEngine;\n  }\n}\n\n// Auto-generated exports\nif (typeof window !== 'undefined' && window.GUTS) {\n  window.GUTS.BaseEngine = BaseEngine;\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9lbmdpbmUvQmFzZUVuZ2luZS5qcyIsIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxVQUFVLENBQUM7RUFDYkMsV0FBV0EsQ0FBQSxFQUFHO0lBQ1YsSUFBSSxDQUFDQyxPQUFPLEdBQUcsQ0FBQyxDQUFDO0lBQ2pCLElBQUksQ0FBQ0MsV0FBVyxHQUFHQyxJQUFJLENBQUNDLEdBQUcsQ0FBQyxDQUFDO0lBQzdCLElBQUksQ0FBQ0MsUUFBUSxHQUFHRixJQUFJLENBQUNDLEdBQUcsQ0FBQyxDQUFDO0lBQzFCLElBQUksQ0FBQ0UsU0FBUyxHQUFHLENBQUM7SUFDbEIsSUFBSSxDQUFDQyxXQUFXLEdBQUcsQ0FBQztJQUNwQixJQUFJLENBQUNDLGFBQWEsR0FBRyxFQUFFO0lBQ3ZCLElBQUksQ0FBQ0MsVUFBVSxHQUFHLENBQUMsQ0FBQztJQUNwQixJQUFJLENBQUNDLFNBQVMsR0FBRyxDQUFDLENBQUM7SUFDbkIsSUFBSSxDQUFDQyxPQUFPLEdBQUcsS0FBSztJQUNwQixJQUFJLENBQUNDLFdBQVcsR0FBRyxJQUFJO0lBQ3ZCLElBQUksQ0FBQ0MsWUFBWSxHQUFHLElBQUk7RUFDNUI7RUFFQSxNQUFNQyxlQUFlQSxDQUFDQyxXQUFXLEVBQUU7SUFDL0I7SUFDQSxNQUFNLElBQUlDLEtBQUssQ0FBQyxpREFBaUQsQ0FBQztFQUN0RTtFQUVBQyxjQUFjQSxDQUFBLEVBQUc7SUFDYixPQUFPLElBQUksQ0FBQ0wsV0FBVztFQUMzQjtFQUdBTSxnQkFBZ0JBLENBQUEsRUFBRztJQUNmLElBQUksQ0FBQ1gsV0FBVyxHQUFHLENBQUM7RUFDeEI7RUFHQVksS0FBS0EsQ0FBQSxFQUFHO0lBQ0osSUFBSSxDQUFDUixPQUFPLEdBQUcsSUFBSTtJQUNuQixJQUFJLENBQUNOLFFBQVEsR0FBRyxJQUFJLENBQUNlLGNBQWMsQ0FBQyxDQUFDO0VBQ3pDO0VBRUFDLElBQUlBLENBQUEsRUFBRztJQUNILElBQUksQ0FBQ1YsT0FBTyxHQUFHLEtBQUs7RUFDeEI7RUFFQVMsY0FBY0EsQ0FBQSxFQUFHO0lBQ2IsT0FBT2pCLElBQUksQ0FBQ0MsR0FBRyxDQUFDLENBQUM7RUFDckI7QUFDSjtBQUNBLElBQUcsT0FBT0wsVUFBVSxJQUFJLFdBQVcsRUFBQztFQUNoQyxJQUFJLE9BQU91QixNQUFNLEtBQUssV0FBVyxFQUFFO0lBQy9CQSxNQUFNLENBQUN2QixVQUFVLEdBQUdBLFVBQVU7RUFDbEM7O0VBRUE7RUFDQSxJQUFJLEtBQTZCLElBQUl3QixNQUFNLENBQUNDLE9BQU8sRUFBRTtJQUNqREQsTUFBTSxDQUFDQyxPQUFPLEdBQUd6QixVQUFVO0VBQy9COztFQUVBO0VBQ0EsSUFBSSxJQUE4QixFQUFFO0lBQ2hDeUIsa0JBQWUsR0FBR3pCLFVBQVU7SUFDNUJ5QixrQkFBa0IsR0FBR3pCLFVBQVU7RUFDbkM7QUFDSjs7QUFFQTtBQUNBLElBQUksT0FBT3VCLE1BQU0sS0FBSyxXQUFXLElBQUlBLE1BQU0sQ0FBQ0ksSUFBSSxFQUFFO0VBQ2hESixNQUFNLENBQUNJLElBQUksQ0FBQzNCLFVBQVUsR0FBR0EsVUFBVTtBQUNyQyIsInNvdXJjZXMiOlsid2VicGFjazovL3Rvd2VyZGVmZW5zZS8uL2VuZ2luZS9CYXNlRW5naW5lLmpzPzk3YzEiXSwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgQmFzZUVuZ2luZSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMucGx1Z2lucyA9IHt9O1xuICAgICAgICB0aGlzLmN1cnJlbnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgICAgdGhpcy5sYXN0VGltZSA9IERhdGUubm93KCk7XG4gICAgICAgIHRoaXMuZGVsdGFUaW1lID0gMDtcbiAgICAgICAgdGhpcy5hY2N1bXVsYXRvciA9IDA7XG4gICAgICAgIHRoaXMuZW5naW5lQ2xhc3NlcyA9IFtdO1xuICAgICAgICB0aGlzLmFwcENsYXNzZXMgPSB7fTtcbiAgICAgICAgdGhpcy5saWJyYXJpZXMgPSB7fTtcbiAgICAgICAgdGhpcy5ydW5uaW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMuY29sbGVjdGlvbnMgPSBudWxsO1xuICAgICAgICB0aGlzLmdhbWVJbnN0YW5jZSA9IG51bGw7XG4gICAgfVxuXG4gICAgYXN5bmMgbG9hZENvbGxlY3Rpb25zKHByb2plY3ROYW1lKSB7XG4gICAgICAgIC8vIFRoaXMgbWV0aG9kIHdpbGwgYmUgb3ZlcnJpZGRlbiBieSBjbGllbnQgYW5kIHNlcnZlciBpbXBsZW1lbnRhdGlvbnNcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdsb2FkQ29sbGVjdGlvbnMgbXVzdCBiZSBpbXBsZW1lbnRlZCBieSBzdWJjbGFzcycpO1xuICAgIH1cblxuICAgIGdldENvbGxlY3Rpb25zKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb2xsZWN0aW9ucztcbiAgICB9XG5cblxuICAgIHJlc2V0QWNjdW11bGF0b3IoKSB7XG4gICAgICAgIHRoaXMuYWNjdW11bGF0b3IgPSAwO1xuICAgIH1cblxuXG4gICAgc3RhcnQoKSB7XG4gICAgICAgIHRoaXMucnVubmluZyA9IHRydWU7XG4gICAgICAgIHRoaXMubGFzdFRpbWUgPSB0aGlzLmdldEN1cnJlbnRUaW1lKCk7XG4gICAgfVxuXG4gICAgc3RvcCgpIHtcbiAgICAgICAgdGhpcy5ydW5uaW5nID0gZmFsc2U7XG4gICAgfVxuXG4gICAgZ2V0Q3VycmVudFRpbWUoKSB7XG4gICAgICAgIHJldHVybiBEYXRlLm5vdygpO1xuICAgIH1cbn1cbmlmKHR5cGVvZiBCYXNlRW5naW5lICE9ICd1bmRlZmluZWQnKXtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgd2luZG93LkJhc2VFbmdpbmUgPSBCYXNlRW5naW5lO1xuICAgIH1cblxuICAgIC8vIE1ha2UgYXZhaWxhYmxlIGFzIEVTIG1vZHVsZSBleHBvcnQgKG5ldyBmb3Igc2VydmVyKSAgXG4gICAgaWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnICYmIG1vZHVsZS5leHBvcnRzKSB7XG4gICAgICAgIG1vZHVsZS5leHBvcnRzID0gQmFzZUVuZ2luZTtcbiAgICB9XG5cbiAgICAvLyBNYWtlIGF2YWlsYWJsZSBhcyBFUzYgZXhwb3J0IChhbHNvIG5ldyBmb3Igc2VydmVyKVxuICAgIGlmICh0eXBlb2YgZXhwb3J0cyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgZXhwb3J0cy5kZWZhdWx0ID0gQmFzZUVuZ2luZTtcbiAgICAgICAgZXhwb3J0cy5CYXNlRW5naW5lID0gQmFzZUVuZ2luZTtcbiAgICB9XG59XG5cbi8vIEF1dG8tZ2VuZXJhdGVkIGV4cG9ydHNcbmlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cuR1VUUykge1xuICB3aW5kb3cuR1VUUy5CYXNlRW5naW5lID0gQmFzZUVuZ2luZTtcbn1cbiJdLCJuYW1lcyI6WyJCYXNlRW5naW5lIiwiY29uc3RydWN0b3IiLCJwbHVnaW5zIiwiY3VycmVudFRpbWUiLCJEYXRlIiwibm93IiwibGFzdFRpbWUiLCJkZWx0YVRpbWUiLCJhY2N1bXVsYXRvciIsImVuZ2luZUNsYXNzZXMiLCJhcHBDbGFzc2VzIiwibGlicmFyaWVzIiwicnVubmluZyIsImNvbGxlY3Rpb25zIiwiZ2FtZUluc3RhbmNlIiwibG9hZENvbGxlY3Rpb25zIiwicHJvamVjdE5hbWUiLCJFcnJvciIsImdldENvbGxlY3Rpb25zIiwicmVzZXRBY2N1bXVsYXRvciIsInN0YXJ0IiwiZ2V0Q3VycmVudFRpbWUiLCJzdG9wIiwid2luZG93IiwibW9kdWxlIiwiZXhwb3J0cyIsImRlZmF1bHQiLCJHVVRTIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./engine/BaseEngine.js\n\n}");

/***/ }),

/***/ "./engine/Engine.js":
/*!**************************!*\
  !*** ./engine/Engine.js ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("{/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* unused harmony export Engine */\nclass Engine extends BaseEngine {\n  constructor(target) {\n    super();\n    this.applicationTarget = document.getElementById(target);\n    this.isServer = false;\n    this.tickRate = 1 / 20; // 20 TPS\n    this.lastTick = 0;\n    const urlParams = new URLSearchParams(window.location.search);\n    this.serverMode = urlParams.get('isServer');\n    this.services = new Map();\n    window.APP = this;\n  }\n  async init(projectName) {\n    this.currentProjectName = projectName;\n    this.collections = await this.loadCollections();\n    if (!this.collections) {\n      console.error(\"Failed to load game configuration\");\n      return;\n    }\n    let projectConfig = this.collections.configs.game;\n    let ui = this.collections.interfaces[projectConfig.interface];\n    if (ui) {\n      let html = ui.html;\n      let css = ui.css;\n      let modals = ui.modals;\n      if (html) {\n        this.applicationTarget.innerHTML += html;\n      }\n      if (css) {\n        let styleTag = document.createElement('style');\n        styleTag.innerHTML = css;\n        document.head.append(styleTag);\n      }\n      if (modals) {\n        modals.forEach(modalId => {\n          let modal = document.createElement('div');\n          modal.setAttribute('id', `modal-${modalId}`);\n          let modalContent = document.createElement('div');\n          modal.classList.add('modal');\n          modalContent.classList.add('modal-content');\n          modal.append(modalContent);\n          modalContent.innerHTML = this.collections.modals[modalId].html;\n          this.applicationTarget.append(modal);\n        });\n      }\n    }\n    this.gameInstance = new GUTS[projectConfig.appLibrary](this);\n    this.loader = new GUTS[projectConfig.appLoaderLibrary](this.gameInstance);\n    await this.loader.load();\n\n    // Cache battle phase enum for game loop comparison\n    const enums = this.gameInstance.call('getEnums');\n    this.battlePhaseEnum = enums?.gamePhase?.battle;\n    this.start();\n  }\n  getCurrentProject() {\n    return this.currentProjectName;\n  }\n  getResourcesPath() {\n    if (window) {\n      let path = window.location.pathname.replace('index.html', 'resources/');\n      return path.slice(1, path.length);\n    }\n    return \"resources/\";\n  }\n  async loadCollections() {\n    // First check localStorage (for editor/development)\n    let project = JSON.parse(localStorage.getItem(this.currentProjectName));\n    if (project) {\n      return project.objectTypes;\n    }\n\n    // Use compiled collections from webpack build\n    if (window.COMPILED_GAME?.collections) {\n      return window.COMPILED_GAME.collections;\n    }\n\n    // No collections available\n    console.warn('No collections found in localStorage or COMPILED_GAME');\n    return {};\n  }\n  hideLoadingScreen() {\n    document.body.style = \"\";\n    requestAnimationFrame(() => {\n      this.applicationTarget.style = '';\n    });\n  }\n  async gameLoop() {\n    if (!this.running) return;\n    const now = this.getCurrentTime();\n    const deltaTime = (now - this.lastTick) / 1000;\n    this.lastTick = now;\n\n    // Always accumulate time for fixed timestep\n    this.accumulator += deltaTime;\n\n    // Process ticks at fixed rate, limit per frame to catch up gradually\n    // This prevents lag spikes while maintaining sync\n    const maxTicksPerFrame = 3;\n    let ticksProcessed = 0;\n    while (this.accumulator >= this.tickRate && ticksProcessed < maxTicksPerFrame) {\n      await this.tick();\n      this.accumulator -= this.tickRate;\n      ticksProcessed++;\n    }\n\n    // Schedule next frame using requestAnimationFrame when tab is active\n    if (this.useRAF) {\n      this.animationFrameId = requestAnimationFrame(() => this.gameLoop());\n    }\n  }\n\n  /**\r\n   * Reset the accumulator to prevent catchup after sync\r\n   */\n  resetAccumulator() {\n    this.accumulator = 0;\n    this.lastTick = this.getCurrentTime();\n  }\n  handleVisibilityChange() {\n    if (document.hidden) {\n      // Tab is hidden - switch to setInterval\n      this.useRAF = false;\n      if (this.animationFrameId) {\n        cancelAnimationFrame(this.animationFrameId);\n        this.animationFrameId = null;\n      }\n      // Use setInterval to keep running in background\n      this.intervalId = setInterval(() => this.gameLoop(), 16);\n    } else {\n      // Tab is visible - switch to requestAnimationFrame\n      this.useRAF = true;\n      if (this.intervalId) {\n        clearInterval(this.intervalId);\n        this.intervalId = null;\n      }\n      // Notify game that tab became visible (for catchup handling)\n      if (this.gameInstance?.triggerEvent) {\n        this.gameInstance.triggerEvent('onTabVisible');\n      }\n      this.animationFrameId = requestAnimationFrame(() => this.gameLoop());\n    }\n  }\n  async tick() {\n    // Update all active game rooms\n    if (this.gameInstance && this.gameInstance.update) {\n      await this.gameInstance.update(this.tickRate);\n    }\n  }\n  start() {\n    super.start();\n    this.lastTick = this.getCurrentTime();\n    this.useRAF = true;\n\n    // Listen for tab visibility changes\n    this.visibilityHandler = () => this.handleVisibilityChange();\n    document.addEventListener('visibilitychange', this.visibilityHandler);\n\n    // Start with requestAnimationFrame\n    this.animationFrameId = requestAnimationFrame(() => this.gameLoop());\n    requestAnimationFrame(() => {\n      this.hideLoadingScreen();\n    });\n  }\n  stop() {\n    super.stop();\n    if (this.animationFrameId) {\n      cancelAnimationFrame(this.animationFrameId);\n      this.animationFrameId = null;\n    }\n    if (this.intervalId) {\n      clearInterval(this.intervalId);\n      this.intervalId = null;\n    }\n    if (this.visibilityHandler) {\n      document.removeEventListener('visibilitychange', this.visibilityHandler);\n      this.visibilityHandler = null;\n    }\n  }\n  getCurrentTime() {\n    return performance.now();\n  }\n  addService(key, serviceInstance) {\n    if (!this.services.get(key)) {\n      this.services.set(key, serviceInstance);\n    } else {\n      console.warn('duplicate service key', key);\n    }\n  }\n}\n\n// Auto-generated exports\nif (typeof window !== 'undefined' && window.GUTS) {\n  window.GUTS.Engine = Engine;\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Engine);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QkFBaUIsR0FBRyxJQUFJO0lBQ2pDO0VBQ0o7RUFDQWpCLGNBQWNBLENBQUEsRUFBRztJQUNiLE9BQU9xQixXQUFXLENBQUN0QixHQUFHLENBQUMsQ0FBQztFQUM1QjtFQUVBdUIsVUFBVUEsQ0FBQ0MsR0FBRyxFQUFFQyxlQUFlLEVBQUU7SUFDN0IsSUFBRyxDQUFDLElBQUksQ0FBQ3pGLFFBQVEsQ0FBQ0QsR0FBRyxDQUFDeUYsR0FBRyxDQUFDLEVBQUM7TUFDdkIsSUFBSSxDQUFDeEYsUUFBUSxDQUFDMEYsR0FBRyxDQUFDRixHQUFHLEVBQUVDLGVBQWUsQ0FBQztJQUMzQyxDQUFDLE1BQU07TUFDSGpGLE9BQU8sQ0FBQ2lELElBQUksQ0FBQyx1QkFBdUIsRUFBRStCLEdBQUcsQ0FBQztJQUM5QztFQUNKO0FBQ0o7O0FBRUE7QUFDQSxJQUFJLE9BQU83RixNQUFNLEtBQUssV0FBVyxJQUFJQSxNQUFNLENBQUNxQyxJQUFJLEVBQUU7RUFDaERyQyxNQUFNLENBQUNxQyxJQUFJLENBQUNqRCxNQUFNLEdBQUdBLE1BQU07QUFDN0I7QUFFQSxpRUFBZUEsTUFBTSxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdG93ZXJkZWZlbnNlLy4vZW5naW5lL0VuZ2luZS5qcz8zZTU0Il0sInNvdXJjZXNDb250ZW50IjpbImNsYXNzIEVuZ2luZSBleHRlbmRzIEJhc2VFbmdpbmUge1xyXG4gICAgY29uc3RydWN0b3IodGFyZ2V0KSB7XHJcbiAgICAgICAgc3VwZXIoKTtcclxuICAgICAgICB0aGlzLmFwcGxpY2F0aW9uVGFyZ2V0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGFyZ2V0KTtcclxuICAgICAgICB0aGlzLmlzU2VydmVyID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy50aWNrUmF0ZSA9IDEgLyAyMDsgLy8gMjAgVFBTXHJcbiAgICAgICAgdGhpcy5sYXN0VGljayA9IDA7XHJcbiAgICAgICAgY29uc3QgdXJsUGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh3aW5kb3cubG9jYXRpb24uc2VhcmNoKTtcclxuICAgICAgICB0aGlzLnNlcnZlck1vZGUgPSB1cmxQYXJhbXMuZ2V0KCdpc1NlcnZlcicpO1xyXG4gICAgICAgIHRoaXMuc2VydmljZXMgPSBuZXcgTWFwKCk7XHJcbiAgICAgICAgd2luZG93LkFQUCA9IHRoaXM7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgaW5pdChwcm9qZWN0TmFtZSkge1xyXG4gICAgICAgIHRoaXMuY3VycmVudFByb2plY3ROYW1lID0gcHJvamVjdE5hbWU7XHJcbiAgICAgICAgdGhpcy5jb2xsZWN0aW9ucyA9IGF3YWl0IHRoaXMubG9hZENvbGxlY3Rpb25zKCk7XHJcbiAgICAgICAgaWYgKCF0aGlzLmNvbGxlY3Rpb25zKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gbG9hZCBnYW1lIGNvbmZpZ3VyYXRpb25cIik7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBwcm9qZWN0Q29uZmlnID0gdGhpcy5jb2xsZWN0aW9ucy5jb25maWdzLmdhbWU7XHJcblxyXG5cclxuICAgICAgICBsZXQgdWkgPSB0aGlzLmNvbGxlY3Rpb25zLmludGVyZmFjZXNbcHJvamVjdENvbmZpZy5pbnRlcmZhY2VdO1xyXG4gICAgICAgIGlmICh1aSkge1xyXG4gICAgICAgICAgICBsZXQgaHRtbCA9IHVpLmh0bWw7XHJcbiAgICAgICAgICAgIGxldCBjc3MgPSB1aS5jc3M7XHJcbiAgICAgICAgICAgIGxldCBtb2RhbHMgPSB1aS5tb2RhbHM7XHJcbiAgICAgICAgICAgIGlmIChodG1sKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFwcGxpY2F0aW9uVGFyZ2V0LmlubmVySFRNTCArPSBodG1sO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChjc3MpIHtcclxuICAgICAgICAgICAgICAgIGxldCBzdHlsZVRhZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyk7XHJcbiAgICAgICAgICAgICAgICBzdHlsZVRhZy5pbm5lckhUTUwgPSBjc3M7XHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5oZWFkLmFwcGVuZChzdHlsZVRhZyk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChtb2RhbHMpIHtcclxuICAgICAgICAgICAgICAgIG1vZGFscy5mb3JFYWNoKChtb2RhbElkKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IG1vZGFsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgbW9kYWwuc2V0QXR0cmlidXRlKCdpZCcsIGBtb2RhbC0ke21vZGFsSWR9YCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IG1vZGFsQ29udGVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgICAgICAgICAgIG1vZGFsLmNsYXNzTGlzdC5hZGQoJ21vZGFsJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgbW9kYWxDb250ZW50LmNsYXNzTGlzdC5hZGQoJ21vZGFsLWNvbnRlbnQnKTtcclxuICAgICAgICAgICAgICAgICAgICBtb2RhbC5hcHBlbmQobW9kYWxDb250ZW50KTtcclxuICAgICAgICAgICAgICAgICAgICBtb2RhbENvbnRlbnQuaW5uZXJIVE1MID0gdGhpcy5jb2xsZWN0aW9ucy5tb2RhbHNbbW9kYWxJZF0uaHRtbDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcGxpY2F0aW9uVGFyZ2V0LmFwcGVuZChtb2RhbCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcblxyXG5cclxuICAgICAgICB0aGlzLmdhbWVJbnN0YW5jZSA9IG5ldyBHVVRTW3Byb2plY3RDb25maWcuYXBwTGlicmFyeV0odGhpcyk7XHJcbiAgICAgICAgdGhpcy5sb2FkZXIgPSBuZXcgR1VUU1twcm9qZWN0Q29uZmlnLmFwcExvYWRlckxpYnJhcnldKHRoaXMuZ2FtZUluc3RhbmNlKTtcclxuICAgICAgICBhd2FpdCB0aGlzLmxvYWRlci5sb2FkKCk7XHJcblxyXG4gICAgICAgIC8vIENhY2hlIGJhdHRsZSBwaGFzZSBlbnVtIGZvciBnYW1lIGxvb3AgY29tcGFyaXNvblxyXG4gICAgICAgIGNvbnN0IGVudW1zID0gdGhpcy5nYW1lSW5zdGFuY2UuY2FsbCgnZ2V0RW51bXMnKTtcclxuICAgICAgICB0aGlzLmJhdHRsZVBoYXNlRW51bSA9IGVudW1zPy5nYW1lUGhhc2U/LmJhdHRsZTtcclxuXHJcbiAgICAgICAgdGhpcy5zdGFydCgpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldEN1cnJlbnRQcm9qZWN0KCl7IFxyXG4gICAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRQcm9qZWN0TmFtZTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRSZXNvdXJjZXNQYXRoKCl7IFxyXG4gICAgICAgIGlmKHdpbmRvdyl7XHJcbiAgICAgICAgICAgIGxldCBwYXRoID0gd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lLnJlcGxhY2UoJ2luZGV4Lmh0bWwnLCAncmVzb3VyY2VzLycpO1xyXG4gICAgICAgICAgICByZXR1cm4gcGF0aC5zbGljZSgxLCBwYXRoLmxlbmd0aCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBcInJlc291cmNlcy9cIjtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBsb2FkQ29sbGVjdGlvbnMoKSB7XHJcbiAgICAgICAgLy8gRmlyc3QgY2hlY2sgbG9jYWxTdG9yYWdlIChmb3IgZWRpdG9yL2RldmVsb3BtZW50KVxyXG4gICAgICAgIGxldCBwcm9qZWN0ID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSh0aGlzLmN1cnJlbnRQcm9qZWN0TmFtZSkpO1xyXG5cclxuICAgICAgICBpZiAocHJvamVjdCkge1xyXG4gICAgICAgICAgICByZXR1cm4gcHJvamVjdC5vYmplY3RUeXBlcztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFVzZSBjb21waWxlZCBjb2xsZWN0aW9ucyBmcm9tIHdlYnBhY2sgYnVpbGRcclxuICAgICAgICBpZiAod2luZG93LkNPTVBJTEVEX0dBTUU/LmNvbGxlY3Rpb25zKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB3aW5kb3cuQ09NUElMRURfR0FNRS5jb2xsZWN0aW9ucztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIE5vIGNvbGxlY3Rpb25zIGF2YWlsYWJsZVxyXG4gICAgICAgIGNvbnNvbGUud2FybignTm8gY29sbGVjdGlvbnMgZm91bmQgaW4gbG9jYWxTdG9yYWdlIG9yIENPTVBJTEVEX0dBTUUnKTtcclxuICAgICAgICByZXR1cm4ge307XHJcbiAgICB9XHJcblxyXG4gICAgaGlkZUxvYWRpbmdTY3JlZW4oKSB7XHJcbiAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZSA9IFwiXCI7XHJcbiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5hcHBsaWNhdGlvblRhcmdldC5zdHlsZSA9ICcnO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgYXN5bmMgZ2FtZUxvb3AoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLnJ1bm5pbmcpIHJldHVybjtcclxuXHJcbiAgICAgICAgY29uc3Qgbm93ID0gdGhpcy5nZXRDdXJyZW50VGltZSgpO1xyXG4gICAgICAgIGNvbnN0IGRlbHRhVGltZSA9IChub3cgLSB0aGlzLmxhc3RUaWNrKSAvIDEwMDA7XHJcbiAgICAgICAgdGhpcy5sYXN0VGljayA9IG5vdztcclxuXHJcbiAgICAgICAgLy8gQWx3YXlzIGFjY3VtdWxhdGUgdGltZSBmb3IgZml4ZWQgdGltZXN0ZXBcclxuICAgICAgICB0aGlzLmFjY3VtdWxhdG9yICs9IGRlbHRhVGltZTtcclxuXHJcbiAgICAgICAgLy8gUHJvY2VzcyB0aWNrcyBhdCBmaXhlZCByYXRlLCBsaW1pdCBwZXIgZnJhbWUgdG8gY2F0Y2ggdXAgZ3JhZHVhbGx5XHJcbiAgICAgICAgLy8gVGhpcyBwcmV2ZW50cyBsYWcgc3Bpa2VzIHdoaWxlIG1haW50YWluaW5nIHN5bmNcclxuICAgICAgICBjb25zdCBtYXhUaWNrc1BlckZyYW1lID0gMztcclxuICAgICAgICBsZXQgdGlja3NQcm9jZXNzZWQgPSAwO1xyXG5cclxuICAgICAgICB3aGlsZSAodGhpcy5hY2N1bXVsYXRvciA+PSB0aGlzLnRpY2tSYXRlICYmIHRpY2tzUHJvY2Vzc2VkIDwgbWF4VGlja3NQZXJGcmFtZSkge1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnRpY2soKTtcclxuICAgICAgICAgICAgdGhpcy5hY2N1bXVsYXRvciAtPSB0aGlzLnRpY2tSYXRlO1xyXG4gICAgICAgICAgICB0aWNrc1Byb2Nlc3NlZCsrO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gU2NoZWR1bGUgbmV4dCBmcmFtZSB1c2luZyByZXF1ZXN0QW5pbWF0aW9uRnJhbWUgd2hlbiB0YWIgaXMgYWN0aXZlXHJcbiAgICAgICAgaWYgKHRoaXMudXNlUkFGKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYW5pbWF0aW9uRnJhbWVJZCA9IHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB0aGlzLmdhbWVMb29wKCkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJlc2V0IHRoZSBhY2N1bXVsYXRvciB0byBwcmV2ZW50IGNhdGNodXAgYWZ0ZXIgc3luY1xyXG4gICAgICovXHJcbiAgICByZXNldEFjY3VtdWxhdG9yKCkge1xyXG4gICAgICAgIHRoaXMuYWNjdW11bGF0b3IgPSAwO1xyXG4gICAgICAgIHRoaXMubGFzdFRpY2sgPSB0aGlzLmdldEN1cnJlbnRUaW1lKCk7XHJcbiAgICB9XHJcblxyXG4gICAgaGFuZGxlVmlzaWJpbGl0eUNoYW5nZSgpIHtcclxuICAgICAgICBpZiAoZG9jdW1lbnQuaGlkZGVuKSB7XHJcbiAgICAgICAgICAgIC8vIFRhYiBpcyBoaWRkZW4gLSBzd2l0Y2ggdG8gc2V0SW50ZXJ2YWxcclxuICAgICAgICAgICAgdGhpcy51c2VSQUYgPSBmYWxzZTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuYW5pbWF0aW9uRnJhbWVJZCkge1xyXG4gICAgICAgICAgICAgICAgY2FuY2VsQW5pbWF0aW9uRnJhbWUodGhpcy5hbmltYXRpb25GcmFtZUlkKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYW5pbWF0aW9uRnJhbWVJZCA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gVXNlIHNldEludGVydmFsIHRvIGtlZXAgcnVubmluZyBpbiBiYWNrZ3JvdW5kXHJcbiAgICAgICAgICAgIHRoaXMuaW50ZXJ2YWxJZCA9IHNldEludGVydmFsKCgpID0+IHRoaXMuZ2FtZUxvb3AoKSwgMTYpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIFRhYiBpcyB2aXNpYmxlIC0gc3dpdGNoIHRvIHJlcXVlc3RBbmltYXRpb25GcmFtZVxyXG4gICAgICAgICAgICB0aGlzLnVzZVJBRiA9IHRydWU7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmludGVydmFsSWQpIHtcclxuICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5pbnRlcnZhbElkKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaW50ZXJ2YWxJZCA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gTm90aWZ5IGdhbWUgdGhhdCB0YWIgYmVjYW1lIHZpc2libGUgKGZvciBjYXRjaHVwIGhhbmRsaW5nKVxyXG4gICAgICAgICAgICBpZiAodGhpcy5nYW1lSW5zdGFuY2U/LnRyaWdnZXJFdmVudCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5nYW1lSW5zdGFuY2UudHJpZ2dlckV2ZW50KCdvblRhYlZpc2libGUnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmFuaW1hdGlvbkZyYW1lSWQgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4gdGhpcy5nYW1lTG9vcCgpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgdGljaygpIHtcclxuICAgICAgICAvLyBVcGRhdGUgYWxsIGFjdGl2ZSBnYW1lIHJvb21zXHJcbiAgICAgICAgaWYgKHRoaXMuZ2FtZUluc3RhbmNlICYmIHRoaXMuZ2FtZUluc3RhbmNlLnVwZGF0ZSkge1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLmdhbWVJbnN0YW5jZS51cGRhdGUodGhpcy50aWNrUmF0ZSk7ICAgICAgICBcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICB9XHJcbiAgICBzdGFydCgpIHtcclxuICAgICAgICBzdXBlci5zdGFydCgpO1xyXG4gICAgICAgIHRoaXMubGFzdFRpY2sgPSB0aGlzLmdldEN1cnJlbnRUaW1lKCk7XHJcbiAgICAgICAgdGhpcy51c2VSQUYgPSB0cnVlO1xyXG5cclxuICAgICAgICAvLyBMaXN0ZW4gZm9yIHRhYiB2aXNpYmlsaXR5IGNoYW5nZXNcclxuICAgICAgICB0aGlzLnZpc2liaWxpdHlIYW5kbGVyID0gKCkgPT4gdGhpcy5oYW5kbGVWaXNpYmlsaXR5Q2hhbmdlKCk7XHJcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndmlzaWJpbGl0eWNoYW5nZScsIHRoaXMudmlzaWJpbGl0eUhhbmRsZXIpO1xyXG5cclxuICAgICAgICAvLyBTdGFydCB3aXRoIHJlcXVlc3RBbmltYXRpb25GcmFtZVxyXG4gICAgICAgIHRoaXMuYW5pbWF0aW9uRnJhbWVJZCA9IHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB0aGlzLmdhbWVMb29wKCkpO1xyXG4gICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuaGlkZUxvYWRpbmdTY3JlZW4oKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBzdG9wKCkge1xyXG4gICAgICAgIHN1cGVyLnN0b3AoKTtcclxuICAgICAgICBpZiAodGhpcy5hbmltYXRpb25GcmFtZUlkKSB7XHJcbiAgICAgICAgICAgIGNhbmNlbEFuaW1hdGlvbkZyYW1lKHRoaXMuYW5pbWF0aW9uRnJhbWVJZCk7XHJcbiAgICAgICAgICAgIHRoaXMuYW5pbWF0aW9uRnJhbWVJZCA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmludGVydmFsSWQpIHtcclxuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmludGVydmFsSWQpO1xyXG4gICAgICAgICAgICB0aGlzLmludGVydmFsSWQgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy52aXNpYmlsaXR5SGFuZGxlcikge1xyXG4gICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCd2aXNpYmlsaXR5Y2hhbmdlJywgdGhpcy52aXNpYmlsaXR5SGFuZGxlcik7XHJcbiAgICAgICAgICAgIHRoaXMudmlzaWJpbGl0eUhhbmRsZXIgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGdldEN1cnJlbnRUaW1lKCkge1xyXG4gICAgICAgIHJldHVybiBwZXJmb3JtYW5jZS5ub3coKTtcclxuICAgIH1cclxuXHJcbiAgICBhZGRTZXJ2aWNlKGtleSwgc2VydmljZUluc3RhbmNlKSB7XHJcbiAgICAgICAgaWYoIXRoaXMuc2VydmljZXMuZ2V0KGtleSkpe1xyXG4gICAgICAgICAgICB0aGlzLnNlcnZpY2VzLnNldChrZXksIHNlcnZpY2VJbnN0YW5jZSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc29sZS53YXJuKCdkdXBsaWNhdGUgc2VydmljZSBrZXknLCBrZXkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxuXG4vLyBBdXRvLWdlbmVyYXRlZCBleHBvcnRzXG5pZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgd2luZG93LkdVVFMpIHtcbiAgd2luZG93LkdVVFMuRW5naW5lID0gRW5naW5lO1xufVxuXG5leHBvcnQgZGVmYXVsdCBFbmdpbmU7XG5leHBvcnQgeyBFbmdpbmUgfTtcbiJdLCJuYW1lcyI6WyJFbmdpbmUiLCJCYXNlRW5naW5lIiwiY29uc3RydWN0b3IiLCJ0YXJnZXQiLCJhcHBsaWNhdGlvblRhcmdldCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJpc1NlcnZlciIsInRpY2tSYXRlIiwibGFzdFRpY2siLCJ1cmxQYXJhbXMiLCJVUkxTZWFyY2hQYXJhbXMiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsInNlYXJjaCIsInNlcnZlck1vZGUiLCJnZXQiLCJzZXJ2aWNlcyIsIk1hcCIsIkFQUCIsImluaXQiLCJwcm9qZWN0TmFtZSIsImN1cnJlbnRQcm9qZWN0TmFtZSIsImNvbGxlY3Rpb25zIiwibG9hZENvbGxlY3Rpb25zIiwiY29uc29sZSIsImVycm9yIiwicHJvamVjdENvbmZpZyIsImNvbmZpZ3MiLCJnYW1lIiwidWkiLCJpbnRlcmZhY2VzIiwiaW50ZXJmYWNlIiwiaHRtbCIsImNzcyIsIm1vZGFscyIsImlubmVySFRNTCIsInN0eWxlVGFnIiwiY3JlYXRlRWxlbWVudCIsImhlYWQiLCJhcHBlbmQiLCJmb3JFYWNoIiwibW9kYWxJZCIsIm1vZGFsIiwic2V0QXR0cmlidXRlIiwibW9kYWxDb250ZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwiZ2FtZUluc3RhbmNlIiwiR1VUUyIsImFwcExpYnJhcnkiLCJsb2FkZXIiLCJhcHBMb2FkZXJMaWJyYXJ5IiwibG9hZCIsImVudW1zIiwiY2FsbCIsImJhdHRsZVBoYXNlRW51bSIsImdhbWVQaGFzZSIsImJhdHRsZSIsInN0YXJ0IiwiZ2V0Q3VycmVudFByb2plY3QiLCJnZXRSZXNvdXJjZXNQYXRoIiwicGF0aCIsInBhdGhuYW1lIiwicmVwbGFjZSIsInNsaWNlIiwibGVuZ3RoIiwicHJvamVjdCIsIkpTT04iLCJwYXJzZSIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJvYmplY3RUeXBlcyIsIkNPTVBJTEVEX0dBTUUiLCJ3YXJuIiwiaGlkZUxvYWRpbmdTY3JlZW4iLCJib2R5Iiwic3R5bGUiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJnYW1lTG9vcCIsInJ1bm5pbmciLCJub3ciLCJnZXRDdXJyZW50VGltZSIsImRlbHRhVGltZSIsImFjY3VtdWxhdG9yIiwibWF4VGlja3NQZXJGcmFtZSIsInRpY2tzUHJvY2Vzc2VkIiwidGljayIsInVzZVJBRiIsImFuaW1hdGlvbkZyYW1lSWQiLCJyZXNldEFjY3VtdWxhdG9yIiwiaGFuZGxlVmlzaWJpbGl0eUNoYW5nZSIsImhpZGRlbiIsImNhbmNlbEFuaW1hdGlvbkZyYW1lIiwiaW50ZXJ2YWxJZCIsInNldEludGVydmFsIiwiY2xlYXJJbnRlcnZhbCIsInRyaWdnZXJFdmVudCIsInVwZGF0ZSIsInZpc2liaWxpdHlIYW5kbGVyIiwiYWRkRXZlbnRMaXN0ZW5lciIsInN0b3AiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwicGVyZm9ybWFuY2UiLCJhZGRTZXJ2aWNlIiwia2V5Iiwic2VydmljZUluc3RhbmNlIiwic2V0Il0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./engine/Engine.js\n\n}");

/***/ }),

/***/ "./global/collections/scripts/libraries/js/BaseECSGame.js":
/*!****************************************************************!*\
  !*** ./global/collections/scripts/libraries/js/BaseECSGame.js ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BaseECSGame: () => (/* binding */ BaseECSGame),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nclass BaseECSGame {\n  constructor(app) {\n    this.app = app;\n    this.state = {};\n    this.entitiesToAdd = [];\n    this.classes = [];\n    this.systems = [];\n\n    // Scene management\n    this.sceneManager = null;\n\n    // Service registry\n    this._services = new GUTS.GameServices();\n\n    // ============================================\n    // HIGH-PERFORMANCE ECS STORAGE (10k+ entities)\n    // ============================================\n\n    // Maximum entities - pre-allocate for performance\n    this.MAX_ENTITIES = 65536; // Power of 2 for fast modulo\n\n    // Entity management with TypedArrays\n    // entityAlive[i] = 1 if entity i exists, 0 if free slot\n    this.entityAlive = new Uint8Array(this.MAX_ENTITIES);\n    // Component bitmask per entity (up to 32 component types with single Uint32)\n    // For more components, we use multiple Uint32s\n    this.entityComponentMask = new Uint32Array(this.MAX_ENTITIES * 2); // 64 component types max\n\n    // Free entity ID pool for recycling\n    this.freeEntityIds = new Uint32Array(this.MAX_ENTITIES);\n    this.freeEntityCount = 0;\n    this.nextEntityId = 1; // Start at 1, reserve 0 as \"no entity\"\n    this.entityCount = 0;\n\n    // Component type registry - maps component name to numeric ID (0-63)\n    this._componentTypeId = new Map(); // componentName -> typeId\n    this._componentTypeNames = []; // typeId -> componentName\n    this._nextComponentTypeId = 0;\n\n    // SoA (Structure of Arrays) storage for numeric components\n    // Each numeric field gets its own Float32Array for cache-friendly iteration\n    this._numericArrays = new Map(); // \"componentType.field.path\" -> Float32Array\n\n    // Track which components are numeric-only (use TypedArrays)\n    // Maps componentId -> { fields: ['field1', 'nested.field2'], isNumeric: true }\n    this._numericComponentInfo = new Map();\n\n    // Object storage for non-numeric/complex component data\n    // Pre-allocated array of objects, indexed by entity ID\n    this._objectComponents = new Map(); // componentType -> Array[MAX_ENTITIES]\n\n    // Query cache for getEntitiesWith - stores reusable arrays to avoid allocations\n    this._queryCache = new Map();\n\n    // Delta sync tracking - stores last synced state for computing deltas\n    this._lastSyncedState = null;\n\n    // Client-only components - excluded from server sync to preserve client state\n    // These components are managed locally and should not be overwritten by server\n    this._clientOnlyComponents = new Set(['renderable', 'animationState']);\n\n    // Proxy cache for getComponent - avoids creating new proxies every call\n    // Map: componentType -> Map(entityId -> proxy)\n    this._proxyCache = new Map();\n\n    // Pre-allocated result array for queries (avoids allocation in hot path)\n    this._queryResultBuffer = new Uint32Array(this.MAX_ENTITIES);\n    this.lastTime = 0;\n    this.currentTime = 0;\n    this.deltaTime = 0;\n    this.tickCount = 0;\n\n    // Fixed timestep for deterministic simulation (20 TPS = 0.05s per tick)\n    this.FIXED_DELTA_TIME = 1 / 20;\n    this.isServer = false;\n    // Performance monitoring\n    if (typeof GUTS !== 'undefined' && typeof GUTS.PerformanceMonitor !== 'undefined') {\n      this.performanceMonitor = new GUTS.PerformanceMonitor();\n    }\n\n    // Call logging for debugging\n    if (typeof GUTS !== 'undefined' && typeof GUTS.CallLogger !== 'undefined') {\n      this.callLogger = new GUTS.CallLogger();\n    }\n\n    // Global seeded random instance - can be reseeded for deterministic simulation\n    if (typeof GUTS !== 'undefined' && typeof GUTS.SeededRandom !== 'undefined') {\n      this.rng = new GUTS.SeededRandom(Date.now());\n    }\n\n    // Initialize component type registry with common components\n    this._initComponentTypes();\n  }\n\n  /**\r\n   * Pre-register common component types and allocate their storage\r\n   */\n  _initComponentTypes() {\n    const collections = this.getCollections();\n    this.componentGenerator = new GUTS.ComponentGenerator(collections.components, collections);\n    this.register(\"getComponents\", this.getComponents.bind(this));\n    this.register(\"getComponentSchema\", this.getComponentSchema.bind(this));\n    this.register(\"getEnumMap\", this.getEnumMap.bind(this));\n    this.register(\"getEnums\", this.getEnums.bind(this));\n    this.register(\"getReverseEnums\", this.getReverseEnums.bind(this));\n    this.register(\"getUnitTypeDef\", this.getUnitTypeDef.bind(this));\n\n    // Pre-register all component types in alphabetical order for deterministic type IDs\n    // This ensures server and client have identical type ID mappings\n    const componentNames = Object.keys(collections.components).sort();\n    for (const componentName of componentNames) {\n      this._getComponentTypeId(componentName);\n    }\n  }\n\n  /**\r\n   * Get or create a numeric component type ID\r\n   */\n  _getComponentTypeId(componentType) {\n    let typeId = this._componentTypeId.get(componentType);\n    if (typeId === undefined) {\n      typeId = this._nextComponentTypeId++;\n      this._componentTypeId.set(componentType, typeId);\n      this._componentTypeNames[typeId] = componentType;\n    }\n    return typeId;\n  }\n\n  /**\r\n   * Set component bit in entity's bitmask\r\n   */\n  _setComponentBit(entityId, componentTypeId) {\n    const maskIndex = entityId * 2 + (componentTypeId >= 32 ? 1 : 0);\n    const bit = componentTypeId % 32;\n    this.entityComponentMask[maskIndex] |= 1 << bit;\n  }\n\n  /**\r\n   * Clear component bit in entity's bitmask\r\n   */\n  _clearComponentBit(entityId, componentTypeId) {\n    const maskIndex = entityId * 2 + (componentTypeId >= 32 ? 1 : 0);\n    const bit = componentTypeId % 32;\n    this.entityComponentMask[maskIndex] &= ~(1 << bit);\n  }\n\n  /**\r\n   * Check if entity has component via bitmask\r\n   */\n  _hasComponentBit(entityId, componentTypeId) {\n    const maskIndex = entityId * 2 + (componentTypeId >= 32 ? 1 : 0);\n    const bit = componentTypeId % 32;\n    return (this.entityComponentMask[maskIndex] & 1 << bit) !== 0;\n  }\n\n  /**\r\n   * Get or create Float32Array for a numeric field\r\n   */\n  _getNumericArray(key) {\n    let arr = this._numericArrays.get(key);\n    if (!arr) {\n      arr = new Float32Array(this.MAX_ENTITIES);\n      this._numericArrays.set(key, arr);\n    }\n    return arr;\n  }\n\n  /**\r\n   * Get or create object storage array for a component type\r\n   */\n  _getObjectStorage(componentType) {\n    let storage = this._objectComponents.get(componentType);\n    if (!storage) {\n      storage = new Array(this.MAX_ENTITIES);\n      this._objectComponents.set(componentType, storage);\n    }\n    return storage;\n  }\n\n  /**\r\n   * Analyze a component schema to determine if it's all-numeric\r\n   * Returns { isNumeric: true, fields: ['field1', 'nested.field2'] } or { isNumeric: false }\r\n   * Numbers, booleans (stored as 0/1), enum strings, and arrays of enum values (bitmasks) are all considered numeric.\r\n   * @param {Object} schema - The component schema\r\n   * @param {Object|null} enumMap - The enum map if this component has enums\r\n   * @param {string} prefix - Path prefix for nested fields\r\n   */\n  _analyzeComponentSchema(schema, enumMap = null, prefix = '') {\n    const fields = [];\n    let isNumeric = true;\n    for (const key in schema) {\n      const value = schema[key];\n      const fieldPath = prefix ? `${prefix}.${key}` : key;\n      if (typeof value === 'number') {\n        fields.push(fieldPath);\n      } else if (typeof value === 'boolean') {\n        // Booleans stored as 0/1 in TypedArrays\n        fields.push(fieldPath);\n      } else if (value === null) {\n        // null fields stored as -Infinity in TypedArrays\n        fields.push(fieldPath);\n      } else if (typeof value === 'string' && enumMap && enumMap.toIndex.hasOwnProperty(value)) {\n        // String that will be converted to enum index - treat as numeric\n        fields.push(fieldPath);\n      } else if (Array.isArray(value) && enumMap) {\n        // Arrays of enum values will be converted to bitmask - treat as numeric\n        // Check if array contains enum values or \"all\"\n        const isEnumArray = value.every(item => item === 'all' || enumMap.toIndex.hasOwnProperty(item));\n        if (isEnumArray) {\n          fields.push(fieldPath);\n        } else {\n          isNumeric = false;\n          break;\n        }\n      } else if (value && typeof value === 'object' && !Array.isArray(value)) {\n        // Recursively check nested objects\n        const nested = this._analyzeComponentSchema(value, enumMap, fieldPath);\n        if (nested.isNumeric) {\n          fields.push(...nested.fields);\n        } else {\n          isNumeric = false;\n          break;\n        }\n      } else {\n        // String (non-enum), non-enum array, null, etc. - not purely numeric\n        isNumeric = false;\n        break;\n      }\n    }\n    return {\n      isNumeric,\n      fields\n    };\n  }\n\n  /**\r\n   * Register a component type and set up storage (TypedArrays for numeric, object array otherwise)\r\n   * Called when a component is first added\r\n   */\n  _setupComponentStorage(componentId, schema, enumMap = null) {\n    if (this._numericComponentInfo.has(componentId)) {\n      return; // Already set up\n    }\n    const analysis = this._analyzeComponentSchema(schema, enumMap);\n    // Cache both schemas for getComponent:\n    // - schema: expanded schema (used for TypedArray field enumeration)\n    // - originalSchema: preserves $fixedArray directives for array proxy creation\n    analysis.schema = schema;\n    analysis.originalSchema = this.componentGenerator.getOriginalSchema(componentId);\n    this._numericComponentInfo.set(componentId, analysis);\n    if (analysis.isNumeric) {\n      // Create TypedArrays for each field\n      for (const fieldPath of analysis.fields) {\n        const key = `${componentId}.${fieldPath}`;\n        this._getNumericArray(key);\n      }\n    }\n  }\n\n  /**\r\n   * Set a value in a numeric component's TypedArray storage\r\n   * Note: Caller should use _toStorageValue() if passing user-provided values\r\n   */\n  _setNumericField(componentId, entityId, fieldPath, value) {\n    const key = `${componentId}.${fieldPath}`;\n    const arr = this._numericArrays.get(key);\n    if (arr) {\n      arr[entityId] = value;\n    }\n  }\n\n  /**\r\n   * Get a value from a numeric component's TypedArray storage (internal)\r\n   * Converts -Infinity (null sentinel) back to null for API consumers\r\n   */\n  _getNumericField(componentId, entityId, fieldPath) {\n    const key = `${componentId}.${fieldPath}`;\n    const arr = this._numericArrays.get(key);\n    if (!arr) return undefined;\n    return this._fromStorageValue(arr[entityId]);\n  }\n\n  /**\r\n   * Get raw value from TypedArray storage without null conversion (for internal use)\r\n   */\n  _getRawNumericField(componentId, entityId, fieldPath) {\n    const key = `${componentId}.${fieldPath}`;\n    const arr = this._numericArrays.get(key);\n    return arr ? arr[entityId] : undefined;\n  }\n\n  /**\r\n   * Direct field read - bypasses proxy for maximum performance in hot paths\r\n   * Use for tight loops where proxy overhead matters (collision, pathfinding)\r\n   * @param {number} entityId - Entity ID\r\n   * @param {string} componentType - Component name (e.g., 'transform')\r\n   * @param {string} fieldPath - Dot-separated path (e.g., 'position.x')\r\n   * @returns {number|null} - Raw value, or null if field was null\r\n   * @example\r\n   * // Instead of: game.getComponent(id, 'transform').position.x\r\n   * const x = game.getField(id, 'transform', 'position.x');\r\n   */\n  getField(entityId, componentType, fieldPath) {\n    return this._getNumericField(componentType, entityId, fieldPath);\n  }\n\n  /**\r\n   * Direct field write - bypasses proxy for maximum performance in hot paths\r\n   * @param {number} entityId - Entity ID\r\n   * @param {string} componentType - Component name (e.g., 'transform')\r\n   * @param {string} fieldPath - Dot-separated path (e.g., 'position.x')\r\n   * @param {number|null} value - Value to set\r\n   * @example\r\n   * // Instead of: game.getComponent(id, 'transform').position.x = 100\r\n   * game.setField(id, 'transform', 'position.x', 100);\r\n   */\n  setField(entityId, componentType, fieldPath, value) {\n    this._setNumericField(componentType, entityId, fieldPath, this._toStorageValue(value));\n  }\n\n  /**\r\n   * Check if a field value represents null/unset\r\n   * @param {number} value - Value from getField or direct TypedArray read\r\n   * @returns {boolean} - True if value represents null\r\n   */\n  isNull(value) {\n    return value === -Infinity || value === null;\n  }\n\n  // ============================================\n  // NULL SENTINEL CONVERSION UTILITIES\n  // ============================================\n  // TypedArrays can't store null, so we use -Infinity as a sentinel value.\n  // These methods provide consistent conversion at all boundaries:\n  //   - _toStorageValue / _fromStorageValue: for TypedArray read/write\n  //   - _toSyncValue / _fromSyncValue: for JSON serialization (sync)\n  // ============================================\n\n  /**\r\n   * Convert API value to TypedArray storage format\r\n   * null -> -Infinity (null sentinel), other values pass through\r\n   */\n  _toStorageValue(value) {\n    return value === null ? -Infinity : value;\n  }\n\n  /**\r\n   * Convert TypedArray storage value to API format\r\n   * -Infinity (null sentinel) -> null, other values pass through\r\n   */\n  _fromStorageValue(value) {\n    return value === -Infinity ? null : value;\n  }\n\n  /**\r\n   * Convert TypedArray storage value to JSON-safe format for sync\r\n   * -Infinity (null sentinel) -> null (JSON null), other values pass through\r\n   * Note: This is the same as _fromStorageValue since JSON uses null\r\n   */\n  _toSyncValue(value) {\n    return value === -Infinity ? null : value;\n  }\n\n  /**\r\n   * Convert JSON sync value back to TypedArray storage format\r\n   * null (JSON null) -> -Infinity (null sentinel), other values pass through\r\n   * Note: This is the same as _toStorageValue since JSON uses null\r\n   */\n  _fromSyncValue(value) {\n    return value === null ? -Infinity : value;\n  }\n\n  /**\r\n   * Write component data to TypedArrays (for numeric components)\r\n   * Handles numbers, booleans (as 0/1), and enum values (already converted to indices)\r\n   */\n  _writeNumericComponent(componentId, entityId, data, schema, prefix = '') {\n    for (const key in schema) {\n      const fieldPath = prefix ? `${prefix}.${key}` : key;\n      const schemaValue = schema[key];\n      let dataValue = prefix ? this._getNestedValue(data, fieldPath) : data[key];\n      if (typeof schemaValue === 'number' || typeof schemaValue === 'boolean' || typeof schemaValue === 'string') {\n        // Convert booleans to 0/1 for storage\n        if (typeof dataValue === 'boolean') {\n          dataValue = dataValue ? 1 : 0;\n        }\n        // Use default from schema if data value is undefined\n        if (dataValue === undefined) {\n          dataValue = typeof schemaValue === 'boolean' ? schemaValue ? 1 : 0 : schemaValue;\n        }\n        this._setNumericField(componentId, entityId, fieldPath, dataValue);\n      } else if (schemaValue === null) {\n        // null schema fields: use null sentinel as default\n        if (dataValue === undefined) {\n          dataValue = null;\n        }\n        this._setNumericField(componentId, entityId, fieldPath, this._toStorageValue(dataValue));\n      } else if (schemaValue && typeof schemaValue === 'object' && !Array.isArray(schemaValue)) {\n        this._writeNumericComponent(componentId, entityId, data, schemaValue, fieldPath);\n      }\n    }\n  }\n\n  /**\r\n   * Read component data from TypedArrays and return as proxy object\r\n   * Proxy reads/writes directly from TypedArrays on every access (no stale data)\r\n   * Proxies are cached per entity+component to avoid GC churn\r\n   */\n  _readNumericComponent(componentId, entityId, schema, prefix = '') {\n    // For top-level calls (no prefix), check proxy cache first\n    if (!prefix) {\n      let componentCache = this._proxyCache.get(componentId);\n      if (!componentCache) {\n        componentCache = new Map();\n        this._proxyCache.set(componentId, componentCache);\n      }\n      const cached = componentCache.get(entityId);\n      if (cached) {\n        return cached;\n      }\n      // Create and cache the proxy\n      const proxy = this._createComponentProxy(componentId, entityId, schema, '');\n      componentCache.set(entityId, proxy);\n      return proxy;\n    }\n    // Nested objects (with prefix) still create proxies but aren't cached separately\n    return this._createComponentProxy(componentId, entityId, schema, prefix);\n  }\n\n  /**\r\n   * Create a proxy that reads/writes directly from TypedArrays\r\n   * Every property access goes through the proxy traps for live data\r\n   */\n  _createComponentProxy(componentId, entityId, schema, prefix) {\n    const game = this;\n\n    // Build schema info for fast lookups\n    const schemaInfo = {};\n    for (const key in schema) {\n      const schemaValue = schema[key];\n      schemaInfo[key] = {\n        fieldPath: prefix ? `${prefix}.${key}` : key,\n        type: schemaValue === null ? 'null' : typeof schemaValue === 'boolean' ? 'boolean' : typeof schemaValue === 'number' || typeof schemaValue === 'string' ? 'number' : schemaValue && schemaValue.$fixedArray ? 'fixedArray' : schemaValue && schemaValue.$bitmask ? 'bitmask' : schemaValue && schemaValue.$enum ? 'enum' : schemaValue && typeof schemaValue === 'object' ? 'nested' : 'unknown',\n        schemaValue\n      };\n    }\n\n    // Cache for nested proxies (fixedArray, bitmask, nested objects)\n    const nestedCache = {};\n    return new Proxy({}, {\n      get(target, prop) {\n        // Support JSON.stringify\n        if (prop === 'toJSON') {\n          return () => {\n            const result = {};\n            for (const key in schemaInfo) {\n              const info = schemaInfo[key];\n              if (info.type === 'number' || info.type === 'enum') {\n                result[key] = game._getNumericField(componentId, entityId, info.fieldPath);\n              } else if (info.type === 'boolean') {\n                result[key] = game._getNumericField(componentId, entityId, info.fieldPath) !== 0;\n              } else if (info.type === 'null') {\n                result[key] = game._getNumericField(componentId, entityId, info.fieldPath);\n              } else if (info.type === 'fixedArray' || info.type === 'bitmask' || info.type === 'nested') {\n                // Trigger the getter to get the nested proxy, then toJSON it\n                const nested = nestedCache[key] || game._createNestedProxy(componentId, entityId, key, info, prefix);\n                result[key] = nested.toJSON ? nested.toJSON() : nested;\n              }\n            }\n            return result;\n          };\n        }\n        const info = schemaInfo[prop];\n        if (!info) return undefined;\n        if (info.type === 'number' || info.type === 'enum') {\n          return game._getNumericField(componentId, entityId, info.fieldPath);\n        } else if (info.type === 'boolean') {\n          return game._getNumericField(componentId, entityId, info.fieldPath) !== 0;\n        } else if (info.type === 'null') {\n          return game._getNumericField(componentId, entityId, info.fieldPath);\n        } else if (info.type === 'fixedArray' || info.type === 'bitmask' || info.type === 'nested') {\n          // Cache nested proxies to avoid recreation\n          if (!nestedCache[prop]) {\n            nestedCache[prop] = game._createNestedProxy(componentId, entityId, prop, info, prefix);\n          }\n          return nestedCache[prop];\n        }\n        return undefined;\n      },\n      set(target, prop, value) {\n        const info = schemaInfo[prop];\n        if (!info) return false;\n        let storedValue = value;\n        if (info.type === 'boolean') {\n          storedValue = value ? 1 : 0;\n        } else if (info.type === 'null') {\n          storedValue = game._toStorageValue(value);\n        }\n        if (info.type === 'number' || info.type === 'boolean' || info.type === 'null' || info.type === 'enum') {\n          game._setNumericField(componentId, entityId, info.fieldPath, storedValue);\n          return true;\n        }\n        return false;\n      },\n      ownKeys() {\n        return Object.keys(schemaInfo);\n      },\n      getOwnPropertyDescriptor(target, prop) {\n        if (prop in schemaInfo) {\n          return {\n            configurable: true,\n            enumerable: true\n          };\n        }\n        return undefined;\n      }\n    });\n  }\n\n  /**\r\n   * Create nested proxy for fixedArray, bitmask, or nested object\r\n   */\n  _createNestedProxy(componentId, entityId, key, info, prefix) {\n    if (info.type === 'fixedArray') {\n      return this._createFixedArrayProxy(componentId, entityId, key, info.schemaValue.$fixedArray, prefix);\n    } else if (info.type === 'bitmask') {\n      return this._createBitmaskProxy(componentId, entityId, key, info.schemaValue.$bitmask, prefix);\n    } else if (info.type === 'nested') {\n      return this._createComponentProxy(componentId, entityId, info.schemaValue, info.fieldPath);\n    }\n    return undefined;\n  }\n\n  /**\r\n   * Create an array-like proxy for $fixedArray fields\r\n   * Allows array[index] access that maps to individual TypedArray fields\r\n   */\n  _createFixedArrayProxy(componentId, entityId, baseName, config, prefix = '') {\n    const game = this;\n    // Support both static size and dynamic sizeFrom (enum-based)\n    let size = config.size || 0;\n    if (config.sizeFrom) {\n      const enumMap = this.componentGenerator.getEnumMap(config.sizeFrom);\n      size = enumMap?.toValue?.length || 0;\n    }\n    const fields = config.fields;\n    const fieldPrefix = prefix ? `${prefix}.${baseName}` : baseName;\n    if (fields && Array.isArray(fields)) {\n      // Multi-field array: each element is an object with the specified fields\n      // Fields stored as: baseName_field0, baseName_field1, etc.\n      return new Proxy({}, {\n        get(target, prop) {\n          if (prop === 'length') return size;\n          // Support JSON.stringify via toJSON\n          if (prop === 'toJSON') {\n            return () => {\n              const arr = [];\n              for (let i = 0; i < size; i++) {\n                const element = {};\n                for (const field of fields) {\n                  element[field] = game._getNumericField(componentId, entityId, `${fieldPrefix}_${field}${i}`);\n                }\n                arr[i] = element;\n              }\n              return arr;\n            };\n          }\n          const index = parseInt(prop, 10);\n          if (!isNaN(index) && index >= 0 && index < size) {\n            // Return object with all fields for this index\n            const element = {};\n            for (const field of fields) {\n              element[field] = game._getNumericField(componentId, entityId, `${fieldPrefix}_${field}${index}`);\n            }\n            // Return proxy for field writes\n            return new Proxy(element, {\n              set(t, f, v) {\n                t[f] = v;\n                game._setNumericField(componentId, entityId, `${fieldPrefix}_${f}${index}`, game._toStorageValue(v));\n                return true;\n              }\n            });\n          }\n          return undefined;\n        },\n        set(target, prop, value) {\n          const index = parseInt(prop, 10);\n          if (!isNaN(index) && index >= 0 && index < size && typeof value === 'object') {\n            for (const field of fields) {\n              if (value[field] !== undefined) {\n                game._setNumericField(componentId, entityId, `${fieldPrefix}_${field}${index}`, game._toStorageValue(value[field]));\n              }\n            }\n            return true;\n          }\n          return false;\n        },\n        ownKeys(target) {\n          const keys = [];\n          for (let i = 0; i < size; i++) {\n            keys.push(String(i));\n          }\n          return keys;\n        },\n        getOwnPropertyDescriptor(target, prop) {\n          const index = parseInt(prop, 10);\n          if (!isNaN(index) && index >= 0 && index < size) {\n            const element = {};\n            for (const field of fields) {\n              element[field] = game._getNumericField(componentId, entityId, `${fieldPrefix}_${field}${index}`);\n            }\n            return {\n              value: element,\n              writable: true,\n              enumerable: true,\n              configurable: true\n            };\n          }\n          return undefined;\n        }\n      });\n    } else {\n      // Simple array: baseName0, baseName1, etc.\n      return new Proxy({}, {\n        get(target, prop) {\n          if (prop === 'length') return size;\n          // Support JSON.stringify via toJSON\n          if (prop === 'toJSON') {\n            return () => {\n              const arr = [];\n              for (let i = 0; i < size; i++) {\n                arr[i] = game._getNumericField(componentId, entityId, `${fieldPrefix}${i}`);\n              }\n              return arr;\n            };\n          }\n          const index = parseInt(prop, 10);\n          if (!isNaN(index) && index >= 0 && index < size) {\n            return game._getNumericField(componentId, entityId, `${fieldPrefix}${index}`);\n          }\n          return undefined;\n        },\n        set(target, prop, value) {\n          const index = parseInt(prop, 10);\n          if (!isNaN(index) && index >= 0 && index < size) {\n            game._setNumericField(componentId, entityId, `${fieldPrefix}${index}`, game._toStorageValue(value));\n            return true;\n          }\n          return false;\n        },\n        ownKeys(target) {\n          // Return numeric indices as strings for JSON.stringify enumeration\n          const keys = [];\n          for (let i = 0; i < size; i++) {\n            keys.push(String(i));\n          }\n          return keys;\n        },\n        getOwnPropertyDescriptor(target, prop) {\n          const index = parseInt(prop, 10);\n          if (!isNaN(index) && index >= 0 && index < size) {\n            return {\n              value: game._getNumericField(componentId, entityId, `${fieldPrefix}${index}`),\n              writable: true,\n              enumerable: true,\n              configurable: true\n            };\n          }\n          return undefined;\n        }\n      });\n    }\n  }\n\n  /**\r\n   * Create a proxy for $bitmask fields\r\n   * Bitmask is stored as individual 32-bit fields (baseName0, baseName1, etc.)\r\n   * Returns a number representing the combined bitmask value\r\n   */\n  _createBitmaskProxy(componentId, entityId, baseName, config, prefix = '') {\n    const game = this;\n    let bitCount;\n    if (config.sizeFrom) {\n      const enumMap = this.componentGenerator.getEnumMap(config.sizeFrom);\n      bitCount = enumMap?.toValue?.length || 32;\n    } else {\n      bitCount = config.size || 32;\n    }\n    const fieldCount = Math.ceil(bitCount / 32);\n    const fieldPrefix = prefix ? `${prefix}.${baseName}` : baseName;\n\n    // For simplicity, return a simple value for single-field bitmasks\n    // and an array-like proxy for multi-field bitmasks\n    if (fieldCount === 1) {\n      // Single 32-bit field - just return the value with a toJSON\n      const value = game._getNumericField(componentId, entityId, `${fieldPrefix}0`) || 0;\n      return value;\n    }\n\n    // Multi-field bitmask - return array-like proxy\n    return new Proxy({}, {\n      get(target, prop) {\n        if (prop === 'length') return fieldCount;\n        if (prop === 'toJSON') {\n          return () => {\n            const arr = [];\n            for (let i = 0; i < fieldCount; i++) {\n              arr[i] = game._getNumericField(componentId, entityId, `${fieldPrefix}${i}`) || 0;\n            }\n            return arr;\n          };\n        }\n        const index = parseInt(prop, 10);\n        if (!isNaN(index) && index >= 0 && index < fieldCount) {\n          return game._getNumericField(componentId, entityId, `${fieldPrefix}${index}`) || 0;\n        }\n        return undefined;\n      },\n      set(target, prop, value) {\n        const index = parseInt(prop, 10);\n        if (!isNaN(index) && index >= 0 && index < fieldCount) {\n          game._setNumericField(componentId, entityId, `${fieldPrefix}${index}`, game._toStorageValue(value));\n          return true;\n        }\n        return false;\n      },\n      ownKeys(target) {\n        const keys = [];\n        for (let i = 0; i < fieldCount; i++) {\n          keys.push(String(i));\n        }\n        return keys;\n      },\n      getOwnPropertyDescriptor(target, prop) {\n        const index = parseInt(prop, 10);\n        if (!isNaN(index) && index >= 0 && index < fieldCount) {\n          return {\n            value: game._getNumericField(componentId, entityId, `${fieldPrefix}${index}`) || 0,\n            writable: true,\n            enumerable: true,\n            configurable: true\n          };\n        }\n        return undefined;\n      }\n    });\n  }\n\n  /**\r\n   * Get a nested value from an object using dot notation path\r\n   */\n  _getNestedValue(obj, path) {\n    const parts = path.split('.');\n    let current = obj;\n    for (const part of parts) {\n      if (current === undefined || current === null) return undefined;\n      current = current[part];\n    }\n    return current;\n  }\n\n  // Service registry methods (delegated to GameServices)\n  register(key, method) {\n    this._services.register(key, method);\n  }\n  hasService(key) {\n    return this._services.has(key);\n  }\n  call(key, ...args) {\n    const result = this._services.call(key, ...args);\n    if (this.callLogger) {\n      this.callLogger.log(key, args, result, this.state.now);\n    }\n    return result;\n  }\n  listServices() {\n    return this._services.listServices();\n  }\n  async init(isServer = false, config) {\n    this.isServer = isServer;\n    if (!this.isServer) {\n      document.addEventListener('keydown', e => {\n        this.triggerEvent('onKeyDown', e.key);\n      });\n    }\n    await this.loadGameScripts(config);\n  }\n  async loadGameScripts(config, options = {}) {\n    this.collections = this.getCollections();\n    this.gameConfig = config ? config : this.isServer ? this.collections.configs.server : this.collections.configs.game;\n\n    // Initialize SceneManager (handles lazy system instantiation)\n    this.sceneManager = new GUTS.SceneManager(this);\n\n    // Store available system types for lazy instantiation\n    this.availableSystemTypes = this.gameConfig.systems || [];\n    // Map to track instantiated systems by name\n    this.systemsByName = new Map();\n\n    // Load initial scene if configured (skip for editors that manage scene loading explicitly)\n    if (!options.skipInitialScene) {\n      await this.loadInitialScene();\n    }\n  }\n\n  /**\r\n   * Load the initial scene from game config\r\n   * @returns {Promise<void>}\r\n   */\n  async loadInitialScene() {\n    const initialScene = this.gameConfig.initialScene;\n    if (initialScene && this.sceneManager) {\n      await this.sceneManager.loadScene(initialScene);\n    } else {\n      console.warn('[BaseECSGame] No initialScene configured in game config');\n    }\n  }\n\n  /**\r\n   * Get or create a system by name (lazy instantiation)\r\n   * @param {string} systemName - The system class name\r\n   * @returns {Object|null} The system instance or null if not available\r\n   */\n  getOrCreateSystem(systemName) {\n    // Check if already instantiated\n    if (this.systemsByName.has(systemName)) {\n      return this.systemsByName.get(systemName);\n    }\n\n    // Check if this system type is available (skip check if no whitelist defined)\n    if (this.availableSystemTypes.length > 0 && !this.availableSystemTypes.includes(systemName)) {\n      console.warn(`[BaseECSGame] System '${systemName}' not in available systems list`);\n      return null;\n    }\n\n    // Check if the class exists\n    if (!GUTS[systemName]) {\n      console.error(`[BaseECSGame] System class '${systemName}' not found in GUTS`);\n      return null;\n    }\n\n    // Create the system\n    const params = {\n      canvas: this.canvas\n    };\n    const systemInst = new GUTS[systemName](this);\n    systemInst.enabled = false;\n\n    // Auto-register services from static services array\n    const SystemClass = GUTS[systemName];\n    if (SystemClass.services && Array.isArray(SystemClass.services)) {\n      for (const serviceName of SystemClass.services) {\n        if (typeof systemInst[serviceName] === 'function') {\n          this.register(serviceName, systemInst[serviceName].bind(systemInst));\n        } else {\n          console.warn(`[BaseECSGame] Service '${serviceName}' not found on ${systemName}`);\n        }\n      }\n    }\n    if (systemInst.init) {\n      systemInst.init(params);\n    }\n\n    // Add to tracking\n    this.systems.push(systemInst);\n    this.systemsByName.set(systemName, systemInst);\n    return systemInst;\n  }\n\n  /**\r\n   * Check if a system is available (defined in config)\r\n   * @param {string} systemName - The system class name\r\n   * @returns {boolean}\r\n   */\n  isSystemAvailable(systemName) {\n    return this.availableSystemTypes.includes(systemName);\n  }\n\n  /**\r\n   * Switch to a different scene\r\n   * @param {string} sceneName - Name of the scene to load\r\n   * @returns {Promise<void>}\r\n   */\n  async switchScene(sceneName) {\n    if (this.sceneManager) {\n      await this.sceneManager.switchScene(sceneName);\n    }\n  }\n  getEntityId() {\n    // Recycle freed entity IDs deterministically - always use lowest available\n    // This ensures client and server get the same ID even if destruction order differs\n    if (this.freeEntityCount > 0) {\n      // Find the minimum ID in the free list for deterministic selection\n      let minIdx = 0;\n      for (let i = 1; i < this.freeEntityCount; i++) {\n        if (this.freeEntityIds[i] < this.freeEntityIds[minIdx]) {\n          minIdx = i;\n        }\n      }\n      const id = this.freeEntityIds[minIdx];\n      // Swap with last and decrement count\n      this.freeEntityIds[minIdx] = this.freeEntityIds[--this.freeEntityCount];\n      return id;\n    }\n    if (this.nextEntityId >= this.MAX_ENTITIES) {\n      throw new Error(`Maximum entity limit (${this.MAX_ENTITIES}) reached`);\n    }\n    return this.nextEntityId++;\n  }\n  getCollections() {\n    return this.app.getCollections();\n  }\n  async update(deltaTime) {\n    if (!this.state.isPaused) {\n      // Start performance frame tracking\n      if (this.performanceMonitor) {\n        this.performanceMonitor.startFrame();\n      }\n\n      // Use tick count based timing to avoid floating-point accumulation errors\n      this.tickCount++;\n      // Use FIXED_DELTA_TIME for deterministic simulation (ignore variable deltaTime)\n      // Round to 2 decimal places to avoid floating-point precision issues\n      // (e.g., 3 * 0.05 = 0.15000000000000002 in JavaScript)\n      this.currentTime = Math.round(this.tickCount * this.FIXED_DELTA_TIME * 100) / 100;\n\n      // Only update if a reasonable amount of time has passed\n      // const timeSinceLastUpdate = this.currentTime - this.lastTime;\n\n      // // Skip update if more than 1 second has passed (tab was inactive)\n      // if (timeSinceLastUpdate > 1000) {\n      //     this.lastTime = this.currentTime; // Reset timer without updating\n      //     return;\n      // }\n      this.state.now = this.currentTime;\n      // Use fixed deltaTime for deterministic simulation\n      this.state.deltaTime = this.FIXED_DELTA_TIME;\n      this.deltaTime = this.FIXED_DELTA_TIME;\n      for (const system of this.systems) {\n        // Skip disabled systems\n        if (!system.enabled) continue;\n        const systemName = system.constructor.name;\n\n        // Start tracking this system\n        if (this.performanceMonitor) {\n          this.performanceMonitor.startSystem(systemName);\n        }\n        if (system.update) {\n          await system.update();\n        }\n\n        // End update tracking\n        if (this.performanceMonitor) {\n          this.performanceMonitor.endSystemUpdate(systemName);\n        }\n        if (system.render && !this.isServer) {\n          // Start render tracking\n          if (this.performanceMonitor) {\n            this.performanceMonitor.startSystemRender(systemName);\n          }\n          await system.render();\n\n          // End render tracking\n          if (this.performanceMonitor) {\n            this.performanceMonitor.endSystemRender(systemName);\n          }\n        } else if (this.performanceMonitor) {\n          // If no render, still need to end the system tracking\n          this.performanceMonitor.startSystemRender(systemName);\n          this.performanceMonitor.endSystemRender(systemName);\n        }\n      }\n\n      // Update performance overlay\n      if (this.performanceMonitor) {\n        this.performanceMonitor.updateOverlay();\n      }\n      this.postUpdate();\n    }\n  }\n  postUpdate() {\n    // this.desyncDebugger?.displaySync(false); \n\n    this.lastTime = this.currentTime;\n    this.entitiesToAdd.forEach(entity => this.addEntity(entity));\n    this.entitiesToAdd = [];\n  }\n  createEntity(setId) {\n    const id = setId || this.getEntityId();\n    // Log if overwriting existing entity - this is a bug!\n    if (this.entityAlive[id]) {\n      console.error(`[BaseECSGame] createEntity called for existing entity ${id}!`);\n      console.trace('createEntity called from:');\n    }\n    // Mark entity as alive\n    this.entityAlive[id] = 1;\n    // Clear component bitmask\n    this.entityComponentMask[id * 2] = 0;\n    this.entityComponentMask[id * 2 + 1] = 0;\n    this.entityCount++;\n    // When using a specific ID, ensure nextEntityId is always higher\n    // This is critical for getEntitiesWith() which iterates up to nextEntityId\n    if (id >= this.nextEntityId) {\n      this.nextEntityId = id + 1;\n    }\n    return id;\n  }\n  destroyEntity(entityId) {\n    if (!this.entityAlive[entityId]) return;\n\n    // Notify systems\n    for (let i = 0; i < this.systems.length; i++) {\n      const system = this.systems[i];\n      if (system.entityDestroyed) {\n        system.entityDestroyed(entityId);\n      }\n    }\n\n    // Clear component data from object storage\n    for (const [componentType, storage] of this._objectComponents) {\n      if (storage[entityId] !== undefined) {\n        storage[entityId] = undefined;\n      }\n    }\n\n    // Clear cached proxies for this entity\n    for (const [, componentCache] of this._proxyCache) {\n      componentCache.delete(entityId);\n    }\n\n    // Note: TypedArray numeric data doesn't need clearing -\n    // the bitmask ensures it won't be read\n\n    // Mark entity as dead and recycle ID\n    this.entityAlive[entityId] = 0;\n    this.entityComponentMask[entityId * 2] = 0;\n    this.entityComponentMask[entityId * 2 + 1] = 0;\n    this.freeEntityIds[this.freeEntityCount++] = entityId;\n    this.entityCount--;\n  }\n  addComponent(entityId, componentId, data) {\n    if (!this.entityAlive[entityId]) {\n      throw new Error(`Entity ${entityId} does not exist`);\n    }\n    const componentMethods = this.call('getComponents');\n    if (!componentMethods[componentId]) {\n      console.warn(`[BaseECSGame] No component factory for '${componentId}'. Add it to the components collection.`);\n    }\n\n    // Use factory function if available, otherwise use data directly as fallback\n    const componentData = componentMethods[componentId] ? componentMethods[componentId](data) : {\n      ...data\n    };\n\n    // Get component type ID and set bitmask\n    const typeId = this._getComponentTypeId(componentId);\n    this._setComponentBit(entityId, typeId);\n\n    // Set up storage on first encounter (analyzes schema for numeric optimization)\n    const schema = this.call('getComponentSchema', componentId);\n    const enumMap = this.hasService('getEnumMap') ? this.call('getEnumMap', componentId) : null;\n    if (schema) {\n      this._setupComponentStorage(componentId, schema, enumMap);\n    }\n\n    // Check if this is a numeric component (use TypedArrays) or object component\n    const componentInfo = this._numericComponentInfo.get(componentId);\n    if (componentInfo && componentInfo.isNumeric && schema) {\n      // Store in TypedArrays\n      this._writeNumericComponent(componentId, entityId, componentData, schema);\n    } else {\n      // Store in object storage (indexed by entity ID)\n      const storage = this._getObjectStorage(componentId);\n      storage[entityId] = componentData;\n    }\n  }\n\n  /**\r\n   * OPTIMIZATION: Add multiple components at once with single cache invalidation\r\n   * @param {*} entityId - Entity ID\r\n   * @param {Object} componentsData - Object mapping componentId -> data\r\n   */\n  addComponents(entityId, componentsData) {\n    if (!this.entityAlive[entityId]) {\n      throw new Error(`Entity ${entityId} does not exist`);\n    }\n    const componentMethods = this.call('getComponents');\n    const hasEnumService = this.hasService('getEnumMap');\n    for (const [componentId, data] of Object.entries(componentsData)) {\n      // Use factory function if available, otherwise use data directly\n      const componentData = componentMethods[componentId] ? componentMethods[componentId](data) : {\n        ...data\n      };\n\n      // Get component type ID and set bitmask\n      const typeId = this._getComponentTypeId(componentId);\n      this._setComponentBit(entityId, typeId);\n\n      // Set up storage on first encounter (analyzes schema for numeric optimization)\n      const schema = this.call('getComponentSchema', componentId);\n      const enumMap = hasEnumService ? this.call('getEnumMap', componentId) : null;\n      if (schema) {\n        this._setupComponentStorage(componentId, schema, enumMap);\n      }\n\n      // Check if this is a numeric component (use TypedArrays) or object component\n      const componentInfo = this._numericComponentInfo.get(componentId);\n      if (componentInfo && componentInfo.isNumeric && schema) {\n        // Store in TypedArrays\n        this._writeNumericComponent(componentId, entityId, componentData, schema);\n      } else {\n        // Store in object storage\n        const storage = this._getObjectStorage(componentId);\n        storage[entityId] = componentData;\n      }\n    }\n\n    // Single cache invalidation for all components\n  }\n  removeComponent(entityId, componentType) {\n    if (!this.entityAlive[entityId]) return null;\n    const component = this.getComponent(entityId, componentType);\n    if (component === undefined) return null;\n\n    // Clear bitmask\n    const typeId = this._componentTypeId.get(componentType);\n    if (typeId !== undefined) {\n      this._clearComponentBit(entityId, typeId);\n    }\n\n    // Clear object storage\n    const storage = this._objectComponents.get(componentType);\n    if (storage) {\n      storage[entityId] = undefined;\n    }\n\n    // Clear cached proxy for this entity+component\n    const componentCache = this._proxyCache.get(componentType);\n    if (componentCache) {\n      componentCache.delete(entityId);\n    }\n    return component;\n  }\n  getComponent(entityId, componentType) {\n    // Fast path: check bitmask first\n    const typeId = this._componentTypeId.get(componentType);\n    if (typeId === undefined) return undefined;\n    if (!this._hasComponentBit(entityId, typeId)) return undefined;\n\n    // Check if this is a numeric component (stored in TypedArrays)\n    const componentInfo = this._numericComponentInfo.get(componentType);\n    if (componentInfo && componentInfo.isNumeric && componentInfo.schema) {\n      // Use original schema to preserve $fixedArray info for array proxy creation\n      const schema = componentInfo.originalSchema || componentInfo.schema;\n      return this._readNumericComponent(componentType, entityId, schema);\n    }\n\n    // Get from object storage\n    const storage = this._objectComponents.get(componentType);\n    return storage ? storage[entityId] : undefined;\n  }\n\n  /**\r\n   * Serialize a component for network sync\r\n   * Uses getComponent (which returns proxies with toJSON support)\r\n   * Returns a plain object suitable for JSON serialization\r\n   */\n  serializeComponent(entityId, componentType) {\n    const component = this.getComponent(entityId, componentType);\n    if (!component) return null;\n    // JSON.parse(JSON.stringify) converts proxy to plain object\n    // The proxy's toJSON methods handle $fixedArray serialization\n    return JSON.parse(JSON.stringify(component));\n  }\n\n  /**\r\n   * Get ECS data for network sync\r\n   * @param {boolean} fullSync - If true, sends full state and resets delta tracking.\r\n   *                             If false, sends only changes since last sync.\r\n   * Returns sparse format to minimize payload size\r\n   * Format: {\r\n   *   fullSync: boolean,  // true if this is a full state sync\r\n   *   entityAlive: { entityId: 1, ... },  // sparse: only alive entities (or changed)\r\n   *   entityDead: [entityId, ...],  // only in delta: entities that died since last sync\r\n   *   entityComponentMask: { entityId: [low, high], ... },  // sparse: only entities with components (or changed)\r\n   *   numericArrays: { key: { entityId: value, ... } },  // sparse: only non-zero/non-null values (or changed)\r\n   *   objectComponents: { componentType: { entityId: data } },\r\n   *   nextEntityId: number\r\n   * }\r\n   */\n  getECSData(fullSync = true) {\n    const maxEntity = this.nextEntityId;\n    const lastState = this._lastSyncedState;\n\n    // If fullSync or no previous state, send everything\n    if (fullSync || !lastState) {\n      const result = this._getFullECSData(maxEntity);\n      result.fullSync = true;\n      // Store current state for future delta calculations\n      this._lastSyncedState = this._captureStateSnapshot(maxEntity);\n      return result;\n    }\n\n    // Delta sync - only send what changed\n    return this._getDeltaECSData(maxEntity, lastState);\n  }\n\n  /**\r\n   * Get full ECS state (sparse format)\r\n   */\n  _getFullECSData(maxEntity) {\n    const result = {\n      nextEntityId: this.nextEntityId,\n      entityAlive: {},\n      entityComponentMask: {},\n      numericArrays: {},\n      objectComponents: {}\n    };\n\n    // Sparse entityAlive - only include alive entities (value = 1)\n    for (let i = 0; i < maxEntity; i++) {\n      if (this.entityAlive[i] === 1) {\n        result.entityAlive[i] = 1;\n      }\n    }\n\n    // Sparse entityComponentMask - only include entities with components\n    // Stored as [low, high] pairs for the two 32-bit parts\n    for (let i = 0; i < maxEntity; i++) {\n      const low = this.entityComponentMask[i * 2];\n      const high = this.entityComponentMask[i * 2 + 1];\n      if (low !== 0 || high !== 0) {\n        result.entityComponentMask[i] = [low, high];\n      }\n    }\n\n    // Include numeric arrays in sparse format (only non-zero, non-null values)\n    // ALSO include zeros that changed FROM non-zero (to ensure clients reset them)\n    // Skip client-only components\n    const lastState = this._lastSyncedState;\n    for (const [key, arr] of this._numericArrays) {\n      // key format is \"componentType.fieldPath\" - extract component type\n      const componentType = key.split('.')[0];\n      if (this._clientOnlyComponents.has(componentType)) {\n        continue; // Skip client-only components\n      }\n      const lastArr = lastState?.numericArrays?.get(key);\n      const lastMaxEntity = lastState?.nextEntityId || 0;\n      const sparse = {};\n      for (let i = 0; i < maxEntity; i++) {\n        const val = arr[i];\n        // Only check lastArr within its bounds\n        const lastVal = lastArr && i < lastMaxEntity ? lastArr[i] : 0;\n        // Include non-zero values\n        // Also include zeros if they were previously non-zero (value changed to 0)\n        if (val !== 0 || lastVal !== 0 && val === 0) {\n          sparse[i] = this._toSyncValue(val);\n        }\n      }\n      // Only include if there are any values\n      if (Object.keys(sparse).length > 0) {\n        result.numericArrays[key] = sparse;\n      }\n    }\n\n    // Include object components - skip client-only\n    for (const [componentType, storage] of this._objectComponents) {\n      if (this._clientOnlyComponents.has(componentType)) {\n        continue;\n      }\n      const componentData = {};\n      for (let i = 0; i < maxEntity; i++) {\n        if (storage[i] !== undefined) {\n          componentData[i] = storage[i];\n        }\n      }\n      if (Object.keys(componentData).length > 0) {\n        result.objectComponents[componentType] = componentData;\n      }\n    }\n    return result;\n  }\n\n  /**\r\n   * Capture a snapshot of current state for delta comparison\r\n   */\n  _captureStateSnapshot(maxEntity) {\n    const snapshot = {\n      nextEntityId: this.nextEntityId,\n      entityAlive: new Uint8Array(maxEntity),\n      entityComponentMask: new Uint32Array(maxEntity * 2),\n      numericArrays: new Map(),\n      objectComponents: new Map()\n    };\n\n    // Copy entityAlive\n    snapshot.entityAlive.set(this.entityAlive.subarray(0, maxEntity));\n\n    // Copy entityComponentMask\n    snapshot.entityComponentMask.set(this.entityComponentMask.subarray(0, maxEntity * 2));\n\n    // Copy numeric arrays\n    for (const [key, arr] of this._numericArrays) {\n      snapshot.numericArrays.set(key, new Float32Array(arr.subarray(0, maxEntity)));\n    }\n\n    // Deep copy object components\n    for (const [componentType, storage] of this._objectComponents) {\n      const copy = new Array(maxEntity);\n      for (let i = 0; i < maxEntity; i++) {\n        if (storage[i] !== undefined) {\n          copy[i] = JSON.parse(JSON.stringify(storage[i]));\n        }\n      }\n      snapshot.objectComponents.set(componentType, copy);\n    }\n    return snapshot;\n  }\n\n  /**\r\n   * Get delta ECS data - only changes since last sync\r\n   */\n  _getDeltaECSData(maxEntity, lastState) {\n    const result = {\n      fullSync: false,\n      nextEntityId: this.nextEntityId,\n      entityAlive: {},\n      entityDead: [],\n      entityComponentMask: {},\n      numericArrays: {},\n      objectComponents: {}\n    };\n    const lastMaxEntity = lastState.nextEntityId;\n\n    // Check entityAlive changes\n    for (let i = 0; i < maxEntity; i++) {\n      const current = this.entityAlive[i];\n      const previous = i < lastMaxEntity ? lastState.entityAlive[i] : 0;\n      if (current !== previous) {\n        if (current === 1) {\n          result.entityAlive[i] = 1; // Entity became alive\n        } else {\n          result.entityDead.push(i); // Entity died\n        }\n      }\n    }\n\n    // Check entityComponentMask changes\n    for (let i = 0; i < maxEntity; i++) {\n      const lowCurrent = this.entityComponentMask[i * 2];\n      const highCurrent = this.entityComponentMask[i * 2 + 1];\n      const lowPrev = i < lastMaxEntity ? lastState.entityComponentMask[i * 2] : 0;\n      const highPrev = i < lastMaxEntity ? lastState.entityComponentMask[i * 2 + 1] : 0;\n      if (lowCurrent !== lowPrev || highCurrent !== highPrev) {\n        result.entityComponentMask[i] = [lowCurrent, highCurrent];\n      }\n    }\n\n    // Check numeric array changes - skip client-only components\n    for (const [key, arr] of this._numericArrays) {\n      const componentType = key.split('.')[0];\n      if (this._clientOnlyComponents.has(componentType)) {\n        continue;\n      }\n      const lastArr = lastState.numericArrays.get(key);\n      const sparse = {};\n      for (let i = 0; i < maxEntity; i++) {\n        const current = arr[i];\n        const previous = lastArr && i < lastMaxEntity ? lastArr[i] : 0;\n        if (current !== previous) {\n          // Include the new value (even if 0 or -Infinity, since it changed)\n          sparse[i] = this._toSyncValue(current);\n        }\n      }\n      if (Object.keys(sparse).length > 0) {\n        result.numericArrays[key] = sparse;\n      }\n    }\n\n    // Check object component changes - skip client-only\n    for (const [componentType, storage] of this._objectComponents) {\n      if (this._clientOnlyComponents.has(componentType)) {\n        continue;\n      }\n      const lastStorage = lastState.objectComponents.get(componentType);\n      const componentData = {};\n      for (let i = 0; i < maxEntity; i++) {\n        const current = storage[i];\n        const previous = lastStorage ? lastStorage[i] : undefined;\n\n        // Check if changed (simple JSON comparison)\n        const currentStr = current !== undefined ? JSON.stringify(current) : undefined;\n        const previousStr = previous !== undefined ? JSON.stringify(previous) : undefined;\n        if (currentStr !== previousStr) {\n          if (current !== undefined) {\n            componentData[i] = current;\n          } else {\n            // Mark as removed with null\n            componentData[i] = null;\n          }\n        }\n      }\n      if (Object.keys(componentData).length > 0) {\n        result.objectComponents[componentType] = componentData;\n      }\n    }\n\n    // Remove empty arrays/objects from result\n    if (result.entityDead.length === 0) delete result.entityDead;\n    if (Object.keys(result.entityAlive).length === 0) delete result.entityAlive;\n    if (Object.keys(result.entityComponentMask).length === 0) delete result.entityComponentMask;\n    if (Object.keys(result.numericArrays).length === 0) delete result.numericArrays;\n    if (Object.keys(result.objectComponents).length === 0) delete result.objectComponents;\n\n    // Update snapshot for next delta\n    this._lastSyncedState = this._captureStateSnapshot(maxEntity);\n    return result;\n  }\n\n  /**\r\n   * Reset delta tracking - call this when you want the next sync to be a full sync\r\n   */\n  resetSyncState() {\n    this._lastSyncedState = null;\n  }\n\n  /**\r\n   * Apply ECS data from server (handles both full sync and delta sync)\r\n   */\n  applyECSData(data) {\n    // Check if this is a full sync or delta sync\n    if (data.fullSync !== false) {\n      this._applyFullECSData(data);\n    } else {\n      this._applyDeltaECSData(data);\n    }\n\n    // Common cleanup for both sync types\n    this._finalizeECSSync(data);\n  }\n\n  /**\r\n   * Apply full ECS sync - replaces all state\r\n   */\n  _applyFullECSData(data) {\n    const maxEntity = data.nextEntityId || this.nextEntityId;\n\n    // Clear and apply entity alive flags from sparse format\n    this.entityAlive.fill(0, 0, maxEntity);\n    if (data.entityAlive) {\n      for (const entityIdStr of Object.keys(data.entityAlive)) {\n        this.entityAlive[parseInt(entityIdStr, 10)] = 1;\n      }\n    }\n\n    // Build bitmask for client-only components to preserve\n    let clientOnlyMaskLow = 0;\n    let clientOnlyMaskHigh = 0;\n    for (const componentType of this._clientOnlyComponents) {\n      const typeId = this._componentTypeId.get(componentType);\n      if (typeId !== undefined) {\n        if (typeId < 32) {\n          clientOnlyMaskLow |= 1 << typeId;\n        } else {\n          clientOnlyMaskHigh |= 1 << typeId - 32;\n        }\n      }\n    }\n\n    // Apply component masks from sparse format, preserving client-only component bits\n    for (let i = 0; i < maxEntity; i++) {\n      // Preserve client-only bits from current mask\n      const preservedLow = this.entityComponentMask[i * 2] & clientOnlyMaskLow;\n      const preservedHigh = this.entityComponentMask[i * 2 + 1] & clientOnlyMaskHigh;\n      // Clear the mask\n      this.entityComponentMask[i * 2] = preservedLow;\n      this.entityComponentMask[i * 2 + 1] = preservedHigh;\n    }\n    if (data.entityComponentMask) {\n      for (const [entityIdStr, mask] of Object.entries(data.entityComponentMask)) {\n        const entityId = parseInt(entityIdStr, 10);\n        // Merge server mask with preserved client-only bits\n        this.entityComponentMask[entityId * 2] |= mask[0];\n        this.entityComponentMask[entityId * 2 + 1] |= mask[1];\n      }\n    }\n\n    // Apply numeric arrays - only clear/replace arrays that server sends\n    // Skip client-only components even if server sends them (backwards compatibility)\n    for (const [key, sparse] of Object.entries(data.numericArrays || {})) {\n      const componentType = key.split('.')[0];\n      if (this._clientOnlyComponents.has(componentType)) {\n        continue; // Don't apply client-only components from server\n      }\n      let arr = this._numericArrays.get(key);\n      if (!arr) {\n        arr = new Float32Array(this.MAX_ENTITIES);\n        this._numericArrays.set(key, arr);\n      }\n      // Clear this specific array before applying server data\n      arr.fill(0, 0, maxEntity);\n      // Apply server values\n      for (const [entityIdStr, value] of Object.entries(sparse)) {\n        arr[parseInt(entityIdStr, 10)] = this._fromSyncValue(value);\n      }\n    }\n\n    // Apply object components - only clear/replace components that server sends\n    // Skip client-only components\n    for (const [componentType, componentData] of Object.entries(data.objectComponents || {})) {\n      if (this._clientOnlyComponents.has(componentType)) {\n        continue;\n      }\n      const storage = this._getObjectStorage(componentType);\n      // Clear this specific component type before applying server data\n      for (let i = 0; i < maxEntity; i++) {\n        storage[i] = undefined;\n      }\n      // Apply server values\n      for (const [entityIdStr, value] of Object.entries(componentData)) {\n        storage[parseInt(entityIdStr, 10)] = value;\n      }\n    }\n  }\n\n  /**\r\n   * Apply delta ECS sync - only applies changes\r\n   */\n  _applyDeltaECSData(data) {\n    // Apply entity deaths\n    if (data.entityDead) {\n      for (const entityId of data.entityDead) {\n        this.entityAlive[entityId] = 0;\n        // Clear component mask for dead entities\n        this.entityComponentMask[entityId * 2] = 0;\n        this.entityComponentMask[entityId * 2 + 1] = 0;\n      }\n    }\n\n    // Apply new/changed alive entities\n    if (data.entityAlive) {\n      for (const entityIdStr of Object.keys(data.entityAlive)) {\n        this.entityAlive[parseInt(entityIdStr, 10)] = 1;\n      }\n    }\n\n    // Apply component mask changes, preserving client-only component bits\n    if (data.entityComponentMask) {\n      // Build bitmask for client-only components to preserve\n      let clientOnlyMaskLow = 0;\n      let clientOnlyMaskHigh = 0;\n      for (const componentType of this._clientOnlyComponents) {\n        const typeId = this._componentTypeId.get(componentType);\n        if (typeId !== undefined) {\n          if (typeId < 32) {\n            clientOnlyMaskLow |= 1 << typeId;\n          } else {\n            clientOnlyMaskHigh |= 1 << typeId - 32;\n          }\n        }\n      }\n      for (const [entityIdStr, mask] of Object.entries(data.entityComponentMask)) {\n        const entityId = parseInt(entityIdStr, 10);\n        // Preserve client-only bits, apply server bits\n        const preservedLow = this.entityComponentMask[entityId * 2] & clientOnlyMaskLow;\n        const preservedHigh = this.entityComponentMask[entityId * 2 + 1] & clientOnlyMaskHigh;\n        this.entityComponentMask[entityId * 2] = mask[0] | preservedLow;\n        this.entityComponentMask[entityId * 2 + 1] = mask[1] | preservedHigh;\n      }\n    }\n\n    // Apply numeric array changes (only changed values)\n    // Skip client-only components\n    for (const [key, sparse] of Object.entries(data.numericArrays || {})) {\n      const componentType = key.split('.')[0];\n      if (this._clientOnlyComponents.has(componentType)) {\n        continue;\n      }\n      let arr = this._numericArrays.get(key);\n      if (!arr) {\n        arr = new Float32Array(this.MAX_ENTITIES);\n        this._numericArrays.set(key, arr);\n      }\n      for (const [entityIdStr, value] of Object.entries(sparse)) {\n        arr[parseInt(entityIdStr, 10)] = this._fromSyncValue(value);\n      }\n    }\n\n    // Apply object component changes - skip client-only\n    for (const [componentType, componentData] of Object.entries(data.objectComponents || {})) {\n      if (this._clientOnlyComponents.has(componentType)) {\n        continue;\n      }\n      const storage = this._getObjectStorage(componentType);\n      for (const [entityIdStr, value] of Object.entries(componentData)) {\n        const entityId = parseInt(entityIdStr, 10);\n        if (value === null) {\n          // null means removed\n          storage[entityId] = undefined;\n        } else {\n          storage[entityId] = value;\n        }\n      }\n    }\n  }\n\n  /**\r\n   * Finalize ECS sync - common cleanup for both full and delta\r\n   */\n  _finalizeECSSync(data) {\n    // Sync entity ID counter\n    if (data.nextEntityId !== undefined) {\n      this.nextEntityId = data.nextEntityId;\n    }\n\n    // Rebuild freeEntityIds from entityAlive to ensure consistency\n    this.freeEntityCount = 0;\n    for (let i = 1; i < this.nextEntityId; i++) {\n      if (this.entityAlive[i] === 0) {\n        this.freeEntityIds[this.freeEntityCount++] = i;\n      }\n    }\n\n    // Clear all cached proxies since data has been overwritten\n    for (const [, componentCache] of this._proxyCache) {\n      componentCache.clear();\n    }\n  }\n\n  /**\r\n   * Update specific fields of a component\r\n   * For numeric components (TypedArray storage), this is the only way to persist changes\r\n   * For object components, this also works (direct mutation still works for those)\r\n   * @param {number} entityId\r\n   * @param {string} componentType\r\n   * @param {Object} updates - Object with field updates, e.g. { current: 50 } or { 'nested.field': 10 }\r\n   */\n  updateComponent(entityId, componentType, updates) {\n    const typeId = this._componentTypeId.get(componentType);\n    if (typeId === undefined) return;\n    if (!this._hasComponentBit(entityId, typeId)) return;\n    const componentInfo = this._numericComponentInfo.get(componentType);\n    if (componentInfo && componentInfo.isNumeric) {\n      // Write to TypedArrays (convert null to storage sentinel)\n      for (const fieldPath in updates) {\n        this._setNumericField(componentType, entityId, fieldPath, this._toStorageValue(updates[fieldPath]));\n      }\n    } else {\n      // Update object storage\n      const storage = this._objectComponents.get(componentType);\n      if (storage && storage[entityId]) {\n        for (const fieldPath in updates) {\n          if (fieldPath.includes('.')) {\n            // Handle nested paths\n            this._setNestedValue(storage[entityId], fieldPath, updates[fieldPath]);\n          } else {\n            storage[entityId][fieldPath] = updates[fieldPath];\n          }\n        }\n      }\n    }\n  }\n\n  /**\r\n   * Set a nested value in an object using dot notation path\r\n   */\n  _setNestedValue(obj, path, value) {\n    const parts = path.split('.');\n    let current = obj;\n    for (let i = 0; i < parts.length - 1; i++) {\n      if (current[parts[i]] === undefined) {\n        current[parts[i]] = {};\n      }\n      current = current[parts[i]];\n    }\n    current[parts[parts.length - 1]] = value;\n  }\n  hasComponent(entityId, componentType) {\n    const typeId = this._componentTypeId.get(componentType);\n    if (typeId === undefined) return false;\n    return this._hasComponentBit(entityId, typeId);\n  }\n  getEntitiesWith(...componentTypes) {\n    // Create cache key from component types\n    const queryKey = componentTypes.join(',');\n\n    // Get or create reusable result array for this query\n    // This avoids allocations - each unique query gets one array that's reused forever\n    let result = this._queryCache.get(queryKey);\n    if (!result) {\n      result = [];\n      this._queryCache.set(queryKey, result);\n    }\n    result.length = 0; // Clear without deallocating (keeps underlying buffer)\n\n    // Build query bitmask from component types\n    let queryMask0 = 0;\n    let queryMask1 = 0;\n    for (const componentType of componentTypes) {\n      const typeId = this._componentTypeId.get(componentType);\n      if (typeId === undefined) {\n        // Component type doesn't exist yet, no entities can have it\n        return result; // Return empty reusable array\n      }\n      if (typeId < 32) {\n        queryMask0 |= 1 << typeId;\n      } else {\n        queryMask1 |= 1 << typeId - 32;\n      }\n    }\n\n    // Scan all entities using bitmask matching\n    // This is cache-friendly because we iterate contiguously through TypedArrays\n    const alive = this.entityAlive;\n    const masks = this.entityComponentMask;\n    const maxId = this.nextEntityId;\n    for (let entityId = 1; entityId < maxId; entityId++) {\n      // Skip dead entities\n      if (!alive[entityId]) continue;\n\n      // Check if entity has all required components via bitmask\n      const mask0 = masks[entityId * 2];\n      const mask1 = masks[entityId * 2 + 1];\n      if ((mask0 & queryMask0) === queryMask0 && (mask1 & queryMask1) === queryMask1) {\n        result.push(entityId);\n      }\n    }\n    return result;\n  }\n\n  /**\r\n   * Get all alive entity IDs\r\n   * @returns {number[]} Array of alive entity IDs\r\n   */\n  getAllEntities() {\n    const result = [];\n    const alive = this.entityAlive;\n    const maxId = this.nextEntityId;\n    for (let entityId = 1; entityId < maxId; entityId++) {\n      if (alive[entityId]) {\n        result.push(entityId);\n      }\n    }\n    return result;\n  }\n\n  /**\r\n   * Check if an entity exists\r\n   * @param {number} entityId\r\n   * @returns {boolean}\r\n   */\n  entityExists(entityId) {\n    return entityId > 0 && entityId < this.MAX_ENTITIES && this.entityAlive[entityId] === 1;\n  }\n\n  /**\r\n   * Get count of alive entities\r\n   * @returns {number}\r\n   */\n  getEntityCount() {\n    return this.entityCount;\n  }\n\n  /**\r\n   * Get all component types for an entity\r\n   * @param {number} entityId\r\n   * @returns {string[]} Array of component type names\r\n   */\n  getEntityComponentTypes(entityId) {\n    if (!this.entityAlive[entityId]) return [];\n    const result = [];\n    const mask0 = this.entityComponentMask[entityId * 2];\n    const mask1 = this.entityComponentMask[entityId * 2 + 1];\n\n    // Check first 32 component types\n    for (let bit = 0; bit < 32; bit++) {\n      if (mask0 & 1 << bit) {\n        const name = this._componentTypeNames[bit];\n        if (name) result.push(name);\n      }\n    }\n\n    // Check next 32 component types\n    for (let bit = 0; bit < 32; bit++) {\n      if (mask1 & 1 << bit) {\n        const name = this._componentTypeNames[bit + 32];\n        if (name) result.push(name);\n      }\n    }\n    return result;\n  }\n\n  /**\r\n   * Iterate over entities with specific components without allocating arrays\r\n   * Calls callback(entityId) for each matching entity\r\n   * @param {string[]} componentTypes - Component types to match\r\n   * @param {function} callback - Called with each matching entityId\r\n   */\n  forEachEntityWith(componentTypes, callback) {\n    // Build query bitmask\n    let queryMask0 = 0;\n    let queryMask1 = 0;\n    for (const componentType of componentTypes) {\n      const typeId = this._componentTypeId.get(componentType);\n      if (typeId === undefined) return; // No entities can match\n      if (typeId < 32) {\n        queryMask0 |= 1 << typeId;\n      } else {\n        queryMask1 |= 1 << typeId - 32;\n      }\n    }\n    const alive = this.entityAlive;\n    const masks = this.entityComponentMask;\n    const maxId = this.nextEntityId;\n    for (let entityId = 1; entityId < maxId; entityId++) {\n      if (!alive[entityId]) continue;\n      const mask0 = masks[entityId * 2];\n      const mask1 = masks[entityId * 2 + 1];\n      if ((mask0 & queryMask0) === queryMask0 && (mask1 & queryMask1) === queryMask1) {\n        callback(entityId);\n      }\n    }\n  }\n\n  /**\r\n   * Clear all entities and reset the ECS state\r\n   */\n  clearAllEntities() {\n    // Clear all object storage\n    for (const storage of this._objectComponents.values()) {\n      storage.fill(undefined);\n    }\n\n    // Reset TypedArrays\n    this.entityAlive.fill(0);\n    this.entityComponentMask.fill(0);\n\n    // Reset entity management\n    this.freeEntityCount = 0;\n    this.nextEntityId = 1;\n    this.entityCount = 0;\n\n    // Invalidate query cache\n  }\n  triggerEvent(eventName, data) {\n    for (let i = 0; i < this.systems.length; i++) {\n      const system = this.systems[i];\n      if (system[eventName]) {\n        system[eventName](data);\n      }\n    }\n  }\n  gameOver() {\n    this.state.gameOver = true;\n  }\n  gameVictory() {\n    this.state.victory = true;\n  }\n  resetCurrentTime() {\n    this.state.now = 0;\n    this.lastTime = 0;\n    this.currentTime = 0;\n    this.tickCount = 0;\n  }\n  getComponents() {\n    if (!this.components) {\n      this.components = this.componentGenerator.getComponents();\n    }\n    return this.components;\n  }\n  getComponentSchema(componentId) {\n    return this.componentGenerator.getSchema(componentId);\n  }\n\n  /**\r\n   * Get enum map with toIndex and toValue\r\n   * @param {string} enumName - The enum name (e.g., 'team', 'element', 'projectiles')\r\n   * @returns {Object} { toIndex: {string->number}, toValue: [number->string] }\r\n   */\n  getEnumMap(enumName) {\n    return this.componentGenerator.getEnumMap(enumName);\n  }\n\n  /**\r\n   * Get a collection item by numeric index\r\n   * @param {string} collectionName - The collection name (e.g., 'levels', 'units')\r\n   * @param {number} index - The numeric index\r\n   * @returns {Object|undefined} The collection item, or undefined if not found\r\n   */\n  getCollectionItem(collectionName, index) {\n    const enumMap = this.componentGenerator.getEnumMap(collectionName);\n    if (!enumMap?.toValue?.[index]) return undefined;\n    const key = enumMap.toValue[index];\n    return this.getCollections()[collectionName]?.[key];\n  }\n\n  /**\r\n   * Get a collection item key (string name) by numeric index\r\n   * @param {string} collectionName - The collection name (e.g., 'levels', 'units')\r\n   * @param {number} index - The numeric index\r\n   * @returns {string|undefined} The collection key, or undefined if not found\r\n   */\n  getCollectionKey(collectionName, index) {\n    const enumMap = this.componentGenerator.getEnumMap(collectionName);\n    return enumMap?.toValue?.[index];\n  }\n\n  /**\r\n   * Get all enums as a convenient lookup object\r\n   * Usage: const enums = game.getEnums();\r\n   *        components.team({ team: enums.team.left })\r\n   * @returns {Object} { team: { neutral: 0, hostile: 1, ... }, element: { ... }, ... }\r\n   */\n  getEnums() {\n    if (!this._enums) {\n      this._enums = this.componentGenerator.getEnums();\n    }\n    return this._enums;\n  }\n\n  /**\r\n   * Get reverse enum lookup (index â†’ key)\r\n   * Usage: const reverseEnums = game.getReverseEnums();\r\n   *        const levelName = reverseEnums.levels[levelIndex];\r\n   * @returns {Object} { levels: { 0: 'level_1', 1: 'level_2' }, ... }\r\n   */\n  getReverseEnums() {\n    if (!this._reverseEnums) {\n      this._reverseEnums = this.componentGenerator.getReverseEnums();\n    }\n    return this._reverseEnums;\n  }\n  getUnitTypeDef(unitTypeComponent) {\n    if (!unitTypeComponent || unitTypeComponent.collection === -1 || unitTypeComponent.type === -1) {\n      return null;\n    }\n    const collections = this.getCollections();\n    const collectionEnumMap = this.getEnumMap('objectTypeDefinitions');\n    const collectionName = collectionEnumMap?.toValue?.[unitTypeComponent.collection];\n    if (!collectionName || !collections[collectionName]) {\n      return null;\n    }\n    const typeEnumMap = this.getEnumMap(collectionName);\n    const typeName = typeEnumMap?.toValue?.[unitTypeComponent.type];\n    if (!typeName) {\n      return null;\n    }\n    const def = collections[collectionName][typeName];\n    // Include resolved names for convenience\n    if (def) {\n      return {\n        ...def,\n        id: typeName,\n        collection: collectionName\n      };\n    }\n    return null;\n  }\n}\n\n// Assign to global.GUTS for server\nif (typeof __webpack_require__.g !== 'undefined' && __webpack_require__.g.GUTS) {\n  __webpack_require__.g.GUTS.BaseECSGame = BaseECSGame;\n}\n\n// ES6 exports for webpack bundling\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (BaseECSGame);\n\n\n// Auto-generated exports\nif (typeof window !== 'undefined' && window.GUTS) {\n  window.GUTS.BaseECSGame = BaseECSGame;\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9nbG9iYWwvY29sbGVjdGlvbnMvc2NyaXB0cy9saWJyYXJpZXMvanMvQmFzZUVDU0dhbWUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxNQUFNQSxXQUFXLENBQUM7RUFDZEMsV0FBV0EsQ0FBQ0MsR0FBRyxFQUFFO0lBQ2IsSUFBSSxDQUFDQSxHQUFHLEdBQUdBLEdBQUc7SUFDZCxJQUFJLENBQUNDLEtBQUssR0FBRyxDQUFDLENBQUM7SUFFZixJQUFJLENBQUNDLGFBQWEsR0FBRyxFQUFFO0lBQ3ZCLElBQUksQ0FBQ0MsT0FBTyxHQUFHLEVBQUU7SUFDakIsSUFBSSxDQUFDQyxPQUFPLEdBQUcsRUFBRTs7SUFFakI7SUFDQSxJQUFJLENBQUNDLFlBQVksR0FBRyxJQUFJOztJQUV4QjtJQUNBLElBQUksQ0FBQ0MsU0FBUyxHQUFHLElBQUlDLElBQUksQ0FBQ0MsWUFBWSxDQUFDLENBQUM7O0lBR3hDO0lBQ0E7SUFDQTs7SUFFQTtJQUNBLElBQUksQ0FBQ0MsWUFBWSxHQUFHLEtBQUssQ0FBQyxDQUFDOztJQUUzQjtJQUNBO0lBQ0EsSUFBSSxDQUFDQyxXQUFXLEdBQUcsSUFBSUMsVUFBVSxDQUFDLElBQUksQ0FBQ0YsWUFBWSxDQUFDO0lBQ3BEO0lBQ0E7SUFDQSxJQUFJLENBQUNHLG1CQUFtQixHQUFHLElBQUlDLFdBQVcsQ0FBQyxJQUFJLENBQUNKLFlBQVksR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDOztJQUVuRTtJQUNBLElBQUksQ0FBQ0ssYUFBYSxHQUFHLElBQUlELFdBQVcsQ0FBQyxJQUFJLENBQUNKLFlBQVksQ0FBQztJQUN2RCxJQUFJLENBQUNNLGVBQWUsR0FBRyxDQUFDO0lBQ3hCLElBQUksQ0FBQ0MsWUFBWSxHQUFHLENBQUMsQ0FBQyxDQUFDO0lBQ3ZCLElBQUksQ0FBQ0MsV0FBVyxHQUFHLENBQUM7O0lBRXBCO0lBQ0EsSUFBSSxDQUFDQyxnQkFBZ0IsR0FBRyxJQUFJQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDbkMsSUFBSSxD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VyxHQUFHQSxXQUFXO0FBQ3pDOztBQUVBO0FBQ0EsaUVBQWVBLFdBQVcsRUFBQztBQUNKOztBQUd2QjtBQUNBLElBQUksT0FBT3FWLE1BQU0sS0FBSyxXQUFXLElBQUlBLE1BQU0sQ0FBQzVVLElBQUksRUFBRTtFQUNoRDRVLE1BQU0sQ0FBQzVVLElBQUksQ0FBQ1QsV0FBVyxHQUFHQSxXQUFXO0FBQ3ZDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdG93ZXJkZWZlbnNlLy4vZ2xvYmFsL2NvbGxlY3Rpb25zL3NjcmlwdHMvbGlicmFyaWVzL2pzL0Jhc2VFQ1NHYW1lLmpzP2FkYTgiXSwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgQmFzZUVDU0dhbWUge1xyXG4gICAgY29uc3RydWN0b3IoYXBwKSB7XHJcbiAgICAgICAgdGhpcy5hcHAgPSBhcHA7XHJcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHt9O1xyXG5cclxuICAgICAgICB0aGlzLmVudGl0aWVzVG9BZGQgPSBbXTtcclxuICAgICAgICB0aGlzLmNsYXNzZXMgPSBbXTtcclxuICAgICAgICB0aGlzLnN5c3RlbXMgPSBbXTtcclxuXHJcbiAgICAgICAgLy8gU2NlbmUgbWFuYWdlbWVudFxyXG4gICAgICAgIHRoaXMuc2NlbmVNYW5hZ2VyID0gbnVsbDtcclxuXHJcbiAgICAgICAgLy8gU2VydmljZSByZWdpc3RyeVxyXG4gICAgICAgIHRoaXMuX3NlcnZpY2VzID0gbmV3IEdVVFMuR2FtZVNlcnZpY2VzKCk7XHJcblxyXG5cclxuICAgICAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4gICAgICAgIC8vIEhJR0gtUEVSRk9STUFOQ0UgRUNTIFNUT1JBR0UgKDEwaysgZW50aXRpZXMpXHJcbiAgICAgICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbiAgICAgICAgLy8gTWF4aW11bSBlbnRpdGllcyAtIHByZS1hbGxvY2F0ZSBmb3IgcGVyZm9ybWFuY2VcclxuICAgICAgICB0aGlzLk1BWF9FTlRJVElFUyA9IDY1NTM2OyAvLyBQb3dlciBvZiAyIGZvciBmYXN0IG1vZHVsb1xyXG5cclxuICAgICAgICAvLyBFbnRpdHkgbWFuYWdlbWVudCB3aXRoIFR5cGVkQXJyYXlzXHJcbiAgICAgICAgLy8gZW50aXR5QWxpdmVbaV0gPSAxIGlmIGVudGl0eSBpIGV4aXN0cywgMCBpZiBmcmVlIHNsb3RcclxuICAgICAgICB0aGlzLmVudGl0eUFsaXZlID0gbmV3IFVpbnQ4QXJyYXkodGhpcy5NQVhfRU5USVRJRVMpO1xyXG4gICAgICAgIC8vIENvbXBvbmVudCBiaXRtYXNrIHBlciBlbnRpdHkgKHVwIHRvIDMyIGNvbXBvbmVudCB0eXBlcyB3aXRoIHNpbmdsZSBVaW50MzIpXHJcbiAgICAgICAgLy8gRm9yIG1vcmUgY29tcG9uZW50cywgd2UgdXNlIG11bHRpcGxlIFVpbnQzMnNcclxuICAgICAgICB0aGlzLmVudGl0eUNvbXBvbmVudE1hc2sgPSBuZXcgVWludDMyQXJyYXkodGhpcy5NQVhfRU5USVRJRVMgKiAyKTsgLy8gNjQgY29tcG9uZW50IHR5cGVzIG1heFxyXG5cclxuICAgICAgICAvLyBGcmVlIGVudGl0eSBJRCBwb29sIGZvciByZWN5Y2xpbmdcclxuICAgICAgICB0aGlzLmZyZWVFbnRpdHlJZHMgPSBuZXcgVWludDMyQXJyYXkodGhpcy5NQVhfRU5USVRJRVMpO1xyXG4gICAgICAgIHRoaXMuZnJlZUVudGl0eUNvdW50ID0gMDtcclxuICAgICAgICB0aGlzLm5leHRFbnRpdHlJZCA9IDE7IC8vIFN0YXJ0IGF0IDEsIHJlc2VydmUgMCBhcyBcIm5vIGVudGl0eVwiXHJcbiAgICAgICAgdGhpcy5lbnRpdHlDb3VudCA9IDA7XHJcblxyXG4gICAgICAgIC8vIENvbXBvbmVudCB0eXBlIHJlZ2lzdHJ5IC0gbWFwcyBjb21wb25lbnQgbmFtZSB0byBudW1lcmljIElEICgwLTYzKVxyXG4gICAgICAgIHRoaXMuX2NvbXBvbmVudFR5cGVJZCA9IG5ldyBNYXAoKTsgLy8gY29tcG9uZW50TmFtZSAtPiB0eXBlSWRcclxuICAgICAgICB0aGlzLl9jb21wb25lbnRUeXBlTmFtZXMgPSBbXTsgLy8gdHlwZUlkIC0+IGNvbXBvbmVudE5hbWVcclxuICAgICAgICB0aGlzLl9uZXh0Q29tcG9uZW50VHlwZUlkID0gMDtcclxuXHJcbiAgICAgICAgLy8gU29BIChTdHJ1Y3R1cmUgb2YgQXJyYXlzKSBzdG9yYWdlIGZvciBudW1lcmljIGNvbXBvbmVudHNcclxuICAgICAgICAvLyBFYWNoIG51bWVyaWMgZmllbGQgZ2V0cyBpdHMgb3duIEZsb2F0MzJBcnJheSBmb3IgY2FjaGUtZnJpZW5kbHkgaXRlcmF0aW9uXHJcbiAgICAgICAgdGhpcy5fbnVtZXJpY0FycmF5cyA9IG5ldyBNYXAoKTsgLy8gXCJjb21wb25lbnRUeXBlLmZpZWxkLnBhdGhcIiAtPiBGbG9hdDMyQXJyYXlcclxuXHJcbiAgICAgICAgLy8gVHJhY2sgd2hpY2ggY29tcG9uZW50cyBhcmUgbnVtZXJpYy1vbmx5ICh1c2UgVHlwZWRBcnJheXMpXHJcbiAgICAgICAgLy8gTWFwcyBjb21wb25lbnRJZCAtPiB7IGZpZWxkczogWydmaWVsZDEnLCAnbmVzdGVkLmZpZWxkMiddLCBpc051bWVyaWM6IHRydWUgfVxyXG4gICAgICAgIHRoaXMuX251bWVyaWNDb21wb25lbnRJbmZvID0gbmV3IE1hcCgpO1xyXG5cclxuICAgICAgICAvLyBPYmplY3Qgc3RvcmFnZSBmb3Igbm9uLW51bWVyaWMvY29tcGxleCBjb21wb25lbnQgZGF0YVxyXG4gICAgICAgIC8vIFByZS1hbGxvY2F0ZWQgYXJyYXkgb2Ygb2JqZWN0cywgaW5kZXhlZCBieSBlbnRpdHkgSURcclxuICAgICAgICB0aGlzLl9vYmplY3RDb21wb25lbnRzID0gbmV3IE1hcCgpOyAvLyBjb21wb25lbnRUeXBlIC0+IEFycmF5W01BWF9FTlRJVElFU11cclxuXHJcbiAgICAgICAgLy8gUXVlcnkgY2FjaGUgZm9yIGdldEVudGl0aWVzV2l0aCAtIHN0b3JlcyByZXVzYWJsZSBhcnJheXMgdG8gYXZvaWQgYWxsb2NhdGlvbnNcclxuICAgICAgICB0aGlzLl9xdWVyeUNhY2hlID0gbmV3IE1hcCgpO1xyXG5cclxuICAgICAgICAvLyBEZWx0YSBzeW5jIHRyYWNraW5nIC0gc3RvcmVzIGxhc3Qgc3luY2VkIHN0YXRlIGZvciBjb21wdXRpbmcgZGVsdGFzXHJcbiAgICAgICAgdGhpcy5fbGFzdFN5bmNlZFN0YXRlID0gbnVsbDtcclxuXHJcbiAgICAgICAgLy8gQ2xpZW50LW9ubHkgY29tcG9uZW50cyAtIGV4Y2x1ZGVkIGZyb20gc2VydmVyIHN5bmMgdG8gcHJlc2VydmUgY2xpZW50IHN0YXRlXHJcbiAgICAgICAgLy8gVGhlc2UgY29tcG9uZW50cyBhcmUgbWFuYWdlZCBsb2NhbGx5IGFuZCBzaG91bGQgbm90IGJlIG92ZXJ3cml0dGVuIGJ5IHNlcnZlclxyXG4gICAgICAgIHRoaXMuX2NsaWVudE9ubHlDb21wb25lbnRzID0gbmV3IFNldChbXHJcbiAgICAgICAgICAgICdyZW5kZXJhYmxlJyxcclxuICAgICAgICAgICAgJ2FuaW1hdGlvblN0YXRlJ1xyXG4gICAgICAgIF0pO1xyXG5cclxuICAgICAgICAvLyBQcm94eSBjYWNoZSBmb3IgZ2V0Q29tcG9uZW50IC0gYXZvaWRzIGNyZWF0aW5nIG5ldyBwcm94aWVzIGV2ZXJ5IGNhbGxcclxuICAgICAgICAvLyBNYXA6IGNvbXBvbmVudFR5cGUgLT4gTWFwKGVudGl0eUlkIC0+IHByb3h5KVxyXG4gICAgICAgIHRoaXMuX3Byb3h5Q2FjaGUgPSBuZXcgTWFwKCk7XHJcblxyXG4gICAgICAgIC8vIFByZS1hbGxvY2F0ZWQgcmVzdWx0IGFycmF5IGZvciBxdWVyaWVzIChhdm9pZHMgYWxsb2NhdGlvbiBpbiBob3QgcGF0aClcclxuICAgICAgICB0aGlzLl9xdWVyeVJlc3VsdEJ1ZmZlciA9IG5ldyBVaW50MzJBcnJheSh0aGlzLk1BWF9FTlRJVElFUyk7XHJcblxyXG4gICAgICAgIHRoaXMubGFzdFRpbWUgPSAwO1xyXG4gICAgICAgIHRoaXMuY3VycmVudFRpbWUgPSAwO1xyXG4gICAgICAgIHRoaXMuZGVsdGFUaW1lID0gMDtcclxuICAgICAgICB0aGlzLnRpY2tDb3VudCA9IDA7XHJcblxyXG4gICAgICAgIC8vIEZpeGVkIHRpbWVzdGVwIGZvciBkZXRlcm1pbmlzdGljIHNpbXVsYXRpb24gKDIwIFRQUyA9IDAuMDVzIHBlciB0aWNrKVxyXG4gICAgICAgIHRoaXMuRklYRURfREVMVEFfVElNRSA9IDEvMjA7XHJcblxyXG4gICAgICAgIHRoaXMuaXNTZXJ2ZXIgPSBmYWxzZTtcclxuICAgICAgICAvLyBQZXJmb3JtYW5jZSBtb25pdG9yaW5nXHJcbiAgICAgICAgaWYgKHR5cGVvZiBHVVRTICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgR1VUUy5QZXJmb3JtYW5jZU1vbml0b3IgIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgICAgIHRoaXMucGVyZm9ybWFuY2VNb25pdG9yID0gbmV3IEdVVFMuUGVyZm9ybWFuY2VNb25pdG9yKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBDYWxsIGxvZ2dpbmcgZm9yIGRlYnVnZ2luZ1xyXG4gICAgICAgIGlmICh0eXBlb2YgR1VUUyAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIEdVVFMuQ2FsbExvZ2dlciAhPT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgICAgICAgdGhpcy5jYWxsTG9nZ2VyID0gbmV3IEdVVFMuQ2FsbExvZ2dlcigpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gR2xvYmFsIHNlZWRlZCByYW5kb20gaW5zdGFuY2UgLSBjYW4gYmUgcmVzZWVkZWQgZm9yIGRldGVybWluaXN0aWMgc2ltdWxhdGlvblxyXG4gICAgICAgIGlmICh0eXBlb2YgR1VUUyAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIEdVVFMuU2VlZGVkUmFuZG9tICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgICAgICB0aGlzLnJuZyA9IG5ldyBHVVRTLlNlZWRlZFJhbmRvbShEYXRlLm5vdygpKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEluaXRpYWxpemUgY29tcG9uZW50IHR5cGUgcmVnaXN0cnkgd2l0aCBjb21tb24gY29tcG9uZW50c1xyXG4gICAgICAgIHRoaXMuX2luaXRDb21wb25lbnRUeXBlcygpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUHJlLXJlZ2lzdGVyIGNvbW1vbiBjb21wb25lbnQgdHlwZXMgYW5kIGFsbG9jYXRlIHRoZWlyIHN0b3JhZ2VcclxuICAgICAqL1xyXG4gICAgX2luaXRDb21wb25lbnRUeXBlcygpIHtcclxuXHJcbiAgICAgICAgY29uc3QgY29sbGVjdGlvbnMgPSB0aGlzLmdldENvbGxlY3Rpb25zKCk7XHJcbiAgICAgICAgdGhpcy5jb21wb25lbnRHZW5lcmF0b3IgPSBuZXcgR1VUUy5Db21wb25lbnRHZW5lcmF0b3IoY29sbGVjdGlvbnMuY29tcG9uZW50cywgY29sbGVjdGlvbnMpO1xyXG4gICAgICAgIHRoaXMucmVnaXN0ZXIoXCJnZXRDb21wb25lbnRzXCIsIHRoaXMuZ2V0Q29tcG9uZW50cy5iaW5kKHRoaXMpKTtcclxuICAgICAgICB0aGlzLnJlZ2lzdGVyKFwiZ2V0Q29tcG9uZW50U2NoZW1hXCIsIHRoaXMuZ2V0Q29tcG9uZW50U2NoZW1hLmJpbmQodGhpcykpO1xyXG4gICAgICAgIHRoaXMucmVnaXN0ZXIoXCJnZXRFbnVtTWFwXCIsIHRoaXMuZ2V0RW51bU1hcC5iaW5kKHRoaXMpKTtcclxuICAgICAgICB0aGlzLnJlZ2lzdGVyKFwiZ2V0RW51bXNcIiwgdGhpcy5nZXRFbnVtcy5iaW5kKHRoaXMpKTtcclxuICAgICAgICB0aGlzLnJlZ2lzdGVyKFwiZ2V0UmV2ZXJzZUVudW1zXCIsIHRoaXMuZ2V0UmV2ZXJzZUVudW1zLmJpbmQodGhpcykpO1xyXG4gICAgICAgIHRoaXMucmVnaXN0ZXIoXCJnZXRVbml0VHlwZURlZlwiLCB0aGlzLmdldFVuaXRUeXBlRGVmLmJpbmQodGhpcykpO1xyXG5cclxuICAgICAgICAvLyBQcmUtcmVnaXN0ZXIgYWxsIGNvbXBvbmVudCB0eXBlcyBpbiBhbHBoYWJldGljYWwgb3JkZXIgZm9yIGRldGVybWluaXN0aWMgdHlwZSBJRHNcclxuICAgICAgICAvLyBUaGlzIGVuc3VyZXMgc2VydmVyIGFuZCBjbGllbnQgaGF2ZSBpZGVudGljYWwgdHlwZSBJRCBtYXBwaW5nc1xyXG4gICAgICAgIGNvbnN0IGNvbXBvbmVudE5hbWVzID0gT2JqZWN0LmtleXMoY29sbGVjdGlvbnMuY29tcG9uZW50cykuc29ydCgpO1xyXG4gICAgICAgIGZvciAoY29uc3QgY29tcG9uZW50TmFtZSBvZiBjb21wb25lbnROYW1lcykge1xyXG4gICAgICAgICAgICB0aGlzLl9nZXRDb21wb25lbnRUeXBlSWQoY29tcG9uZW50TmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogR2V0IG9yIGNyZWF0ZSBhIG51bWVyaWMgY29tcG9uZW50IHR5cGUgSURcclxuICAgICAqL1xyXG4gICAgX2dldENvbXBvbmVudFR5cGVJZChjb21wb25lbnRUeXBlKSB7XHJcbiAgICAgICAgbGV0IHR5cGVJZCA9IHRoaXMuX2NvbXBvbmVudFR5cGVJZC5nZXQoY29tcG9uZW50VHlwZSk7XHJcbiAgICAgICAgaWYgKHR5cGVJZCA9PT0gdW5kZWZpbmVkKSB7XHJcblxyXG4gICAgICAgICAgICB0eXBlSWQgPSB0aGlzLl9uZXh0Q29tcG9uZW50VHlwZUlkKys7XHJcbiAgICAgICAgICAgIHRoaXMuX2NvbXBvbmVudFR5cGVJZC5zZXQoY29tcG9uZW50VHlwZSwgdHlwZUlkKTtcclxuICAgICAgICAgICAgdGhpcy5fY29tcG9uZW50VHlwZU5hbWVzW3R5cGVJZF0gPSBjb21wb25lbnRUeXBlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdHlwZUlkO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogU2V0IGNvbXBvbmVudCBiaXQgaW4gZW50aXR5J3MgYml0bWFza1xyXG4gICAgICovXHJcbiAgICBfc2V0Q29tcG9uZW50Qml0KGVudGl0eUlkLCBjb21wb25lbnRUeXBlSWQpIHtcclxuICAgICAgICBjb25zdCBtYXNrSW5kZXggPSBlbnRpdHlJZCAqIDIgKyAoY29tcG9uZW50VHlwZUlkID49IDMyID8gMSA6IDApO1xyXG4gICAgICAgIGNvbnN0IGJpdCA9IGNvbXBvbmVudFR5cGVJZCAlIDMyO1xyXG4gICAgICAgIHRoaXMuZW50aXR5Q29tcG9uZW50TWFza1ttYXNrSW5kZXhdIHw9ICgxIDw8IGJpdCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDbGVhciBjb21wb25lbnQgYml0IGluIGVudGl0eSdzIGJpdG1hc2tcclxuICAgICAqL1xyXG4gICAgX2NsZWFyQ29tcG9uZW50Qml0KGVudGl0eUlkLCBjb21wb25lbnRUeXBlSWQpIHtcclxuICAgICAgICBjb25zdCBtYXNrSW5kZXggPSBlbnRpdHlJZCAqIDIgKyAoY29tcG9uZW50VHlwZUlkID49IDMyID8gMSA6IDApO1xyXG4gICAgICAgIGNvbnN0IGJpdCA9IGNvbXBvbmVudFR5cGVJZCAlIDMyO1xyXG4gICAgICAgIHRoaXMuZW50aXR5Q29tcG9uZW50TWFza1ttYXNrSW5kZXhdICY9IH4oMSA8PCBiaXQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ2hlY2sgaWYgZW50aXR5IGhhcyBjb21wb25lbnQgdmlhIGJpdG1hc2tcclxuICAgICAqL1xyXG4gICAgX2hhc0NvbXBvbmVudEJpdChlbnRpdHlJZCwgY29tcG9uZW50VHlwZUlkKSB7XHJcbiAgICAgICAgY29uc3QgbWFza0luZGV4ID0gZW50aXR5SWQgKiAyICsgKGNvbXBvbmVudFR5cGVJZCA+PSAzMiA/IDEgOiAwKTtcclxuICAgICAgICBjb25zdCBiaXQgPSBjb21wb25lbnRUeXBlSWQgJSAzMjtcclxuICAgICAgICByZXR1cm4gKHRoaXMuZW50aXR5Q29tcG9uZW50TWFza1ttYXNrSW5kZXhdICYgKDEgPDwgYml0KSkgIT09IDA7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXQgb3IgY3JlYXRlIEZsb2F0MzJBcnJheSBmb3IgYSBudW1lcmljIGZpZWxkXHJcbiAgICAgKi9cclxuICAgIF9nZXROdW1lcmljQXJyYXkoa2V5KSB7XHJcbiAgICAgICAgbGV0IGFyciA9IHRoaXMuX251bWVyaWNBcnJheXMuZ2V0KGtleSk7XHJcbiAgICAgICAgaWYgKCFhcnIpIHtcclxuICAgICAgICAgICAgYXJyID0gbmV3IEZsb2F0MzJBcnJheSh0aGlzLk1BWF9FTlRJVElFUyk7XHJcbiAgICAgICAgICAgIHRoaXMuX251bWVyaWNBcnJheXMuc2V0KGtleSwgYXJyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGFycjtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEdldCBvciBjcmVhdGUgb2JqZWN0IHN0b3JhZ2UgYXJyYXkgZm9yIGEgY29tcG9uZW50IHR5cGVcclxuICAgICAqL1xyXG4gICAgX2dldE9iamVjdFN0b3JhZ2UoY29tcG9uZW50VHlwZSkge1xyXG4gICAgICAgIGxldCBzdG9yYWdlID0gdGhpcy5fb2JqZWN0Q29tcG9uZW50cy5nZXQoY29tcG9uZW50VHlwZSk7XHJcbiAgICAgICAgaWYgKCFzdG9yYWdlKSB7XHJcbiAgICAgICAgICAgIHN0b3JhZ2UgPSBuZXcgQXJyYXkodGhpcy5NQVhfRU5USVRJRVMpO1xyXG4gICAgICAgICAgICB0aGlzLl9vYmplY3RDb21wb25lbnRzLnNldChjb21wb25lbnRUeXBlLCBzdG9yYWdlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHN0b3JhZ2U7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBBbmFseXplIGEgY29tcG9uZW50IHNjaGVtYSB0byBkZXRlcm1pbmUgaWYgaXQncyBhbGwtbnVtZXJpY1xyXG4gICAgICogUmV0dXJucyB7IGlzTnVtZXJpYzogdHJ1ZSwgZmllbGRzOiBbJ2ZpZWxkMScsICduZXN0ZWQuZmllbGQyJ10gfSBvciB7IGlzTnVtZXJpYzogZmFsc2UgfVxyXG4gICAgICogTnVtYmVycywgYm9vbGVhbnMgKHN0b3JlZCBhcyAwLzEpLCBlbnVtIHN0cmluZ3MsIGFuZCBhcnJheXMgb2YgZW51bSB2YWx1ZXMgKGJpdG1hc2tzKSBhcmUgYWxsIGNvbnNpZGVyZWQgbnVtZXJpYy5cclxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBzY2hlbWEgLSBUaGUgY29tcG9uZW50IHNjaGVtYVxyXG4gICAgICogQHBhcmFtIHtPYmplY3R8bnVsbH0gZW51bU1hcCAtIFRoZSBlbnVtIG1hcCBpZiB0aGlzIGNvbXBvbmVudCBoYXMgZW51bXNcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBwcmVmaXggLSBQYXRoIHByZWZpeCBmb3IgbmVzdGVkIGZpZWxkc1xyXG4gICAgICovXHJcbiAgICBfYW5hbHl6ZUNvbXBvbmVudFNjaGVtYShzY2hlbWEsIGVudW1NYXAgPSBudWxsLCBwcmVmaXggPSAnJykge1xyXG4gICAgICAgIGNvbnN0IGZpZWxkcyA9IFtdO1xyXG4gICAgICAgIGxldCBpc051bWVyaWMgPSB0cnVlO1xyXG5cclxuICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBzY2hlbWEpIHtcclxuICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBzY2hlbWFba2V5XTtcclxuICAgICAgICAgICAgY29uc3QgZmllbGRQYXRoID0gcHJlZml4ID8gYCR7cHJlZml4fS4ke2tleX1gIDoga2V5O1xyXG5cclxuICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicpIHtcclxuICAgICAgICAgICAgICAgIGZpZWxkcy5wdXNoKGZpZWxkUGF0aCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSAnYm9vbGVhbicpIHtcclxuICAgICAgICAgICAgICAgIC8vIEJvb2xlYW5zIHN0b3JlZCBhcyAwLzEgaW4gVHlwZWRBcnJheXNcclxuICAgICAgICAgICAgICAgIGZpZWxkcy5wdXNoKGZpZWxkUGF0aCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodmFsdWUgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIC8vIG51bGwgZmllbGRzIHN0b3JlZCBhcyAtSW5maW5pdHkgaW4gVHlwZWRBcnJheXNcclxuICAgICAgICAgICAgICAgIGZpZWxkcy5wdXNoKGZpZWxkUGF0aCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyAmJiBlbnVtTWFwICYmIGVudW1NYXAudG9JbmRleC5oYXNPd25Qcm9wZXJ0eSh2YWx1ZSkpIHtcclxuICAgICAgICAgICAgICAgIC8vIFN0cmluZyB0aGF0IHdpbGwgYmUgY29udmVydGVkIHRvIGVudW0gaW5kZXggLSB0cmVhdCBhcyBudW1lcmljXHJcbiAgICAgICAgICAgICAgICBmaWVsZHMucHVzaChmaWVsZFBhdGgpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpICYmIGVudW1NYXApIHtcclxuICAgICAgICAgICAgICAgIC8vIEFycmF5cyBvZiBlbnVtIHZhbHVlcyB3aWxsIGJlIGNvbnZlcnRlZCB0byBiaXRtYXNrIC0gdHJlYXQgYXMgbnVtZXJpY1xyXG4gICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgYXJyYXkgY29udGFpbnMgZW51bSB2YWx1ZXMgb3IgXCJhbGxcIlxyXG4gICAgICAgICAgICAgICAgY29uc3QgaXNFbnVtQXJyYXkgPSB2YWx1ZS5ldmVyeShpdGVtID0+XHJcbiAgICAgICAgICAgICAgICAgICAgaXRlbSA9PT0gJ2FsbCcgfHwgZW51bU1hcC50b0luZGV4Lmhhc093blByb3BlcnR5KGl0ZW0pXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgaWYgKGlzRW51bUFycmF5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZmllbGRzLnB1c2goZmllbGRQYXRoKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaXNOdW1lcmljID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodmFsdWUgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiAhQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcclxuICAgICAgICAgICAgICAgIC8vIFJlY3Vyc2l2ZWx5IGNoZWNrIG5lc3RlZCBvYmplY3RzXHJcbiAgICAgICAgICAgICAgICBjb25zdCBuZXN0ZWQgPSB0aGlzLl9hbmFseXplQ29tcG9uZW50U2NoZW1hKHZhbHVlLCBlbnVtTWFwLCBmaWVsZFBhdGgpO1xyXG4gICAgICAgICAgICAgICAgaWYgKG5lc3RlZC5pc051bWVyaWMpIHtcclxuICAgICAgICAgICAgICAgICAgICBmaWVsZHMucHVzaCguLi5uZXN0ZWQuZmllbGRzKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaXNOdW1lcmljID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyBTdHJpbmcgKG5vbi1lbnVtKSwgbm9uLWVudW0gYXJyYXksIG51bGwsIGV0Yy4gLSBub3QgcHVyZWx5IG51bWVyaWNcclxuICAgICAgICAgICAgICAgIGlzTnVtZXJpYyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB7IGlzTnVtZXJpYywgZmllbGRzIH07XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZWdpc3RlciBhIGNvbXBvbmVudCB0eXBlIGFuZCBzZXQgdXAgc3RvcmFnZSAoVHlwZWRBcnJheXMgZm9yIG51bWVyaWMsIG9iamVjdCBhcnJheSBvdGhlcndpc2UpXHJcbiAgICAgKiBDYWxsZWQgd2hlbiBhIGNvbXBvbmVudCBpcyBmaXJzdCBhZGRlZFxyXG4gICAgICovXHJcbiAgICBfc2V0dXBDb21wb25lbnRTdG9yYWdlKGNvbXBvbmVudElkLCBzY2hlbWEsIGVudW1NYXAgPSBudWxsKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX251bWVyaWNDb21wb25lbnRJbmZvLmhhcyhjb21wb25lbnRJZCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuOyAvLyBBbHJlYWR5IHNldCB1cFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgYW5hbHlzaXMgPSB0aGlzLl9hbmFseXplQ29tcG9uZW50U2NoZW1hKHNjaGVtYSwgZW51bU1hcCk7XHJcbiAgICAgICAgLy8gQ2FjaGUgYm90aCBzY2hlbWFzIGZvciBnZXRDb21wb25lbnQ6XHJcbiAgICAgICAgLy8gLSBzY2hlbWE6IGV4cGFuZGVkIHNjaGVtYSAodXNlZCBmb3IgVHlwZWRBcnJheSBmaWVsZCBlbnVtZXJhdGlvbilcclxuICAgICAgICAvLyAtIG9yaWdpbmFsU2NoZW1hOiBwcmVzZXJ2ZXMgJGZpeGVkQXJyYXkgZGlyZWN0aXZlcyBmb3IgYXJyYXkgcHJveHkgY3JlYXRpb25cclxuICAgICAgICBhbmFseXNpcy5zY2hlbWEgPSBzY2hlbWE7XHJcbiAgICAgICAgYW5hbHlzaXMub3JpZ2luYWxTY2hlbWEgPSB0aGlzLmNvbXBvbmVudEdlbmVyYXRvci5nZXRPcmlnaW5hbFNjaGVtYShjb21wb25lbnRJZCk7XHJcbiAgICAgICAgdGhpcy5fbnVtZXJpY0NvbXBvbmVudEluZm8uc2V0KGNvbXBvbmVudElkLCBhbmFseXNpcyk7XHJcblxyXG4gICAgICAgIGlmIChhbmFseXNpcy5pc051bWVyaWMpIHtcclxuICAgICAgICAgICAgLy8gQ3JlYXRlIFR5cGVkQXJyYXlzIGZvciBlYWNoIGZpZWxkXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZmllbGRQYXRoIG9mIGFuYWx5c2lzLmZpZWxkcykge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qga2V5ID0gYCR7Y29tcG9uZW50SWR9LiR7ZmllbGRQYXRofWA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9nZXROdW1lcmljQXJyYXkoa2V5KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFNldCBhIHZhbHVlIGluIGEgbnVtZXJpYyBjb21wb25lbnQncyBUeXBlZEFycmF5IHN0b3JhZ2VcclxuICAgICAqIE5vdGU6IENhbGxlciBzaG91bGQgdXNlIF90b1N0b3JhZ2VWYWx1ZSgpIGlmIHBhc3NpbmcgdXNlci1wcm92aWRlZCB2YWx1ZXNcclxuICAgICAqL1xyXG4gICAgX3NldE51bWVyaWNGaWVsZChjb21wb25lbnRJZCwgZW50aXR5SWQsIGZpZWxkUGF0aCwgdmFsdWUpIHtcclxuICAgICAgICBjb25zdCBrZXkgPSBgJHtjb21wb25lbnRJZH0uJHtmaWVsZFBhdGh9YDtcclxuICAgICAgICBjb25zdCBhcnIgPSB0aGlzLl9udW1lcmljQXJyYXlzLmdldChrZXkpO1xyXG4gICAgICAgIGlmIChhcnIpIHtcclxuICAgICAgICAgICAgYXJyW2VudGl0eUlkXSA9IHZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEdldCBhIHZhbHVlIGZyb20gYSBudW1lcmljIGNvbXBvbmVudCdzIFR5cGVkQXJyYXkgc3RvcmFnZSAoaW50ZXJuYWwpXHJcbiAgICAgKiBDb252ZXJ0cyAtSW5maW5pdHkgKG51bGwgc2VudGluZWwpIGJhY2sgdG8gbnVsbCBmb3IgQVBJIGNvbnN1bWVyc1xyXG4gICAgICovXHJcbiAgICBfZ2V0TnVtZXJpY0ZpZWxkKGNvbXBvbmVudElkLCBlbnRpdHlJZCwgZmllbGRQYXRoKSB7XHJcbiAgICAgICAgY29uc3Qga2V5ID0gYCR7Y29tcG9uZW50SWR9LiR7ZmllbGRQYXRofWA7XHJcbiAgICAgICAgY29uc3QgYXJyID0gdGhpcy5fbnVtZXJpY0FycmF5cy5nZXQoa2V5KTtcclxuICAgICAgICBpZiAoIWFycikgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZnJvbVN0b3JhZ2VWYWx1ZShhcnJbZW50aXR5SWRdKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEdldCByYXcgdmFsdWUgZnJvbSBUeXBlZEFycmF5IHN0b3JhZ2Ugd2l0aG91dCBudWxsIGNvbnZlcnNpb24gKGZvciBpbnRlcm5hbCB1c2UpXHJcbiAgICAgKi9cclxuICAgIF9nZXRSYXdOdW1lcmljRmllbGQoY29tcG9uZW50SWQsIGVudGl0eUlkLCBmaWVsZFBhdGgpIHtcclxuICAgICAgICBjb25zdCBrZXkgPSBgJHtjb21wb25lbnRJZH0uJHtmaWVsZFBhdGh9YDtcclxuICAgICAgICBjb25zdCBhcnIgPSB0aGlzLl9udW1lcmljQXJyYXlzLmdldChrZXkpO1xyXG4gICAgICAgIHJldHVybiBhcnIgPyBhcnJbZW50aXR5SWRdIDogdW5kZWZpbmVkO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRGlyZWN0IGZpZWxkIHJlYWQgLSBieXBhc3NlcyBwcm94eSBmb3IgbWF4aW11bSBwZXJmb3JtYW5jZSBpbiBob3QgcGF0aHNcclxuICAgICAqIFVzZSBmb3IgdGlnaHQgbG9vcHMgd2hlcmUgcHJveHkgb3ZlcmhlYWQgbWF0dGVycyAoY29sbGlzaW9uLCBwYXRoZmluZGluZylcclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBlbnRpdHlJZCAtIEVudGl0eSBJRFxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGNvbXBvbmVudFR5cGUgLSBDb21wb25lbnQgbmFtZSAoZS5nLiwgJ3RyYW5zZm9ybScpXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZmllbGRQYXRoIC0gRG90LXNlcGFyYXRlZCBwYXRoIChlLmcuLCAncG9zaXRpb24ueCcpXHJcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfG51bGx9IC0gUmF3IHZhbHVlLCBvciBudWxsIGlmIGZpZWxkIHdhcyBudWxsXHJcbiAgICAgKiBAZXhhbXBsZVxyXG4gICAgICogLy8gSW5zdGVhZCBvZjogZ2FtZS5nZXRDb21wb25lbnQoaWQsICd0cmFuc2Zvcm0nKS5wb3NpdGlvbi54XHJcbiAgICAgKiBjb25zdCB4ID0gZ2FtZS5nZXRGaWVsZChpZCwgJ3RyYW5zZm9ybScsICdwb3NpdGlvbi54Jyk7XHJcbiAgICAgKi9cclxuICAgIGdldEZpZWxkKGVudGl0eUlkLCBjb21wb25lbnRUeXBlLCBmaWVsZFBhdGgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZ2V0TnVtZXJpY0ZpZWxkKGNvbXBvbmVudFR5cGUsIGVudGl0eUlkLCBmaWVsZFBhdGgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRGlyZWN0IGZpZWxkIHdyaXRlIC0gYnlwYXNzZXMgcHJveHkgZm9yIG1heGltdW0gcGVyZm9ybWFuY2UgaW4gaG90IHBhdGhzXHJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gZW50aXR5SWQgLSBFbnRpdHkgSURcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBjb21wb25lbnRUeXBlIC0gQ29tcG9uZW50IG5hbWUgKGUuZy4sICd0cmFuc2Zvcm0nKVxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGZpZWxkUGF0aCAtIERvdC1zZXBhcmF0ZWQgcGF0aCAoZS5nLiwgJ3Bvc2l0aW9uLngnKVxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ8bnVsbH0gdmFsdWUgLSBWYWx1ZSB0byBzZXRcclxuICAgICAqIEBleGFtcGxlXHJcbiAgICAgKiAvLyBJbnN0ZWFkIG9mOiBnYW1lLmdldENvbXBvbmVudChpZCwgJ3RyYW5zZm9ybScpLnBvc2l0aW9uLnggPSAxMDBcclxuICAgICAqIGdhbWUuc2V0RmllbGQoaWQsICd0cmFuc2Zvcm0nLCAncG9zaXRpb24ueCcsIDEwMCk7XHJcbiAgICAgKi9cclxuICAgIHNldEZpZWxkKGVudGl0eUlkLCBjb21wb25lbnRUeXBlLCBmaWVsZFBhdGgsIHZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy5fc2V0TnVtZXJpY0ZpZWxkKGNvbXBvbmVudFR5cGUsIGVudGl0eUlkLCBmaWVsZFBhdGgsIHRoaXMuX3RvU3RvcmFnZVZhbHVlKHZhbHVlKSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDaGVjayBpZiBhIGZpZWxkIHZhbHVlIHJlcHJlc2VudHMgbnVsbC91bnNldFxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHZhbHVlIC0gVmFsdWUgZnJvbSBnZXRGaWVsZCBvciBkaXJlY3QgVHlwZWRBcnJheSByZWFkXHJcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gLSBUcnVlIGlmIHZhbHVlIHJlcHJlc2VudHMgbnVsbFxyXG4gICAgICovXHJcbiAgICBpc051bGwodmFsdWUpIHtcclxuICAgICAgICByZXR1cm4gdmFsdWUgPT09IC1JbmZpbml0eSB8fCB2YWx1ZSA9PT0gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4gICAgLy8gTlVMTCBTRU5USU5FTCBDT05WRVJTSU9OIFVUSUxJVElFU1xyXG4gICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuICAgIC8vIFR5cGVkQXJyYXlzIGNhbid0IHN0b3JlIG51bGwsIHNvIHdlIHVzZSAtSW5maW5pdHkgYXMgYSBzZW50aW5lbCB2YWx1ZS5cclxuICAgIC8vIFRoZXNlIG1ldGhvZHMgcHJvdmlkZSBjb25zaXN0ZW50IGNvbnZlcnNpb24gYXQgYWxsIGJvdW5kYXJpZXM6XHJcbiAgICAvLyAgIC0gX3RvU3RvcmFnZVZhbHVlIC8gX2Zyb21TdG9yYWdlVmFsdWU6IGZvciBUeXBlZEFycmF5IHJlYWQvd3JpdGVcclxuICAgIC8vICAgLSBfdG9TeW5jVmFsdWUgLyBfZnJvbVN5bmNWYWx1ZTogZm9yIEpTT04gc2VyaWFsaXphdGlvbiAoc3luYylcclxuICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDb252ZXJ0IEFQSSB2YWx1ZSB0byBUeXBlZEFycmF5IHN0b3JhZ2UgZm9ybWF0XHJcbiAgICAgKiBudWxsIC0+IC1JbmZpbml0eSAobnVsbCBzZW50aW5lbCksIG90aGVyIHZhbHVlcyBwYXNzIHRocm91Z2hcclxuICAgICAqL1xyXG4gICAgX3RvU3RvcmFnZVZhbHVlKHZhbHVlKSB7XHJcbiAgICAgICAgcmV0dXJuIHZhbHVlID09PSBudWxsID8gLUluZmluaXR5IDogdmFsdWU7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDb252ZXJ0IFR5cGVkQXJyYXkgc3RvcmFnZSB2YWx1ZSB0byBBUEkgZm9ybWF0XHJcbiAgICAgKiAtSW5maW5pdHkgKG51bGwgc2VudGluZWwpIC0+IG51bGwsIG90aGVyIHZhbHVlcyBwYXNzIHRocm91Z2hcclxuICAgICAqL1xyXG4gICAgX2Zyb21TdG9yYWdlVmFsdWUodmFsdWUpIHtcclxuICAgICAgICByZXR1cm4gdmFsdWUgPT09IC1JbmZpbml0eSA/IG51bGwgOiB2YWx1ZTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENvbnZlcnQgVHlwZWRBcnJheSBzdG9yYWdlIHZhbHVlIHRvIEpTT04tc2FmZSBmb3JtYXQgZm9yIHN5bmNcclxuICAgICAqIC1JbmZpbml0eSAobnVsbCBzZW50aW5lbCkgLT4gbnVsbCAoSlNPTiBudWxsKSwgb3RoZXIgdmFsdWVzIHBhc3MgdGhyb3VnaFxyXG4gICAgICogTm90ZTogVGhpcyBpcyB0aGUgc2FtZSBhcyBfZnJvbVN0b3JhZ2VWYWx1ZSBzaW5jZSBKU09OIHVzZXMgbnVsbFxyXG4gICAgICovXHJcbiAgICBfdG9TeW5jVmFsdWUodmFsdWUpIHtcclxuICAgICAgICByZXR1cm4gdmFsdWUgPT09IC1JbmZpbml0eSA/IG51bGwgOiB2YWx1ZTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENvbnZlcnQgSlNPTiBzeW5jIHZhbHVlIGJhY2sgdG8gVHlwZWRBcnJheSBzdG9yYWdlIGZvcm1hdFxyXG4gICAgICogbnVsbCAoSlNPTiBudWxsKSAtPiAtSW5maW5pdHkgKG51bGwgc2VudGluZWwpLCBvdGhlciB2YWx1ZXMgcGFzcyB0aHJvdWdoXHJcbiAgICAgKiBOb3RlOiBUaGlzIGlzIHRoZSBzYW1lIGFzIF90b1N0b3JhZ2VWYWx1ZSBzaW5jZSBKU09OIHVzZXMgbnVsbFxyXG4gICAgICovXHJcbiAgICBfZnJvbVN5bmNWYWx1ZSh2YWx1ZSkge1xyXG4gICAgICAgIHJldHVybiB2YWx1ZSA9PT0gbnVsbCA/IC1JbmZpbml0eSA6IHZhbHVlO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogV3JpdGUgY29tcG9uZW50IGRhdGEgdG8gVHlwZWRBcnJheXMgKGZvciBudW1lcmljIGNvbXBvbmVudHMpXHJcbiAgICAgKiBIYW5kbGVzIG51bWJlcnMsIGJvb2xlYW5zIChhcyAwLzEpLCBhbmQgZW51bSB2YWx1ZXMgKGFscmVhZHkgY29udmVydGVkIHRvIGluZGljZXMpXHJcbiAgICAgKi9cclxuICAgIF93cml0ZU51bWVyaWNDb21wb25lbnQoY29tcG9uZW50SWQsIGVudGl0eUlkLCBkYXRhLCBzY2hlbWEsIHByZWZpeCA9ICcnKSB7XHJcbiAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gc2NoZW1hKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGZpZWxkUGF0aCA9IHByZWZpeCA/IGAke3ByZWZpeH0uJHtrZXl9YCA6IGtleTtcclxuICAgICAgICAgICAgY29uc3Qgc2NoZW1hVmFsdWUgPSBzY2hlbWFba2V5XTtcclxuICAgICAgICAgICAgbGV0IGRhdGFWYWx1ZSA9IHByZWZpeFxyXG4gICAgICAgICAgICAgICAgPyB0aGlzLl9nZXROZXN0ZWRWYWx1ZShkYXRhLCBmaWVsZFBhdGgpXHJcbiAgICAgICAgICAgICAgICA6IGRhdGFba2V5XTtcclxuXHJcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygc2NoZW1hVmFsdWUgPT09ICdudW1iZXInIHx8IHR5cGVvZiBzY2hlbWFWYWx1ZSA9PT0gJ2Jvb2xlYW4nIHx8IHR5cGVvZiBzY2hlbWFWYWx1ZSA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgICAgIC8vIENvbnZlcnQgYm9vbGVhbnMgdG8gMC8xIGZvciBzdG9yYWdlXHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGRhdGFWYWx1ZSA9PT0gJ2Jvb2xlYW4nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YVZhbHVlID0gZGF0YVZhbHVlID8gMSA6IDA7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyBVc2UgZGVmYXVsdCBmcm9tIHNjaGVtYSBpZiBkYXRhIHZhbHVlIGlzIHVuZGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGFWYWx1ZSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YVZhbHVlID0gdHlwZW9mIHNjaGVtYVZhbHVlID09PSAnYm9vbGVhbicgPyAoc2NoZW1hVmFsdWUgPyAxIDogMCkgOiBzY2hlbWFWYWx1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuX3NldE51bWVyaWNGaWVsZChjb21wb25lbnRJZCwgZW50aXR5SWQsIGZpZWxkUGF0aCwgZGF0YVZhbHVlKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChzY2hlbWFWYWx1ZSA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgLy8gbnVsbCBzY2hlbWEgZmllbGRzOiB1c2UgbnVsbCBzZW50aW5lbCBhcyBkZWZhdWx0XHJcbiAgICAgICAgICAgICAgICBpZiAoZGF0YVZhbHVlID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhVmFsdWUgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5fc2V0TnVtZXJpY0ZpZWxkKGNvbXBvbmVudElkLCBlbnRpdHlJZCwgZmllbGRQYXRoLCB0aGlzLl90b1N0b3JhZ2VWYWx1ZShkYXRhVmFsdWUpKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChzY2hlbWFWYWx1ZSAmJiB0eXBlb2Ygc2NoZW1hVmFsdWUgPT09ICdvYmplY3QnICYmICFBcnJheS5pc0FycmF5KHNjaGVtYVZhbHVlKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fd3JpdGVOdW1lcmljQ29tcG9uZW50KGNvbXBvbmVudElkLCBlbnRpdHlJZCwgZGF0YSwgc2NoZW1hVmFsdWUsIGZpZWxkUGF0aCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZWFkIGNvbXBvbmVudCBkYXRhIGZyb20gVHlwZWRBcnJheXMgYW5kIHJldHVybiBhcyBwcm94eSBvYmplY3RcclxuICAgICAqIFByb3h5IHJlYWRzL3dyaXRlcyBkaXJlY3RseSBmcm9tIFR5cGVkQXJyYXlzIG9uIGV2ZXJ5IGFjY2VzcyAobm8gc3RhbGUgZGF0YSlcclxuICAgICAqIFByb3hpZXMgYXJlIGNhY2hlZCBwZXIgZW50aXR5K2NvbXBvbmVudCB0byBhdm9pZCBHQyBjaHVyblxyXG4gICAgICovXHJcbiAgICBfcmVhZE51bWVyaWNDb21wb25lbnQoY29tcG9uZW50SWQsIGVudGl0eUlkLCBzY2hlbWEsIHByZWZpeCA9ICcnKSB7XHJcbiAgICAgICAgLy8gRm9yIHRvcC1sZXZlbCBjYWxscyAobm8gcHJlZml4KSwgY2hlY2sgcHJveHkgY2FjaGUgZmlyc3RcclxuICAgICAgICBpZiAoIXByZWZpeCkge1xyXG4gICAgICAgICAgICBsZXQgY29tcG9uZW50Q2FjaGUgPSB0aGlzLl9wcm94eUNhY2hlLmdldChjb21wb25lbnRJZCk7XHJcbiAgICAgICAgICAgIGlmICghY29tcG9uZW50Q2FjaGUpIHtcclxuICAgICAgICAgICAgICAgIGNvbXBvbmVudENhY2hlID0gbmV3IE1hcCgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcHJveHlDYWNoZS5zZXQoY29tcG9uZW50SWQsIGNvbXBvbmVudENhY2hlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCBjYWNoZWQgPSBjb21wb25lbnRDYWNoZS5nZXQoZW50aXR5SWQpO1xyXG4gICAgICAgICAgICBpZiAoY2FjaGVkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY2FjaGVkO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIENyZWF0ZSBhbmQgY2FjaGUgdGhlIHByb3h5XHJcbiAgICAgICAgICAgIGNvbnN0IHByb3h5ID0gdGhpcy5fY3JlYXRlQ29tcG9uZW50UHJveHkoY29tcG9uZW50SWQsIGVudGl0eUlkLCBzY2hlbWEsICcnKTtcclxuICAgICAgICAgICAgY29tcG9uZW50Q2FjaGUuc2V0KGVudGl0eUlkLCBwcm94eSk7XHJcbiAgICAgICAgICAgIHJldHVybiBwcm94eTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gTmVzdGVkIG9iamVjdHMgKHdpdGggcHJlZml4KSBzdGlsbCBjcmVhdGUgcHJveGllcyBidXQgYXJlbid0IGNhY2hlZCBzZXBhcmF0ZWx5XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NyZWF0ZUNvbXBvbmVudFByb3h5KGNvbXBvbmVudElkLCBlbnRpdHlJZCwgc2NoZW1hLCBwcmVmaXgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlIGEgcHJveHkgdGhhdCByZWFkcy93cml0ZXMgZGlyZWN0bHkgZnJvbSBUeXBlZEFycmF5c1xyXG4gICAgICogRXZlcnkgcHJvcGVydHkgYWNjZXNzIGdvZXMgdGhyb3VnaCB0aGUgcHJveHkgdHJhcHMgZm9yIGxpdmUgZGF0YVxyXG4gICAgICovXHJcbiAgICBfY3JlYXRlQ29tcG9uZW50UHJveHkoY29tcG9uZW50SWQsIGVudGl0eUlkLCBzY2hlbWEsIHByZWZpeCkge1xyXG4gICAgICAgIGNvbnN0IGdhbWUgPSB0aGlzO1xyXG5cclxuICAgICAgICAvLyBCdWlsZCBzY2hlbWEgaW5mbyBmb3IgZmFzdCBsb29rdXBzXHJcbiAgICAgICAgY29uc3Qgc2NoZW1hSW5mbyA9IHt9O1xyXG4gICAgICAgIGZvciAoY29uc3Qga2V5IGluIHNjaGVtYSkge1xyXG4gICAgICAgICAgICBjb25zdCBzY2hlbWFWYWx1ZSA9IHNjaGVtYVtrZXldO1xyXG4gICAgICAgICAgICBzY2hlbWFJbmZvW2tleV0gPSB7XHJcbiAgICAgICAgICAgICAgICBmaWVsZFBhdGg6IHByZWZpeCA/IGAke3ByZWZpeH0uJHtrZXl9YCA6IGtleSxcclxuICAgICAgICAgICAgICAgIHR5cGU6IHNjaGVtYVZhbHVlID09PSBudWxsID8gJ251bGwnIDpcclxuICAgICAgICAgICAgICAgICAgICAgIHR5cGVvZiBzY2hlbWFWYWx1ZSA9PT0gJ2Jvb2xlYW4nID8gJ2Jvb2xlYW4nIDpcclxuICAgICAgICAgICAgICAgICAgICAgICh0eXBlb2Ygc2NoZW1hVmFsdWUgPT09ICdudW1iZXInIHx8IHR5cGVvZiBzY2hlbWFWYWx1ZSA9PT0gJ3N0cmluZycpID8gJ251bWJlcicgOlxyXG4gICAgICAgICAgICAgICAgICAgICAgKHNjaGVtYVZhbHVlICYmIHNjaGVtYVZhbHVlLiRmaXhlZEFycmF5KSA/ICdmaXhlZEFycmF5JyA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAoc2NoZW1hVmFsdWUgJiYgc2NoZW1hVmFsdWUuJGJpdG1hc2spID8gJ2JpdG1hc2snIDpcclxuICAgICAgICAgICAgICAgICAgICAgIChzY2hlbWFWYWx1ZSAmJiBzY2hlbWFWYWx1ZS4kZW51bSkgPyAnZW51bScgOlxyXG4gICAgICAgICAgICAgICAgICAgICAgKHNjaGVtYVZhbHVlICYmIHR5cGVvZiBzY2hlbWFWYWx1ZSA9PT0gJ29iamVjdCcpID8gJ25lc3RlZCcgOiAndW5rbm93bicsXHJcbiAgICAgICAgICAgICAgICBzY2hlbWFWYWx1ZVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gQ2FjaGUgZm9yIG5lc3RlZCBwcm94aWVzIChmaXhlZEFycmF5LCBiaXRtYXNrLCBuZXN0ZWQgb2JqZWN0cylcclxuICAgICAgICBjb25zdCBuZXN0ZWRDYWNoZSA9IHt9O1xyXG5cclxuICAgICAgICByZXR1cm4gbmV3IFByb3h5KHt9LCB7XHJcbiAgICAgICAgICAgIGdldCh0YXJnZXQsIHByb3ApIHtcclxuICAgICAgICAgICAgICAgIC8vIFN1cHBvcnQgSlNPTi5zdHJpbmdpZnlcclxuICAgICAgICAgICAgICAgIGlmIChwcm9wID09PSAndG9KU09OJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHt9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBzY2hlbWFJbmZvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpbmZvID0gc2NoZW1hSW5mb1trZXldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZm8udHlwZSA9PT0gJ251bWJlcicgfHwgaW5mby50eXBlID09PSAnZW51bScpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRba2V5XSA9IGdhbWUuX2dldE51bWVyaWNGaWVsZChjb21wb25lbnRJZCwgZW50aXR5SWQsIGluZm8uZmllbGRQYXRoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5mby50eXBlID09PSAnYm9vbGVhbicpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRba2V5XSA9IGdhbWUuX2dldE51bWVyaWNGaWVsZChjb21wb25lbnRJZCwgZW50aXR5SWQsIGluZm8uZmllbGRQYXRoKSAhPT0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5mby50eXBlID09PSAnbnVsbCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRba2V5XSA9IGdhbWUuX2dldE51bWVyaWNGaWVsZChjb21wb25lbnRJZCwgZW50aXR5SWQsIGluZm8uZmllbGRQYXRoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5mby50eXBlID09PSAnZml4ZWRBcnJheScgfHwgaW5mby50eXBlID09PSAnYml0bWFzaycgfHwgaW5mby50eXBlID09PSAnbmVzdGVkJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRyaWdnZXIgdGhlIGdldHRlciB0byBnZXQgdGhlIG5lc3RlZCBwcm94eSwgdGhlbiB0b0pTT04gaXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXN0ZWQgPSBuZXN0ZWRDYWNoZVtrZXldIHx8IGdhbWUuX2NyZWF0ZU5lc3RlZFByb3h5KGNvbXBvbmVudElkLCBlbnRpdHlJZCwga2V5LCBpbmZvLCBwcmVmaXgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFtrZXldID0gbmVzdGVkLnRvSlNPTiA/IG5lc3RlZC50b0pTT04oKSA6IG5lc3RlZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgaW5mbyA9IHNjaGVtYUluZm9bcHJvcF07XHJcbiAgICAgICAgICAgICAgICBpZiAoIWluZm8pIHJldHVybiB1bmRlZmluZWQ7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGluZm8udHlwZSA9PT0gJ251bWJlcicgfHwgaW5mby50eXBlID09PSAnZW51bScpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2FtZS5fZ2V0TnVtZXJpY0ZpZWxkKGNvbXBvbmVudElkLCBlbnRpdHlJZCwgaW5mby5maWVsZFBhdGgpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpbmZvLnR5cGUgPT09ICdib29sZWFuJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBnYW1lLl9nZXROdW1lcmljRmllbGQoY29tcG9uZW50SWQsIGVudGl0eUlkLCBpbmZvLmZpZWxkUGF0aCkgIT09IDA7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGluZm8udHlwZSA9PT0gJ251bGwnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdhbWUuX2dldE51bWVyaWNGaWVsZChjb21wb25lbnRJZCwgZW50aXR5SWQsIGluZm8uZmllbGRQYXRoKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5mby50eXBlID09PSAnZml4ZWRBcnJheScgfHwgaW5mby50eXBlID09PSAnYml0bWFzaycgfHwgaW5mby50eXBlID09PSAnbmVzdGVkJykge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIENhY2hlIG5lc3RlZCBwcm94aWVzIHRvIGF2b2lkIHJlY3JlYXRpb25cclxuICAgICAgICAgICAgICAgICAgICBpZiAoIW5lc3RlZENhY2hlW3Byb3BdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5lc3RlZENhY2hlW3Byb3BdID0gZ2FtZS5fY3JlYXRlTmVzdGVkUHJveHkoY29tcG9uZW50SWQsIGVudGl0eUlkLCBwcm9wLCBpbmZvLCBwcmVmaXgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmVzdGVkQ2FjaGVbcHJvcF07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBzZXQodGFyZ2V0LCBwcm9wLCB2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaW5mbyA9IHNjaGVtYUluZm9bcHJvcF07XHJcbiAgICAgICAgICAgICAgICBpZiAoIWluZm8pIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgICAgICBsZXQgc3RvcmVkVmFsdWUgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgIGlmIChpbmZvLnR5cGUgPT09ICdib29sZWFuJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0b3JlZFZhbHVlID0gdmFsdWUgPyAxIDogMDtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5mby50eXBlID09PSAnbnVsbCcpIHtcclxuICAgICAgICAgICAgICAgICAgICBzdG9yZWRWYWx1ZSA9IGdhbWUuX3RvU3RvcmFnZVZhbHVlKHZhbHVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoaW5mby50eXBlID09PSAnbnVtYmVyJyB8fCBpbmZvLnR5cGUgPT09ICdib29sZWFuJyB8fCBpbmZvLnR5cGUgPT09ICdudWxsJyB8fCBpbmZvLnR5cGUgPT09ICdlbnVtJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGdhbWUuX3NldE51bWVyaWNGaWVsZChjb21wb25lbnRJZCwgZW50aXR5SWQsIGluZm8uZmllbGRQYXRoLCBzdG9yZWRWYWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIG93bktleXMoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gT2JqZWN0LmtleXMoc2NoZW1hSW5mbyk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIHByb3ApIHtcclxuICAgICAgICAgICAgICAgIGlmIChwcm9wIGluIHNjaGVtYUluZm8pIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4geyBjb25maWd1cmFibGU6IHRydWUsIGVudW1lcmFibGU6IHRydWUgfTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZSBuZXN0ZWQgcHJveHkgZm9yIGZpeGVkQXJyYXksIGJpdG1hc2ssIG9yIG5lc3RlZCBvYmplY3RcclxuICAgICAqL1xyXG4gICAgX2NyZWF0ZU5lc3RlZFByb3h5KGNvbXBvbmVudElkLCBlbnRpdHlJZCwga2V5LCBpbmZvLCBwcmVmaXgpIHtcclxuICAgICAgICBpZiAoaW5mby50eXBlID09PSAnZml4ZWRBcnJheScpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NyZWF0ZUZpeGVkQXJyYXlQcm94eShjb21wb25lbnRJZCwgZW50aXR5SWQsIGtleSwgaW5mby5zY2hlbWFWYWx1ZS4kZml4ZWRBcnJheSwgcHJlZml4KTtcclxuICAgICAgICB9IGVsc2UgaWYgKGluZm8udHlwZSA9PT0gJ2JpdG1hc2snKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jcmVhdGVCaXRtYXNrUHJveHkoY29tcG9uZW50SWQsIGVudGl0eUlkLCBrZXksIGluZm8uc2NoZW1hVmFsdWUuJGJpdG1hc2ssIHByZWZpeCk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChpbmZvLnR5cGUgPT09ICduZXN0ZWQnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jcmVhdGVDb21wb25lbnRQcm94eShjb21wb25lbnRJZCwgZW50aXR5SWQsIGluZm8uc2NoZW1hVmFsdWUsIGluZm8uZmllbGRQYXRoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZSBhbiBhcnJheS1saWtlIHByb3h5IGZvciAkZml4ZWRBcnJheSBmaWVsZHNcclxuICAgICAqIEFsbG93cyBhcnJheVtpbmRleF0gYWNjZXNzIHRoYXQgbWFwcyB0byBpbmRpdmlkdWFsIFR5cGVkQXJyYXkgZmllbGRzXHJcbiAgICAgKi9cclxuICAgIF9jcmVhdGVGaXhlZEFycmF5UHJveHkoY29tcG9uZW50SWQsIGVudGl0eUlkLCBiYXNlTmFtZSwgY29uZmlnLCBwcmVmaXggPSAnJykge1xyXG4gICAgICAgIGNvbnN0IGdhbWUgPSB0aGlzO1xyXG4gICAgICAgIC8vIFN1cHBvcnQgYm90aCBzdGF0aWMgc2l6ZSBhbmQgZHluYW1pYyBzaXplRnJvbSAoZW51bS1iYXNlZClcclxuICAgICAgICBsZXQgc2l6ZSA9IGNvbmZpZy5zaXplIHx8IDA7XHJcbiAgICAgICAgaWYgKGNvbmZpZy5zaXplRnJvbSkge1xyXG4gICAgICAgICAgICBjb25zdCBlbnVtTWFwID0gdGhpcy5jb21wb25lbnRHZW5lcmF0b3IuZ2V0RW51bU1hcChjb25maWcuc2l6ZUZyb20pO1xyXG4gICAgICAgICAgICBzaXplID0gZW51bU1hcD8udG9WYWx1ZT8ubGVuZ3RoIHx8IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGZpZWxkcyA9IGNvbmZpZy5maWVsZHM7XHJcbiAgICAgICAgY29uc3QgZmllbGRQcmVmaXggPSBwcmVmaXggPyBgJHtwcmVmaXh9LiR7YmFzZU5hbWV9YCA6IGJhc2VOYW1lO1xyXG5cclxuICAgICAgICBpZiAoZmllbGRzICYmIEFycmF5LmlzQXJyYXkoZmllbGRzKSkge1xyXG4gICAgICAgICAgICAvLyBNdWx0aS1maWVsZCBhcnJheTogZWFjaCBlbGVtZW50IGlzIGFuIG9iamVjdCB3aXRoIHRoZSBzcGVjaWZpZWQgZmllbGRzXHJcbiAgICAgICAgICAgIC8vIEZpZWxkcyBzdG9yZWQgYXM6IGJhc2VOYW1lX2ZpZWxkMCwgYmFzZU5hbWVfZmllbGQxLCBldGMuXHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJveHkoe30sIHtcclxuICAgICAgICAgICAgICAgIGdldCh0YXJnZXQsIHByb3ApIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocHJvcCA9PT0gJ2xlbmd0aCcpIHJldHVybiBzaXplO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFN1cHBvcnQgSlNPTi5zdHJpbmdpZnkgdmlhIHRvSlNPTlxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChwcm9wID09PSAndG9KU09OJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYXJyID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNpemU7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQgPSB7fTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGZpZWxkIG9mIGZpZWxkcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50W2ZpZWxkXSA9IGdhbWUuX2dldE51bWVyaWNGaWVsZChjb21wb25lbnRJZCwgZW50aXR5SWQsIGAke2ZpZWxkUHJlZml4fV8ke2ZpZWxkfSR7aX1gKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJyW2ldID0gZWxlbWVudDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhcnI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gcGFyc2VJbnQocHJvcCwgMTApO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghaXNOYU4oaW5kZXgpICYmIGluZGV4ID49IDAgJiYgaW5kZXggPCBzaXplKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJldHVybiBvYmplY3Qgd2l0aCBhbGwgZmllbGRzIGZvciB0aGlzIGluZGV4XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQgPSB7fTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBmaWVsZCBvZiBmaWVsZHMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnRbZmllbGRdID0gZ2FtZS5fZ2V0TnVtZXJpY0ZpZWxkKGNvbXBvbmVudElkLCBlbnRpdHlJZCwgYCR7ZmllbGRQcmVmaXh9XyR7ZmllbGR9JHtpbmRleH1gKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZXR1cm4gcHJveHkgZm9yIGZpZWxkIHdyaXRlc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFByb3h5KGVsZW1lbnQsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldCh0LCBmLCB2KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdFtmXSA9IHY7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZS5fc2V0TnVtZXJpY0ZpZWxkKGNvbXBvbmVudElkLCBlbnRpdHlJZCwgYCR7ZmllbGRQcmVmaXh9XyR7Zn0ke2luZGV4fWAsIGdhbWUuX3RvU3RvcmFnZVZhbHVlKHYpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgc2V0KHRhcmdldCwgcHJvcCwgdmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpbmRleCA9IHBhcnNlSW50KHByb3AsIDEwKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWlzTmFOKGluZGV4KSAmJiBpbmRleCA+PSAwICYmIGluZGV4IDwgc2l6ZSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZmllbGQgb2YgZmllbGRzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWVbZmllbGRdICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lLl9zZXROdW1lcmljRmllbGQoY29tcG9uZW50SWQsIGVudGl0eUlkLCBgJHtmaWVsZFByZWZpeH1fJHtmaWVsZH0ke2luZGV4fWAsIGdhbWUuX3RvU3RvcmFnZVZhbHVlKHZhbHVlW2ZpZWxkXSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgb3duS2V5cyh0YXJnZXQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBrZXlzID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaXplOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAga2V5cy5wdXNoKFN0cmluZyhpKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBrZXlzO1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIHByb3ApIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpbmRleCA9IHBhcnNlSW50KHByb3AsIDEwKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWlzTmFOKGluZGV4KSAmJiBpbmRleCA+PSAwICYmIGluZGV4IDwgc2l6ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlbGVtZW50ID0ge307XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZmllbGQgb2YgZmllbGRzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50W2ZpZWxkXSA9IGdhbWUuX2dldE51bWVyaWNGaWVsZChjb21wb25lbnRJZCwgZW50aXR5SWQsIGAke2ZpZWxkUHJlZml4fV8ke2ZpZWxkfSR7aW5kZXh9YCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBlbGVtZW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIFNpbXBsZSBhcnJheTogYmFzZU5hbWUwLCBiYXNlTmFtZTEsIGV0Yy5cclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm94eSh7fSwge1xyXG4gICAgICAgICAgICAgICAgZ2V0KHRhcmdldCwgcHJvcCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChwcm9wID09PSAnbGVuZ3RoJykgcmV0dXJuIHNpemU7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gU3VwcG9ydCBKU09OLnN0cmluZ2lmeSB2aWEgdG9KU09OXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByb3AgPT09ICd0b0pTT04nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhcnIgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2l6ZTsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJyW2ldID0gZ2FtZS5fZ2V0TnVtZXJpY0ZpZWxkKGNvbXBvbmVudElkLCBlbnRpdHlJZCwgYCR7ZmllbGRQcmVmaXh9JHtpfWApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFycjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaW5kZXggPSBwYXJzZUludChwcm9wLCAxMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpc05hTihpbmRleCkgJiYgaW5kZXggPj0gMCAmJiBpbmRleCA8IHNpemUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdhbWUuX2dldE51bWVyaWNGaWVsZChjb21wb25lbnRJZCwgZW50aXR5SWQsIGAke2ZpZWxkUHJlZml4fSR7aW5kZXh9YCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgc2V0KHRhcmdldCwgcHJvcCwgdmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpbmRleCA9IHBhcnNlSW50KHByb3AsIDEwKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWlzTmFOKGluZGV4KSAmJiBpbmRleCA+PSAwICYmIGluZGV4IDwgc2l6ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBnYW1lLl9zZXROdW1lcmljRmllbGQoY29tcG9uZW50SWQsIGVudGl0eUlkLCBgJHtmaWVsZFByZWZpeH0ke2luZGV4fWAsIGdhbWUuX3RvU3RvcmFnZVZhbHVlKHZhbHVlKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgb3duS2V5cyh0YXJnZXQpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBSZXR1cm4gbnVtZXJpYyBpbmRpY2VzIGFzIHN0cmluZ3MgZm9yIEpTT04uc3RyaW5naWZ5IGVudW1lcmF0aW9uXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qga2V5cyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2l6ZTsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleXMucHVzaChTdHJpbmcoaSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ga2V5cztcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBwcm9wKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaW5kZXggPSBwYXJzZUludChwcm9wLCAxMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpc05hTihpbmRleCkgJiYgaW5kZXggPj0gMCAmJiBpbmRleCA8IHNpemUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBnYW1lLl9nZXROdW1lcmljRmllbGQoY29tcG9uZW50SWQsIGVudGl0eUlkLCBgJHtmaWVsZFByZWZpeH0ke2luZGV4fWApLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZSBhIHByb3h5IGZvciAkYml0bWFzayBmaWVsZHNcclxuICAgICAqIEJpdG1hc2sgaXMgc3RvcmVkIGFzIGluZGl2aWR1YWwgMzItYml0IGZpZWxkcyAoYmFzZU5hbWUwLCBiYXNlTmFtZTEsIGV0Yy4pXHJcbiAgICAgKiBSZXR1cm5zIGEgbnVtYmVyIHJlcHJlc2VudGluZyB0aGUgY29tYmluZWQgYml0bWFzayB2YWx1ZVxyXG4gICAgICovXHJcbiAgICBfY3JlYXRlQml0bWFza1Byb3h5KGNvbXBvbmVudElkLCBlbnRpdHlJZCwgYmFzZU5hbWUsIGNvbmZpZywgcHJlZml4ID0gJycpIHtcclxuICAgICAgICBjb25zdCBnYW1lID0gdGhpcztcclxuICAgICAgICBsZXQgYml0Q291bnQ7XHJcblxyXG4gICAgICAgIGlmIChjb25maWcuc2l6ZUZyb20pIHtcclxuICAgICAgICAgICAgY29uc3QgZW51bU1hcCA9IHRoaXMuY29tcG9uZW50R2VuZXJhdG9yLmdldEVudW1NYXAoY29uZmlnLnNpemVGcm9tKTtcclxuICAgICAgICAgICAgYml0Q291bnQgPSBlbnVtTWFwPy50b1ZhbHVlPy5sZW5ndGggfHwgMzI7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgYml0Q291bnQgPSBjb25maWcuc2l6ZSB8fCAzMjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGZpZWxkQ291bnQgPSBNYXRoLmNlaWwoYml0Q291bnQgLyAzMik7XHJcbiAgICAgICAgY29uc3QgZmllbGRQcmVmaXggPSBwcmVmaXggPyBgJHtwcmVmaXh9LiR7YmFzZU5hbWV9YCA6IGJhc2VOYW1lO1xyXG5cclxuICAgICAgICAvLyBGb3Igc2ltcGxpY2l0eSwgcmV0dXJuIGEgc2ltcGxlIHZhbHVlIGZvciBzaW5nbGUtZmllbGQgYml0bWFza3NcclxuICAgICAgICAvLyBhbmQgYW4gYXJyYXktbGlrZSBwcm94eSBmb3IgbXVsdGktZmllbGQgYml0bWFza3NcclxuICAgICAgICBpZiAoZmllbGRDb3VudCA9PT0gMSkge1xyXG4gICAgICAgICAgICAvLyBTaW5nbGUgMzItYml0IGZpZWxkIC0ganVzdCByZXR1cm4gdGhlIHZhbHVlIHdpdGggYSB0b0pTT05cclxuICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBnYW1lLl9nZXROdW1lcmljRmllbGQoY29tcG9uZW50SWQsIGVudGl0eUlkLCBgJHtmaWVsZFByZWZpeH0wYCkgfHwgMDtcclxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gTXVsdGktZmllbGQgYml0bWFzayAtIHJldHVybiBhcnJheS1saWtlIHByb3h5XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm94eSh7fSwge1xyXG4gICAgICAgICAgICBnZXQodGFyZ2V0LCBwcm9wKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocHJvcCA9PT0gJ2xlbmd0aCcpIHJldHVybiBmaWVsZENvdW50O1xyXG4gICAgICAgICAgICAgICAgaWYgKHByb3AgPT09ICd0b0pTT04nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYXJyID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZmllbGRDb3VudDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcnJbaV0gPSBnYW1lLl9nZXROdW1lcmljRmllbGQoY29tcG9uZW50SWQsIGVudGl0eUlkLCBgJHtmaWVsZFByZWZpeH0ke2l9YCkgfHwgMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXJyO1xyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpbmRleCA9IHBhcnNlSW50KHByb3AsIDEwKTtcclxuICAgICAgICAgICAgICAgIGlmICghaXNOYU4oaW5kZXgpICYmIGluZGV4ID49IDAgJiYgaW5kZXggPCBmaWVsZENvdW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdhbWUuX2dldE51bWVyaWNGaWVsZChjb21wb25lbnRJZCwgZW50aXR5SWQsIGAke2ZpZWxkUHJlZml4fSR7aW5kZXh9YCkgfHwgMDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHNldCh0YXJnZXQsIHByb3AsIHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpbmRleCA9IHBhcnNlSW50KHByb3AsIDEwKTtcclxuICAgICAgICAgICAgICAgIGlmICghaXNOYU4oaW5kZXgpICYmIGluZGV4ID49IDAgJiYgaW5kZXggPCBmaWVsZENvdW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZ2FtZS5fc2V0TnVtZXJpY0ZpZWxkKGNvbXBvbmVudElkLCBlbnRpdHlJZCwgYCR7ZmllbGRQcmVmaXh9JHtpbmRleH1gLCBnYW1lLl90b1N0b3JhZ2VWYWx1ZSh2YWx1ZSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBvd25LZXlzKHRhcmdldCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qga2V5cyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBmaWVsZENvdW50OyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBrZXlzLnB1c2goU3RyaW5nKGkpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBrZXlzO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBwcm9wKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpbmRleCA9IHBhcnNlSW50KHByb3AsIDEwKTtcclxuICAgICAgICAgICAgICAgIGlmICghaXNOYU4oaW5kZXgpICYmIGluZGV4ID49IDAgJiYgaW5kZXggPCBmaWVsZENvdW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGdhbWUuX2dldE51bWVyaWNGaWVsZChjb21wb25lbnRJZCwgZW50aXR5SWQsIGAke2ZpZWxkUHJlZml4fSR7aW5kZXh9YCkgfHwgMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXQgYSBuZXN0ZWQgdmFsdWUgZnJvbSBhbiBvYmplY3QgdXNpbmcgZG90IG5vdGF0aW9uIHBhdGhcclxuICAgICAqL1xyXG4gICAgX2dldE5lc3RlZFZhbHVlKG9iaiwgcGF0aCkge1xyXG4gICAgICAgIGNvbnN0IHBhcnRzID0gcGF0aC5zcGxpdCgnLicpO1xyXG4gICAgICAgIGxldCBjdXJyZW50ID0gb2JqO1xyXG4gICAgICAgIGZvciAoY29uc3QgcGFydCBvZiBwYXJ0cykge1xyXG4gICAgICAgICAgICBpZiAoY3VycmVudCA9PT0gdW5kZWZpbmVkIHx8IGN1cnJlbnQgPT09IG51bGwpIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIGN1cnJlbnQgPSBjdXJyZW50W3BhcnRdO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gY3VycmVudDtcclxuICAgIH1cclxuXHJcbiAgICAvLyBTZXJ2aWNlIHJlZ2lzdHJ5IG1ldGhvZHMgKGRlbGVnYXRlZCB0byBHYW1lU2VydmljZXMpXHJcbiAgICByZWdpc3RlcihrZXksIG1ldGhvZCkge1xyXG4gICAgICAgIHRoaXMuX3NlcnZpY2VzLnJlZ2lzdGVyKGtleSwgbWV0aG9kKTtcclxuICAgIH1cclxuXHJcbiAgICBoYXNTZXJ2aWNlKGtleSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9zZXJ2aWNlcy5oYXMoa2V5KTtcclxuICAgIH1cclxuXHJcbiAgICBjYWxsKGtleSwgLi4uYXJncykge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMuX3NlcnZpY2VzLmNhbGwoa2V5LCAuLi5hcmdzKTtcclxuICAgICAgICBpZiAodGhpcy5jYWxsTG9nZ2VyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FsbExvZ2dlci5sb2coa2V5LCBhcmdzLCByZXN1bHQsIHRoaXMuc3RhdGUubm93KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH1cclxuXHJcbiAgICBsaXN0U2VydmljZXMoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NlcnZpY2VzLmxpc3RTZXJ2aWNlcygpO1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIGluaXQoaXNTZXJ2ZXIgPSBmYWxzZSwgY29uZmlnKSB7XHJcbiAgICAgICAgdGhpcy5pc1NlcnZlciA9IGlzU2VydmVyO1xyXG4gICAgICAgIGlmKCF0aGlzLmlzU2VydmVyKXtcclxuICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXJFdmVudCgnb25LZXlEb3duJywgZS5rZXkpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgYXdhaXQgdGhpcy5sb2FkR2FtZVNjcmlwdHMoY29uZmlnKTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBsb2FkR2FtZVNjcmlwdHMoY29uZmlnLCBvcHRpb25zID0ge30pIHtcclxuICAgICAgICB0aGlzLmNvbGxlY3Rpb25zID0gdGhpcy5nZXRDb2xsZWN0aW9ucygpO1xyXG4gICAgICAgIHRoaXMuZ2FtZUNvbmZpZyA9IGNvbmZpZyA/IGNvbmZpZyA6ICh0aGlzLmlzU2VydmVyID8gdGhpcy5jb2xsZWN0aW9ucy5jb25maWdzLnNlcnZlciA6IHRoaXMuY29sbGVjdGlvbnMuY29uZmlncy5nYW1lKTtcclxuXHJcbiAgICAgICAgLy8gSW5pdGlhbGl6ZSBTY2VuZU1hbmFnZXIgKGhhbmRsZXMgbGF6eSBzeXN0ZW0gaW5zdGFudGlhdGlvbilcclxuICAgICAgICB0aGlzLnNjZW5lTWFuYWdlciA9IG5ldyBHVVRTLlNjZW5lTWFuYWdlcih0aGlzKTtcclxuXHJcbiAgICAgICAgLy8gU3RvcmUgYXZhaWxhYmxlIHN5c3RlbSB0eXBlcyBmb3IgbGF6eSBpbnN0YW50aWF0aW9uXHJcbiAgICAgICAgdGhpcy5hdmFpbGFibGVTeXN0ZW1UeXBlcyA9IHRoaXMuZ2FtZUNvbmZpZy5zeXN0ZW1zIHx8IFtdO1xyXG4gICAgICAgIC8vIE1hcCB0byB0cmFjayBpbnN0YW50aWF0ZWQgc3lzdGVtcyBieSBuYW1lXHJcbiAgICAgICAgdGhpcy5zeXN0ZW1zQnlOYW1lID0gbmV3IE1hcCgpO1xyXG5cclxuICAgICAgICAvLyBMb2FkIGluaXRpYWwgc2NlbmUgaWYgY29uZmlndXJlZCAoc2tpcCBmb3IgZWRpdG9ycyB0aGF0IG1hbmFnZSBzY2VuZSBsb2FkaW5nIGV4cGxpY2l0bHkpXHJcbiAgICAgICAgaWYgKCFvcHRpb25zLnNraXBJbml0aWFsU2NlbmUpIHtcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5sb2FkSW5pdGlhbFNjZW5lKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogTG9hZCB0aGUgaW5pdGlhbCBzY2VuZSBmcm9tIGdhbWUgY29uZmlnXHJcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTx2b2lkPn1cclxuICAgICAqL1xyXG4gICAgYXN5bmMgbG9hZEluaXRpYWxTY2VuZSgpIHtcclxuICAgICAgICBjb25zdCBpbml0aWFsU2NlbmUgPSB0aGlzLmdhbWVDb25maWcuaW5pdGlhbFNjZW5lO1xyXG4gICAgICAgIGlmIChpbml0aWFsU2NlbmUgJiYgdGhpcy5zY2VuZU1hbmFnZXIpIHtcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5zY2VuZU1hbmFnZXIubG9hZFNjZW5lKGluaXRpYWxTY2VuZSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc29sZS53YXJuKCdbQmFzZUVDU0dhbWVdIE5vIGluaXRpYWxTY2VuZSBjb25maWd1cmVkIGluIGdhbWUgY29uZmlnJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogR2V0IG9yIGNyZWF0ZSBhIHN5c3RlbSBieSBuYW1lIChsYXp5IGluc3RhbnRpYXRpb24pXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gc3lzdGVtTmFtZSAtIFRoZSBzeXN0ZW0gY2xhc3MgbmFtZVxyXG4gICAgICogQHJldHVybnMge09iamVjdHxudWxsfSBUaGUgc3lzdGVtIGluc3RhbmNlIG9yIG51bGwgaWYgbm90IGF2YWlsYWJsZVxyXG4gICAgICovXHJcbiAgICBnZXRPckNyZWF0ZVN5c3RlbShzeXN0ZW1OYW1lKSB7XHJcbiAgICAgICAgLy8gQ2hlY2sgaWYgYWxyZWFkeSBpbnN0YW50aWF0ZWRcclxuICAgICAgICBpZiAodGhpcy5zeXN0ZW1zQnlOYW1lLmhhcyhzeXN0ZW1OYW1lKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zeXN0ZW1zQnlOYW1lLmdldChzeXN0ZW1OYW1lKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIENoZWNrIGlmIHRoaXMgc3lzdGVtIHR5cGUgaXMgYXZhaWxhYmxlIChza2lwIGNoZWNrIGlmIG5vIHdoaXRlbGlzdCBkZWZpbmVkKVxyXG4gICAgICAgIGlmICh0aGlzLmF2YWlsYWJsZVN5c3RlbVR5cGVzLmxlbmd0aCA+IDAgJiYgIXRoaXMuYXZhaWxhYmxlU3lzdGVtVHlwZXMuaW5jbHVkZXMoc3lzdGVtTmFtZSkpIHtcclxuICAgICAgICAgICAgY29uc29sZS53YXJuKGBbQmFzZUVDU0dhbWVdIFN5c3RlbSAnJHtzeXN0ZW1OYW1lfScgbm90IGluIGF2YWlsYWJsZSBzeXN0ZW1zIGxpc3RgKTtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBDaGVjayBpZiB0aGUgY2xhc3MgZXhpc3RzXHJcbiAgICAgICAgaWYgKCFHVVRTW3N5c3RlbU5hbWVdKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYFtCYXNlRUNTR2FtZV0gU3lzdGVtIGNsYXNzICcke3N5c3RlbU5hbWV9JyBub3QgZm91bmQgaW4gR1VUU2ApO1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIENyZWF0ZSB0aGUgc3lzdGVtXHJcbiAgICAgICAgY29uc3QgcGFyYW1zID0geyBjYW52YXM6IHRoaXMuY2FudmFzIH07XHJcbiAgICAgICAgY29uc3Qgc3lzdGVtSW5zdCA9IG5ldyBHVVRTW3N5c3RlbU5hbWVdKHRoaXMpO1xyXG4gICAgICAgIHN5c3RlbUluc3QuZW5hYmxlZCA9IGZhbHNlO1xyXG5cclxuICAgICAgICAvLyBBdXRvLXJlZ2lzdGVyIHNlcnZpY2VzIGZyb20gc3RhdGljIHNlcnZpY2VzIGFycmF5XHJcbiAgICAgICAgY29uc3QgU3lzdGVtQ2xhc3MgPSBHVVRTW3N5c3RlbU5hbWVdO1xyXG4gICAgICAgIGlmIChTeXN0ZW1DbGFzcy5zZXJ2aWNlcyAmJiBBcnJheS5pc0FycmF5KFN5c3RlbUNsYXNzLnNlcnZpY2VzKSkge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHNlcnZpY2VOYW1lIG9mIFN5c3RlbUNsYXNzLnNlcnZpY2VzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHN5c3RlbUluc3Rbc2VydmljZU5hbWVdID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWdpc3RlcihzZXJ2aWNlTmFtZSwgc3lzdGVtSW5zdFtzZXJ2aWNlTmFtZV0uYmluZChzeXN0ZW1JbnN0KSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihgW0Jhc2VFQ1NHYW1lXSBTZXJ2aWNlICcke3NlcnZpY2VOYW1lfScgbm90IGZvdW5kIG9uICR7c3lzdGVtTmFtZX1gKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHN5c3RlbUluc3QuaW5pdCkge1xyXG4gICAgICAgICAgICBzeXN0ZW1JbnN0LmluaXQocGFyYW1zKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEFkZCB0byB0cmFja2luZ1xyXG4gICAgICAgIHRoaXMuc3lzdGVtcy5wdXNoKHN5c3RlbUluc3QpO1xyXG4gICAgICAgIHRoaXMuc3lzdGVtc0J5TmFtZS5zZXQoc3lzdGVtTmFtZSwgc3lzdGVtSW5zdCk7XHJcblxyXG4gICAgICAgIHJldHVybiBzeXN0ZW1JbnN0O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ2hlY2sgaWYgYSBzeXN0ZW0gaXMgYXZhaWxhYmxlIChkZWZpbmVkIGluIGNvbmZpZylcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBzeXN0ZW1OYW1lIC0gVGhlIHN5c3RlbSBjbGFzcyBuYW1lXHJcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cclxuICAgICAqL1xyXG4gICAgaXNTeXN0ZW1BdmFpbGFibGUoc3lzdGVtTmFtZSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmF2YWlsYWJsZVN5c3RlbVR5cGVzLmluY2x1ZGVzKHN5c3RlbU5hbWUpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogU3dpdGNoIHRvIGEgZGlmZmVyZW50IHNjZW5lXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gc2NlbmVOYW1lIC0gTmFtZSBvZiB0aGUgc2NlbmUgdG8gbG9hZFxyXG4gICAgICogQHJldHVybnMge1Byb21pc2U8dm9pZD59XHJcbiAgICAgKi9cclxuICAgIGFzeW5jIHN3aXRjaFNjZW5lKHNjZW5lTmFtZSkge1xyXG4gICAgICAgIGlmICh0aGlzLnNjZW5lTWFuYWdlcikge1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnNjZW5lTWFuYWdlci5zd2l0Y2hTY2VuZShzY2VuZU5hbWUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBnZXRFbnRpdHlJZCgpIHtcclxuICAgICAgICAvLyBSZWN5Y2xlIGZyZWVkIGVudGl0eSBJRHMgZGV0ZXJtaW5pc3RpY2FsbHkgLSBhbHdheXMgdXNlIGxvd2VzdCBhdmFpbGFibGVcclxuICAgICAgICAvLyBUaGlzIGVuc3VyZXMgY2xpZW50IGFuZCBzZXJ2ZXIgZ2V0IHRoZSBzYW1lIElEIGV2ZW4gaWYgZGVzdHJ1Y3Rpb24gb3JkZXIgZGlmZmVyc1xyXG4gICAgICAgIGlmICh0aGlzLmZyZWVFbnRpdHlDb3VudCA+IDApIHtcclxuICAgICAgICAgICAgLy8gRmluZCB0aGUgbWluaW11bSBJRCBpbiB0aGUgZnJlZSBsaXN0IGZvciBkZXRlcm1pbmlzdGljIHNlbGVjdGlvblxyXG4gICAgICAgICAgICBsZXQgbWluSWR4ID0gMDtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCB0aGlzLmZyZWVFbnRpdHlDb3VudDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5mcmVlRW50aXR5SWRzW2ldIDwgdGhpcy5mcmVlRW50aXR5SWRzW21pbklkeF0pIHtcclxuICAgICAgICAgICAgICAgICAgICBtaW5JZHggPSBpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IGlkID0gdGhpcy5mcmVlRW50aXR5SWRzW21pbklkeF07XHJcbiAgICAgICAgICAgIC8vIFN3YXAgd2l0aCBsYXN0IGFuZCBkZWNyZW1lbnQgY291bnRcclxuICAgICAgICAgICAgdGhpcy5mcmVlRW50aXR5SWRzW21pbklkeF0gPSB0aGlzLmZyZWVFbnRpdHlJZHNbLS10aGlzLmZyZWVFbnRpdHlDb3VudF07XHJcbiAgICAgICAgICAgIHJldHVybiBpZDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMubmV4dEVudGl0eUlkID49IHRoaXMuTUFYX0VOVElUSUVTKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTWF4aW11bSBlbnRpdHkgbGltaXQgKCR7dGhpcy5NQVhfRU5USVRJRVN9KSByZWFjaGVkYCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLm5leHRFbnRpdHlJZCsrO1xyXG4gICAgfVxyXG5cclxuICAgIGdldENvbGxlY3Rpb25zKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmFwcC5nZXRDb2xsZWN0aW9ucygpO1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIHVwZGF0ZShkZWx0YVRpbWUpIHtcclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLnN0YXRlLmlzUGF1c2VkKSB7XHJcbiAgICAgICAgICAgIC8vIFN0YXJ0IHBlcmZvcm1hbmNlIGZyYW1lIHRyYWNraW5nXHJcbiAgICAgICAgICAgIGlmICh0aGlzLnBlcmZvcm1hbmNlTW9uaXRvcikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wZXJmb3JtYW5jZU1vbml0b3Iuc3RhcnRGcmFtZSgpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBVc2UgdGljayBjb3VudCBiYXNlZCB0aW1pbmcgdG8gYXZvaWQgZmxvYXRpbmctcG9pbnQgYWNjdW11bGF0aW9uIGVycm9yc1xyXG4gICAgICAgICAgICB0aGlzLnRpY2tDb3VudCsrO1xyXG4gICAgICAgICAgICAvLyBVc2UgRklYRURfREVMVEFfVElNRSBmb3IgZGV0ZXJtaW5pc3RpYyBzaW11bGF0aW9uIChpZ25vcmUgdmFyaWFibGUgZGVsdGFUaW1lKVxyXG4gICAgICAgICAgICAvLyBSb3VuZCB0byAyIGRlY2ltYWwgcGxhY2VzIHRvIGF2b2lkIGZsb2F0aW5nLXBvaW50IHByZWNpc2lvbiBpc3N1ZXNcclxuICAgICAgICAgICAgLy8gKGUuZy4sIDMgKiAwLjA1ID0gMC4xNTAwMDAwMDAwMDAwMDAwMiBpbiBKYXZhU2NyaXB0KVxyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRUaW1lID0gTWF0aC5yb3VuZCh0aGlzLnRpY2tDb3VudCAqIHRoaXMuRklYRURfREVMVEFfVElNRSAqIDEwMCkgLyAxMDA7XHJcblxyXG4gICAgICAgICAgICAvLyBPbmx5IHVwZGF0ZSBpZiBhIHJlYXNvbmFibGUgYW1vdW50IG9mIHRpbWUgaGFzIHBhc3NlZFxyXG4gICAgICAgICAgICAvLyBjb25zdCB0aW1lU2luY2VMYXN0VXBkYXRlID0gdGhpcy5jdXJyZW50VGltZSAtIHRoaXMubGFzdFRpbWU7XHJcblxyXG4gICAgICAgICAgICAvLyAvLyBTa2lwIHVwZGF0ZSBpZiBtb3JlIHRoYW4gMSBzZWNvbmQgaGFzIHBhc3NlZCAodGFiIHdhcyBpbmFjdGl2ZSlcclxuICAgICAgICAgICAgLy8gaWYgKHRpbWVTaW5jZUxhc3RVcGRhdGUgPiAxMDAwKSB7XHJcbiAgICAgICAgICAgIC8vICAgICB0aGlzLmxhc3RUaW1lID0gdGhpcy5jdXJyZW50VGltZTsgLy8gUmVzZXQgdGltZXIgd2l0aG91dCB1cGRhdGluZ1xyXG4gICAgICAgICAgICAvLyAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgIHRoaXMuc3RhdGUubm93ID0gdGhpcy5jdXJyZW50VGltZTtcclxuICAgICAgICAgICAgLy8gVXNlIGZpeGVkIGRlbHRhVGltZSBmb3IgZGV0ZXJtaW5pc3RpYyBzaW11bGF0aW9uXHJcbiAgICAgICAgICAgIHRoaXMuc3RhdGUuZGVsdGFUaW1lID0gdGhpcy5GSVhFRF9ERUxUQV9USU1FO1xyXG4gICAgICAgICAgICB0aGlzLmRlbHRhVGltZSA9IHRoaXMuRklYRURfREVMVEFfVElNRTtcclxuXHJcbiAgICAgICAgICAgIGZvciAoY29uc3Qgc3lzdGVtIG9mIHRoaXMuc3lzdGVtcykge1xyXG4gICAgICAgICAgICAgICAgLy8gU2tpcCBkaXNhYmxlZCBzeXN0ZW1zXHJcbiAgICAgICAgICAgICAgICBpZiAoIXN5c3RlbS5lbmFibGVkKSBjb250aW51ZTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBzeXN0ZW1OYW1lID0gc3lzdGVtLmNvbnN0cnVjdG9yLm5hbWU7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gU3RhcnQgdHJhY2tpbmcgdGhpcyBzeXN0ZW1cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnBlcmZvcm1hbmNlTW9uaXRvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGVyZm9ybWFuY2VNb25pdG9yLnN0YXJ0U3lzdGVtKHN5c3RlbU5hbWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmIChzeXN0ZW0udXBkYXRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgc3lzdGVtLnVwZGF0ZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIC8vIEVuZCB1cGRhdGUgdHJhY2tpbmdcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnBlcmZvcm1hbmNlTW9uaXRvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGVyZm9ybWFuY2VNb25pdG9yLmVuZFN5c3RlbVVwZGF0ZShzeXN0ZW1OYW1lKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZihzeXN0ZW0ucmVuZGVyICYmICF0aGlzLmlzU2VydmVyKXtcclxuICAgICAgICAgICAgICAgICAgICAvLyBTdGFydCByZW5kZXIgdHJhY2tpbmdcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5wZXJmb3JtYW5jZU1vbml0b3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wZXJmb3JtYW5jZU1vbml0b3Iuc3RhcnRTeXN0ZW1SZW5kZXIoc3lzdGVtTmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBzeXN0ZW0ucmVuZGVyKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIEVuZCByZW5kZXIgdHJhY2tpbmdcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5wZXJmb3JtYW5jZU1vbml0b3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wZXJmb3JtYW5jZU1vbml0b3IuZW5kU3lzdGVtUmVuZGVyKHN5c3RlbU5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5wZXJmb3JtYW5jZU1vbml0b3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBJZiBubyByZW5kZXIsIHN0aWxsIG5lZWQgdG8gZW5kIHRoZSBzeXN0ZW0gdHJhY2tpbmdcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBlcmZvcm1hbmNlTW9uaXRvci5zdGFydFN5c3RlbVJlbmRlcihzeXN0ZW1OYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBlcmZvcm1hbmNlTW9uaXRvci5lbmRTeXN0ZW1SZW5kZXIoc3lzdGVtTmFtZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIFVwZGF0ZSBwZXJmb3JtYW5jZSBvdmVybGF5XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnBlcmZvcm1hbmNlTW9uaXRvcikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wZXJmb3JtYW5jZU1vbml0b3IudXBkYXRlT3ZlcmxheSgpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLnBvc3RVcGRhdGUoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcG9zdFVwZGF0ZSgpIHtcclxuICAgICAgIC8vIHRoaXMuZGVzeW5jRGVidWdnZXI/LmRpc3BsYXlTeW5jKGZhbHNlKTsgXHJcbiAgICAgICBcclxuICAgICAgICB0aGlzLmxhc3RUaW1lID0gdGhpcy5jdXJyZW50VGltZTtcclxuICAgIFxyXG4gICAgICAgIHRoaXMuZW50aXRpZXNUb0FkZC5mb3JFYWNoKChlbnRpdHkpID0+IHRoaXMuYWRkRW50aXR5KGVudGl0eSkpOyAgICAgICAgXHJcbiAgICAgICAgdGhpcy5lbnRpdGllc1RvQWRkID0gW107XHJcbiAgICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgY3JlYXRlRW50aXR5KHNldElkKSB7XHJcbiAgICAgICAgY29uc3QgaWQgPSBzZXRJZCB8fCB0aGlzLmdldEVudGl0eUlkKCk7XHJcbiAgICAgICAgLy8gTG9nIGlmIG92ZXJ3cml0aW5nIGV4aXN0aW5nIGVudGl0eSAtIHRoaXMgaXMgYSBidWchXHJcbiAgICAgICAgaWYgKHRoaXMuZW50aXR5QWxpdmVbaWRdKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYFtCYXNlRUNTR2FtZV0gY3JlYXRlRW50aXR5IGNhbGxlZCBmb3IgZXhpc3RpbmcgZW50aXR5ICR7aWR9IWApO1xyXG4gICAgICAgICAgICBjb25zb2xlLnRyYWNlKCdjcmVhdGVFbnRpdHkgY2FsbGVkIGZyb206Jyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIE1hcmsgZW50aXR5IGFzIGFsaXZlXHJcbiAgICAgICAgdGhpcy5lbnRpdHlBbGl2ZVtpZF0gPSAxO1xyXG4gICAgICAgIC8vIENsZWFyIGNvbXBvbmVudCBiaXRtYXNrXHJcbiAgICAgICAgdGhpcy5lbnRpdHlDb21wb25lbnRNYXNrW2lkICogMl0gPSAwO1xyXG4gICAgICAgIHRoaXMuZW50aXR5Q29tcG9uZW50TWFza1tpZCAqIDIgKyAxXSA9IDA7XHJcbiAgICAgICAgdGhpcy5lbnRpdHlDb3VudCsrO1xyXG4gICAgICAgIC8vIFdoZW4gdXNpbmcgYSBzcGVjaWZpYyBJRCwgZW5zdXJlIG5leHRFbnRpdHlJZCBpcyBhbHdheXMgaGlnaGVyXHJcbiAgICAgICAgLy8gVGhpcyBpcyBjcml0aWNhbCBmb3IgZ2V0RW50aXRpZXNXaXRoKCkgd2hpY2ggaXRlcmF0ZXMgdXAgdG8gbmV4dEVudGl0eUlkXHJcbiAgICAgICAgaWYgKGlkID49IHRoaXMubmV4dEVudGl0eUlkKSB7XHJcbiAgICAgICAgICAgIHRoaXMubmV4dEVudGl0eUlkID0gaWQgKyAxO1xyXG4gICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBpZDtcclxuICAgIH1cclxuXHJcbiAgICBkZXN0cm95RW50aXR5KGVudGl0eUlkKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmVudGl0eUFsaXZlW2VudGl0eUlkXSkgcmV0dXJuO1xyXG5cclxuICAgICAgICAvLyBOb3RpZnkgc3lzdGVtc1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5zeXN0ZW1zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHN5c3RlbSA9IHRoaXMuc3lzdGVtc1tpXTtcclxuICAgICAgICAgICAgaWYgKHN5c3RlbS5lbnRpdHlEZXN0cm95ZWQpIHtcclxuICAgICAgICAgICAgICAgIHN5c3RlbS5lbnRpdHlEZXN0cm95ZWQoZW50aXR5SWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBDbGVhciBjb21wb25lbnQgZGF0YSBmcm9tIG9iamVjdCBzdG9yYWdlXHJcbiAgICAgICAgZm9yIChjb25zdCBbY29tcG9uZW50VHlwZSwgc3RvcmFnZV0gb2YgdGhpcy5fb2JqZWN0Q29tcG9uZW50cykge1xyXG4gICAgICAgICAgICBpZiAoc3RvcmFnZVtlbnRpdHlJZF0gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgc3RvcmFnZVtlbnRpdHlJZF0gPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIENsZWFyIGNhY2hlZCBwcm94aWVzIGZvciB0aGlzIGVudGl0eVxyXG4gICAgICAgIGZvciAoY29uc3QgWywgY29tcG9uZW50Q2FjaGVdIG9mIHRoaXMuX3Byb3h5Q2FjaGUpIHtcclxuICAgICAgICAgICAgY29tcG9uZW50Q2FjaGUuZGVsZXRlKGVudGl0eUlkKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIE5vdGU6IFR5cGVkQXJyYXkgbnVtZXJpYyBkYXRhIGRvZXNuJ3QgbmVlZCBjbGVhcmluZyAtXHJcbiAgICAgICAgLy8gdGhlIGJpdG1hc2sgZW5zdXJlcyBpdCB3b24ndCBiZSByZWFkXHJcblxyXG4gICAgICAgIC8vIE1hcmsgZW50aXR5IGFzIGRlYWQgYW5kIHJlY3ljbGUgSURcclxuICAgICAgICB0aGlzLmVudGl0eUFsaXZlW2VudGl0eUlkXSA9IDA7XHJcbiAgICAgICAgdGhpcy5lbnRpdHlDb21wb25lbnRNYXNrW2VudGl0eUlkICogMl0gPSAwO1xyXG4gICAgICAgIHRoaXMuZW50aXR5Q29tcG9uZW50TWFza1tlbnRpdHlJZCAqIDIgKyAxXSA9IDA7XHJcbiAgICAgICAgdGhpcy5mcmVlRW50aXR5SWRzW3RoaXMuZnJlZUVudGl0eUNvdW50KytdID0gZW50aXR5SWQ7XHJcbiAgICAgICAgdGhpcy5lbnRpdHlDb3VudC0tO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgYWRkQ29tcG9uZW50KGVudGl0eUlkLCBjb21wb25lbnRJZCwgZGF0YSkge1xyXG4gICAgICAgIGlmICghdGhpcy5lbnRpdHlBbGl2ZVtlbnRpdHlJZF0pIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBFbnRpdHkgJHtlbnRpdHlJZH0gZG9lcyBub3QgZXhpc3RgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGNvbXBvbmVudE1ldGhvZHMgPSB0aGlzLmNhbGwoJ2dldENvbXBvbmVudHMnKTtcclxuICAgICAgICBpZiAoIWNvbXBvbmVudE1ldGhvZHNbY29tcG9uZW50SWRdKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihgW0Jhc2VFQ1NHYW1lXSBObyBjb21wb25lbnQgZmFjdG9yeSBmb3IgJyR7Y29tcG9uZW50SWR9Jy4gQWRkIGl0IHRvIHRoZSBjb21wb25lbnRzIGNvbGxlY3Rpb24uYCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBVc2UgZmFjdG9yeSBmdW5jdGlvbiBpZiBhdmFpbGFibGUsIG90aGVyd2lzZSB1c2UgZGF0YSBkaXJlY3RseSBhcyBmYWxsYmFja1xyXG4gICAgICAgIGNvbnN0IGNvbXBvbmVudERhdGEgPSBjb21wb25lbnRNZXRob2RzW2NvbXBvbmVudElkXVxyXG4gICAgICAgICAgICA/IGNvbXBvbmVudE1ldGhvZHNbY29tcG9uZW50SWRdKGRhdGEpXHJcbiAgICAgICAgICAgIDogeyAuLi5kYXRhIH07XHJcblxyXG4gICAgICAgIC8vIEdldCBjb21wb25lbnQgdHlwZSBJRCBhbmQgc2V0IGJpdG1hc2tcclxuICAgICAgICBjb25zdCB0eXBlSWQgPSB0aGlzLl9nZXRDb21wb25lbnRUeXBlSWQoY29tcG9uZW50SWQpO1xyXG4gICAgICAgIHRoaXMuX3NldENvbXBvbmVudEJpdChlbnRpdHlJZCwgdHlwZUlkKTtcclxuXHJcbiAgICAgICAgLy8gU2V0IHVwIHN0b3JhZ2Ugb24gZmlyc3QgZW5jb3VudGVyIChhbmFseXplcyBzY2hlbWEgZm9yIG51bWVyaWMgb3B0aW1pemF0aW9uKVxyXG4gICAgICAgIGNvbnN0IHNjaGVtYSA9IHRoaXMuY2FsbCgnZ2V0Q29tcG9uZW50U2NoZW1hJywgY29tcG9uZW50SWQpO1xyXG4gICAgICAgIGNvbnN0IGVudW1NYXAgPSB0aGlzLmhhc1NlcnZpY2UoJ2dldEVudW1NYXAnKSA/IHRoaXMuY2FsbCgnZ2V0RW51bU1hcCcsIGNvbXBvbmVudElkKSA6IG51bGw7XHJcbiAgICAgICAgaWYgKHNjaGVtYSkge1xyXG4gICAgICAgICAgICB0aGlzLl9zZXR1cENvbXBvbmVudFN0b3JhZ2UoY29tcG9uZW50SWQsIHNjaGVtYSwgZW51bU1hcCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBDaGVjayBpZiB0aGlzIGlzIGEgbnVtZXJpYyBjb21wb25lbnQgKHVzZSBUeXBlZEFycmF5cykgb3Igb2JqZWN0IGNvbXBvbmVudFxyXG4gICAgICAgIGNvbnN0IGNvbXBvbmVudEluZm8gPSB0aGlzLl9udW1lcmljQ29tcG9uZW50SW5mby5nZXQoY29tcG9uZW50SWQpO1xyXG4gICAgICAgIGlmIChjb21wb25lbnRJbmZvICYmIGNvbXBvbmVudEluZm8uaXNOdW1lcmljICYmIHNjaGVtYSkge1xyXG4gICAgICAgICAgICAvLyBTdG9yZSBpbiBUeXBlZEFycmF5c1xyXG4gICAgICAgICAgICB0aGlzLl93cml0ZU51bWVyaWNDb21wb25lbnQoY29tcG9uZW50SWQsIGVudGl0eUlkLCBjb21wb25lbnREYXRhLCBzY2hlbWEpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIFN0b3JlIGluIG9iamVjdCBzdG9yYWdlIChpbmRleGVkIGJ5IGVudGl0eSBJRClcclxuICAgICAgICAgICAgY29uc3Qgc3RvcmFnZSA9IHRoaXMuX2dldE9iamVjdFN0b3JhZ2UoY29tcG9uZW50SWQpO1xyXG4gICAgICAgICAgICBzdG9yYWdlW2VudGl0eUlkXSA9IGNvbXBvbmVudERhdGE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIE9QVElNSVpBVElPTjogQWRkIG11bHRpcGxlIGNvbXBvbmVudHMgYXQgb25jZSB3aXRoIHNpbmdsZSBjYWNoZSBpbnZhbGlkYXRpb25cclxuICAgICAqIEBwYXJhbSB7Kn0gZW50aXR5SWQgLSBFbnRpdHkgSURcclxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBjb21wb25lbnRzRGF0YSAtIE9iamVjdCBtYXBwaW5nIGNvbXBvbmVudElkIC0+IGRhdGFcclxuICAgICAqL1xyXG4gICAgYWRkQ29tcG9uZW50cyhlbnRpdHlJZCwgY29tcG9uZW50c0RhdGEpIHtcclxuICAgICAgICBpZiAoIXRoaXMuZW50aXR5QWxpdmVbZW50aXR5SWRdKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRW50aXR5ICR7ZW50aXR5SWR9IGRvZXMgbm90IGV4aXN0YCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBjb21wb25lbnRNZXRob2RzID0gdGhpcy5jYWxsKCdnZXRDb21wb25lbnRzJyk7XHJcbiAgICAgICAgY29uc3QgaGFzRW51bVNlcnZpY2UgPSB0aGlzLmhhc1NlcnZpY2UoJ2dldEVudW1NYXAnKTtcclxuXHJcbiAgICAgICAgZm9yIChjb25zdCBbY29tcG9uZW50SWQsIGRhdGFdIG9mIE9iamVjdC5lbnRyaWVzKGNvbXBvbmVudHNEYXRhKSkge1xyXG4gICAgICAgICAgICAvLyBVc2UgZmFjdG9yeSBmdW5jdGlvbiBpZiBhdmFpbGFibGUsIG90aGVyd2lzZSB1c2UgZGF0YSBkaXJlY3RseVxyXG4gICAgICAgICAgICBjb25zdCBjb21wb25lbnREYXRhID0gY29tcG9uZW50TWV0aG9kc1tjb21wb25lbnRJZF1cclxuICAgICAgICAgICAgICAgID8gY29tcG9uZW50TWV0aG9kc1tjb21wb25lbnRJZF0oZGF0YSlcclxuICAgICAgICAgICAgICAgIDogeyAuLi5kYXRhIH07XHJcblxyXG4gICAgICAgICAgICAvLyBHZXQgY29tcG9uZW50IHR5cGUgSUQgYW5kIHNldCBiaXRtYXNrXHJcbiAgICAgICAgICAgIGNvbnN0IHR5cGVJZCA9IHRoaXMuX2dldENvbXBvbmVudFR5cGVJZChjb21wb25lbnRJZCk7XHJcbiAgICAgICAgICAgIHRoaXMuX3NldENvbXBvbmVudEJpdChlbnRpdHlJZCwgdHlwZUlkKTtcclxuXHJcbiAgICAgICAgICAgIC8vIFNldCB1cCBzdG9yYWdlIG9uIGZpcnN0IGVuY291bnRlciAoYW5hbHl6ZXMgc2NoZW1hIGZvciBudW1lcmljIG9wdGltaXphdGlvbilcclxuICAgICAgICAgICAgY29uc3Qgc2NoZW1hID0gdGhpcy5jYWxsKCdnZXRDb21wb25lbnRTY2hlbWEnLCBjb21wb25lbnRJZCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGVudW1NYXAgPSBoYXNFbnVtU2VydmljZSA/IHRoaXMuY2FsbCgnZ2V0RW51bU1hcCcsIGNvbXBvbmVudElkKSA6IG51bGw7XHJcbiAgICAgICAgICAgIGlmIChzY2hlbWEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3NldHVwQ29tcG9uZW50U3RvcmFnZShjb21wb25lbnRJZCwgc2NoZW1hLCBlbnVtTWFwKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gQ2hlY2sgaWYgdGhpcyBpcyBhIG51bWVyaWMgY29tcG9uZW50ICh1c2UgVHlwZWRBcnJheXMpIG9yIG9iamVjdCBjb21wb25lbnRcclxuICAgICAgICAgICAgY29uc3QgY29tcG9uZW50SW5mbyA9IHRoaXMuX251bWVyaWNDb21wb25lbnRJbmZvLmdldChjb21wb25lbnRJZCk7XHJcbiAgICAgICAgICAgIGlmIChjb21wb25lbnRJbmZvICYmIGNvbXBvbmVudEluZm8uaXNOdW1lcmljICYmIHNjaGVtYSkge1xyXG4gICAgICAgICAgICAgICAgLy8gU3RvcmUgaW4gVHlwZWRBcnJheXNcclxuICAgICAgICAgICAgICAgIHRoaXMuX3dyaXRlTnVtZXJpY0NvbXBvbmVudChjb21wb25lbnRJZCwgZW50aXR5SWQsIGNvbXBvbmVudERhdGEsIHNjaGVtYSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyBTdG9yZSBpbiBvYmplY3Qgc3RvcmFnZVxyXG4gICAgICAgICAgICAgICAgY29uc3Qgc3RvcmFnZSA9IHRoaXMuX2dldE9iamVjdFN0b3JhZ2UoY29tcG9uZW50SWQpO1xyXG4gICAgICAgICAgICAgICAgc3RvcmFnZVtlbnRpdHlJZF0gPSBjb21wb25lbnREYXRhO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBTaW5nbGUgY2FjaGUgaW52YWxpZGF0aW9uIGZvciBhbGwgY29tcG9uZW50c1xyXG4gICAgfVxyXG5cclxuICAgIHJlbW92ZUNvbXBvbmVudChlbnRpdHlJZCwgY29tcG9uZW50VHlwZSkge1xyXG4gICAgICAgIGlmICghdGhpcy5lbnRpdHlBbGl2ZVtlbnRpdHlJZF0pIHJldHVybiBudWxsO1xyXG5cclxuICAgICAgICBjb25zdCBjb21wb25lbnQgPSB0aGlzLmdldENvbXBvbmVudChlbnRpdHlJZCwgY29tcG9uZW50VHlwZSk7XHJcbiAgICAgICAgaWYgKGNvbXBvbmVudCA9PT0gdW5kZWZpbmVkKSByZXR1cm4gbnVsbDtcclxuXHJcbiAgICAgICAgLy8gQ2xlYXIgYml0bWFza1xyXG4gICAgICAgIGNvbnN0IHR5cGVJZCA9IHRoaXMuX2NvbXBvbmVudFR5cGVJZC5nZXQoY29tcG9uZW50VHlwZSk7XHJcbiAgICAgICAgaWYgKHR5cGVJZCAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2NsZWFyQ29tcG9uZW50Qml0KGVudGl0eUlkLCB0eXBlSWQpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gQ2xlYXIgb2JqZWN0IHN0b3JhZ2VcclxuICAgICAgICBjb25zdCBzdG9yYWdlID0gdGhpcy5fb2JqZWN0Q29tcG9uZW50cy5nZXQoY29tcG9uZW50VHlwZSk7XHJcbiAgICAgICAgaWYgKHN0b3JhZ2UpIHtcclxuICAgICAgICAgICAgc3RvcmFnZVtlbnRpdHlJZF0gPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBDbGVhciBjYWNoZWQgcHJveHkgZm9yIHRoaXMgZW50aXR5K2NvbXBvbmVudFxyXG4gICAgICAgIGNvbnN0IGNvbXBvbmVudENhY2hlID0gdGhpcy5fcHJveHlDYWNoZS5nZXQoY29tcG9uZW50VHlwZSk7XHJcbiAgICAgICAgaWYgKGNvbXBvbmVudENhY2hlKSB7XHJcbiAgICAgICAgICAgIGNvbXBvbmVudENhY2hlLmRlbGV0ZShlbnRpdHlJZCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gY29tcG9uZW50O1xyXG4gICAgfVxyXG5cclxuICAgIGdldENvbXBvbmVudChlbnRpdHlJZCwgY29tcG9uZW50VHlwZSkge1xyXG4gICAgICAgIC8vIEZhc3QgcGF0aDogY2hlY2sgYml0bWFzayBmaXJzdFxyXG4gICAgICAgIGNvbnN0IHR5cGVJZCA9IHRoaXMuX2NvbXBvbmVudFR5cGVJZC5nZXQoY29tcG9uZW50VHlwZSk7XHJcbiAgICAgICAgaWYgKHR5cGVJZCA9PT0gdW5kZWZpbmVkKSByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICAgIGlmICghdGhpcy5faGFzQ29tcG9uZW50Qml0KGVudGl0eUlkLCB0eXBlSWQpKSByZXR1cm4gdW5kZWZpbmVkO1xyXG5cclxuICAgICAgICAvLyBDaGVjayBpZiB0aGlzIGlzIGEgbnVtZXJpYyBjb21wb25lbnQgKHN0b3JlZCBpbiBUeXBlZEFycmF5cylcclxuICAgICAgICBjb25zdCBjb21wb25lbnRJbmZvID0gdGhpcy5fbnVtZXJpY0NvbXBvbmVudEluZm8uZ2V0KGNvbXBvbmVudFR5cGUpO1xyXG4gICAgICAgIGlmIChjb21wb25lbnRJbmZvICYmIGNvbXBvbmVudEluZm8uaXNOdW1lcmljICYmIGNvbXBvbmVudEluZm8uc2NoZW1hKSB7XHJcbiAgICAgICAgICAgIC8vIFVzZSBvcmlnaW5hbCBzY2hlbWEgdG8gcHJlc2VydmUgJGZpeGVkQXJyYXkgaW5mbyBmb3IgYXJyYXkgcHJveHkgY3JlYXRpb25cclxuICAgICAgICAgICAgY29uc3Qgc2NoZW1hID0gY29tcG9uZW50SW5mby5vcmlnaW5hbFNjaGVtYSB8fCBjb21wb25lbnRJbmZvLnNjaGVtYTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlYWROdW1lcmljQ29tcG9uZW50KGNvbXBvbmVudFR5cGUsIGVudGl0eUlkLCBzY2hlbWEpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gR2V0IGZyb20gb2JqZWN0IHN0b3JhZ2VcclxuICAgICAgICBjb25zdCBzdG9yYWdlID0gdGhpcy5fb2JqZWN0Q29tcG9uZW50cy5nZXQoY29tcG9uZW50VHlwZSk7XHJcbiAgICAgICAgcmV0dXJuIHN0b3JhZ2UgPyBzdG9yYWdlW2VudGl0eUlkXSA6IHVuZGVmaW5lZDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFNlcmlhbGl6ZSBhIGNvbXBvbmVudCBmb3IgbmV0d29yayBzeW5jXHJcbiAgICAgKiBVc2VzIGdldENvbXBvbmVudCAod2hpY2ggcmV0dXJucyBwcm94aWVzIHdpdGggdG9KU09OIHN1cHBvcnQpXHJcbiAgICAgKiBSZXR1cm5zIGEgcGxhaW4gb2JqZWN0IHN1aXRhYmxlIGZvciBKU09OIHNlcmlhbGl6YXRpb25cclxuICAgICAqL1xyXG4gICAgc2VyaWFsaXplQ29tcG9uZW50KGVudGl0eUlkLCBjb21wb25lbnRUeXBlKSB7XHJcbiAgICAgICAgY29uc3QgY29tcG9uZW50ID0gdGhpcy5nZXRDb21wb25lbnQoZW50aXR5SWQsIGNvbXBvbmVudFR5cGUpO1xyXG4gICAgICAgIGlmICghY29tcG9uZW50KSByZXR1cm4gbnVsbDtcclxuICAgICAgICAvLyBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KSBjb252ZXJ0cyBwcm94eSB0byBwbGFpbiBvYmplY3RcclxuICAgICAgICAvLyBUaGUgcHJveHkncyB0b0pTT04gbWV0aG9kcyBoYW5kbGUgJGZpeGVkQXJyYXkgc2VyaWFsaXphdGlvblxyXG4gICAgICAgIHJldHVybiBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGNvbXBvbmVudCkpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogR2V0IEVDUyBkYXRhIGZvciBuZXR3b3JrIHN5bmNcclxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gZnVsbFN5bmMgLSBJZiB0cnVlLCBzZW5kcyBmdWxsIHN0YXRlIGFuZCByZXNldHMgZGVsdGEgdHJhY2tpbmcuXHJcbiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSWYgZmFsc2UsIHNlbmRzIG9ubHkgY2hhbmdlcyBzaW5jZSBsYXN0IHN5bmMuXHJcbiAgICAgKiBSZXR1cm5zIHNwYXJzZSBmb3JtYXQgdG8gbWluaW1pemUgcGF5bG9hZCBzaXplXHJcbiAgICAgKiBGb3JtYXQ6IHtcclxuICAgICAqICAgZnVsbFN5bmM6IGJvb2xlYW4sICAvLyB0cnVlIGlmIHRoaXMgaXMgYSBmdWxsIHN0YXRlIHN5bmNcclxuICAgICAqICAgZW50aXR5QWxpdmU6IHsgZW50aXR5SWQ6IDEsIC4uLiB9LCAgLy8gc3BhcnNlOiBvbmx5IGFsaXZlIGVudGl0aWVzIChvciBjaGFuZ2VkKVxyXG4gICAgICogICBlbnRpdHlEZWFkOiBbZW50aXR5SWQsIC4uLl0sICAvLyBvbmx5IGluIGRlbHRhOiBlbnRpdGllcyB0aGF0IGRpZWQgc2luY2UgbGFzdCBzeW5jXHJcbiAgICAgKiAgIGVudGl0eUNvbXBvbmVudE1hc2s6IHsgZW50aXR5SWQ6IFtsb3csIGhpZ2hdLCAuLi4gfSwgIC8vIHNwYXJzZTogb25seSBlbnRpdGllcyB3aXRoIGNvbXBvbmVudHMgKG9yIGNoYW5nZWQpXHJcbiAgICAgKiAgIG51bWVyaWNBcnJheXM6IHsga2V5OiB7IGVudGl0eUlkOiB2YWx1ZSwgLi4uIH0gfSwgIC8vIHNwYXJzZTogb25seSBub24temVyby9ub24tbnVsbCB2YWx1ZXMgKG9yIGNoYW5nZWQpXHJcbiAgICAgKiAgIG9iamVjdENvbXBvbmVudHM6IHsgY29tcG9uZW50VHlwZTogeyBlbnRpdHlJZDogZGF0YSB9IH0sXHJcbiAgICAgKiAgIG5leHRFbnRpdHlJZDogbnVtYmVyXHJcbiAgICAgKiB9XHJcbiAgICAgKi9cclxuICAgIGdldEVDU0RhdGEoZnVsbFN5bmMgPSB0cnVlKSB7XHJcbiAgICAgICAgY29uc3QgbWF4RW50aXR5ID0gdGhpcy5uZXh0RW50aXR5SWQ7XHJcbiAgICAgICAgY29uc3QgbGFzdFN0YXRlID0gdGhpcy5fbGFzdFN5bmNlZFN0YXRlO1xyXG5cclxuICAgICAgICAvLyBJZiBmdWxsU3luYyBvciBubyBwcmV2aW91cyBzdGF0ZSwgc2VuZCBldmVyeXRoaW5nXHJcbiAgICAgICAgaWYgKGZ1bGxTeW5jIHx8ICFsYXN0U3RhdGUpIHtcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy5fZ2V0RnVsbEVDU0RhdGEobWF4RW50aXR5KTtcclxuICAgICAgICAgICAgcmVzdWx0LmZ1bGxTeW5jID0gdHJ1ZTtcclxuICAgICAgICAgICAgLy8gU3RvcmUgY3VycmVudCBzdGF0ZSBmb3IgZnV0dXJlIGRlbHRhIGNhbGN1bGF0aW9uc1xyXG4gICAgICAgICAgICB0aGlzLl9sYXN0U3luY2VkU3RhdGUgPSB0aGlzLl9jYXB0dXJlU3RhdGVTbmFwc2hvdChtYXhFbnRpdHkpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gRGVsdGEgc3luYyAtIG9ubHkgc2VuZCB3aGF0IGNoYW5nZWRcclxuICAgICAgICByZXR1cm4gdGhpcy5fZ2V0RGVsdGFFQ1NEYXRhKG1heEVudGl0eSwgbGFzdFN0YXRlKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEdldCBmdWxsIEVDUyBzdGF0ZSAoc3BhcnNlIGZvcm1hdClcclxuICAgICAqL1xyXG4gICAgX2dldEZ1bGxFQ1NEYXRhKG1heEVudGl0eSkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHtcclxuICAgICAgICAgICAgbmV4dEVudGl0eUlkOiB0aGlzLm5leHRFbnRpdHlJZCxcclxuICAgICAgICAgICAgZW50aXR5QWxpdmU6IHt9LFxyXG4gICAgICAgICAgICBlbnRpdHlDb21wb25lbnRNYXNrOiB7fSxcclxuICAgICAgICAgICAgbnVtZXJpY0FycmF5czoge30sXHJcbiAgICAgICAgICAgIG9iamVjdENvbXBvbmVudHM6IHt9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8gU3BhcnNlIGVudGl0eUFsaXZlIC0gb25seSBpbmNsdWRlIGFsaXZlIGVudGl0aWVzICh2YWx1ZSA9IDEpXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtYXhFbnRpdHk7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5lbnRpdHlBbGl2ZVtpXSA9PT0gMSkge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0LmVudGl0eUFsaXZlW2ldID0gMTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gU3BhcnNlIGVudGl0eUNvbXBvbmVudE1hc2sgLSBvbmx5IGluY2x1ZGUgZW50aXRpZXMgd2l0aCBjb21wb25lbnRzXHJcbiAgICAgICAgLy8gU3RvcmVkIGFzIFtsb3csIGhpZ2hdIHBhaXJzIGZvciB0aGUgdHdvIDMyLWJpdCBwYXJ0c1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbWF4RW50aXR5OyBpKyspIHtcclxuICAgICAgICAgICAgY29uc3QgbG93ID0gdGhpcy5lbnRpdHlDb21wb25lbnRNYXNrW2kgKiAyXTtcclxuICAgICAgICAgICAgY29uc3QgaGlnaCA9IHRoaXMuZW50aXR5Q29tcG9uZW50TWFza1tpICogMiArIDFdO1xyXG4gICAgICAgICAgICBpZiAobG93ICE9PSAwIHx8IGhpZ2ggIT09IDApIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdC5lbnRpdHlDb21wb25lbnRNYXNrW2ldID0gW2xvdywgaGlnaF07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEluY2x1ZGUgbnVtZXJpYyBhcnJheXMgaW4gc3BhcnNlIGZvcm1hdCAob25seSBub24temVybywgbm9uLW51bGwgdmFsdWVzKVxyXG4gICAgICAgIC8vIEFMU08gaW5jbHVkZSB6ZXJvcyB0aGF0IGNoYW5nZWQgRlJPTSBub24temVybyAodG8gZW5zdXJlIGNsaWVudHMgcmVzZXQgdGhlbSlcclxuICAgICAgICAvLyBTa2lwIGNsaWVudC1vbmx5IGNvbXBvbmVudHNcclxuICAgICAgICBjb25zdCBsYXN0U3RhdGUgPSB0aGlzLl9sYXN0U3luY2VkU3RhdGU7XHJcbiAgICAgICAgZm9yIChjb25zdCBba2V5LCBhcnJdIG9mIHRoaXMuX251bWVyaWNBcnJheXMpIHtcclxuICAgICAgICAgICAgLy8ga2V5IGZvcm1hdCBpcyBcImNvbXBvbmVudFR5cGUuZmllbGRQYXRoXCIgLSBleHRyYWN0IGNvbXBvbmVudCB0eXBlXHJcbiAgICAgICAgICAgIGNvbnN0IGNvbXBvbmVudFR5cGUgPSBrZXkuc3BsaXQoJy4nKVswXTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX2NsaWVudE9ubHlDb21wb25lbnRzLmhhcyhjb21wb25lbnRUeXBlKSkge1xyXG4gICAgICAgICAgICAgICAgY29udGludWU7ICAvLyBTa2lwIGNsaWVudC1vbmx5IGNvbXBvbmVudHNcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29uc3QgbGFzdEFyciA9IGxhc3RTdGF0ZT8ubnVtZXJpY0FycmF5cz8uZ2V0KGtleSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGxhc3RNYXhFbnRpdHkgPSBsYXN0U3RhdGU/Lm5leHRFbnRpdHlJZCB8fCAwO1xyXG4gICAgICAgICAgICBjb25zdCBzcGFyc2UgPSB7fTtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtYXhFbnRpdHk7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdmFsID0gYXJyW2ldO1xyXG4gICAgICAgICAgICAgICAgLy8gT25seSBjaGVjayBsYXN0QXJyIHdpdGhpbiBpdHMgYm91bmRzXHJcbiAgICAgICAgICAgICAgICBjb25zdCBsYXN0VmFsID0gKGxhc3RBcnIgJiYgaSA8IGxhc3RNYXhFbnRpdHkpID8gbGFzdEFycltpXSA6IDA7XHJcbiAgICAgICAgICAgICAgICAvLyBJbmNsdWRlIG5vbi16ZXJvIHZhbHVlc1xyXG4gICAgICAgICAgICAgICAgLy8gQWxzbyBpbmNsdWRlIHplcm9zIGlmIHRoZXkgd2VyZSBwcmV2aW91c2x5IG5vbi16ZXJvICh2YWx1ZSBjaGFuZ2VkIHRvIDApXHJcbiAgICAgICAgICAgICAgICBpZiAodmFsICE9PSAwIHx8IChsYXN0VmFsICE9PSAwICYmIHZhbCA9PT0gMCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBzcGFyc2VbaV0gPSB0aGlzLl90b1N5bmNWYWx1ZSh2YWwpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIE9ubHkgaW5jbHVkZSBpZiB0aGVyZSBhcmUgYW55IHZhbHVlc1xyXG4gICAgICAgICAgICBpZiAoT2JqZWN0LmtleXMoc3BhcnNlKS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQubnVtZXJpY0FycmF5c1trZXldID0gc3BhcnNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBJbmNsdWRlIG9iamVjdCBjb21wb25lbnRzIC0gc2tpcCBjbGllbnQtb25seVxyXG4gICAgICAgIGZvciAoY29uc3QgW2NvbXBvbmVudFR5cGUsIHN0b3JhZ2VdIG9mIHRoaXMuX29iamVjdENvbXBvbmVudHMpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX2NsaWVudE9ubHlDb21wb25lbnRzLmhhcyhjb21wb25lbnRUeXBlKSkge1xyXG4gICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNvbXBvbmVudERhdGEgPSB7fTtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtYXhFbnRpdHk7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHN0b3JhZ2VbaV0gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudERhdGFbaV0gPSBzdG9yYWdlW2ldO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChPYmplY3Qua2V5cyhjb21wb25lbnREYXRhKS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQub2JqZWN0Q29tcG9uZW50c1tjb21wb25lbnRUeXBlXSA9IGNvbXBvbmVudERhdGE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDYXB0dXJlIGEgc25hcHNob3Qgb2YgY3VycmVudCBzdGF0ZSBmb3IgZGVsdGEgY29tcGFyaXNvblxyXG4gICAgICovXHJcbiAgICBfY2FwdHVyZVN0YXRlU25hcHNob3QobWF4RW50aXR5KSB7XHJcbiAgICAgICAgY29uc3Qgc25hcHNob3QgPSB7XHJcbiAgICAgICAgICAgIG5leHRFbnRpdHlJZDogdGhpcy5uZXh0RW50aXR5SWQsXHJcbiAgICAgICAgICAgIGVudGl0eUFsaXZlOiBuZXcgVWludDhBcnJheShtYXhFbnRpdHkpLFxyXG4gICAgICAgICAgICBlbnRpdHlDb21wb25lbnRNYXNrOiBuZXcgVWludDMyQXJyYXkobWF4RW50aXR5ICogMiksXHJcbiAgICAgICAgICAgIG51bWVyaWNBcnJheXM6IG5ldyBNYXAoKSxcclxuICAgICAgICAgICAgb2JqZWN0Q29tcG9uZW50czogbmV3IE1hcCgpXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8gQ29weSBlbnRpdHlBbGl2ZVxyXG4gICAgICAgIHNuYXBzaG90LmVudGl0eUFsaXZlLnNldCh0aGlzLmVudGl0eUFsaXZlLnN1YmFycmF5KDAsIG1heEVudGl0eSkpO1xyXG5cclxuICAgICAgICAvLyBDb3B5IGVudGl0eUNvbXBvbmVudE1hc2tcclxuICAgICAgICBzbmFwc2hvdC5lbnRpdHlDb21wb25lbnRNYXNrLnNldCh0aGlzLmVudGl0eUNvbXBvbmVudE1hc2suc3ViYXJyYXkoMCwgbWF4RW50aXR5ICogMikpO1xyXG5cclxuICAgICAgICAvLyBDb3B5IG51bWVyaWMgYXJyYXlzXHJcbiAgICAgICAgZm9yIChjb25zdCBba2V5LCBhcnJdIG9mIHRoaXMuX251bWVyaWNBcnJheXMpIHtcclxuICAgICAgICAgICAgc25hcHNob3QubnVtZXJpY0FycmF5cy5zZXQoa2V5LCBuZXcgRmxvYXQzMkFycmF5KGFyci5zdWJhcnJheSgwLCBtYXhFbnRpdHkpKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBEZWVwIGNvcHkgb2JqZWN0IGNvbXBvbmVudHNcclxuICAgICAgICBmb3IgKGNvbnN0IFtjb21wb25lbnRUeXBlLCBzdG9yYWdlXSBvZiB0aGlzLl9vYmplY3RDb21wb25lbnRzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvcHkgPSBuZXcgQXJyYXkobWF4RW50aXR5KTtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtYXhFbnRpdHk7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHN0b3JhZ2VbaV0gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvcHlbaV0gPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHN0b3JhZ2VbaV0pKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzbmFwc2hvdC5vYmplY3RDb21wb25lbnRzLnNldChjb21wb25lbnRUeXBlLCBjb3B5KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBzbmFwc2hvdDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEdldCBkZWx0YSBFQ1MgZGF0YSAtIG9ubHkgY2hhbmdlcyBzaW5jZSBsYXN0IHN5bmNcclxuICAgICAqL1xyXG4gICAgX2dldERlbHRhRUNTRGF0YShtYXhFbnRpdHksIGxhc3RTdGF0ZSkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHtcclxuICAgICAgICAgICAgZnVsbFN5bmM6IGZhbHNlLFxyXG4gICAgICAgICAgICBuZXh0RW50aXR5SWQ6IHRoaXMubmV4dEVudGl0eUlkLFxyXG4gICAgICAgICAgICBlbnRpdHlBbGl2ZToge30sXHJcbiAgICAgICAgICAgIGVudGl0eURlYWQ6IFtdLFxyXG4gICAgICAgICAgICBlbnRpdHlDb21wb25lbnRNYXNrOiB7fSxcclxuICAgICAgICAgICAgbnVtZXJpY0FycmF5czoge30sXHJcbiAgICAgICAgICAgIG9iamVjdENvbXBvbmVudHM6IHt9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgY29uc3QgbGFzdE1heEVudGl0eSA9IGxhc3RTdGF0ZS5uZXh0RW50aXR5SWQ7XHJcblxyXG4gICAgICAgIC8vIENoZWNrIGVudGl0eUFsaXZlIGNoYW5nZXNcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1heEVudGl0eTsgaSsrKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnQgPSB0aGlzLmVudGl0eUFsaXZlW2ldO1xyXG4gICAgICAgICAgICBjb25zdCBwcmV2aW91cyA9IGkgPCBsYXN0TWF4RW50aXR5ID8gbGFzdFN0YXRlLmVudGl0eUFsaXZlW2ldIDogMDtcclxuXHJcbiAgICAgICAgICAgIGlmIChjdXJyZW50ICE9PSBwcmV2aW91cykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnQgPT09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHQuZW50aXR5QWxpdmVbaV0gPSAxOyAgLy8gRW50aXR5IGJlY2FtZSBhbGl2ZVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHQuZW50aXR5RGVhZC5wdXNoKGkpOyAgLy8gRW50aXR5IGRpZWRcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gQ2hlY2sgZW50aXR5Q29tcG9uZW50TWFzayBjaGFuZ2VzXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtYXhFbnRpdHk7IGkrKykge1xyXG4gICAgICAgICAgICBjb25zdCBsb3dDdXJyZW50ID0gdGhpcy5lbnRpdHlDb21wb25lbnRNYXNrW2kgKiAyXTtcclxuICAgICAgICAgICAgY29uc3QgaGlnaEN1cnJlbnQgPSB0aGlzLmVudGl0eUNvbXBvbmVudE1hc2tbaSAqIDIgKyAxXTtcclxuICAgICAgICAgICAgY29uc3QgbG93UHJldiA9IGkgPCBsYXN0TWF4RW50aXR5ID8gbGFzdFN0YXRlLmVudGl0eUNvbXBvbmVudE1hc2tbaSAqIDJdIDogMDtcclxuICAgICAgICAgICAgY29uc3QgaGlnaFByZXYgPSBpIDwgbGFzdE1heEVudGl0eSA/IGxhc3RTdGF0ZS5lbnRpdHlDb21wb25lbnRNYXNrW2kgKiAyICsgMV0gOiAwO1xyXG5cclxuICAgICAgICAgICAgaWYgKGxvd0N1cnJlbnQgIT09IGxvd1ByZXYgfHwgaGlnaEN1cnJlbnQgIT09IGhpZ2hQcmV2KSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQuZW50aXR5Q29tcG9uZW50TWFza1tpXSA9IFtsb3dDdXJyZW50LCBoaWdoQ3VycmVudF07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIENoZWNrIG51bWVyaWMgYXJyYXkgY2hhbmdlcyAtIHNraXAgY2xpZW50LW9ubHkgY29tcG9uZW50c1xyXG4gICAgICAgIGZvciAoY29uc3QgW2tleSwgYXJyXSBvZiB0aGlzLl9udW1lcmljQXJyYXlzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbXBvbmVudFR5cGUgPSBrZXkuc3BsaXQoJy4nKVswXTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX2NsaWVudE9ubHlDb21wb25lbnRzLmhhcyhjb21wb25lbnRUeXBlKSkge1xyXG4gICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGxhc3RBcnIgPSBsYXN0U3RhdGUubnVtZXJpY0FycmF5cy5nZXQoa2V5KTtcclxuICAgICAgICAgICAgY29uc3Qgc3BhcnNlID0ge307XHJcblxyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1heEVudGl0eTsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50ID0gYXJyW2ldO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcHJldmlvdXMgPSAobGFzdEFyciAmJiBpIDwgbGFzdE1heEVudGl0eSkgPyBsYXN0QXJyW2ldIDogMDtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudCAhPT0gcHJldmlvdXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBJbmNsdWRlIHRoZSBuZXcgdmFsdWUgKGV2ZW4gaWYgMCBvciAtSW5maW5pdHksIHNpbmNlIGl0IGNoYW5nZWQpXHJcbiAgICAgICAgICAgICAgICAgICAgc3BhcnNlW2ldID0gdGhpcy5fdG9TeW5jVmFsdWUoY3VycmVudCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChPYmplY3Qua2V5cyhzcGFyc2UpLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdC5udW1lcmljQXJyYXlzW2tleV0gPSBzcGFyc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIENoZWNrIG9iamVjdCBjb21wb25lbnQgY2hhbmdlcyAtIHNraXAgY2xpZW50LW9ubHlcclxuICAgICAgICBmb3IgKGNvbnN0IFtjb21wb25lbnRUeXBlLCBzdG9yYWdlXSBvZiB0aGlzLl9vYmplY3RDb21wb25lbnRzKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9jbGllbnRPbmx5Q29tcG9uZW50cy5oYXMoY29tcG9uZW50VHlwZSkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCBsYXN0U3RvcmFnZSA9IGxhc3RTdGF0ZS5vYmplY3RDb21wb25lbnRzLmdldChjb21wb25lbnRUeXBlKTtcclxuICAgICAgICAgICAgY29uc3QgY29tcG9uZW50RGF0YSA9IHt9O1xyXG5cclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtYXhFbnRpdHk7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY3VycmVudCA9IHN0b3JhZ2VbaV07XHJcbiAgICAgICAgICAgICAgICBjb25zdCBwcmV2aW91cyA9IGxhc3RTdG9yYWdlID8gbGFzdFN0b3JhZ2VbaV0gOiB1bmRlZmluZWQ7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgY2hhbmdlZCAoc2ltcGxlIEpTT04gY29tcGFyaXNvbilcclxuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRTdHIgPSBjdXJyZW50ICE9PSB1bmRlZmluZWQgPyBKU09OLnN0cmluZ2lmeShjdXJyZW50KSA6IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHByZXZpb3VzU3RyID0gcHJldmlvdXMgIT09IHVuZGVmaW5lZCA/IEpTT04uc3RyaW5naWZ5KHByZXZpb3VzKSA6IHVuZGVmaW5lZDtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudFN0ciAhPT0gcHJldmlvdXNTdHIpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudCAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudERhdGFbaV0gPSBjdXJyZW50O1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1hcmsgYXMgcmVtb3ZlZCB3aXRoIG51bGxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50RGF0YVtpXSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoT2JqZWN0LmtleXMoY29tcG9uZW50RGF0YSkubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0Lm9iamVjdENvbXBvbmVudHNbY29tcG9uZW50VHlwZV0gPSBjb21wb25lbnREYXRhO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBSZW1vdmUgZW1wdHkgYXJyYXlzL29iamVjdHMgZnJvbSByZXN1bHRcclxuICAgICAgICBpZiAocmVzdWx0LmVudGl0eURlYWQubGVuZ3RoID09PSAwKSBkZWxldGUgcmVzdWx0LmVudGl0eURlYWQ7XHJcbiAgICAgICAgaWYgKE9iamVjdC5rZXlzKHJlc3VsdC5lbnRpdHlBbGl2ZSkubGVuZ3RoID09PSAwKSBkZWxldGUgcmVzdWx0LmVudGl0eUFsaXZlO1xyXG4gICAgICAgIGlmIChPYmplY3Qua2V5cyhyZXN1bHQuZW50aXR5Q29tcG9uZW50TWFzaykubGVuZ3RoID09PSAwKSBkZWxldGUgcmVzdWx0LmVudGl0eUNvbXBvbmVudE1hc2s7XHJcbiAgICAgICAgaWYgKE9iamVjdC5rZXlzKHJlc3VsdC5udW1lcmljQXJyYXlzKS5sZW5ndGggPT09IDApIGRlbGV0ZSByZXN1bHQubnVtZXJpY0FycmF5cztcclxuICAgICAgICBpZiAoT2JqZWN0LmtleXMocmVzdWx0Lm9iamVjdENvbXBvbmVudHMpLmxlbmd0aCA9PT0gMCkgZGVsZXRlIHJlc3VsdC5vYmplY3RDb21wb25lbnRzO1xyXG5cclxuICAgICAgICAvLyBVcGRhdGUgc25hcHNob3QgZm9yIG5leHQgZGVsdGFcclxuICAgICAgICB0aGlzLl9sYXN0U3luY2VkU3RhdGUgPSB0aGlzLl9jYXB0dXJlU3RhdGVTbmFwc2hvdChtYXhFbnRpdHkpO1xyXG5cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmVzZXQgZGVsdGEgdHJhY2tpbmcgLSBjYWxsIHRoaXMgd2hlbiB5b3Ugd2FudCB0aGUgbmV4dCBzeW5jIHRvIGJlIGEgZnVsbCBzeW5jXHJcbiAgICAgKi9cclxuICAgIHJlc2V0U3luY1N0YXRlKCkge1xyXG4gICAgICAgIHRoaXMuX2xhc3RTeW5jZWRTdGF0ZSA9IG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBBcHBseSBFQ1MgZGF0YSBmcm9tIHNlcnZlciAoaGFuZGxlcyBib3RoIGZ1bGwgc3luYyBhbmQgZGVsdGEgc3luYylcclxuICAgICAqL1xyXG4gICAgYXBwbHlFQ1NEYXRhKGRhdGEpIHtcclxuICAgICAgICAvLyBDaGVjayBpZiB0aGlzIGlzIGEgZnVsbCBzeW5jIG9yIGRlbHRhIHN5bmNcclxuICAgICAgICBpZiAoZGF0YS5mdWxsU3luYyAhPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgdGhpcy5fYXBwbHlGdWxsRUNTRGF0YShkYXRhKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9hcHBseURlbHRhRUNTRGF0YShkYXRhKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIENvbW1vbiBjbGVhbnVwIGZvciBib3RoIHN5bmMgdHlwZXNcclxuICAgICAgICB0aGlzLl9maW5hbGl6ZUVDU1N5bmMoZGF0YSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBBcHBseSBmdWxsIEVDUyBzeW5jIC0gcmVwbGFjZXMgYWxsIHN0YXRlXHJcbiAgICAgKi9cclxuICAgIF9hcHBseUZ1bGxFQ1NEYXRhKGRhdGEpIHtcclxuICAgICAgICBjb25zdCBtYXhFbnRpdHkgPSBkYXRhLm5leHRFbnRpdHlJZCB8fCB0aGlzLm5leHRFbnRpdHlJZDtcclxuXHJcbiAgICAgICAgLy8gQ2xlYXIgYW5kIGFwcGx5IGVudGl0eSBhbGl2ZSBmbGFncyBmcm9tIHNwYXJzZSBmb3JtYXRcclxuICAgICAgICB0aGlzLmVudGl0eUFsaXZlLmZpbGwoMCwgMCwgbWF4RW50aXR5KTtcclxuICAgICAgICBpZiAoZGF0YS5lbnRpdHlBbGl2ZSkge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGVudGl0eUlkU3RyIG9mIE9iamVjdC5rZXlzKGRhdGEuZW50aXR5QWxpdmUpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVudGl0eUFsaXZlW3BhcnNlSW50KGVudGl0eUlkU3RyLCAxMCldID0gMTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gQnVpbGQgYml0bWFzayBmb3IgY2xpZW50LW9ubHkgY29tcG9uZW50cyB0byBwcmVzZXJ2ZVxyXG4gICAgICAgIGxldCBjbGllbnRPbmx5TWFza0xvdyA9IDA7XHJcbiAgICAgICAgbGV0IGNsaWVudE9ubHlNYXNrSGlnaCA9IDA7XHJcbiAgICAgICAgZm9yIChjb25zdCBjb21wb25lbnRUeXBlIG9mIHRoaXMuX2NsaWVudE9ubHlDb21wb25lbnRzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHR5cGVJZCA9IHRoaXMuX2NvbXBvbmVudFR5cGVJZC5nZXQoY29tcG9uZW50VHlwZSk7XHJcbiAgICAgICAgICAgIGlmICh0eXBlSWQgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVJZCA8IDMyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2xpZW50T25seU1hc2tMb3cgfD0gKDEgPDwgdHlwZUlkKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2xpZW50T25seU1hc2tIaWdoIHw9ICgxIDw8ICh0eXBlSWQgLSAzMikpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBBcHBseSBjb21wb25lbnQgbWFza3MgZnJvbSBzcGFyc2UgZm9ybWF0LCBwcmVzZXJ2aW5nIGNsaWVudC1vbmx5IGNvbXBvbmVudCBiaXRzXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtYXhFbnRpdHk7IGkrKykge1xyXG4gICAgICAgICAgICAvLyBQcmVzZXJ2ZSBjbGllbnQtb25seSBiaXRzIGZyb20gY3VycmVudCBtYXNrXHJcbiAgICAgICAgICAgIGNvbnN0IHByZXNlcnZlZExvdyA9IHRoaXMuZW50aXR5Q29tcG9uZW50TWFza1tpICogMl0gJiBjbGllbnRPbmx5TWFza0xvdztcclxuICAgICAgICAgICAgY29uc3QgcHJlc2VydmVkSGlnaCA9IHRoaXMuZW50aXR5Q29tcG9uZW50TWFza1tpICogMiArIDFdICYgY2xpZW50T25seU1hc2tIaWdoO1xyXG4gICAgICAgICAgICAvLyBDbGVhciB0aGUgbWFza1xyXG4gICAgICAgICAgICB0aGlzLmVudGl0eUNvbXBvbmVudE1hc2tbaSAqIDJdID0gcHJlc2VydmVkTG93O1xyXG4gICAgICAgICAgICB0aGlzLmVudGl0eUNvbXBvbmVudE1hc2tbaSAqIDIgKyAxXSA9IHByZXNlcnZlZEhpZ2g7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChkYXRhLmVudGl0eUNvbXBvbmVudE1hc2spIHtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBbZW50aXR5SWRTdHIsIG1hc2tdIG9mIE9iamVjdC5lbnRyaWVzKGRhdGEuZW50aXR5Q29tcG9uZW50TWFzaykpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGVudGl0eUlkID0gcGFyc2VJbnQoZW50aXR5SWRTdHIsIDEwKTtcclxuICAgICAgICAgICAgICAgIC8vIE1lcmdlIHNlcnZlciBtYXNrIHdpdGggcHJlc2VydmVkIGNsaWVudC1vbmx5IGJpdHNcclxuICAgICAgICAgICAgICAgIHRoaXMuZW50aXR5Q29tcG9uZW50TWFza1tlbnRpdHlJZCAqIDJdIHw9IG1hc2tbMF07XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVudGl0eUNvbXBvbmVudE1hc2tbZW50aXR5SWQgKiAyICsgMV0gfD0gbWFza1sxXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gQXBwbHkgbnVtZXJpYyBhcnJheXMgLSBvbmx5IGNsZWFyL3JlcGxhY2UgYXJyYXlzIHRoYXQgc2VydmVyIHNlbmRzXHJcbiAgICAgICAgLy8gU2tpcCBjbGllbnQtb25seSBjb21wb25lbnRzIGV2ZW4gaWYgc2VydmVyIHNlbmRzIHRoZW0gKGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5KVxyXG4gICAgICAgIGZvciAoY29uc3QgW2tleSwgc3BhcnNlXSBvZiBPYmplY3QuZW50cmllcyhkYXRhLm51bWVyaWNBcnJheXMgfHwge30pKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbXBvbmVudFR5cGUgPSBrZXkuc3BsaXQoJy4nKVswXTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX2NsaWVudE9ubHlDb21wb25lbnRzLmhhcyhjb21wb25lbnRUeXBlKSkge1xyXG4gICAgICAgICAgICAgICAgY29udGludWU7ICAvLyBEb24ndCBhcHBseSBjbGllbnQtb25seSBjb21wb25lbnRzIGZyb20gc2VydmVyXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGxldCBhcnIgPSB0aGlzLl9udW1lcmljQXJyYXlzLmdldChrZXkpO1xyXG4gICAgICAgICAgICBpZiAoIWFycikge1xyXG4gICAgICAgICAgICAgICAgYXJyID0gbmV3IEZsb2F0MzJBcnJheSh0aGlzLk1BWF9FTlRJVElFUyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9udW1lcmljQXJyYXlzLnNldChrZXksIGFycik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gQ2xlYXIgdGhpcyBzcGVjaWZpYyBhcnJheSBiZWZvcmUgYXBwbHlpbmcgc2VydmVyIGRhdGFcclxuICAgICAgICAgICAgYXJyLmZpbGwoMCwgMCwgbWF4RW50aXR5KTtcclxuICAgICAgICAgICAgLy8gQXBwbHkgc2VydmVyIHZhbHVlc1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IFtlbnRpdHlJZFN0ciwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKHNwYXJzZSkpIHtcclxuICAgICAgICAgICAgICAgIGFycltwYXJzZUludChlbnRpdHlJZFN0ciwgMTApXSA9IHRoaXMuX2Zyb21TeW5jVmFsdWUodmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBBcHBseSBvYmplY3QgY29tcG9uZW50cyAtIG9ubHkgY2xlYXIvcmVwbGFjZSBjb21wb25lbnRzIHRoYXQgc2VydmVyIHNlbmRzXHJcbiAgICAgICAgLy8gU2tpcCBjbGllbnQtb25seSBjb21wb25lbnRzXHJcbiAgICAgICAgZm9yIChjb25zdCBbY29tcG9uZW50VHlwZSwgY29tcG9uZW50RGF0YV0gb2YgT2JqZWN0LmVudHJpZXMoZGF0YS5vYmplY3RDb21wb25lbnRzIHx8IHt9KSkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5fY2xpZW50T25seUNvbXBvbmVudHMuaGFzKGNvbXBvbmVudFR5cGUpKSB7XHJcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29uc3Qgc3RvcmFnZSA9IHRoaXMuX2dldE9iamVjdFN0b3JhZ2UoY29tcG9uZW50VHlwZSk7XHJcbiAgICAgICAgICAgIC8vIENsZWFyIHRoaXMgc3BlY2lmaWMgY29tcG9uZW50IHR5cGUgYmVmb3JlIGFwcGx5aW5nIHNlcnZlciBkYXRhXHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbWF4RW50aXR5OyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHN0b3JhZ2VbaV0gPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gQXBwbHkgc2VydmVyIHZhbHVlc1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IFtlbnRpdHlJZFN0ciwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKGNvbXBvbmVudERhdGEpKSB7XHJcbiAgICAgICAgICAgICAgICBzdG9yYWdlW3BhcnNlSW50KGVudGl0eUlkU3RyLCAxMCldID0gdmFsdWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBBcHBseSBkZWx0YSBFQ1Mgc3luYyAtIG9ubHkgYXBwbGllcyBjaGFuZ2VzXHJcbiAgICAgKi9cclxuICAgIF9hcHBseURlbHRhRUNTRGF0YShkYXRhKSB7XHJcbiAgICAgICAgLy8gQXBwbHkgZW50aXR5IGRlYXRoc1xyXG4gICAgICAgIGlmIChkYXRhLmVudGl0eURlYWQpIHtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBlbnRpdHlJZCBvZiBkYXRhLmVudGl0eURlYWQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZW50aXR5QWxpdmVbZW50aXR5SWRdID0gMDtcclxuICAgICAgICAgICAgICAgIC8vIENsZWFyIGNvbXBvbmVudCBtYXNrIGZvciBkZWFkIGVudGl0aWVzXHJcbiAgICAgICAgICAgICAgICB0aGlzLmVudGl0eUNvbXBvbmVudE1hc2tbZW50aXR5SWQgKiAyXSA9IDA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVudGl0eUNvbXBvbmVudE1hc2tbZW50aXR5SWQgKiAyICsgMV0gPSAwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBBcHBseSBuZXcvY2hhbmdlZCBhbGl2ZSBlbnRpdGllc1xyXG4gICAgICAgIGlmIChkYXRhLmVudGl0eUFsaXZlKSB7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZW50aXR5SWRTdHIgb2YgT2JqZWN0LmtleXMoZGF0YS5lbnRpdHlBbGl2ZSkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZW50aXR5QWxpdmVbcGFyc2VJbnQoZW50aXR5SWRTdHIsIDEwKV0gPSAxO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBBcHBseSBjb21wb25lbnQgbWFzayBjaGFuZ2VzLCBwcmVzZXJ2aW5nIGNsaWVudC1vbmx5IGNvbXBvbmVudCBiaXRzXHJcbiAgICAgICAgaWYgKGRhdGEuZW50aXR5Q29tcG9uZW50TWFzaykge1xyXG4gICAgICAgICAgICAvLyBCdWlsZCBiaXRtYXNrIGZvciBjbGllbnQtb25seSBjb21wb25lbnRzIHRvIHByZXNlcnZlXHJcbiAgICAgICAgICAgIGxldCBjbGllbnRPbmx5TWFza0xvdyA9IDA7XHJcbiAgICAgICAgICAgIGxldCBjbGllbnRPbmx5TWFza0hpZ2ggPSAwO1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGNvbXBvbmVudFR5cGUgb2YgdGhpcy5fY2xpZW50T25seUNvbXBvbmVudHMpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHR5cGVJZCA9IHRoaXMuX2NvbXBvbmVudFR5cGVJZC5nZXQoY29tcG9uZW50VHlwZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZUlkICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZUlkIDwgMzIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2xpZW50T25seU1hc2tMb3cgfD0gKDEgPDwgdHlwZUlkKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGllbnRPbmx5TWFza0hpZ2ggfD0gKDEgPDwgKHR5cGVJZCAtIDMyKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IFtlbnRpdHlJZFN0ciwgbWFza10gb2YgT2JqZWN0LmVudHJpZXMoZGF0YS5lbnRpdHlDb21wb25lbnRNYXNrKSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZW50aXR5SWQgPSBwYXJzZUludChlbnRpdHlJZFN0ciwgMTApO1xyXG4gICAgICAgICAgICAgICAgLy8gUHJlc2VydmUgY2xpZW50LW9ubHkgYml0cywgYXBwbHkgc2VydmVyIGJpdHNcclxuICAgICAgICAgICAgICAgIGNvbnN0IHByZXNlcnZlZExvdyA9IHRoaXMuZW50aXR5Q29tcG9uZW50TWFza1tlbnRpdHlJZCAqIDJdICYgY2xpZW50T25seU1hc2tMb3c7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBwcmVzZXJ2ZWRIaWdoID0gdGhpcy5lbnRpdHlDb21wb25lbnRNYXNrW2VudGl0eUlkICogMiArIDFdICYgY2xpZW50T25seU1hc2tIaWdoO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lbnRpdHlDb21wb25lbnRNYXNrW2VudGl0eUlkICogMl0gPSBtYXNrWzBdIHwgcHJlc2VydmVkTG93O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lbnRpdHlDb21wb25lbnRNYXNrW2VudGl0eUlkICogMiArIDFdID0gbWFza1sxXSB8IHByZXNlcnZlZEhpZ2g7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEFwcGx5IG51bWVyaWMgYXJyYXkgY2hhbmdlcyAob25seSBjaGFuZ2VkIHZhbHVlcylcclxuICAgICAgICAvLyBTa2lwIGNsaWVudC1vbmx5IGNvbXBvbmVudHNcclxuICAgICAgICBmb3IgKGNvbnN0IFtrZXksIHNwYXJzZV0gb2YgT2JqZWN0LmVudHJpZXMoZGF0YS5udW1lcmljQXJyYXlzIHx8IHt9KSkge1xyXG4gICAgICAgICAgICBjb25zdCBjb21wb25lbnRUeXBlID0ga2V5LnNwbGl0KCcuJylbMF07XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9jbGllbnRPbmx5Q29tcG9uZW50cy5oYXMoY29tcG9uZW50VHlwZSkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBsZXQgYXJyID0gdGhpcy5fbnVtZXJpY0FycmF5cy5nZXQoa2V5KTtcclxuICAgICAgICAgICAgaWYgKCFhcnIpIHtcclxuICAgICAgICAgICAgICAgIGFyciA9IG5ldyBGbG9hdDMyQXJyYXkodGhpcy5NQVhfRU5USVRJRVMpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbnVtZXJpY0FycmF5cy5zZXQoa2V5LCBhcnIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgW2VudGl0eUlkU3RyLCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoc3BhcnNlKSkge1xyXG4gICAgICAgICAgICAgICAgYXJyW3BhcnNlSW50KGVudGl0eUlkU3RyLCAxMCldID0gdGhpcy5fZnJvbVN5bmNWYWx1ZSh2YWx1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEFwcGx5IG9iamVjdCBjb21wb25lbnQgY2hhbmdlcyAtIHNraXAgY2xpZW50LW9ubHlcclxuICAgICAgICBmb3IgKGNvbnN0IFtjb21wb25lbnRUeXBlLCBjb21wb25lbnREYXRhXSBvZiBPYmplY3QuZW50cmllcyhkYXRhLm9iamVjdENvbXBvbmVudHMgfHwge30pKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9jbGllbnRPbmx5Q29tcG9uZW50cy5oYXMoY29tcG9uZW50VHlwZSkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCBzdG9yYWdlID0gdGhpcy5fZ2V0T2JqZWN0U3RvcmFnZShjb21wb25lbnRUeXBlKTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBbZW50aXR5SWRTdHIsIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhjb21wb25lbnREYXRhKSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZW50aXR5SWQgPSBwYXJzZUludChlbnRpdHlJZFN0ciwgMTApO1xyXG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gbnVsbCBtZWFucyByZW1vdmVkXHJcbiAgICAgICAgICAgICAgICAgICAgc3RvcmFnZVtlbnRpdHlJZF0gPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0b3JhZ2VbZW50aXR5SWRdID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBGaW5hbGl6ZSBFQ1Mgc3luYyAtIGNvbW1vbiBjbGVhbnVwIGZvciBib3RoIGZ1bGwgYW5kIGRlbHRhXHJcbiAgICAgKi9cclxuICAgIF9maW5hbGl6ZUVDU1N5bmMoZGF0YSkge1xyXG4gICAgICAgIC8vIFN5bmMgZW50aXR5IElEIGNvdW50ZXJcclxuICAgICAgICBpZiAoZGF0YS5uZXh0RW50aXR5SWQgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICB0aGlzLm5leHRFbnRpdHlJZCA9IGRhdGEubmV4dEVudGl0eUlkO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gUmVidWlsZCBmcmVlRW50aXR5SWRzIGZyb20gZW50aXR5QWxpdmUgdG8gZW5zdXJlIGNvbnNpc3RlbmN5XHJcbiAgICAgICAgdGhpcy5mcmVlRW50aXR5Q291bnQgPSAwO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgdGhpcy5uZXh0RW50aXR5SWQ7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5lbnRpdHlBbGl2ZVtpXSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5mcmVlRW50aXR5SWRzW3RoaXMuZnJlZUVudGl0eUNvdW50KytdID0gaTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gQ2xlYXIgYWxsIGNhY2hlZCBwcm94aWVzIHNpbmNlIGRhdGEgaGFzIGJlZW4gb3ZlcndyaXR0ZW5cclxuICAgICAgICBmb3IgKGNvbnN0IFssIGNvbXBvbmVudENhY2hlXSBvZiB0aGlzLl9wcm94eUNhY2hlKSB7XHJcbiAgICAgICAgICAgIGNvbXBvbmVudENhY2hlLmNsZWFyKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogVXBkYXRlIHNwZWNpZmljIGZpZWxkcyBvZiBhIGNvbXBvbmVudFxyXG4gICAgICogRm9yIG51bWVyaWMgY29tcG9uZW50cyAoVHlwZWRBcnJheSBzdG9yYWdlKSwgdGhpcyBpcyB0aGUgb25seSB3YXkgdG8gcGVyc2lzdCBjaGFuZ2VzXHJcbiAgICAgKiBGb3Igb2JqZWN0IGNvbXBvbmVudHMsIHRoaXMgYWxzbyB3b3JrcyAoZGlyZWN0IG11dGF0aW9uIHN0aWxsIHdvcmtzIGZvciB0aG9zZSlcclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBlbnRpdHlJZFxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGNvbXBvbmVudFR5cGVcclxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSB1cGRhdGVzIC0gT2JqZWN0IHdpdGggZmllbGQgdXBkYXRlcywgZS5nLiB7IGN1cnJlbnQ6IDUwIH0gb3IgeyAnbmVzdGVkLmZpZWxkJzogMTAgfVxyXG4gICAgICovXHJcbiAgICB1cGRhdGVDb21wb25lbnQoZW50aXR5SWQsIGNvbXBvbmVudFR5cGUsIHVwZGF0ZXMpIHtcclxuICAgICAgICBjb25zdCB0eXBlSWQgPSB0aGlzLl9jb21wb25lbnRUeXBlSWQuZ2V0KGNvbXBvbmVudFR5cGUpO1xyXG4gICAgICAgIGlmICh0eXBlSWQgPT09IHVuZGVmaW5lZCkgcmV0dXJuO1xyXG4gICAgICAgIGlmICghdGhpcy5faGFzQ29tcG9uZW50Qml0KGVudGl0eUlkLCB0eXBlSWQpKSByZXR1cm47XHJcblxyXG4gICAgICAgIGNvbnN0IGNvbXBvbmVudEluZm8gPSB0aGlzLl9udW1lcmljQ29tcG9uZW50SW5mby5nZXQoY29tcG9uZW50VHlwZSk7XHJcbiAgICAgICAgaWYgKGNvbXBvbmVudEluZm8gJiYgY29tcG9uZW50SW5mby5pc051bWVyaWMpIHtcclxuICAgICAgICAgICAgLy8gV3JpdGUgdG8gVHlwZWRBcnJheXMgKGNvbnZlcnQgbnVsbCB0byBzdG9yYWdlIHNlbnRpbmVsKVxyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGZpZWxkUGF0aCBpbiB1cGRhdGVzKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zZXROdW1lcmljRmllbGQoY29tcG9uZW50VHlwZSwgZW50aXR5SWQsIGZpZWxkUGF0aCwgdGhpcy5fdG9TdG9yYWdlVmFsdWUodXBkYXRlc1tmaWVsZFBhdGhdKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBVcGRhdGUgb2JqZWN0IHN0b3JhZ2VcclxuICAgICAgICAgICAgY29uc3Qgc3RvcmFnZSA9IHRoaXMuX29iamVjdENvbXBvbmVudHMuZ2V0KGNvbXBvbmVudFR5cGUpO1xyXG4gICAgICAgICAgICBpZiAoc3RvcmFnZSAmJiBzdG9yYWdlW2VudGl0eUlkXSkge1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBmaWVsZFBhdGggaW4gdXBkYXRlcykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChmaWVsZFBhdGguaW5jbHVkZXMoJy4nKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBIYW5kbGUgbmVzdGVkIHBhdGhzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3NldE5lc3RlZFZhbHVlKHN0b3JhZ2VbZW50aXR5SWRdLCBmaWVsZFBhdGgsIHVwZGF0ZXNbZmllbGRQYXRoXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RvcmFnZVtlbnRpdHlJZF1bZmllbGRQYXRoXSA9IHVwZGF0ZXNbZmllbGRQYXRoXTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBTZXQgYSBuZXN0ZWQgdmFsdWUgaW4gYW4gb2JqZWN0IHVzaW5nIGRvdCBub3RhdGlvbiBwYXRoXHJcbiAgICAgKi9cclxuICAgIF9zZXROZXN0ZWRWYWx1ZShvYmosIHBhdGgsIHZhbHVlKSB7XHJcbiAgICAgICAgY29uc3QgcGFydHMgPSBwYXRoLnNwbGl0KCcuJyk7XHJcbiAgICAgICAgbGV0IGN1cnJlbnQgPSBvYmo7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwYXJ0cy5sZW5ndGggLSAxOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKGN1cnJlbnRbcGFydHNbaV1dID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRbcGFydHNbaV1dID0ge307XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY3VycmVudCA9IGN1cnJlbnRbcGFydHNbaV1dO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjdXJyZW50W3BhcnRzW3BhcnRzLmxlbmd0aCAtIDFdXSA9IHZhbHVlO1xyXG4gICAgfVxyXG5cclxuICAgIGhhc0NvbXBvbmVudChlbnRpdHlJZCwgY29tcG9uZW50VHlwZSkge1xyXG4gICAgICAgIGNvbnN0IHR5cGVJZCA9IHRoaXMuX2NvbXBvbmVudFR5cGVJZC5nZXQoY29tcG9uZW50VHlwZSk7XHJcbiAgICAgICAgaWYgKHR5cGVJZCA9PT0gdW5kZWZpbmVkKSByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2hhc0NvbXBvbmVudEJpdChlbnRpdHlJZCwgdHlwZUlkKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRFbnRpdGllc1dpdGgoLi4uY29tcG9uZW50VHlwZXMpIHtcclxuICAgICAgICAvLyBDcmVhdGUgY2FjaGUga2V5IGZyb20gY29tcG9uZW50IHR5cGVzXHJcbiAgICAgICAgY29uc3QgcXVlcnlLZXkgPSBjb21wb25lbnRUeXBlcy5qb2luKCcsJyk7XHJcblxyXG4gICAgICAgIC8vIEdldCBvciBjcmVhdGUgcmV1c2FibGUgcmVzdWx0IGFycmF5IGZvciB0aGlzIHF1ZXJ5XHJcbiAgICAgICAgLy8gVGhpcyBhdm9pZHMgYWxsb2NhdGlvbnMgLSBlYWNoIHVuaXF1ZSBxdWVyeSBnZXRzIG9uZSBhcnJheSB0aGF0J3MgcmV1c2VkIGZvcmV2ZXJcclxuICAgICAgICBsZXQgcmVzdWx0ID0gdGhpcy5fcXVlcnlDYWNoZS5nZXQocXVlcnlLZXkpO1xyXG4gICAgICAgIGlmICghcmVzdWx0KSB7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IFtdO1xyXG4gICAgICAgICAgICB0aGlzLl9xdWVyeUNhY2hlLnNldChxdWVyeUtleSwgcmVzdWx0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmVzdWx0Lmxlbmd0aCA9IDA7ICAvLyBDbGVhciB3aXRob3V0IGRlYWxsb2NhdGluZyAoa2VlcHMgdW5kZXJseWluZyBidWZmZXIpXHJcblxyXG4gICAgICAgIC8vIEJ1aWxkIHF1ZXJ5IGJpdG1hc2sgZnJvbSBjb21wb25lbnQgdHlwZXNcclxuICAgICAgICBsZXQgcXVlcnlNYXNrMCA9IDA7XHJcbiAgICAgICAgbGV0IHF1ZXJ5TWFzazEgPSAwO1xyXG4gICAgICAgIGZvciAoY29uc3QgY29tcG9uZW50VHlwZSBvZiBjb21wb25lbnRUeXBlcykge1xyXG4gICAgICAgICAgICBjb25zdCB0eXBlSWQgPSB0aGlzLl9jb21wb25lbnRUeXBlSWQuZ2V0KGNvbXBvbmVudFR5cGUpO1xyXG4gICAgICAgICAgICBpZiAodHlwZUlkID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIC8vIENvbXBvbmVudCB0eXBlIGRvZXNuJ3QgZXhpc3QgeWV0LCBubyBlbnRpdGllcyBjYW4gaGF2ZSBpdFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDsgIC8vIFJldHVybiBlbXB0eSByZXVzYWJsZSBhcnJheVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0eXBlSWQgPCAzMikge1xyXG4gICAgICAgICAgICAgICAgcXVlcnlNYXNrMCB8PSAoMSA8PCB0eXBlSWQpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcXVlcnlNYXNrMSB8PSAoMSA8PCAodHlwZUlkIC0gMzIpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gU2NhbiBhbGwgZW50aXRpZXMgdXNpbmcgYml0bWFzayBtYXRjaGluZ1xyXG4gICAgICAgIC8vIFRoaXMgaXMgY2FjaGUtZnJpZW5kbHkgYmVjYXVzZSB3ZSBpdGVyYXRlIGNvbnRpZ3VvdXNseSB0aHJvdWdoIFR5cGVkQXJyYXlzXHJcbiAgICAgICAgY29uc3QgYWxpdmUgPSB0aGlzLmVudGl0eUFsaXZlO1xyXG4gICAgICAgIGNvbnN0IG1hc2tzID0gdGhpcy5lbnRpdHlDb21wb25lbnRNYXNrO1xyXG4gICAgICAgIGNvbnN0IG1heElkID0gdGhpcy5uZXh0RW50aXR5SWQ7XHJcblxyXG4gICAgICAgIGZvciAobGV0IGVudGl0eUlkID0gMTsgZW50aXR5SWQgPCBtYXhJZDsgZW50aXR5SWQrKykge1xyXG4gICAgICAgICAgICAvLyBTa2lwIGRlYWQgZW50aXRpZXNcclxuICAgICAgICAgICAgaWYgKCFhbGl2ZVtlbnRpdHlJZF0pIGNvbnRpbnVlO1xyXG5cclxuICAgICAgICAgICAgLy8gQ2hlY2sgaWYgZW50aXR5IGhhcyBhbGwgcmVxdWlyZWQgY29tcG9uZW50cyB2aWEgYml0bWFza1xyXG4gICAgICAgICAgICBjb25zdCBtYXNrMCA9IG1hc2tzW2VudGl0eUlkICogMl07XHJcbiAgICAgICAgICAgIGNvbnN0IG1hc2sxID0gbWFza3NbZW50aXR5SWQgKiAyICsgMV07XHJcblxyXG4gICAgICAgICAgICBpZiAoKG1hc2swICYgcXVlcnlNYXNrMCkgPT09IHF1ZXJ5TWFzazAgJiZcclxuICAgICAgICAgICAgICAgIChtYXNrMSAmIHF1ZXJ5TWFzazEpID09PSBxdWVyeU1hc2sxKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaChlbnRpdHlJZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogR2V0IGFsbCBhbGl2ZSBlbnRpdHkgSURzXHJcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyW119IEFycmF5IG9mIGFsaXZlIGVudGl0eSBJRHNcclxuICAgICAqL1xyXG4gICAgZ2V0QWxsRW50aXRpZXMoKSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gW107XHJcbiAgICAgICAgY29uc3QgYWxpdmUgPSB0aGlzLmVudGl0eUFsaXZlO1xyXG4gICAgICAgIGNvbnN0IG1heElkID0gdGhpcy5uZXh0RW50aXR5SWQ7XHJcbiAgICAgICAgZm9yIChsZXQgZW50aXR5SWQgPSAxOyBlbnRpdHlJZCA8IG1heElkOyBlbnRpdHlJZCsrKSB7XHJcbiAgICAgICAgICAgIGlmIChhbGl2ZVtlbnRpdHlJZF0pIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKGVudGl0eUlkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ2hlY2sgaWYgYW4gZW50aXR5IGV4aXN0c1xyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGVudGl0eUlkXHJcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cclxuICAgICAqL1xyXG4gICAgZW50aXR5RXhpc3RzKGVudGl0eUlkKSB7XHJcbiAgICAgICAgcmV0dXJuIGVudGl0eUlkID4gMCAmJiBlbnRpdHlJZCA8IHRoaXMuTUFYX0VOVElUSUVTICYmIHRoaXMuZW50aXR5QWxpdmVbZW50aXR5SWRdID09PSAxO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogR2V0IGNvdW50IG9mIGFsaXZlIGVudGl0aWVzXHJcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfVxyXG4gICAgICovXHJcbiAgICBnZXRFbnRpdHlDb3VudCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5lbnRpdHlDb3VudDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEdldCBhbGwgY29tcG9uZW50IHR5cGVzIGZvciBhbiBlbnRpdHlcclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBlbnRpdHlJZFxyXG4gICAgICogQHJldHVybnMge3N0cmluZ1tdfSBBcnJheSBvZiBjb21wb25lbnQgdHlwZSBuYW1lc1xyXG4gICAgICovXHJcbiAgICBnZXRFbnRpdHlDb21wb25lbnRUeXBlcyhlbnRpdHlJZCkge1xyXG4gICAgICAgIGlmICghdGhpcy5lbnRpdHlBbGl2ZVtlbnRpdHlJZF0pIHJldHVybiBbXTtcclxuXHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gW107XHJcbiAgICAgICAgY29uc3QgbWFzazAgPSB0aGlzLmVudGl0eUNvbXBvbmVudE1hc2tbZW50aXR5SWQgKiAyXTtcclxuICAgICAgICBjb25zdCBtYXNrMSA9IHRoaXMuZW50aXR5Q29tcG9uZW50TWFza1tlbnRpdHlJZCAqIDIgKyAxXTtcclxuXHJcbiAgICAgICAgLy8gQ2hlY2sgZmlyc3QgMzIgY29tcG9uZW50IHR5cGVzXHJcbiAgICAgICAgZm9yIChsZXQgYml0ID0gMDsgYml0IDwgMzI7IGJpdCsrKSB7XHJcbiAgICAgICAgICAgIGlmIChtYXNrMCAmICgxIDw8IGJpdCkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5hbWUgPSB0aGlzLl9jb21wb25lbnRUeXBlTmFtZXNbYml0XTtcclxuICAgICAgICAgICAgICAgIGlmIChuYW1lKSByZXN1bHQucHVzaChuYW1lKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gQ2hlY2sgbmV4dCAzMiBjb21wb25lbnQgdHlwZXNcclxuICAgICAgICBmb3IgKGxldCBiaXQgPSAwOyBiaXQgPCAzMjsgYml0KyspIHtcclxuICAgICAgICAgICAgaWYgKG1hc2sxICYgKDEgPDwgYml0KSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbmFtZSA9IHRoaXMuX2NvbXBvbmVudFR5cGVOYW1lc1tiaXQgKyAzMl07XHJcbiAgICAgICAgICAgICAgICBpZiAobmFtZSkgcmVzdWx0LnB1c2gobmFtZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBJdGVyYXRlIG92ZXIgZW50aXRpZXMgd2l0aCBzcGVjaWZpYyBjb21wb25lbnRzIHdpdGhvdXQgYWxsb2NhdGluZyBhcnJheXNcclxuICAgICAqIENhbGxzIGNhbGxiYWNrKGVudGl0eUlkKSBmb3IgZWFjaCBtYXRjaGluZyBlbnRpdHlcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nW119IGNvbXBvbmVudFR5cGVzIC0gQ29tcG9uZW50IHR5cGVzIHRvIG1hdGNoXHJcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBjYWxsYmFjayAtIENhbGxlZCB3aXRoIGVhY2ggbWF0Y2hpbmcgZW50aXR5SWRcclxuICAgICAqL1xyXG4gICAgZm9yRWFjaEVudGl0eVdpdGgoY29tcG9uZW50VHlwZXMsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgLy8gQnVpbGQgcXVlcnkgYml0bWFza1xyXG4gICAgICAgIGxldCBxdWVyeU1hc2swID0gMDtcclxuICAgICAgICBsZXQgcXVlcnlNYXNrMSA9IDA7XHJcbiAgICAgICAgZm9yIChjb25zdCBjb21wb25lbnRUeXBlIG9mIGNvbXBvbmVudFR5cGVzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHR5cGVJZCA9IHRoaXMuX2NvbXBvbmVudFR5cGVJZC5nZXQoY29tcG9uZW50VHlwZSk7XHJcbiAgICAgICAgICAgIGlmICh0eXBlSWQgPT09IHVuZGVmaW5lZCkgcmV0dXJuOyAvLyBObyBlbnRpdGllcyBjYW4gbWF0Y2hcclxuICAgICAgICAgICAgaWYgKHR5cGVJZCA8IDMyKSB7XHJcbiAgICAgICAgICAgICAgICBxdWVyeU1hc2swIHw9ICgxIDw8IHR5cGVJZCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBxdWVyeU1hc2sxIHw9ICgxIDw8ICh0eXBlSWQgLSAzMikpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBhbGl2ZSA9IHRoaXMuZW50aXR5QWxpdmU7XHJcbiAgICAgICAgY29uc3QgbWFza3MgPSB0aGlzLmVudGl0eUNvbXBvbmVudE1hc2s7XHJcbiAgICAgICAgY29uc3QgbWF4SWQgPSB0aGlzLm5leHRFbnRpdHlJZDtcclxuXHJcbiAgICAgICAgZm9yIChsZXQgZW50aXR5SWQgPSAxOyBlbnRpdHlJZCA8IG1heElkOyBlbnRpdHlJZCsrKSB7XHJcbiAgICAgICAgICAgIGlmICghYWxpdmVbZW50aXR5SWRdKSBjb250aW51ZTtcclxuICAgICAgICAgICAgY29uc3QgbWFzazAgPSBtYXNrc1tlbnRpdHlJZCAqIDJdO1xyXG4gICAgICAgICAgICBjb25zdCBtYXNrMSA9IG1hc2tzW2VudGl0eUlkICogMiArIDFdO1xyXG4gICAgICAgICAgICBpZiAoKG1hc2swICYgcXVlcnlNYXNrMCkgPT09IHF1ZXJ5TWFzazAgJiZcclxuICAgICAgICAgICAgICAgIChtYXNrMSAmIHF1ZXJ5TWFzazEpID09PSBxdWVyeU1hc2sxKSB7XHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhlbnRpdHlJZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDbGVhciBhbGwgZW50aXRpZXMgYW5kIHJlc2V0IHRoZSBFQ1Mgc3RhdGVcclxuICAgICAqL1xyXG4gICAgY2xlYXJBbGxFbnRpdGllcygpIHtcclxuICAgICAgICAvLyBDbGVhciBhbGwgb2JqZWN0IHN0b3JhZ2VcclxuICAgICAgICBmb3IgKGNvbnN0IHN0b3JhZ2Ugb2YgdGhpcy5fb2JqZWN0Q29tcG9uZW50cy52YWx1ZXMoKSkge1xyXG4gICAgICAgICAgICBzdG9yYWdlLmZpbGwodW5kZWZpbmVkKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFJlc2V0IFR5cGVkQXJyYXlzXHJcbiAgICAgICAgdGhpcy5lbnRpdHlBbGl2ZS5maWxsKDApO1xyXG4gICAgICAgIHRoaXMuZW50aXR5Q29tcG9uZW50TWFzay5maWxsKDApO1xyXG5cclxuICAgICAgICAvLyBSZXNldCBlbnRpdHkgbWFuYWdlbWVudFxyXG4gICAgICAgIHRoaXMuZnJlZUVudGl0eUNvdW50ID0gMDtcclxuICAgICAgICB0aGlzLm5leHRFbnRpdHlJZCA9IDE7XHJcbiAgICAgICAgdGhpcy5lbnRpdHlDb3VudCA9IDA7XHJcblxyXG4gICAgICAgIC8vIEludmFsaWRhdGUgcXVlcnkgY2FjaGVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgIHRyaWdnZXJFdmVudChldmVudE5hbWUsIGRhdGEpIHtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuc3lzdGVtcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBjb25zdCBzeXN0ZW0gPSB0aGlzLnN5c3RlbXNbaV07XHJcbiAgICAgICAgICAgIGlmIChzeXN0ZW1bZXZlbnROYW1lXSkge1xyXG4gICAgICAgICAgICAgICAgc3lzdGVtW2V2ZW50TmFtZV0oZGF0YSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZ2FtZU92ZXIoKSB7XHJcbiAgICAgICAgdGhpcy5zdGF0ZS5nYW1lT3ZlciA9IHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgZ2FtZVZpY3RvcnkoKSB7XHJcbiAgICAgICAgdGhpcy5zdGF0ZS52aWN0b3J5ID0gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICByZXNldEN1cnJlbnRUaW1lKCkge1xyXG4gICAgICAgIHRoaXMuc3RhdGUubm93ID0gMDtcclxuICAgICAgICB0aGlzLmxhc3RUaW1lID0gMDtcclxuICAgICAgICB0aGlzLmN1cnJlbnRUaW1lID0gMDtcclxuICAgICAgICB0aGlzLnRpY2tDb3VudCA9IDA7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0Q29tcG9uZW50cygpe1xyXG4gICAgICAgIGlmKCF0aGlzLmNvbXBvbmVudHMpe1xyXG4gICAgICAgICAgICB0aGlzLmNvbXBvbmVudHMgPSB0aGlzLmNvbXBvbmVudEdlbmVyYXRvci5nZXRDb21wb25lbnRzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmNvbXBvbmVudHM7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0Q29tcG9uZW50U2NoZW1hKGNvbXBvbmVudElkKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY29tcG9uZW50R2VuZXJhdG9yLmdldFNjaGVtYShjb21wb25lbnRJZCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXQgZW51bSBtYXAgd2l0aCB0b0luZGV4IGFuZCB0b1ZhbHVlXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZW51bU5hbWUgLSBUaGUgZW51bSBuYW1lIChlLmcuLCAndGVhbScsICdlbGVtZW50JywgJ3Byb2plY3RpbGVzJylcclxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9IHsgdG9JbmRleDoge3N0cmluZy0+bnVtYmVyfSwgdG9WYWx1ZTogW251bWJlci0+c3RyaW5nXSB9XHJcbiAgICAgKi9cclxuICAgIGdldEVudW1NYXAoZW51bU5hbWUpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jb21wb25lbnRHZW5lcmF0b3IuZ2V0RW51bU1hcChlbnVtTmFtZSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXQgYSBjb2xsZWN0aW9uIGl0ZW0gYnkgbnVtZXJpYyBpbmRleFxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGNvbGxlY3Rpb25OYW1lIC0gVGhlIGNvbGxlY3Rpb24gbmFtZSAoZS5nLiwgJ2xldmVscycsICd1bml0cycpXHJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gaW5kZXggLSBUaGUgbnVtZXJpYyBpbmRleFxyXG4gICAgICogQHJldHVybnMge09iamVjdHx1bmRlZmluZWR9IFRoZSBjb2xsZWN0aW9uIGl0ZW0sIG9yIHVuZGVmaW5lZCBpZiBub3QgZm91bmRcclxuICAgICAqL1xyXG4gICAgZ2V0Q29sbGVjdGlvbkl0ZW0oY29sbGVjdGlvbk5hbWUsIGluZGV4KSB7XHJcbiAgICAgICAgY29uc3QgZW51bU1hcCA9IHRoaXMuY29tcG9uZW50R2VuZXJhdG9yLmdldEVudW1NYXAoY29sbGVjdGlvbk5hbWUpO1xyXG4gICAgICAgIGlmICghZW51bU1hcD8udG9WYWx1ZT8uW2luZGV4XSkgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgICAgICBjb25zdCBrZXkgPSBlbnVtTWFwLnRvVmFsdWVbaW5kZXhdO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmdldENvbGxlY3Rpb25zKClbY29sbGVjdGlvbk5hbWVdPy5ba2V5XTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEdldCBhIGNvbGxlY3Rpb24gaXRlbSBrZXkgKHN0cmluZyBuYW1lKSBieSBudW1lcmljIGluZGV4XHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gY29sbGVjdGlvbk5hbWUgLSBUaGUgY29sbGVjdGlvbiBuYW1lIChlLmcuLCAnbGV2ZWxzJywgJ3VuaXRzJylcclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBpbmRleCAtIFRoZSBudW1lcmljIGluZGV4XHJcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfHVuZGVmaW5lZH0gVGhlIGNvbGxlY3Rpb24ga2V5LCBvciB1bmRlZmluZWQgaWYgbm90IGZvdW5kXHJcbiAgICAgKi9cclxuICAgIGdldENvbGxlY3Rpb25LZXkoY29sbGVjdGlvbk5hbWUsIGluZGV4KSB7XHJcbiAgICAgICAgY29uc3QgZW51bU1hcCA9IHRoaXMuY29tcG9uZW50R2VuZXJhdG9yLmdldEVudW1NYXAoY29sbGVjdGlvbk5hbWUpO1xyXG4gICAgICAgIHJldHVybiBlbnVtTWFwPy50b1ZhbHVlPy5baW5kZXhdO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogR2V0IGFsbCBlbnVtcyBhcyBhIGNvbnZlbmllbnQgbG9va3VwIG9iamVjdFxyXG4gICAgICogVXNhZ2U6IGNvbnN0IGVudW1zID0gZ2FtZS5nZXRFbnVtcygpO1xyXG4gICAgICogICAgICAgIGNvbXBvbmVudHMudGVhbSh7IHRlYW06IGVudW1zLnRlYW0ubGVmdCB9KVxyXG4gICAgICogQHJldHVybnMge09iamVjdH0geyB0ZWFtOiB7IG5ldXRyYWw6IDAsIGhvc3RpbGU6IDEsIC4uLiB9LCBlbGVtZW50OiB7IC4uLiB9LCAuLi4gfVxyXG4gICAgICovXHJcbiAgICBnZXRFbnVtcygpIHtcclxuICAgICAgICBpZiAoIXRoaXMuX2VudW1zKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2VudW1zID0gdGhpcy5jb21wb25lbnRHZW5lcmF0b3IuZ2V0RW51bXMoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2VudW1zO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogR2V0IHJldmVyc2UgZW51bSBsb29rdXAgKGluZGV4IOKGkiBrZXkpXHJcbiAgICAgKiBVc2FnZTogY29uc3QgcmV2ZXJzZUVudW1zID0gZ2FtZS5nZXRSZXZlcnNlRW51bXMoKTtcclxuICAgICAqICAgICAgICBjb25zdCBsZXZlbE5hbWUgPSByZXZlcnNlRW51bXMubGV2ZWxzW2xldmVsSW5kZXhdO1xyXG4gICAgICogQHJldHVybnMge09iamVjdH0geyBsZXZlbHM6IHsgMDogJ2xldmVsXzEnLCAxOiAnbGV2ZWxfMicgfSwgLi4uIH1cclxuICAgICAqL1xyXG4gICAgZ2V0UmV2ZXJzZUVudW1zKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5fcmV2ZXJzZUVudW1zKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3JldmVyc2VFbnVtcyA9IHRoaXMuY29tcG9uZW50R2VuZXJhdG9yLmdldFJldmVyc2VFbnVtcygpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5fcmV2ZXJzZUVudW1zO1xyXG4gICAgfVxyXG5cclxuICAgIGdldFVuaXRUeXBlRGVmKHVuaXRUeXBlQ29tcG9uZW50KSB7XHJcbiAgICAgICAgaWYgKCF1bml0VHlwZUNvbXBvbmVudCB8fCB1bml0VHlwZUNvbXBvbmVudC5jb2xsZWN0aW9uID09PSAtMSB8fCB1bml0VHlwZUNvbXBvbmVudC50eXBlID09PSAtMSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGNvbGxlY3Rpb25zID0gdGhpcy5nZXRDb2xsZWN0aW9ucygpO1xyXG4gICAgICAgIGNvbnN0IGNvbGxlY3Rpb25FbnVtTWFwID0gdGhpcy5nZXRFbnVtTWFwKCdvYmplY3RUeXBlRGVmaW5pdGlvbnMnKTtcclxuICAgICAgICBjb25zdCBjb2xsZWN0aW9uTmFtZSA9IGNvbGxlY3Rpb25FbnVtTWFwPy50b1ZhbHVlPy5bdW5pdFR5cGVDb21wb25lbnQuY29sbGVjdGlvbl07XHJcblxyXG4gICAgICAgIGlmICghY29sbGVjdGlvbk5hbWUgfHwgIWNvbGxlY3Rpb25zW2NvbGxlY3Rpb25OYW1lXSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHR5cGVFbnVtTWFwID0gdGhpcy5nZXRFbnVtTWFwKGNvbGxlY3Rpb25OYW1lKTtcclxuICAgICAgICBjb25zdCB0eXBlTmFtZSA9IHR5cGVFbnVtTWFwPy50b1ZhbHVlPy5bdW5pdFR5cGVDb21wb25lbnQudHlwZV07XHJcblxyXG4gICAgICAgIGlmICghdHlwZU5hbWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBkZWYgPSBjb2xsZWN0aW9uc1tjb2xsZWN0aW9uTmFtZV1bdHlwZU5hbWVdO1xyXG4gICAgICAgIC8vIEluY2x1ZGUgcmVzb2x2ZWQgbmFtZXMgZm9yIGNvbnZlbmllbmNlXHJcbiAgICAgICAgaWYgKGRlZikge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgLi4uZGVmLFxyXG4gICAgICAgICAgICAgICAgaWQ6IHR5cGVOYW1lLFxyXG4gICAgICAgICAgICAgICAgY29sbGVjdGlvbjogY29sbGVjdGlvbk5hbWVcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbn1cclxuXHJcblxyXG4vLyBBc3NpZ24gdG8gZ2xvYmFsLkdVVFMgZm9yIHNlcnZlclxyXG5pZiAodHlwZW9mIGdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcgJiYgZ2xvYmFsLkdVVFMpIHtcclxuICAgIGdsb2JhbC5HVVRTLkJhc2VFQ1NHYW1lID0gQmFzZUVDU0dhbWU7XHJcbn1cclxuXHJcbi8vIEVTNiBleHBvcnRzIGZvciB3ZWJwYWNrIGJ1bmRsaW5nXHJcbmV4cG9ydCBkZWZhdWx0IEJhc2VFQ1NHYW1lO1xyXG5leHBvcnQgeyBCYXNlRUNTR2FtZSB9O1xyXG5cblxuLy8gQXV0by1nZW5lcmF0ZWQgZXhwb3J0c1xuaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHdpbmRvdy5HVVRTKSB7XG4gIHdpbmRvdy5HVVRTLkJhc2VFQ1NHYW1lID0gQmFzZUVDU0dhbWU7XG59XG4iXSwibmFtZXMiOlsiQmFzZUVDU0dhbWUiLCJjb25zdHJ1Y3RvciIsImFwcCIsInN0YXRlIiwiZW50aXRpZXNUb0FkZCIsImNsYXNzZXMiLCJzeXN0ZW1zIiwic2NlbmVNYW5hZ2VyIiwiX3NlcnZpY2VzIiwiR1VUUyIsIkdhbWVTZXJ2aWNlcyIsIk1BWF9FTlRJVElFUyIsImVudGl0eUFsaXZlIiwiVWludDhBcnJheSIsImVudGl0eUNvbXBvbmVudE1hc2siLCJVaW50MzJBcnJheSIsImZyZWVFbnRpdHlJZHMiLCJmcmVlRW50aXR5Q291bnQiLCJuZXh0RW50aXR5SWQiLCJlbnRpdHlDb3VudCIsIl9jb21wb25lbnRUeXBlSWQiLCJNYXAiLCJfY29tcG9uZW50VHlwZU5hbWVzIiwiX25leHRDb21wb25lbnRUeXBlSWQiLCJfbnVtZXJpY0FycmF5cyIsIl9udW1lcmljQ29tcG9uZW50SW5mbyIsIl9vYmplY3RDb21wb25lbnRzIiwiX3F1ZXJ5Q2FjaGUiLCJfbGFzdFN5bmNlZFN0YXRlIiwiX2NsaWVudE9ubHlDb21wb25lbnRzIiwiU2V0IiwiX3Byb3h5Q2FjaGUiLCJfcXVlcnlSZXN1bHRCdWZmZXIiLCJsYXN0VGltZSIsImN1cnJlbnRUaW1lIiwiZGVsdGFUaW1lIiwidGlja0NvdW50IiwiRklYRURfREVMVEFfVElNRSIsImlzU2VydmVyIiwiUGVyZm9ybWFuY2VNb25pdG9yIiwicGVyZm9ybWFuY2VNb25pdG9yIiwiQ2FsbExvZ2dlciIsImNhbGxMb2dnZXIiLCJTZWVkZWRSYW5kb20iLCJybmciLCJEYXRlIiwibm93IiwiX2luaXRDb21wb25lbnRUeXBlcyIsImNvbGxlY3Rpb25zIiwiZ2V0Q29sbGVjdGlvbnMiLCJjb21wb25lbnRHZW5lcmF0b3IiLCJDb21wb25lbnRHZW5lcmF0b3IiLCJjb21wb25lbnRzIiwicmVnaXN0ZXIiLCJnZXRDb21wb25lbnRzIiwiYmluZCIsImdldENvbXBvbmVudFNjaGVtYSIsImdldEVudW1NYXAiLCJnZXRFbnVtcyIsImdldFJldmVyc2VFbnVtcyIsImdldFVuaXRUeXBlRGVmIiwiY29tcG9uZW50TmFtZXMiLCJPYmplY3QiLCJrZXlzIiwic29ydCIsImNvbXBvbmVudE5hbWUiLCJfZ2V0Q29tcG9uZW50VHlwZUlkIiwiY29tcG9uZW50VHlwZSIsInR5cGVJZCIsImdldCIsInVuZGVmaW5lZCIsInNldCIsIl9zZXRDb21wb25lbnRCaXQiLCJlbnRpdHlJZCIsImNvbXBvbmVudFR5cGVJZCIsIm1hc2tJbmRleCIsImJpdCIsIl9jbGVhckNvbXBvbmVudEJpdCIsIl9oYXNDb21wb25lbnRCaXQiLCJfZ2V0TnVtZXJpY0FycmF5Iiwia2V5IiwiYXJyIiwiRmxvYXQzMkFycmF5IiwiX2dldE9iamVjdFN0b3JhZ2UiLCJzdG9yYWdlIiwiQXJyYXkiLCJfYW5hbHl6ZUNvbXBvbmVudFNjaGVtYSIsInNjaGVtYSIsImVudW1NYXAiLCJwcmVmaXgiLCJmaWVsZHMiLCJpc051bWVyaWMiLCJ2YWx1ZSIsImZpZWxkUGF0aCIsInB1c2giLCJ0b0luZGV4IiwiaGFzT3duUHJvcGVydHkiLCJpc0FycmF5IiwiaXNFbnVtQXJyYXkiLCJldmVyeSIsIml0ZW0iLCJuZXN0ZWQiLCJfc2V0dXBDb21wb25lbnRTdG9yYWdlIiwiY29tcG9uZW50SWQiLCJoYXMiLCJhbmFseXNpcyIsIm9yaWdpbmFsU2NoZW1hIiwiZ2V0T3JpZ2luYWxTY2hlbWEiLCJfc2V0TnVtZXJpY0ZpZWxkIiwiX2dldE51bWVyaWNGaWVsZCIsIl9mcm9tU3RvcmFnZVZhbHVlIiwiX2dldFJhd051bWVyaWNGaWVsZCIsImdldEZpZWxkIiwic2V0RmllbGQiLCJfdG9TdG9yYWdlVmFsdWUiLCJpc051bGwiLCJJbmZpbml0eSIsIl90b1N5bmNWYWx1ZSIsIl9mcm9tU3luY1ZhbHVlIiwiX3dyaXRlTnVtZXJpY0NvbXBvbmVudCIsImRhdGEiLCJzY2hlbWFWYWx1ZSIsImRhdGFWYWx1ZSIsIl9nZXROZXN0ZWRWYWx1ZSIsIl9yZWFkTnVtZXJpY0NvbXBvbmVudCIsImNvbXBvbmVudENhY2hlIiwiY2FjaGVkIiwicHJveHkiLCJfY3JlYXRlQ29tcG9uZW50UHJveHkiLCJnYW1lIiwic2NoZW1hSW5mbyIsInR5cGUiLCIkZml4ZWRBcnJheSIsIiRiaXRtYXNrIiwiJGVudW0iLCJuZXN0ZWRDYWNoZSIsIlByb3h5IiwidGFyZ2V0IiwicHJvcCIsInJlc3VsdCIsImluZm8iLCJfY3JlYXRlTmVzdGVkUHJveHkiLCJ0b0pTT04iLCJzdG9yZWRWYWx1ZSIsIm93bktleXMiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJjb25maWd1cmFibGUiLCJlbnVtZXJhYmxlIiwiX2NyZWF0ZUZpeGVkQXJyYXlQcm94eSIsIl9jcmVhdGVCaXRtYXNrUHJveHkiLCJiYXNlTmFtZSIsImNvbmZpZyIsInNpemUiLCJzaXplRnJvbSIsInRvVmFsdWUiLCJsZW5ndGgiLCJmaWVsZFByZWZpeCIsImkiLCJlbGVtZW50IiwiZmllbGQiLCJpbmRleCIsInBhcnNlSW50IiwiaXNOYU4iLCJ0IiwiZiIsInYiLCJTdHJpbmciLCJ3cml0YWJsZSIsImJpdENvdW50IiwiZmllbGRDb3VudCIsIk1hdGgiLCJjZWlsIiwib2JqIiwicGF0aCIsInBhcnRzIiwic3BsaXQiLCJjdXJyZW50IiwicGFydCIsIm1ldGhvZCIsImhhc1NlcnZpY2UiLCJjYWxsIiwiYXJncyIsImxvZyIsImxpc3RTZXJ2aWNlcyIsImluaXQiLCJkb2N1bWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwidHJpZ2dlckV2ZW50IiwibG9hZEdhbWVTY3JpcHRzIiwib3B0aW9ucyIsImdhbWVDb25maWciLCJjb25maWdzIiwic2VydmVyIiwiU2NlbmVNYW5hZ2VyIiwiYXZhaWxhYmxlU3lzdGVtVHlwZXMiLCJzeXN0ZW1zQnlOYW1lIiwic2tpcEluaXRpYWxTY2VuZSIsImxvYWRJbml0aWFsU2NlbmUiLCJpbml0aWFsU2NlbmUiLCJsb2FkU2NlbmUiLCJjb25zb2xlIiwid2FybiIsImdldE9yQ3JlYXRlU3lzdGVtIiwic3lzdGVtTmFtZSIsImluY2x1ZGVzIiwiZXJyb3IiLCJwYXJhbXMiLCJjYW52YXMiLCJzeXN0ZW1JbnN0IiwiZW5hYmxlZCIsIlN5c3RlbUNsYXNzIiwic2VydmljZXMiLCJzZXJ2aWNlTmFtZSIsImlzU3lzdGVtQXZhaWxhYmxlIiwic3dpdGNoU2NlbmUiLCJzY2VuZU5hbWUiLCJnZXRFbnRpdHlJZCIsIm1pbklkeCIsImlkIiwiRXJyb3IiLCJ1cGRhdGUiLCJpc1BhdXNlZCIsInN0YXJ0RnJhbWUiLCJyb3VuZCIsInN5c3RlbSIsIm5hbWUiLCJzdGFydFN5c3RlbSIsImVuZFN5c3RlbVVwZGF0ZSIsInJlbmRlciIsInN0YXJ0U3lzdGVtUmVuZGVyIiwiZW5kU3lzdGVtUmVuZGVyIiwidXBkYXRlT3ZlcmxheSIsInBvc3RVcGRhdGUiLCJmb3JFYWNoIiwiZW50aXR5IiwiYWRkRW50aXR5IiwiY3JlYXRlRW50aXR5Iiwic2V0SWQiLCJ0cmFjZSIsImRlc3Ryb3lFbnRpdHkiLCJlbnRpdHlEZXN0cm95ZWQiLCJkZWxldGUiLCJhZGRDb21wb25lbnQiLCJjb21wb25lbnRNZXRob2RzIiwiY29tcG9uZW50RGF0YSIsImNvbXBvbmVudEluZm8iLCJhZGRDb21wb25lbnRzIiwiY29tcG9uZW50c0RhdGEiLCJoYXNFbnVtU2VydmljZSIsImVudHJpZXMiLCJyZW1vdmVDb21wb25lbnQiLCJjb21wb25lbnQiLCJnZXRDb21wb25lbnQiLCJzZXJpYWxpemVDb21wb25lbnQiLCJKU09OIiwicGFyc2UiLCJzdHJpbmdpZnkiLCJnZXRFQ1NEYXRhIiwiZnVsbFN5bmMiLCJtYXhFbnRpdHkiLCJsYXN0U3RhdGUiLCJfZ2V0RnVsbEVDU0RhdGEiLCJfY2FwdHVyZVN0YXRlU25hcHNob3QiLCJfZ2V0RGVsdGFFQ1NEYXRhIiwibnVtZXJpY0FycmF5cyIsIm9iamVjdENvbXBvbmVudHMiLCJsb3ciLCJoaWdoIiwibGFzdEFyciIsImxhc3RNYXhFbnRpdHkiLCJzcGFyc2UiLCJ2YWwiLCJsYXN0VmFsIiwic25hcHNob3QiLCJzdWJhcnJheSIsImNvcHkiLCJlbnRpdHlEZWFkIiwicHJldmlvdXMiLCJsb3dDdXJyZW50IiwiaGlnaEN1cnJlbnQiLCJsb3dQcmV2IiwiaGlnaFByZXYiLCJsYXN0U3RvcmFnZSIsImN1cnJlbnRTdHIiLCJwcmV2aW91c1N0ciIsInJlc2V0U3luY1N0YXRlIiwiYXBwbHlFQ1NEYXRhIiwiX2FwcGx5RnVsbEVDU0RhdGEiLCJfYXBwbHlEZWx0YUVDU0RhdGEiLCJfZmluYWxpemVFQ1NTeW5jIiwiZmlsbCIsImVudGl0eUlkU3RyIiwiY2xpZW50T25seU1hc2tMb3ciLCJjbGllbnRPbmx5TWFza0hpZ2giLCJwcmVzZXJ2ZWRMb3ciLCJwcmVzZXJ2ZWRIaWdoIiwibWFzayIsImNsZWFyIiwidXBkYXRlQ29tcG9uZW50IiwidXBkYXRlcyIsIl9zZXROZXN0ZWRWYWx1ZSIsImhhc0NvbXBvbmVudCIsImdldEVudGl0aWVzV2l0aCIsImNvbXBvbmVudFR5cGVzIiwicXVlcnlLZXkiLCJqb2luIiwicXVlcnlNYXNrMCIsInF1ZXJ5TWFzazEiLCJhbGl2ZSIsIm1hc2tzIiwibWF4SWQiLCJtYXNrMCIsIm1hc2sxIiwiZ2V0QWxsRW50aXRpZXMiLCJlbnRpdHlFeGlzdHMiLCJnZXRFbnRpdHlDb3VudCIsImdldEVudGl0eUNvbXBvbmVudFR5cGVzIiwiZm9yRWFjaEVudGl0eVdpdGgiLCJjYWxsYmFjayIsImNsZWFyQWxsRW50aXRpZXMiLCJ2YWx1ZXMiLCJldmVudE5hbWUiLCJnYW1lT3ZlciIsImdhbWVWaWN0b3J5IiwidmljdG9yeSIsInJlc2V0Q3VycmVudFRpbWUiLCJnZXRTY2hlbWEiLCJlbnVtTmFtZSIsImdldENvbGxlY3Rpb25JdGVtIiwiY29sbGVjdGlvbk5hbWUiLCJnZXRDb2xsZWN0aW9uS2V5IiwiX2VudW1zIiwiX3JldmVyc2VFbnVtcyIsInVuaXRUeXBlQ29tcG9uZW50IiwiY29sbGVjdGlvbiIsImNvbGxlY3Rpb25FbnVtTWFwIiwidHlwZUVudW1NYXAiLCJ0eXBlTmFtZSIsImRlZiIsImdsb2JhbCIsIndpbmRvdyJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./global/collections/scripts/libraries/js/BaseECSGame.js\n\n}");

/***/ }),

/***/ "./global/collections/scripts/libraries/js/BaseLoader.js":
/*!***************************************************************!*\
  !*** ./global/collections/scripts/libraries/js/BaseLoader.js ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BaseLoader: () => (/* binding */ BaseLoader),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nclass BaseLoader {\n  constructor(game) {\n    this.game = game;\n  }\n  async load() {\n    this.collections = this.game.getCollections();\n    this.game.init(false);\n  }\n}\n\n// Auto-generated exports\nif (typeof window !== 'undefined' && window.GUTS) {\n  window.GUTS.BaseLoader = BaseLoader;\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (BaseLoader);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9nbG9iYWwvY29sbGVjdGlvbnMvc2NyaXB0cy9saWJyYXJpZXMvanMvQmFzZUxvYWRlci5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUFBLE1BQU1BLFVBQVUsQ0FBQztFQUNiQyxXQUFXQSxDQUFDQyxJQUFJLEVBQUU7SUFDZCxJQUFJLENBQUNBLElBQUksR0FBR0EsSUFBSTtFQUNwQjtFQUNBLE1BQU1DLElBQUlBLENBQUEsRUFBRTtJQUNSLElBQUksQ0FBQ0MsV0FBVyxHQUFHLElBQUksQ0FBQ0YsSUFBSSxDQUFDRyxjQUFjLENBQUMsQ0FBQztJQUM3QyxJQUFJLENBQUNILElBQUksQ0FBQ0ksSUFBSSxDQUFDLEtBQUssQ0FBQztFQUN6QjtBQUdKOztBQUVBO0FBQ0EsSUFBSSxPQUFPQyxNQUFNLEtBQUssV0FBVyxJQUFJQSxNQUFNLENBQUNDLElBQUksRUFBRTtFQUNoREQsTUFBTSxDQUFDQyxJQUFJLENBQUNSLFVBQVUsR0FBR0EsVUFBVTtBQUNyQztBQUVBLGlFQUFlQSxVQUFVLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90b3dlcmRlZmVuc2UvLi9nbG9iYWwvY29sbGVjdGlvbnMvc2NyaXB0cy9saWJyYXJpZXMvanMvQmFzZUxvYWRlci5qcz9jY2YxIl0sInNvdXJjZXNDb250ZW50IjpbImNsYXNzIEJhc2VMb2FkZXIge1xuICAgIGNvbnN0cnVjdG9yKGdhbWUpIHtcbiAgICAgICAgdGhpcy5nYW1lID0gZ2FtZTtcbiAgICB9ICAgIFxuICAgIGFzeW5jIGxvYWQoKXtcbiAgICAgICAgdGhpcy5jb2xsZWN0aW9ucyA9IHRoaXMuZ2FtZS5nZXRDb2xsZWN0aW9ucygpOyAgICAgICAgICBcbiAgICAgICAgdGhpcy5nYW1lLmluaXQoZmFsc2UpO1xuICAgIH1cbiAgICBcbiBcbn1cblxuLy8gQXV0by1nZW5lcmF0ZWQgZXhwb3J0c1xuaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHdpbmRvdy5HVVRTKSB7XG4gIHdpbmRvdy5HVVRTLkJhc2VMb2FkZXIgPSBCYXNlTG9hZGVyO1xufVxuXG5leHBvcnQgZGVmYXVsdCBCYXNlTG9hZGVyO1xuZXhwb3J0IHsgQmFzZUxvYWRlciB9O1xuIl0sIm5hbWVzIjpbIkJhc2VMb2FkZXIiLCJjb25zdHJ1Y3RvciIsImdhbWUiLCJsb2FkIiwiY29sbGVjdGlvbnMiLCJnZXRDb2xsZWN0aW9ucyIsImluaXQiLCJ3aW5kb3ciLCJHVVRTIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./global/collections/scripts/libraries/js/BaseLoader.js\n\n}");

/***/ }),

/***/ "./global/collections/scripts/libraries/js/BaseSystem.js":
/*!***************************************************************!*\
  !*** ./global/collections/scripts/libraries/js/BaseSystem.js ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BaseSystem: () => (/* binding */ BaseSystem),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == typeof i ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != typeof i) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nclass BaseSystem {\n  constructor(game) {\n    this.game = game;\n    this.engine = game.app;\n    this.enabled = true;\n    this.enums = this.game.getEnums();\n    this.collections = this.game.getCollections();\n    this.reverseEnums = this.game.getReverseEnums();\n  }\n\n  /**\r\n   * Called after all systems are initialized\r\n   */\n  postAllInit() {}\n\n  /**\r\n   * Called when a scene is loaded\r\n   * @param {Object} sceneData - The scene configuration data\r\n   */\n  onSceneLoad(sceneData) {}\n\n  /**\r\n   * Called when a scene is unloaded\r\n   */\n  onSceneUnload() {}\n\n  /**\r\n   * Check if this system is required for a given scene\r\n   * Override in subclasses to make systems optional based on scene config\r\n   * @param {Object} sceneData - The scene configuration data\r\n   * @returns {boolean} True if this system should be enabled for this scene\r\n   */\n  isRequiredForScene(sceneData) {\n    // If scene specifies systems, check if this system is in the list\n    if (sceneData?.systems && Array.isArray(sceneData.systems)) {\n      return sceneData.systems.includes(this.constructor.name);\n    }\n    // Default: always required\n    return true;\n  }\n  update() {}\n  render() {}\n}\n\n// Assign to global.GUTS for server\n// Static property that subclasses can override to define services to register\n// Format: ['methodName1', 'methodName2', ...]\n// Each method will be auto-registered as game.register('methodName', this.methodName.bind(this))\n_defineProperty(BaseSystem, \"services\", []);\nif (typeof __webpack_require__.g !== 'undefined' && __webpack_require__.g.GUTS) {\n  __webpack_require__.g.GUTS.BaseSystem = BaseSystem;\n}\n\n// ES6 exports for webpack bundling\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (BaseSystem);\n\n\n// Auto-generated exports\nif (typeof window !== 'undefined' && window.GUTS) {\n  window.GUTS.BaseSystem = BaseSystem;\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9nbG9iYWwvY29sbGVjdGlvbnMvc2NyaXB0cy9saWJyYXJpZXMvanMvQmFzZVN5c3RlbS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBLE1BQU1BLFVBQVUsQ0FBQztFQU1iQyxXQUFXQSxDQUFDQyxJQUFJLEVBQUU7SUFDZCxJQUFJLENBQUNBLElBQUksR0FBR0EsSUFBSTtJQUNoQixJQUFJLENBQUNDLE1BQU0sR0FBR0QsSUFBSSxDQUFDRSxHQUFHO0lBQ3RCLElBQUksQ0FBQ0MsT0FBTyxHQUFHLElBQUk7SUFDbkIsSUFBSSxDQUFDQyxLQUFLLEdBQUcsSUFBSSxDQUFDSixJQUFJLENBQUNLLFFBQVEsQ0FBQyxDQUFDO0lBQ2pDLElBQUksQ0FBQ0MsV0FBVyxHQUFHLElBQUksQ0FBQ04sSUFBSSxDQUFDTyxjQUFjLENBQUMsQ0FBQztJQUM3QyxJQUFJLENBQUNDLFlBQVksR0FBRyxJQUFJLENBQUNSLElBQUksQ0FBQ1MsZUFBZSxDQUFDLENBQUM7RUFDbkQ7O0VBRUE7QUFDSjtBQUNBO0VBQ0lDLFdBQVdBLENBQUEsRUFBRyxDQUVkOztFQUVBO0FBQ0o7QUFDQTtBQUNBO0VBQ0lDLFdBQVdBLENBQUNDLFNBQVMsRUFBRSxDQUV2Qjs7RUFFQTtBQUNKO0FBQ0E7RUFDSUMsYUFBYUEsQ0FBQSxFQUFHLENBRWhCOztFQUVBO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtFQUNJQyxrQkFBa0JBLENBQUNGLFNBQVMsRUFBRTtJQUMxQjtJQUNBLElBQUlBLFNBQVMsRUFBRUcsT0FBTyxJQUFJQyxLQUFLLENBQUNDLE9BQU8sQ0FBQ0wsU0FBUyxDQUFDRyxPQUFPLENBQUMsRUFBRTtNQUN4RCxPQUFPSCxTQUFTLENBQUNHLE9BQU8sQ0FBQ0csUUFBUSxDQUFDLElBQUksQ0FBQ25CLFdBQVcsQ0FBQ29CLElBQUksQ0FBQztJQUM1RDtJQUNBO0lBQ0EsT0FBTyxJQUFJO0VBQ2Y7RUFFQUMsTUFBTUEsQ0FBQSxFQUFFLENBRVI7RUFFQUMsTUFBTUEsQ0FBQSxFQUFHLENBRVQ7QUFFSjs7QUFHQTtBQTlESTtBQUNBO0FBQ0E7QUFBQUMsZUFBQSxDQUhFeEIsVUFBVSxjQUlNLEVBQUU7QUE0RHhCLElBQUksT0FBT3lCLHFCQUFNLEtBQUssV0FBVyxJQUFJQSxxQkFBTSxDQUFDQyxJQUFJLEVBQUU7RUFDOUNELHFCQUFNLENBQUNDLElBQUksQ0FBQzFCLFVBQVUsR0FBR0EsVUFBVTtBQUN2Qzs7QUFFQTtBQUNBLGlFQUFlQSxVQUFVLEVBQUM7QUFDSjs7QUFFdEI7QUFDQSxJQUFJLE9BQU8yQixNQUFNLEtBQUssV0FBVyxJQUFJQSxNQUFNLENBQUNELElBQUksRUFBRTtFQUNoREMsTUFBTSxDQUFDRCxJQUFJLENBQUMxQixVQUFVLEdBQUdBLFVBQVU7QUFDckMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90b3dlcmRlZmVuc2UvLi9nbG9iYWwvY29sbGVjdGlvbnMvc2NyaXB0cy9saWJyYXJpZXMvanMvQmFzZVN5c3RlbS5qcz9mMDBmIl0sInNvdXJjZXNDb250ZW50IjpbImNsYXNzIEJhc2VTeXN0ZW0ge1xyXG4gICAgLy8gU3RhdGljIHByb3BlcnR5IHRoYXQgc3ViY2xhc3NlcyBjYW4gb3ZlcnJpZGUgdG8gZGVmaW5lIHNlcnZpY2VzIHRvIHJlZ2lzdGVyXHJcbiAgICAvLyBGb3JtYXQ6IFsnbWV0aG9kTmFtZTEnLCAnbWV0aG9kTmFtZTInLCAuLi5dXHJcbiAgICAvLyBFYWNoIG1ldGhvZCB3aWxsIGJlIGF1dG8tcmVnaXN0ZXJlZCBhcyBnYW1lLnJlZ2lzdGVyKCdtZXRob2ROYW1lJywgdGhpcy5tZXRob2ROYW1lLmJpbmQodGhpcykpXHJcbiAgICBzdGF0aWMgc2VydmljZXMgPSBbXTtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihnYW1lKSB7XHJcbiAgICAgICAgdGhpcy5nYW1lID0gZ2FtZTtcclxuICAgICAgICB0aGlzLmVuZ2luZSA9IGdhbWUuYXBwO1xyXG4gICAgICAgIHRoaXMuZW5hYmxlZCA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5lbnVtcyA9IHRoaXMuZ2FtZS5nZXRFbnVtcygpO1xyXG4gICAgICAgIHRoaXMuY29sbGVjdGlvbnMgPSB0aGlzLmdhbWUuZ2V0Q29sbGVjdGlvbnMoKTtcclxuICAgICAgICB0aGlzLnJldmVyc2VFbnVtcyA9IHRoaXMuZ2FtZS5nZXRSZXZlcnNlRW51bXMoKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENhbGxlZCBhZnRlciBhbGwgc3lzdGVtcyBhcmUgaW5pdGlhbGl6ZWRcclxuICAgICAqL1xyXG4gICAgcG9zdEFsbEluaXQoKSB7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ2FsbGVkIHdoZW4gYSBzY2VuZSBpcyBsb2FkZWRcclxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBzY2VuZURhdGEgLSBUaGUgc2NlbmUgY29uZmlndXJhdGlvbiBkYXRhXHJcbiAgICAgKi9cclxuICAgIG9uU2NlbmVMb2FkKHNjZW5lRGF0YSkge1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENhbGxlZCB3aGVuIGEgc2NlbmUgaXMgdW5sb2FkZWRcclxuICAgICAqL1xyXG4gICAgb25TY2VuZVVubG9hZCgpIHtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDaGVjayBpZiB0aGlzIHN5c3RlbSBpcyByZXF1aXJlZCBmb3IgYSBnaXZlbiBzY2VuZVxyXG4gICAgICogT3ZlcnJpZGUgaW4gc3ViY2xhc3NlcyB0byBtYWtlIHN5c3RlbXMgb3B0aW9uYWwgYmFzZWQgb24gc2NlbmUgY29uZmlnXHJcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gc2NlbmVEYXRhIC0gVGhlIHNjZW5lIGNvbmZpZ3VyYXRpb24gZGF0YVxyXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgdGhpcyBzeXN0ZW0gc2hvdWxkIGJlIGVuYWJsZWQgZm9yIHRoaXMgc2NlbmVcclxuICAgICAqL1xyXG4gICAgaXNSZXF1aXJlZEZvclNjZW5lKHNjZW5lRGF0YSkge1xyXG4gICAgICAgIC8vIElmIHNjZW5lIHNwZWNpZmllcyBzeXN0ZW1zLCBjaGVjayBpZiB0aGlzIHN5c3RlbSBpcyBpbiB0aGUgbGlzdFxyXG4gICAgICAgIGlmIChzY2VuZURhdGE/LnN5c3RlbXMgJiYgQXJyYXkuaXNBcnJheShzY2VuZURhdGEuc3lzdGVtcykpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHNjZW5lRGF0YS5zeXN0ZW1zLmluY2x1ZGVzKHRoaXMuY29uc3RydWN0b3IubmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIERlZmF1bHQ6IGFsd2F5cyByZXF1aXJlZFxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIHVwZGF0ZSgpe1xyXG5cclxuICAgIH1cclxuXHJcbiAgICByZW5kZXIoKSB7XHJcblxyXG4gICAgfVxyXG5cclxufVxyXG5cclxuXHJcbi8vIEFzc2lnbiB0byBnbG9iYWwuR1VUUyBmb3Igc2VydmVyXHJcbmlmICh0eXBlb2YgZ2xvYmFsICE9PSAndW5kZWZpbmVkJyAmJiBnbG9iYWwuR1VUUykge1xyXG4gICAgZ2xvYmFsLkdVVFMuQmFzZVN5c3RlbSA9IEJhc2VTeXN0ZW07XHJcbn1cclxuXHJcbi8vIEVTNiBleHBvcnRzIGZvciB3ZWJwYWNrIGJ1bmRsaW5nXHJcbmV4cG9ydCBkZWZhdWx0IEJhc2VTeXN0ZW07XHJcbmV4cG9ydCB7IEJhc2VTeXN0ZW0gfTtcblxuLy8gQXV0by1nZW5lcmF0ZWQgZXhwb3J0c1xuaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHdpbmRvdy5HVVRTKSB7XG4gIHdpbmRvdy5HVVRTLkJhc2VTeXN0ZW0gPSBCYXNlU3lzdGVtO1xufVxuIl0sIm5hbWVzIjpbIkJhc2VTeXN0ZW0iLCJjb25zdHJ1Y3RvciIsImdhbWUiLCJlbmdpbmUiLCJhcHAiLCJlbmFibGVkIiwiZW51bXMiLCJnZXRFbnVtcyIsImNvbGxlY3Rpb25zIiwiZ2V0Q29sbGVjdGlvbnMiLCJyZXZlcnNlRW51bXMiLCJnZXRSZXZlcnNlRW51bXMiLCJwb3N0QWxsSW5pdCIsIm9uU2NlbmVMb2FkIiwic2NlbmVEYXRhIiwib25TY2VuZVVubG9hZCIsImlzUmVxdWlyZWRGb3JTY2VuZSIsInN5c3RlbXMiLCJBcnJheSIsImlzQXJyYXkiLCJpbmNsdWRlcyIsIm5hbWUiLCJ1cGRhdGUiLCJyZW5kZXIiLCJfZGVmaW5lUHJvcGVydHkiLCJnbG9iYWwiLCJHVVRTIiwid2luZG93Il0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./global/collections/scripts/libraries/js/BaseSystem.js\n\n}");

/***/ }),

/***/ "./global/collections/scripts/libraries/js/SceneManager.js":
/*!*****************************************************************!*\
  !*** ./global/collections/scripts/libraries/js/SceneManager.js ***!
  \*****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SceneManager: () => (/* binding */ SceneManager),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/**\r\n * SceneManager - Handles loading, switching, and managing game scenes\r\n * Scenes define which systems to run and which entities to spawn\r\n */\nclass SceneManager {\n  constructor(game) {\n    this.game = game;\n    this.currentScene = null;\n    this.currentSceneName = null;\n    this.spawnedEntityIds = new Set();\n  }\n\n  /**\r\n   * Load a scene by name\r\n   * @param {string} sceneName - The name of the scene to load (from scenes collection)\r\n   * @returns {Promise<void>}\r\n   */\n  async loadScene(sceneName) {\n    const collections = this.game.getCollections();\n    const sceneData = collections.scenes?.[sceneName];\n    if (!sceneData) {\n      return;\n    }\n\n    // Get systems needed by new scene for smart cleanup\n    // Include base systems + environment-specific systems\n    const isServer = !!this.game.isServer;\n    const baseSystems = sceneData.systems || [];\n    const environmentSystems = isServer ? sceneData.serverSystems || [] : sceneData.clientSystems || [];\n    const newSceneSystems = new Set([...baseSystems, ...environmentSystems]);\n\n    // Unload current scene if one is loaded\n    if (this.currentScene) {\n      await this.unloadCurrentScene(newSceneSystems);\n    }\n    this.currentScene = sceneData;\n    this.currentSceneName = sceneName;\n\n    // Enable/disable systems based on scene configuration\n    this.configureSystems(sceneData);\n\n    // Check if we're loading from a save file\n    const isLoadingSave = !!this.game.pendingSaveData;\n    console.log(`[SceneManager] Loading scene: ${sceneName}, isLoadingSave: ${isLoadingSave}, hasSaveData: ${!!this.game.pendingSaveData}, hasSaveSystem: ${!!this.game.saveSystem}, isServer: ${!!this.game.isServer}`);\n    if (this.game.pendingSaveData) {\n      console.log(`[SceneManager] pendingSaveData has ${this.game.pendingSaveData.entities?.length || 0} entities`);\n    }\n\n    // Set flag so systems know not to spawn starting entities\n    if (isLoadingSave) {\n      this.game.state.isLoadingSave = true;\n    }\n\n    // Spawn entities from scene definition (skip if loading save - save has all entities)\n    if (!isLoadingSave) {\n      await this.spawnSceneEntities(sceneData);\n    } else {\n      console.log(`[SceneManager] Skipping scene entities - loading from save`);\n    }\n\n    // Inject saved entities if there's pending save data\n    if (isLoadingSave) {\n      console.log('[SceneManager] Calling saveSystem.loadSavedEntities(), saveSystem:', this.game.saveSystem ? 'exists' : 'null');\n      if (this.game.saveSystem) {\n        this.game.saveSystem.loadSavedEntities();\n      } else {\n        console.error('[SceneManager] SaveSystem not available but pendingSaveData exists!');\n      }\n    }\n\n    // Notify all systems that scene has loaded (initial setup)\n    await this.notifySceneLoaded(sceneData);\n\n    // Notify all systems for post-load processing (after all systems have done initial setup)\n    this.notifyPostSceneLoad(sceneData);\n  }\n\n  /**\r\n   * Switch to a different scene\r\n   * @param {string} sceneName - The name of the scene to switch to\r\n   * @returns {Promise<void>}\r\n   */\n  async switchScene(sceneName) {\n    await this.loadScene(sceneName);\n  }\n\n  /**\r\n   * Unload the current scene\r\n   * @param {Set<string>} [keepSystems] - System names to keep (needed by next scene)\r\n   * @returns {Promise<void>}\r\n   */\n  async unloadCurrentScene(keepSystems = new Set()) {\n    if (!this.currentScene) return;\n\n    // Clear isLoadingSave flag but preserve pendingSaveData for the next scene\n    this.game.state.isLoadingSave = false;\n    // Note: Don't clear pendingSaveData here - it may be needed for the incoming scene\n\n    // Notify systems that are being unloaded (not kept)\n    this.notifySceneUnloading(keepSystems);\n\n    // Destroy ALL entities - not just scene-spawned ones\n    // This includes dynamically created entities (units, projectiles, etc.)\n    const allEntityIds = this.game.getAllEntities();\n    for (const entityId of allEntityIds) {\n      this.game.destroyEntity(entityId);\n    }\n    this.spawnedEntityIds.clear();\n\n    // Reset entity ID counter so new scene starts fresh\n    this.game.nextEntityId = 1;\n\n    // Destroy systems that are NOT needed by the new scene\n    this.destroyUnneededSystems(keepSystems);\n    this.currentScene = null;\n    this.currentSceneName = null;\n  }\n\n  /**\r\n   * Destroy enabled systems that are not needed by the next scene\r\n   * @param {Set<string>} keepSystems - System names to keep\r\n   */\n  destroyUnneededSystems(keepSystems) {\n    const systemsToRemove = [];\n    for (const system of this.game.systems) {\n      if (system.enabled) {\n        const systemName = system.constructor.name;\n\n        // Skip systems that are needed in the next scene\n        if (keepSystems.has(systemName)) {\n          continue;\n        }\n\n        // Call dispose if available\n        if (system.dispose) {\n          system.dispose();\n        }\n        systemsToRemove.push({\n          system,\n          systemName\n        });\n      }\n    }\n\n    // Remove destroyed systems from arrays and maps\n    for (const {\n      system,\n      systemName\n    } of systemsToRemove) {\n      const index = this.game.systems.indexOf(system);\n      if (index > -1) {\n        this.game.systems.splice(index, 1);\n      }\n      this.game.systemsByName.delete(systemName);\n\n      // Reset the postAllInit flag so it can be called again when reinstantiated\n      system._postAllInitCalled = false;\n    }\n  }\n\n  /**\r\n   * Configure which systems are enabled based on scene configuration\r\n   * Uses lazy instantiation - only creates systems when a scene needs them\r\n   * Supports clientSystems and serverSystems for environment-specific systems\r\n   * @param {Object} sceneData - The scene configuration\r\n   */\n  configureSystems(sceneData) {\n    // Base systems shared by client and server\n    const baseSystems = sceneData.systems || [];\n\n    // Environment-specific systems\n    const isServer = !!this.game.isServer;\n    const environmentSystems = isServer ? sceneData.serverSystems || [] : sceneData.clientSystems || [];\n\n    // Combine base + environment-specific systems\n    const sceneSystems = [...baseSystems, ...environmentSystems];\n\n    // Disable all currently active systems first\n    for (const system of this.game.systems) {\n      system.enabled = false;\n    }\n\n    // Lazily instantiate and enable systems required by this scene\n    for (const systemName of sceneSystems) {\n      const system = this.game.getOrCreateSystem(systemName);\n      if (system) {\n        system.enabled = true;\n      }\n    }\n\n    // Call postAllInit on any newly created systems\n    // (systems that were just instantiated need this called)\n    for (const systemName of sceneSystems) {\n      const system = this.game.systemsByName.get(systemName);\n      if (system && system.postAllInit && !system._postAllInitCalled) {\n        system.postAllInit();\n        system._postAllInitCalled = true;\n      }\n    }\n  }\n\n  /**\r\n   * Spawn all entities defined in the scene (deprecated - entities should be in level data)\r\n   * Only supports type prefab format: { prefab: \"unit\", type: \"dragon_red\", components: {...} }\r\n   * @param {Object} sceneData - The scene configuration\r\n   * @returns {Promise<void>}\r\n   */\n  async spawnSceneEntities(sceneData) {\n    const entities = sceneData.entities || [];\n    if (entities.length === 0) return;\n    const collections = this.game.getCollections();\n    const prefabs = collections.prefabs || {};\n    const enums = this.game.call?.('getEnums');\n    for (const entityDef of entities) {\n      if (!entityDef.prefab || !entityDef.type) {\n        console.warn(`[SceneManager] Entity missing prefab or type:`, entityDef);\n        continue;\n      }\n      const prefabData = prefabs[entityDef.prefab];\n      if (!prefabData) {\n        console.warn(`[SceneManager] Prefab '${entityDef.prefab}' not found`);\n        continue;\n      }\n      const collection = prefabData.collection;\n      if (!collection) {\n        console.warn(`[SceneManager] Prefab '${entityDef.prefab}' missing collection`);\n        continue;\n      }\n\n      // Get team from components or default to neutral\n      const team = entityDef.components?.team?.team ?? enums?.team?.neutral ?? 0;\n\n      // Use createEntityFromPrefab service\n      if (this.game.hasService?.('createEntityFromPrefab')) {\n        const createdId = this.game.call('createEntityFromPrefab', {\n          prefab: entityDef.prefab,\n          type: entityDef.type,\n          collection: collection,\n          team: team,\n          componentOverrides: entityDef.components || {}\n        });\n        if (createdId) {\n          this.spawnedEntityIds.add(createdId);\n        }\n      } else {\n        console.warn(`[SceneManager] createEntityFromPrefab service not available`);\n      }\n    }\n  }\n\n  /**\r\n   * Notify all systems that a scene has been loaded\r\n   * @param {Object} sceneData - The scene configuration\r\n   */\n  async notifySceneLoaded(sceneData) {\n    for (const system of this.game.systems) {\n      if (system.enabled && system.onSceneLoad) {\n        await system.onSceneLoad(sceneData);\n      }\n    }\n  }\n\n  /**\r\n   * Notify all systems after scene load is complete\r\n   * This runs after all systems have done their initial onSceneLoad setup\r\n   * @param {Object} sceneData - The scene configuration\r\n   */\n  notifyPostSceneLoad(sceneData) {\n    for (const system of this.game.systems) {\n      if (system.enabled && system.postSceneLoad) {\n        system.postSceneLoad(sceneData);\n      }\n    }\n  }\n\n  /**\r\n   * Notify systems that the scene is being unloaded\r\n   * Only notifies systems that are being destroyed (not kept for next scene)\r\n   * @param {Set<string>} [keepSystems] - System names that will be kept\r\n   */\n  notifySceneUnloading(keepSystems = new Set()) {\n    for (const system of this.game.systems) {\n      if (system.enabled && system.onSceneUnload) {\n        const systemName = system.constructor.name;\n        // Only call onSceneUnload for systems being destroyed\n        if (!keepSystems.has(systemName)) {\n          system.onSceneUnload();\n        }\n      }\n    }\n  }\n\n  /**\r\n   * Get the current scene data\r\n   * @returns {Object|null} Current scene data or null\r\n   */\n  getCurrentScene() {\n    return this.currentScene;\n  }\n\n  /**\r\n   * Get the current scene name\r\n   * @returns {string|null} Current scene name or null\r\n   */\n  getCurrentSceneName() {\n    return this.currentSceneName;\n  }\n\n  /**\r\n   * Check if a scene is currently loaded\r\n   * @returns {boolean} True if a scene is loaded\r\n   */\n  hasLoadedScene() {\n    return this.currentScene !== null;\n  }\n\n  /**\r\n   * Get list of all available scenes\r\n   * @returns {string[]} Array of scene names\r\n   */\n  getAvailableScenes() {\n    const collections = this.game.getCollections();\n    return Object.keys(collections.scenes || {});\n  }\n}\n\n// ES6 exports for webpack bundling\n// The class-export-loader will automatically add window.GUTS.SceneManager assignment\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (SceneManager);\n\n\n// Auto-generated exports\nif (typeof window !== 'undefined' && window.GUTS) {\n  window.GUTS.SceneManager = SceneManager;\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9nbG9iYWwvY29sbGVjdGlvbnMvc2NyaXB0cy9saWJyYXJpZXMvanMvU2NlbmVNYW5hZ2VyLmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNQSxZQUFZLENBQUM7RUFDZkMsV0FBV0EsQ0FBQ0MsSUFBSSxFQUFFO0lBQ2QsSUFBSSxDQUFDQSxJQUFJLEdBQUdBLElBQUk7SUFDaEIsSUFBSSxDQUFDQyxZQUFZLEdBQUcsSUFBSTtJQUN4QixJQUFJLENBQUNDLGdCQUFnQixHQUFHLElBQUk7SUFDNUIsSUFBSSxDQUFDQyxnQkFBZ0IsR0FBRyxJQUFJQyxHQUFHLENBQUMsQ0FBQztFQUNyQzs7RUFFQTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0VBQ0ksTUFBTUMsU0FBU0EsQ0FBQ0MsU0FBUyxFQUFFO0lBQ3ZCLE1BQU1DLFdBQVcsR0FBRyxJQUFJLENBQUNQLElBQUksQ0FBQ1EsY0FBYyxDQUFDLENBQUM7SUFDOUMsTUFBTUMsU0FBUyxHQUFHRixXQUFXLENBQUNHLE1BQU0sR0FBR0osU0FBUyxDQUFDO0lBRWpELElBQUksQ0FBQ0csU0FBUyxFQUFFO01BQ1o7SUFDSjs7SUFFQTtJQUNBO0lBQ0EsTUFBTUUsUUFBUSxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUNYLElBQUksQ0FBQ1csUUFBUTtJQUNyQyxNQUFNQyxXQUFXLEdBQUdILFNBQVMsQ0FBQ0ksT0FBTyxJQUFJLEVBQUU7SUFDM0MsTUFBTUMsa0JBQWtCLEdBQUdILFFBQVEsR0FDNUJGLFNBQVMsQ0FBQ00sYUFBYSxJQUFJLEVBQUUsR0FDN0JOLFNBQVMsQ0FBQ08sYUFBYSxJQUFJLEVBQUc7SUFDckMsTUFBTUMsZUFBZSxHQUFHLElBQUliLEdBQUcsQ0FBQyxDQUFDLEdBQUdRLFdBQVcsRUFBRSxHQUFHRSxrQkFBa0IsQ0FBQyxDQUFDOztJQUV4RTtJQUNBLElBQUksSUFBSSxDQUFDYixZQUFZLEVBQUU7TUFDbkIsTUFBTSxJQUFJLENBQUNpQixrQkFBa0IsQ0FBQ0Qs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Q0EsaUVBQWVaLFlBQVksRUFBQztBQUNKOztBQUV4QjtBQUNBLElBQUksT0FBT3dGLE1BQU0sS0FBSyxXQUFXLElBQUlBLE1BQU0sQ0FBQ0MsSUFBSSxFQUFFO0VBQ2hERCxNQUFNLENBQUNDLElBQUksQ0FBQ3pGLFlBQVksR0FBR0EsWUFBWTtBQUN6QyIsInNvdXJjZXMiOlsid2VicGFjazovL3Rvd2VyZGVmZW5zZS8uL2dsb2JhbC9jb2xsZWN0aW9ucy9zY3JpcHRzL2xpYnJhcmllcy9qcy9TY2VuZU1hbmFnZXIuanM/NjQ4YiJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogU2NlbmVNYW5hZ2VyIC0gSGFuZGxlcyBsb2FkaW5nLCBzd2l0Y2hpbmcsIGFuZCBtYW5hZ2luZyBnYW1lIHNjZW5lc1xyXG4gKiBTY2VuZXMgZGVmaW5lIHdoaWNoIHN5c3RlbXMgdG8gcnVuIGFuZCB3aGljaCBlbnRpdGllcyB0byBzcGF3blxyXG4gKi9cclxuY2xhc3MgU2NlbmVNYW5hZ2VyIHtcclxuICAgIGNvbnN0cnVjdG9yKGdhbWUpIHtcclxuICAgICAgICB0aGlzLmdhbWUgPSBnYW1lO1xyXG4gICAgICAgIHRoaXMuY3VycmVudFNjZW5lID0gbnVsbDtcclxuICAgICAgICB0aGlzLmN1cnJlbnRTY2VuZU5hbWUgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuc3Bhd25lZEVudGl0eUlkcyA9IG5ldyBTZXQoKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIExvYWQgYSBzY2VuZSBieSBuYW1lXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gc2NlbmVOYW1lIC0gVGhlIG5hbWUgb2YgdGhlIHNjZW5lIHRvIGxvYWQgKGZyb20gc2NlbmVzIGNvbGxlY3Rpb24pXHJcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTx2b2lkPn1cclxuICAgICAqL1xyXG4gICAgYXN5bmMgbG9hZFNjZW5lKHNjZW5lTmFtZSkge1xyXG4gICAgICAgIGNvbnN0IGNvbGxlY3Rpb25zID0gdGhpcy5nYW1lLmdldENvbGxlY3Rpb25zKCk7XHJcbiAgICAgICAgY29uc3Qgc2NlbmVEYXRhID0gY29sbGVjdGlvbnMuc2NlbmVzPy5bc2NlbmVOYW1lXTtcclxuXHJcbiAgICAgICAgaWYgKCFzY2VuZURhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gR2V0IHN5c3RlbXMgbmVlZGVkIGJ5IG5ldyBzY2VuZSBmb3Igc21hcnQgY2xlYW51cFxyXG4gICAgICAgIC8vIEluY2x1ZGUgYmFzZSBzeXN0ZW1zICsgZW52aXJvbm1lbnQtc3BlY2lmaWMgc3lzdGVtc1xyXG4gICAgICAgIGNvbnN0IGlzU2VydmVyID0gISF0aGlzLmdhbWUuaXNTZXJ2ZXI7XHJcbiAgICAgICAgY29uc3QgYmFzZVN5c3RlbXMgPSBzY2VuZURhdGEuc3lzdGVtcyB8fCBbXTtcclxuICAgICAgICBjb25zdCBlbnZpcm9ubWVudFN5c3RlbXMgPSBpc1NlcnZlclxyXG4gICAgICAgICAgICA/IChzY2VuZURhdGEuc2VydmVyU3lzdGVtcyB8fCBbXSlcclxuICAgICAgICAgICAgOiAoc2NlbmVEYXRhLmNsaWVudFN5c3RlbXMgfHwgW10pO1xyXG4gICAgICAgIGNvbnN0IG5ld1NjZW5lU3lzdGVtcyA9IG5ldyBTZXQoWy4uLmJhc2VTeXN0ZW1zLCAuLi5lbnZpcm9ubWVudFN5c3RlbXNdKTtcclxuXHJcbiAgICAgICAgLy8gVW5sb2FkIGN1cnJlbnQgc2NlbmUgaWYgb25lIGlzIGxvYWRlZFxyXG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRTY2VuZSkge1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnVubG9hZEN1cnJlbnRTY2VuZShuZXdTY2VuZVN5c3RlbXMpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5jdXJyZW50U2NlbmUgPSBzY2VuZURhdGE7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50U2NlbmVOYW1lID0gc2NlbmVOYW1lO1xyXG5cclxuICAgICAgICAvLyBFbmFibGUvZGlzYWJsZSBzeXN0ZW1zIGJhc2VkIG9uIHNjZW5lIGNvbmZpZ3VyYXRpb25cclxuICAgICAgICB0aGlzLmNvbmZpZ3VyZVN5c3RlbXMoc2NlbmVEYXRhKTtcclxuXHJcbiAgICAgICAgLy8gQ2hlY2sgaWYgd2UncmUgbG9hZGluZyBmcm9tIGEgc2F2ZSBmaWxlXHJcbiAgICAgICAgY29uc3QgaXNMb2FkaW5nU2F2ZSA9ICEhdGhpcy5nYW1lLnBlbmRpbmdTYXZlRGF0YTtcclxuXHJcbiAgICAgICAgY29uc29sZS5sb2coYFtTY2VuZU1hbmFnZXJdIExvYWRpbmcgc2NlbmU6ICR7c2NlbmVOYW1lfSwgaXNMb2FkaW5nU2F2ZTogJHtpc0xvYWRpbmdTYXZlfSwgaGFzU2F2ZURhdGE6ICR7ISF0aGlzLmdhbWUucGVuZGluZ1NhdmVEYXRhfSwgaGFzU2F2ZVN5c3RlbTogJHshIXRoaXMuZ2FtZS5zYXZlU3lzdGVtfSwgaXNTZXJ2ZXI6ICR7ISF0aGlzLmdhbWUuaXNTZXJ2ZXJ9YCk7XHJcbiAgICAgICAgaWYgKHRoaXMuZ2FtZS5wZW5kaW5nU2F2ZURhdGEpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coYFtTY2VuZU1hbmFnZXJdIHBlbmRpbmdTYXZlRGF0YSBoYXMgJHt0aGlzLmdhbWUucGVuZGluZ1NhdmVEYXRhLmVudGl0aWVzPy5sZW5ndGggfHwgMH0gZW50aXRpZXNgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFNldCBmbGFnIHNvIHN5c3RlbXMga25vdyBub3QgdG8gc3Bhd24gc3RhcnRpbmcgZW50aXRpZXNcclxuICAgICAgICBpZiAoaXNMb2FkaW5nU2F2ZSkge1xyXG4gICAgICAgICAgICB0aGlzLmdhbWUuc3RhdGUuaXNMb2FkaW5nU2F2ZSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBTcGF3biBlbnRpdGllcyBmcm9tIHNjZW5lIGRlZmluaXRpb24gKHNraXAgaWYgbG9hZGluZyBzYXZlIC0gc2F2ZSBoYXMgYWxsIGVudGl0aWVzKVxyXG4gICAgICAgIGlmICghaXNMb2FkaW5nU2F2ZSkge1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnNwYXduU2NlbmVFbnRpdGllcyhzY2VuZURhdGEpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBbU2NlbmVNYW5hZ2VyXSBTa2lwcGluZyBzY2VuZSBlbnRpdGllcyAtIGxvYWRpbmcgZnJvbSBzYXZlYCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBJbmplY3Qgc2F2ZWQgZW50aXRpZXMgaWYgdGhlcmUncyBwZW5kaW5nIHNhdmUgZGF0YVxyXG4gICAgICAgIGlmIChpc0xvYWRpbmdTYXZlKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbU2NlbmVNYW5hZ2VyXSBDYWxsaW5nIHNhdmVTeXN0ZW0ubG9hZFNhdmVkRW50aXRpZXMoKSwgc2F2ZVN5c3RlbTonLCB0aGlzLmdhbWUuc2F2ZVN5c3RlbSA/ICdleGlzdHMnIDogJ251bGwnKTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZ2FtZS5zYXZlU3lzdGVtKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdhbWUuc2F2ZVN5c3RlbS5sb2FkU2F2ZWRFbnRpdGllcygpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignW1NjZW5lTWFuYWdlcl0gU2F2ZVN5c3RlbSBub3QgYXZhaWxhYmxlIGJ1dCBwZW5kaW5nU2F2ZURhdGEgZXhpc3RzIScpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBOb3RpZnkgYWxsIHN5c3RlbXMgdGhhdCBzY2VuZSBoYXMgbG9hZGVkIChpbml0aWFsIHNldHVwKVxyXG4gICAgICAgIGF3YWl0IHRoaXMubm90aWZ5U2NlbmVMb2FkZWQoc2NlbmVEYXRhKTtcclxuXHJcbiAgICAgICAgLy8gTm90aWZ5IGFsbCBzeXN0ZW1zIGZvciBwb3N0LWxvYWQgcHJvY2Vzc2luZyAoYWZ0ZXIgYWxsIHN5c3RlbXMgaGF2ZSBkb25lIGluaXRpYWwgc2V0dXApXHJcbiAgICAgICAgdGhpcy5ub3RpZnlQb3N0U2NlbmVMb2FkKHNjZW5lRGF0YSk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogU3dpdGNoIHRvIGEgZGlmZmVyZW50IHNjZW5lXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gc2NlbmVOYW1lIC0gVGhlIG5hbWUgb2YgdGhlIHNjZW5lIHRvIHN3aXRjaCB0b1xyXG4gICAgICogQHJldHVybnMge1Byb21pc2U8dm9pZD59XHJcbiAgICAgKi9cclxuICAgIGFzeW5jIHN3aXRjaFNjZW5lKHNjZW5lTmFtZSkge1xyXG4gICAgICAgIGF3YWl0IHRoaXMubG9hZFNjZW5lKHNjZW5lTmFtZSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBVbmxvYWQgdGhlIGN1cnJlbnQgc2NlbmVcclxuICAgICAqIEBwYXJhbSB7U2V0PHN0cmluZz59IFtrZWVwU3lzdGVtc10gLSBTeXN0ZW0gbmFtZXMgdG8ga2VlcCAobmVlZGVkIGJ5IG5leHQgc2NlbmUpXHJcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTx2b2lkPn1cclxuICAgICAqL1xyXG4gICAgYXN5bmMgdW5sb2FkQ3VycmVudFNjZW5lKGtlZXBTeXN0ZW1zID0gbmV3IFNldCgpKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmN1cnJlbnRTY2VuZSkgcmV0dXJuO1xyXG5cclxuICAgICAgICAvLyBDbGVhciBpc0xvYWRpbmdTYXZlIGZsYWcgYnV0IHByZXNlcnZlIHBlbmRpbmdTYXZlRGF0YSBmb3IgdGhlIG5leHQgc2NlbmVcclxuICAgICAgICB0aGlzLmdhbWUuc3RhdGUuaXNMb2FkaW5nU2F2ZSA9IGZhbHNlO1xyXG4gICAgICAgIC8vIE5vdGU6IERvbid0IGNsZWFyIHBlbmRpbmdTYXZlRGF0YSBoZXJlIC0gaXQgbWF5IGJlIG5lZWRlZCBmb3IgdGhlIGluY29taW5nIHNjZW5lXHJcblxyXG4gICAgICAgIC8vIE5vdGlmeSBzeXN0ZW1zIHRoYXQgYXJlIGJlaW5nIHVubG9hZGVkIChub3Qga2VwdClcclxuICAgICAgICB0aGlzLm5vdGlmeVNjZW5lVW5sb2FkaW5nKGtlZXBTeXN0ZW1zKTtcclxuXHJcbiAgICAgICAgLy8gRGVzdHJveSBBTEwgZW50aXRpZXMgLSBub3QganVzdCBzY2VuZS1zcGF3bmVkIG9uZXNcclxuICAgICAgICAvLyBUaGlzIGluY2x1ZGVzIGR5bmFtaWNhbGx5IGNyZWF0ZWQgZW50aXRpZXMgKHVuaXRzLCBwcm9qZWN0aWxlcywgZXRjLilcclxuICAgICAgICBjb25zdCBhbGxFbnRpdHlJZHMgPSB0aGlzLmdhbWUuZ2V0QWxsRW50aXRpZXMoKTtcclxuICAgICAgICBmb3IgKGNvbnN0IGVudGl0eUlkIG9mIGFsbEVudGl0eUlkcykge1xyXG4gICAgICAgICAgICB0aGlzLmdhbWUuZGVzdHJveUVudGl0eShlbnRpdHlJZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc3Bhd25lZEVudGl0eUlkcy5jbGVhcigpO1xyXG5cclxuICAgICAgICAvLyBSZXNldCBlbnRpdHkgSUQgY291bnRlciBzbyBuZXcgc2NlbmUgc3RhcnRzIGZyZXNoXHJcbiAgICAgICAgdGhpcy5nYW1lLm5leHRFbnRpdHlJZCA9IDE7XHJcblxyXG4gICAgICAgIC8vIERlc3Ryb3kgc3lzdGVtcyB0aGF0IGFyZSBOT1QgbmVlZGVkIGJ5IHRoZSBuZXcgc2NlbmVcclxuICAgICAgICB0aGlzLmRlc3Ryb3lVbm5lZWRlZFN5c3RlbXMoa2VlcFN5c3RlbXMpO1xyXG5cclxuICAgICAgICB0aGlzLmN1cnJlbnRTY2VuZSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50U2NlbmVOYW1lID0gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIERlc3Ryb3kgZW5hYmxlZCBzeXN0ZW1zIHRoYXQgYXJlIG5vdCBuZWVkZWQgYnkgdGhlIG5leHQgc2NlbmVcclxuICAgICAqIEBwYXJhbSB7U2V0PHN0cmluZz59IGtlZXBTeXN0ZW1zIC0gU3lzdGVtIG5hbWVzIHRvIGtlZXBcclxuICAgICAqL1xyXG4gICAgZGVzdHJveVVubmVlZGVkU3lzdGVtcyhrZWVwU3lzdGVtcykge1xyXG4gICAgICAgIGNvbnN0IHN5c3RlbXNUb1JlbW92ZSA9IFtdO1xyXG5cclxuICAgICAgICBmb3IgKGNvbnN0IHN5c3RlbSBvZiB0aGlzLmdhbWUuc3lzdGVtcykge1xyXG4gICAgICAgICAgICBpZiAoc3lzdGVtLmVuYWJsZWQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHN5c3RlbU5hbWUgPSBzeXN0ZW0uY29uc3RydWN0b3IubmFtZTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBTa2lwIHN5c3RlbXMgdGhhdCBhcmUgbmVlZGVkIGluIHRoZSBuZXh0IHNjZW5lXHJcbiAgICAgICAgICAgICAgICBpZiAoa2VlcFN5c3RlbXMuaGFzKHN5c3RlbU5hbWUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gQ2FsbCBkaXNwb3NlIGlmIGF2YWlsYWJsZVxyXG4gICAgICAgICAgICAgICAgaWYgKHN5c3RlbS5kaXNwb3NlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3lzdGVtLmRpc3Bvc2UoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBzeXN0ZW1zVG9SZW1vdmUucHVzaCh7IHN5c3RlbSwgc3lzdGVtTmFtZSB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gUmVtb3ZlIGRlc3Ryb3llZCBzeXN0ZW1zIGZyb20gYXJyYXlzIGFuZCBtYXBzXHJcbiAgICAgICAgZm9yIChjb25zdCB7IHN5c3RlbSwgc3lzdGVtTmFtZSB9IG9mIHN5c3RlbXNUb1JlbW92ZSkge1xyXG4gICAgICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMuZ2FtZS5zeXN0ZW1zLmluZGV4T2Yoc3lzdGVtKTtcclxuICAgICAgICAgICAgaWYgKGluZGV4ID4gLTEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2FtZS5zeXN0ZW1zLnNwbGljZShpbmRleCwgMSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5nYW1lLnN5c3RlbXNCeU5hbWUuZGVsZXRlKHN5c3RlbU5hbWUpO1xyXG5cclxuICAgICAgICAgICAgLy8gUmVzZXQgdGhlIHBvc3RBbGxJbml0IGZsYWcgc28gaXQgY2FuIGJlIGNhbGxlZCBhZ2FpbiB3aGVuIHJlaW5zdGFudGlhdGVkXHJcbiAgICAgICAgICAgIHN5c3RlbS5fcG9zdEFsbEluaXRDYWxsZWQgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDb25maWd1cmUgd2hpY2ggc3lzdGVtcyBhcmUgZW5hYmxlZCBiYXNlZCBvbiBzY2VuZSBjb25maWd1cmF0aW9uXHJcbiAgICAgKiBVc2VzIGxhenkgaW5zdGFudGlhdGlvbiAtIG9ubHkgY3JlYXRlcyBzeXN0ZW1zIHdoZW4gYSBzY2VuZSBuZWVkcyB0aGVtXHJcbiAgICAgKiBTdXBwb3J0cyBjbGllbnRTeXN0ZW1zIGFuZCBzZXJ2ZXJTeXN0ZW1zIGZvciBlbnZpcm9ubWVudC1zcGVjaWZpYyBzeXN0ZW1zXHJcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gc2NlbmVEYXRhIC0gVGhlIHNjZW5lIGNvbmZpZ3VyYXRpb25cclxuICAgICAqL1xyXG4gICAgY29uZmlndXJlU3lzdGVtcyhzY2VuZURhdGEpIHtcclxuICAgICAgICAvLyBCYXNlIHN5c3RlbXMgc2hhcmVkIGJ5IGNsaWVudCBhbmQgc2VydmVyXHJcbiAgICAgICAgY29uc3QgYmFzZVN5c3RlbXMgPSBzY2VuZURhdGEuc3lzdGVtcyB8fCBbXTtcclxuXHJcbiAgICAgICAgLy8gRW52aXJvbm1lbnQtc3BlY2lmaWMgc3lzdGVtc1xyXG4gICAgICAgIGNvbnN0IGlzU2VydmVyID0gISF0aGlzLmdhbWUuaXNTZXJ2ZXI7XHJcbiAgICAgICAgY29uc3QgZW52aXJvbm1lbnRTeXN0ZW1zID0gaXNTZXJ2ZXJcclxuICAgICAgICAgICAgPyAoc2NlbmVEYXRhLnNlcnZlclN5c3RlbXMgfHwgW10pXHJcbiAgICAgICAgICAgIDogKHNjZW5lRGF0YS5jbGllbnRTeXN0ZW1zIHx8IFtdKTtcclxuXHJcbiAgICAgICAgLy8gQ29tYmluZSBiYXNlICsgZW52aXJvbm1lbnQtc3BlY2lmaWMgc3lzdGVtc1xyXG4gICAgICAgIGNvbnN0IHNjZW5lU3lzdGVtcyA9IFsuLi5iYXNlU3lzdGVtcywgLi4uZW52aXJvbm1lbnRTeXN0ZW1zXTtcclxuXHJcbiAgICAgICAgLy8gRGlzYWJsZSBhbGwgY3VycmVudGx5IGFjdGl2ZSBzeXN0ZW1zIGZpcnN0XHJcbiAgICAgICAgZm9yIChjb25zdCBzeXN0ZW0gb2YgdGhpcy5nYW1lLnN5c3RlbXMpIHtcclxuICAgICAgICAgICAgc3lzdGVtLmVuYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIExhemlseSBpbnN0YW50aWF0ZSBhbmQgZW5hYmxlIHN5c3RlbXMgcmVxdWlyZWQgYnkgdGhpcyBzY2VuZVxyXG4gICAgICAgIGZvciAoY29uc3Qgc3lzdGVtTmFtZSBvZiBzY2VuZVN5c3RlbXMpIHtcclxuICAgICAgICAgICAgY29uc3Qgc3lzdGVtID0gdGhpcy5nYW1lLmdldE9yQ3JlYXRlU3lzdGVtKHN5c3RlbU5hbWUpO1xyXG4gICAgICAgICAgICBpZiAoc3lzdGVtKSB7XHJcbiAgICAgICAgICAgICAgICBzeXN0ZW0uZW5hYmxlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIENhbGwgcG9zdEFsbEluaXQgb24gYW55IG5ld2x5IGNyZWF0ZWQgc3lzdGVtc1xyXG4gICAgICAgIC8vIChzeXN0ZW1zIHRoYXQgd2VyZSBqdXN0IGluc3RhbnRpYXRlZCBuZWVkIHRoaXMgY2FsbGVkKVxyXG4gICAgICAgIGZvciAoY29uc3Qgc3lzdGVtTmFtZSBvZiBzY2VuZVN5c3RlbXMpIHtcclxuICAgICAgICAgICAgY29uc3Qgc3lzdGVtID0gdGhpcy5nYW1lLnN5c3RlbXNCeU5hbWUuZ2V0KHN5c3RlbU5hbWUpO1xyXG4gICAgICAgICAgICBpZiAoc3lzdGVtICYmIHN5c3RlbS5wb3N0QWxsSW5pdCAmJiAhc3lzdGVtLl9wb3N0QWxsSW5pdENhbGxlZCkge1xyXG4gICAgICAgICAgICAgICAgc3lzdGVtLnBvc3RBbGxJbml0KCk7XHJcbiAgICAgICAgICAgICAgICBzeXN0ZW0uX3Bvc3RBbGxJbml0Q2FsbGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFNwYXduIGFsbCBlbnRpdGllcyBkZWZpbmVkIGluIHRoZSBzY2VuZSAoZGVwcmVjYXRlZCAtIGVudGl0aWVzIHNob3VsZCBiZSBpbiBsZXZlbCBkYXRhKVxyXG4gICAgICogT25seSBzdXBwb3J0cyB0eXBlIHByZWZhYiBmb3JtYXQ6IHsgcHJlZmFiOiBcInVuaXRcIiwgdHlwZTogXCJkcmFnb25fcmVkXCIsIGNvbXBvbmVudHM6IHsuLi59IH1cclxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBzY2VuZURhdGEgLSBUaGUgc2NlbmUgY29uZmlndXJhdGlvblxyXG4gICAgICogQHJldHVybnMge1Byb21pc2U8dm9pZD59XHJcbiAgICAgKi9cclxuICAgIGFzeW5jIHNwYXduU2NlbmVFbnRpdGllcyhzY2VuZURhdGEpIHtcclxuICAgICAgICBjb25zdCBlbnRpdGllcyA9IHNjZW5lRGF0YS5lbnRpdGllcyB8fCBbXTtcclxuICAgICAgICBpZiAoZW50aXRpZXMubGVuZ3RoID09PSAwKSByZXR1cm47XHJcblxyXG4gICAgICAgIGNvbnN0IGNvbGxlY3Rpb25zID0gdGhpcy5nYW1lLmdldENvbGxlY3Rpb25zKCk7XHJcbiAgICAgICAgY29uc3QgcHJlZmFicyA9IGNvbGxlY3Rpb25zLnByZWZhYnMgfHwge307XHJcbiAgICAgICAgY29uc3QgZW51bXMgPSB0aGlzLmdhbWUuY2FsbD8uKCdnZXRFbnVtcycpO1xyXG5cclxuICAgICAgICBmb3IgKGNvbnN0IGVudGl0eURlZiBvZiBlbnRpdGllcykge1xyXG4gICAgICAgICAgICBpZiAoIWVudGl0eURlZi5wcmVmYWIgfHwgIWVudGl0eURlZi50eXBlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYFtTY2VuZU1hbmFnZXJdIEVudGl0eSBtaXNzaW5nIHByZWZhYiBvciB0eXBlOmAsIGVudGl0eURlZik7XHJcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29uc3QgcHJlZmFiRGF0YSA9IHByZWZhYnNbZW50aXR5RGVmLnByZWZhYl07XHJcbiAgICAgICAgICAgIGlmICghcHJlZmFiRGF0YSkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBbU2NlbmVNYW5hZ2VyXSBQcmVmYWIgJyR7ZW50aXR5RGVmLnByZWZhYn0nIG5vdCBmb3VuZGApO1xyXG4gICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNvbGxlY3Rpb24gPSBwcmVmYWJEYXRhLmNvbGxlY3Rpb247XHJcbiAgICAgICAgICAgIGlmICghY29sbGVjdGlvbikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBbU2NlbmVNYW5hZ2VyXSBQcmVmYWIgJyR7ZW50aXR5RGVmLnByZWZhYn0nIG1pc3NpbmcgY29sbGVjdGlvbmApO1xyXG4gICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIEdldCB0ZWFtIGZyb20gY29tcG9uZW50cyBvciBkZWZhdWx0IHRvIG5ldXRyYWxcclxuICAgICAgICAgICAgY29uc3QgdGVhbSA9IGVudGl0eURlZi5jb21wb25lbnRzPy50ZWFtPy50ZWFtID8/IGVudW1zPy50ZWFtPy5uZXV0cmFsID8/IDA7XHJcblxyXG4gICAgICAgICAgICAvLyBVc2UgY3JlYXRlRW50aXR5RnJvbVByZWZhYiBzZXJ2aWNlXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmdhbWUuaGFzU2VydmljZT8uKCdjcmVhdGVFbnRpdHlGcm9tUHJlZmFiJykpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNyZWF0ZWRJZCA9IHRoaXMuZ2FtZS5jYWxsKCdjcmVhdGVFbnRpdHlGcm9tUHJlZmFiJywge1xyXG4gICAgICAgICAgICAgICAgICAgIHByZWZhYjogZW50aXR5RGVmLnByZWZhYixcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiBlbnRpdHlEZWYudHlwZSxcclxuICAgICAgICAgICAgICAgICAgICBjb2xsZWN0aW9uOiBjb2xsZWN0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgIHRlYW06IHRlYW0sXHJcbiAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50T3ZlcnJpZGVzOiBlbnRpdHlEZWYuY29tcG9uZW50cyB8fCB7fVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGNyZWF0ZWRJZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3Bhd25lZEVudGl0eUlkcy5hZGQoY3JlYXRlZElkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihgW1NjZW5lTWFuYWdlcl0gY3JlYXRlRW50aXR5RnJvbVByZWZhYiBzZXJ2aWNlIG5vdCBhdmFpbGFibGVgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIE5vdGlmeSBhbGwgc3lzdGVtcyB0aGF0IGEgc2NlbmUgaGFzIGJlZW4gbG9hZGVkXHJcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gc2NlbmVEYXRhIC0gVGhlIHNjZW5lIGNvbmZpZ3VyYXRpb25cclxuICAgICAqL1xyXG4gICAgYXN5bmMgbm90aWZ5U2NlbmVMb2FkZWQoc2NlbmVEYXRhKSB7XHJcbiAgICAgICAgZm9yIChjb25zdCBzeXN0ZW0gb2YgdGhpcy5nYW1lLnN5c3RlbXMpIHtcclxuICAgICAgICAgICAgaWYgKHN5c3RlbS5lbmFibGVkICYmIHN5c3RlbS5vblNjZW5lTG9hZCkge1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgc3lzdGVtLm9uU2NlbmVMb2FkKHNjZW5lRGF0YSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBOb3RpZnkgYWxsIHN5c3RlbXMgYWZ0ZXIgc2NlbmUgbG9hZCBpcyBjb21wbGV0ZVxyXG4gICAgICogVGhpcyBydW5zIGFmdGVyIGFsbCBzeXN0ZW1zIGhhdmUgZG9uZSB0aGVpciBpbml0aWFsIG9uU2NlbmVMb2FkIHNldHVwXHJcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gc2NlbmVEYXRhIC0gVGhlIHNjZW5lIGNvbmZpZ3VyYXRpb25cclxuICAgICAqL1xyXG4gICAgbm90aWZ5UG9zdFNjZW5lTG9hZChzY2VuZURhdGEpIHtcclxuICAgICAgICBmb3IgKGNvbnN0IHN5c3RlbSBvZiB0aGlzLmdhbWUuc3lzdGVtcykge1xyXG4gICAgICAgICAgICBpZiAoc3lzdGVtLmVuYWJsZWQgJiYgc3lzdGVtLnBvc3RTY2VuZUxvYWQpIHtcclxuICAgICAgICAgICAgICAgIHN5c3RlbS5wb3N0U2NlbmVMb2FkKHNjZW5lRGF0YSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBOb3RpZnkgc3lzdGVtcyB0aGF0IHRoZSBzY2VuZSBpcyBiZWluZyB1bmxvYWRlZFxyXG4gICAgICogT25seSBub3RpZmllcyBzeXN0ZW1zIHRoYXQgYXJlIGJlaW5nIGRlc3Ryb3llZCAobm90IGtlcHQgZm9yIG5leHQgc2NlbmUpXHJcbiAgICAgKiBAcGFyYW0ge1NldDxzdHJpbmc+fSBba2VlcFN5c3RlbXNdIC0gU3lzdGVtIG5hbWVzIHRoYXQgd2lsbCBiZSBrZXB0XHJcbiAgICAgKi9cclxuICAgIG5vdGlmeVNjZW5lVW5sb2FkaW5nKGtlZXBTeXN0ZW1zID0gbmV3IFNldCgpKSB7XHJcbiAgICAgICAgZm9yIChjb25zdCBzeXN0ZW0gb2YgdGhpcy5nYW1lLnN5c3RlbXMpIHtcclxuICAgICAgICAgICAgaWYgKHN5c3RlbS5lbmFibGVkICYmIHN5c3RlbS5vblNjZW5lVW5sb2FkKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzeXN0ZW1OYW1lID0gc3lzdGVtLmNvbnN0cnVjdG9yLm5hbWU7XHJcbiAgICAgICAgICAgICAgICAvLyBPbmx5IGNhbGwgb25TY2VuZVVubG9hZCBmb3Igc3lzdGVtcyBiZWluZyBkZXN0cm95ZWRcclxuICAgICAgICAgICAgICAgIGlmICgha2VlcFN5c3RlbXMuaGFzKHN5c3RlbU5hbWUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3lzdGVtLm9uU2NlbmVVbmxvYWQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEdldCB0aGUgY3VycmVudCBzY2VuZSBkYXRhXHJcbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fG51bGx9IEN1cnJlbnQgc2NlbmUgZGF0YSBvciBudWxsXHJcbiAgICAgKi9cclxuICAgIGdldEN1cnJlbnRTY2VuZSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jdXJyZW50U2NlbmU7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXQgdGhlIGN1cnJlbnQgc2NlbmUgbmFtZVxyXG4gICAgICogQHJldHVybnMge3N0cmluZ3xudWxsfSBDdXJyZW50IHNjZW5lIG5hbWUgb3IgbnVsbFxyXG4gICAgICovXHJcbiAgICBnZXRDdXJyZW50U2NlbmVOYW1lKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRTY2VuZU5hbWU7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDaGVjayBpZiBhIHNjZW5lIGlzIGN1cnJlbnRseSBsb2FkZWRcclxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIGEgc2NlbmUgaXMgbG9hZGVkXHJcbiAgICAgKi9cclxuICAgIGhhc0xvYWRlZFNjZW5lKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRTY2VuZSAhPT0gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEdldCBsaXN0IG9mIGFsbCBhdmFpbGFibGUgc2NlbmVzXHJcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nW119IEFycmF5IG9mIHNjZW5lIG5hbWVzXHJcbiAgICAgKi9cclxuICAgIGdldEF2YWlsYWJsZVNjZW5lcygpIHtcclxuICAgICAgICBjb25zdCBjb2xsZWN0aW9ucyA9IHRoaXMuZ2FtZS5nZXRDb2xsZWN0aW9ucygpO1xyXG4gICAgICAgIHJldHVybiBPYmplY3Qua2V5cyhjb2xsZWN0aW9ucy5zY2VuZXMgfHwge30pO1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyBFUzYgZXhwb3J0cyBmb3Igd2VicGFjayBidW5kbGluZ1xyXG4vLyBUaGUgY2xhc3MtZXhwb3J0LWxvYWRlciB3aWxsIGF1dG9tYXRpY2FsbHkgYWRkIHdpbmRvdy5HVVRTLlNjZW5lTWFuYWdlciBhc3NpZ25tZW50XHJcbmV4cG9ydCBkZWZhdWx0IFNjZW5lTWFuYWdlcjtcclxuZXhwb3J0IHsgU2NlbmVNYW5hZ2VyIH07XG5cbi8vIEF1dG8tZ2VuZXJhdGVkIGV4cG9ydHNcbmlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cuR1VUUykge1xuICB3aW5kb3cuR1VUUy5TY2VuZU1hbmFnZXIgPSBTY2VuZU1hbmFnZXI7XG59XG4iXSwibmFtZXMiOlsiU2NlbmVNYW5hZ2VyIiwiY29uc3RydWN0b3IiLCJnYW1lIiwiY3VycmVudFNjZW5lIiwiY3VycmVudFNjZW5lTmFtZSIsInNwYXduZWRFbnRpdHlJZHMiLCJTZXQiLCJsb2FkU2NlbmUiLCJzY2VuZU5hbWUiLCJjb2xsZWN0aW9ucyIsImdldENvbGxlY3Rpb25zIiwic2NlbmVEYXRhIiwic2NlbmVzIiwiaXNTZXJ2ZXIiLCJiYXNlU3lzdGVtcyIsInN5c3RlbXMiLCJlbnZpcm9ubWVudFN5c3RlbXMiLCJzZXJ2ZXJTeXN0ZW1zIiwiY2xpZW50U3lzdGVtcyIsIm5ld1NjZW5lU3lzdGVtcyIsInVubG9hZEN1cnJlbnRTY2VuZSIsImNvbmZpZ3VyZVN5c3RlbXMiLCJpc0xvYWRpbmdTYXZlIiwicGVuZGluZ1NhdmVEYXRhIiwiY29uc29sZSIsImxvZyIsInNhdmVTeXN0ZW0iLCJlbnRpdGllcyIsImxlbmd0aCIsInN0YXRlIiwic3Bhd25TY2VuZUVudGl0aWVzIiwibG9hZFNhdmVkRW50aXRpZXMiLCJlcnJvciIsIm5vdGlmeVNjZW5lTG9hZGVkIiwibm90aWZ5UG9zdFNjZW5lTG9hZCIsInN3aXRjaFNjZW5lIiwia2VlcFN5c3RlbXMiLCJub3RpZnlTY2VuZVVubG9hZGluZyIsImFsbEVudGl0eUlkcyIsImdldEFsbEVudGl0aWVzIiwiZW50aXR5SWQiLCJkZXN0cm95RW50aXR5IiwiY2xlYXIiLCJuZXh0RW50aXR5SWQiLCJkZXN0cm95VW5uZWVkZWRTeXN0ZW1zIiwic3lzdGVtc1RvUmVtb3ZlIiwic3lzdGVtIiwiZW5hYmxlZCIsInN5c3RlbU5hbWUiLCJuYW1lIiwiaGFzIiwiZGlzcG9zZSIsInB1c2giLCJpbmRleCIsImluZGV4T2YiLCJzcGxpY2UiLCJzeXN0ZW1zQnlOYW1lIiwiZGVsZXRlIiwiX3Bvc3RBbGxJbml0Q2FsbGVkIiwic2NlbmVTeXN0ZW1zIiwiZ2V0T3JDcmVhdGVTeXN0ZW0iLCJnZXQiLCJwb3N0QWxsSW5pdCIsInByZWZhYnMiLCJlbnVtcyIsImNhbGwiLCJlbnRpdHlEZWYiLCJwcmVmYWIiLCJ0eXBlIiwid2FybiIsInByZWZhYkRhdGEiLCJjb2xsZWN0aW9uIiwidGVhbSIsImNvbXBvbmVudHMiLCJuZXV0cmFsIiwiaGFzU2VydmljZSIsImNyZWF0ZWRJZCIsImNvbXBvbmVudE92ZXJyaWRlcyIsImFkZCIsIm9uU2NlbmVMb2FkIiwicG9zdFNjZW5lTG9hZCIsIm9uU2NlbmVVbmxvYWQiLCJnZXRDdXJyZW50U2NlbmUiLCJnZXRDdXJyZW50U2NlbmVOYW1lIiwiaGFzTG9hZGVkU2NlbmUiLCJnZXRBdmFpbGFibGVTY2VuZXMiLCJPYmplY3QiLCJrZXlzIiwid2luZG93IiwiR1VUUyJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./global/collections/scripts/libraries/js/SceneManager.js\n\n}");

/***/ }),

/***/ "./projects/HelloWorld/collections/data/scenes/hello.json":
/*!****************************************************************!*\
  !*** ./projects/HelloWorld/collections/data/scenes/hello.json ***!
  \****************************************************************/
/***/ ((module) => {

"use strict";
module.exports = /*#__PURE__*/JSON.parse('{"title":"Hello Scene","systems":["HelloSystem"],"entities":[]}');

/***/ }),

/***/ "./projects/HelloWorld/collections/scripts/systems/data/HelloSystem.json":
/*!*******************************************************************************!*\
  !*** ./projects/HelloWorld/collections/scripts/systems/data/HelloSystem.json ***!
  \*******************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = /*#__PURE__*/JSON.parse('{"title":"HelloSystem","description":"A simple system that displays Hello World"}');

/***/ }),

/***/ "./projects/HelloWorld/collections/scripts/systems/js/HelloSystem.js":
/*!***************************************************************************!*\
  !*** ./projects/HelloWorld/collections/scripts/systems/js/HelloSystem.js ***!
  \***************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   HelloSystem: () => (/* binding */ HelloSystem),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nclass HelloSystem extends GUTS.BaseSystem {\n  constructor(game) {\n    super(game);\n    this.game.helloSystem = this;\n    this.messageDisplayed = false;\n  }\n  init() {\n    // Register any game manager functions here\n  }\n  onSceneLoad(sceneData) {\n    console.log('[HelloSystem] Hello World scene loaded!');\n  }\n  update() {\n    // Called every frame - could animate the message here\n  }\n  onSceneUnload() {\n    // Clean up when scene unloads\n    const overlay = document.getElementById('hello-overlay');\n    if (overlay) {\n      overlay.remove();\n    }\n  }\n}\n\n// Auto-generated exports\nif (typeof window !== 'undefined' && window.GUTS) {\n  window.GUTS.HelloSystem = HelloSystem;\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (HelloSystem);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9wcm9qZWN0cy9IZWxsb1dvcmxkL2NvbGxlY3Rpb25zL3NjcmlwdHMvc3lzdGVtcy9qcy9IZWxsb1N5c3RlbS5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUFBLE1BQU1BLFdBQVcsU0FBU0MsSUFBSSxDQUFDQyxVQUFVLENBQUM7RUFDdENDLFdBQVdBLENBQUNDLElBQUksRUFBRTtJQUNkLEtBQUssQ0FBQ0EsSUFBSSxDQUFDO0lBQ1gsSUFBSSxDQUFDQSxJQUFJLENBQUNDLFdBQVcsR0FBRyxJQUFJO0lBQzVCLElBQUksQ0FBQ0MsZ0JBQWdCLEdBQUcsS0FBSztFQUNqQztFQUVBQyxJQUFJQSxDQUFBLEVBQUc7SUFDSDtFQUFBO0VBR0pDLFdBQVdBLENBQUNDLFNBQVMsRUFBRTtJQUNuQkMsT0FBTyxDQUFDQyxHQUFHLENBQUMseUNBQXlDLENBQUM7RUFFMUQ7RUFFQUMsTUFBTUEsQ0FBQSxFQUFHO0lBQ0w7RUFBQTtFQUdKQyxhQUFhQSxDQUFBLEVBQUc7SUFDWjtJQUNBLE1BQU1DLE9BQU8sR0FBR0MsUUFBUSxDQUFDQyxjQUFjLENBQUMsZUFBZSxDQUFDO0lBQ3hELElBQUlGLE9BQU8sRUFBRTtNQUNUQSxPQUFPLENBQUNHLE1BQU0sQ0FBQyxDQUFDO0lBQ3BCO0VBQ0o7QUFDSjs7QUFFQTtBQUNBLElBQUksT0FBT0MsTUFBTSxLQUFLLFdBQVcsSUFBSUEsTUFBTSxDQUFDakIsSUFBSSxFQUFFO0VBQ2hEaUIsTUFBTSxDQUFDakIsSUFBSSxDQUFDRCxXQUFXLEdBQUdBLFdBQVc7QUFDdkM7QUFFQSxpRUFBZUEsV0FBVyxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdG93ZXJkZWZlbnNlLy4vcHJvamVjdHMvSGVsbG9Xb3JsZC9jb2xsZWN0aW9ucy9zY3JpcHRzL3N5c3RlbXMvanMvSGVsbG9TeXN0ZW0uanM/NDlkOCJdLCJzb3VyY2VzQ29udGVudCI6WyJjbGFzcyBIZWxsb1N5c3RlbSBleHRlbmRzIEdVVFMuQmFzZVN5c3RlbSB7XHJcbiAgICBjb25zdHJ1Y3RvcihnYW1lKSB7XHJcbiAgICAgICAgc3VwZXIoZ2FtZSk7XHJcbiAgICAgICAgdGhpcy5nYW1lLmhlbGxvU3lzdGVtID0gdGhpcztcclxuICAgICAgICB0aGlzLm1lc3NhZ2VEaXNwbGF5ZWQgPSBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBpbml0KCkge1xyXG4gICAgICAgIC8vIFJlZ2lzdGVyIGFueSBnYW1lIG1hbmFnZXIgZnVuY3Rpb25zIGhlcmVcclxuICAgIH1cclxuXHJcbiAgICBvblNjZW5lTG9hZChzY2VuZURhdGEpIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnW0hlbGxvU3lzdGVtXSBIZWxsbyBXb3JsZCBzY2VuZSBsb2FkZWQhJyk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHVwZGF0ZSgpIHtcclxuICAgICAgICAvLyBDYWxsZWQgZXZlcnkgZnJhbWUgLSBjb3VsZCBhbmltYXRlIHRoZSBtZXNzYWdlIGhlcmVcclxuICAgIH1cclxuXHJcbiAgICBvblNjZW5lVW5sb2FkKCkge1xyXG4gICAgICAgIC8vIENsZWFuIHVwIHdoZW4gc2NlbmUgdW5sb2Fkc1xyXG4gICAgICAgIGNvbnN0IG92ZXJsYXkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVsbG8tb3ZlcmxheScpO1xyXG4gICAgICAgIGlmIChvdmVybGF5KSB7XHJcbiAgICAgICAgICAgIG92ZXJsYXkucmVtb3ZlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XG5cbi8vIEF1dG8tZ2VuZXJhdGVkIGV4cG9ydHNcbmlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cuR1VUUykge1xuICB3aW5kb3cuR1VUUy5IZWxsb1N5c3RlbSA9IEhlbGxvU3lzdGVtO1xufVxuXG5leHBvcnQgZGVmYXVsdCBIZWxsb1N5c3RlbTtcbmV4cG9ydCB7IEhlbGxvU3lzdGVtIH07XG4iXSwibmFtZXMiOlsiSGVsbG9TeXN0ZW0iLCJHVVRTIiwiQmFzZVN5c3RlbSIsImNvbnN0cnVjdG9yIiwiZ2FtZSIsImhlbGxvU3lzdGVtIiwibWVzc2FnZURpc3BsYXllZCIsImluaXQiLCJvblNjZW5lTG9hZCIsInNjZW5lRGF0YSIsImNvbnNvbGUiLCJsb2ciLCJ1cGRhdGUiLCJvblNjZW5lVW5sb2FkIiwib3ZlcmxheSIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJyZW1vdmUiLCJ3aW5kb3ciXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./projects/HelloWorld/collections/scripts/systems/js/HelloSystem.js\n\n}");

/***/ }),

/***/ "./projects/HelloWorld/collections/settings/configs/game.json":
/*!********************************************************************!*\
  !*** ./projects/HelloWorld/collections/settings/configs/game.json ***!
  \********************************************************************/
/***/ ((module) => {

"use strict";
module.exports = /*#__PURE__*/JSON.parse('{"title":"Hello World","gridSize":48,"imageSize":128,"is3D":true,"isIsometric":false,"libraries":["BaseECSGame","SceneManager","BaseSystem","BaseLoader"],"systems":["HelloSystem"],"classes":[],"interface":"main","appLibrary":"BaseECSGame","appLoaderLibrary":"BaseLoader","canvasWidth":800,"canvasHeight":600,"initialScene":"hello"}');

/***/ }),

/***/ "./projects/HelloWorld/collections/settings/configs/state.json":
/*!*********************************************************************!*\
  !*** ./projects/HelloWorld/collections/settings/configs/state.json ***!
  \*********************************************************************/
/***/ ((module) => {

"use strict";
module.exports = {"isPaused":false};

/***/ }),

/***/ "./projects/HelloWorld/collections/settings/objectTypeCategories/data.json":
/*!*********************************************************************************!*\
  !*** ./projects/HelloWorld/collections/settings/objectTypeCategories/data.json ***!
  \*********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = {"title":"Data"};

/***/ }),

/***/ "./projects/HelloWorld/collections/settings/objectTypeCategories/scripts.json":
/*!************************************************************************************!*\
  !*** ./projects/HelloWorld/collections/settings/objectTypeCategories/scripts.json ***!
  \************************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = {"title":"Scripts"};

/***/ }),

/***/ "./projects/HelloWorld/collections/settings/objectTypeCategories/ui.json":
/*!*******************************************************************************!*\
  !*** ./projects/HelloWorld/collections/settings/objectTypeCategories/ui.json ***!
  \*******************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = {"title":"UI"};

/***/ }),

/***/ "./projects/HelloWorld/collections/settings/objectTypeDefinitions/interfaces.json":
/*!****************************************************************************************!*\
  !*** ./projects/HelloWorld/collections/settings/objectTypeDefinitions/interfaces.json ***!
  \****************************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = /*#__PURE__*/JSON.parse('{"id":"interfaces","name":"Interfaces","singular":"Interface","objectTypeCategory":"ui"}');

/***/ }),

/***/ "./projects/HelloWorld/collections/settings/objectTypeDefinitions/scenes.json":
/*!************************************************************************************!*\
  !*** ./projects/HelloWorld/collections/settings/objectTypeDefinitions/scenes.json ***!
  \************************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = /*#__PURE__*/JSON.parse('{"id":"scenes","name":"Scenes","singular":"scene","objectTypeCategory":"data"}');

/***/ }),

/***/ "./projects/HelloWorld/collections/settings/objectTypeDefinitions/systems.json":
/*!*************************************************************************************!*\
  !*** ./projects/HelloWorld/collections/settings/objectTypeDefinitions/systems.json ***!
  \*************************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = /*#__PURE__*/JSON.parse('{"id":"systems","name":"Systems","singular":"system","objectTypeCategory":"scripts"}');

/***/ }),

/***/ "./projects/HelloWorld/collections/ui/interfaces/css/main.css":
/*!********************************************************************!*\
  !*** ./projects/HelloWorld/collections/ui/interfaces/css/main.css ***!
  \********************************************************************/
/***/ ((module) => {

"use strict";
module.exports = "body {\r\n    background-color: black;\r\n    color: white;\r\n}\r\n\r\n#appContainer {\r\n    width: 72%;\r\n    height: 48px;\r\n    left: 0;\r\n    right: 0;\r\n    top: 0;\r\n    bottom: 0;\r\n    margin: auto;\r\n    font-size: 2em;\r\n    position: absolute;\r\n    display: block;\r\n    text-align: center;\r\n}";

/***/ }),

/***/ "./projects/HelloWorld/collections/ui/interfaces/data/main.json":
/*!**********************************************************************!*\
  !*** ./projects/HelloWorld/collections/ui/interfaces/data/main.json ***!
  \**********************************************************************/
/***/ ((module) => {

"use strict";
module.exports = /*#__PURE__*/JSON.parse('{"title":"Main Interface","modals":[],"fileName":"main"}');

/***/ }),

/***/ "./projects/HelloWorld/collections/ui/interfaces/html/main.html":
/*!**********************************************************************!*\
  !*** ./projects/HelloWorld/collections/ui/interfaces/html/main.html ***!
  \**********************************************************************/
/***/ ((module) => {

"use strict";
module.exports = "<div id=\"gameContainer\" class=\"screen active\">\r\n    Hello World!\r\n</div>\r\n";

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/compat get default export */
/******/ 	(() => {
/******/ 		// getDefaultExport function for compatibility with non-harmony modules
/******/ 		__webpack_require__.n = (module) => {
/******/ 			var getter = module && module.__esModule ?
/******/ 				() => (module['default']) :
/******/ 				() => (module);
/******/ 			__webpack_require__.d(getter, { a: getter });
/******/ 			return getter;
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/global */
/******/ 	(() => {
/******/ 		__webpack_require__.g = (function() {
/******/ 			if (typeof globalThis === 'object') return globalThis;
/******/ 			try {
/******/ 				return this || new Function('return this')();
/******/ 			} catch (e) {
/******/ 				if (typeof window === 'object') return window;
/******/ 			}
/******/ 		})();
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval-source-map devtool is used.
/******/ 	var __webpack_exports__ = __webpack_require__("./build/.temp/HelloWorld/combined-entry.js");
/******/ 	
/******/ })()
;