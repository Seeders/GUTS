const DEFAULT_PROJECT_CONFIG = {
  "objectTypes": {
    "attackSounds": {
      "missileLaunch": {
        "title": "Missile Launch",
        "audio": {
          "waveform": "noise",
          "frequency": 341,
          "duration": 0.4,
          "noise": {
            "type": "brown",
            "amount": 0.63,
            "filter": {
              "type": "bandpass",
              "frequency": 20
            }
          },
          "envelope": {
            "attack": 0.252,
            "decay": 0.4,
            "sustain": 0,
            "release": 0.001
          },
          "pitchEnvelope": {
            "start": 3.38,
            "end": 0.59,
            "time": 0.4
          },
          "effects": {
            "filter": {
              "type": "lowpass",
              "frequency": 20000,
              "Q": 1
            },
            "distortion": 0,
            "delay": {
              "time": 0,
              "feedback": 0
            },
            "reverb": 0.11,
            "bitcrusher": 0,
            "pan": 0
          }
        }
      },
      "plasma": {
        "title": "Plasma",
        "audio": {
          "waveform": "triangle",
          "frequency": 197,
          "duration": 0.1,
          "envelope": {
            "attack": 0.001,
            "decay": 0.076,
            "sustain": 0.5,
            "release": 0.001
          },
          "pitchEnvelope": {
            "start": 3.41,
            "end": 0.23,
            "time": 0.1
          },
          "effects": {
            "filter": {
              "type": "lowpass",
              "frequency": 400,
              "Q": 1
            },
            "distortion": 5,
            "delay": {
              "time": 0,
              "feedback": 0
            },
            "reverb": 0,
            "bitcrusher": 0,
            "pan": 0
          }
        }
      },
      "TeslaAttack": {
        "title": "Tesla Attack",
        "audio": {
          "waveform": "noise",
          "frequency": 200,
          "duration": 0.15,
          "envelope": {
            "attack": 0.001,
            "decay": 0.03,
            "sustain": 0.4,
            "release": 0.02
          },
          "pitchEnvelope": {
            "start": 2.5,
            "end": 0.8,
            "time": 0.15
          },
          "effects": {
            "filter": {
              "type": "bandpass",
              "frequency": 1200,
              "Q": 3
            },
            "distortion": 30,
            "delay": {
              "time": 0.05,
              "feedback": 0.05
            },
            "reverb": 0.05,
            "bitcrusher": 0.5,
            "pan": 0
          }
        }
      },
      "gunshot": {
        "title": "GunShot",
        "audio": {
          "waveform": "noise",
          "frequency": 200,
          "duration": 0.5,
          "noise": {
            "type": "pink",
            "amount": 0.8,
            "filter": {
              "type": "lowpass",
              "frequency": 400
            }
          },
          "envelope": {
            "attack": 0.01,
            "decay": 0.3,
            "sustain": 0.2,
            "release": 0.1
          },
          "pitchEnvelope": {
            "start": 4,
            "end": 2,
            "time": 0.5
          },
          "effects": {
            "filter": {
              "type": "lowpass",
              "frequency": 800,
              "Q": 1
            },
            "distortion": 2,
            "delay": {
              "time": 0.1,
              "feedback": 0.3
            },
            "reverb": 0.4,
            "bitcrusher": 0.5,
            "pan": 0
          }
        }
      },
      "laser": {
        "title": "Laser",
        "audio": {
          "waveform": "triangle",
          "frequency": 197,
          "duration": 0.1,
          "envelope": {
            "attack": 0.001,
            "decay": 0.076,
            "sustain": 0.5,
            "release": 0.001
          },
          "pitchEnvelope": {
            "start": 3.41,
            "end": 0.23,
            "time": 0.1
          },
          "effects": {
            "filter": {
              "type": "lowpass",
              "frequency": 400,
              "Q": 1
            },
            "distortion": 5,
            "delay": {
              "time": 0.27,
              "feedback": 0.09
            },
            "reverb": 0,
            "bitcrusher": 0,
            "pan": 0
          }
        }
      }
    },
    "hitSounds": {
      "explosion": {
        "title": "Explosion",
        "audio": {
          "waveform": "noise",
          "frequency": 100,
          "duration": 1,
          "noise": {
            "type": "white",
            "amount": 0,
            "filter": {
              "type": "none",
              "frequency": 2000
            }
          },
          "envelope": {
            "attack": 0.005,
            "decay": 0.2,
            "sustain": 0.3,
            "release": 0.3
          },
          "pitchEnvelope": {
            "start": 2,
            "end": 0.5,
            "time": 1
          },
          "effects": {
            "filter": {
              "type": "lowpass",
              "frequency": 800,
              "Q": 1
            },
            "distortion": 3,
            "delay": {
              "time": 0.15,
              "feedback": 0.25
            },
            "reverb": 0.5,
            "bitcrusher": 0.5,
            "pan": 0
          }
        }
      },
      "plasma": {
        "title": "Plasma",
        "audio": {
          "waveform": "noise",
          "frequency": 73,
          "duration": 0.1,
          "envelope": {
            "attack": 0.001,
            "decay": 2,
            "sustain": 0,
            "release": 0.001
          },
          "pitchEnvelope": {
            "start": 0.97,
            "end": 1.01,
            "time": 0.1
          },
          "effects": {
            "filter": {
              "type": "lowpass",
              "frequency": 70,
              "Q": 2
            },
            "distortion": 3,
            "delay": {
              "time": 0,
              "feedback": 0
            },
            "reverb": 0,
            "bitcrusher": 0.1,
            "pan": 0
          }
        }
      }
    },
    "sounds": {
      "test": {
        "title": "test",
        "audio": {
          "waveform": "noise",
          "frequency": 440,
          "duration": 0.6,
          "noise": {
            "type": "pink",
            "amount": 1,
            "filter": {
              "type": "bandpass",
              "frequency": 1200,
              "Q": 1.8
            }
          },
          "envelope": {
            "attack": 0.02,
            "decay": 0.4,
            "sustain": 0,
            "release": 0
          },
          "pitchEnvelope": {
            "start": 1.8,
            "end": 0.4,
            "time": 0.5
          },
          "effects": {
            "filter": {
              "type": "none",
              "frequency": 20000,
              "Q": 1
            },
            "distortion": 0.2,
            "delay": {
              "time": 0,
              "feedback": 0
            },
            "reverb": 0.15,
            "bitcrusher": 0,
            "pan": 0
          }
        }
      },
      "pickup": {
        "title": "Pickup",
        "audio": {
          "waveform": "triangle",
          "frequency": 200,
          "duration": 0.1,
          "envelope": {
            "attack": 0.001,
            "decay": 0,
            "sustain": 0,
            "release": 0.001
          },
          "pitchEnvelope": {
            "start": 0.34,
            "end": 1.89,
            "time": 0.1
          },
          "effects": {
            "filter": {
              "type": "lowpass",
              "frequency": 400,
              "Q": 1
            },
            "distortion": 20,
            "delay": {
              "time": 0,
              "feedback": 0.2
            },
            "reverb": 0,
            "bitcrusher": 0.1,
            "pan": 0
          }
        }
      },
      "placeTower": {
        "title": "Place Tower",
        "audio": {
          "waveform": "sine",
          "frequency": 20,
          "duration": 0.2,
          "noise": {
            "type": "pink",
            "amount": 0.8,
            "filter": {
              "type": "lowpass",
              "frequency": 400
            }
          },
          "envelope": {
            "attack": 0.01,
            "decay": 0,
            "sustain": 0.1,
            "release": 0.001
          },
          "pitchEnvelope": {
            "start": 4,
            "end": 4,
            "time": 0.2
          },
          "effects": {
            "filter": {
              "type": "lowpass",
              "frequency": 500,
              "Q": 1
            },
            "distortion": 0,
            "delay": {
              "time": 0.05,
              "feedback": 0.2
            },
            "reverb": 0.3,
            "bitcrusher": 0.4,
            "pan": 0
          }
        }
      }
    },
    "effects": {
      "weaken": {
        "id": "weaken",
        "title": "Weakened",
        "desc": "Target's armor is reduced",
        "stat": "armor",
        "lifeTime": 100
      },
      "slow": {
        "id": "slow",
        "title": "Slow",
        "desc": "Target is slowed",
        "stat": "speed",
        "lifeTime": 100
      }
    },
    "gameEvents": {
      "placeTower": {
        "title": "Place Tower",
        "sound": "placeTower"
      }
    },
    "modifierSets": {
      "global": {
        "maxBloodCoreHP": 100,
        "bloodShardMultiplier": 1,
        "towerCostMod": 1,
        "damageMultiplier": 1,
        "healingMultiplier": 1,
        "essenceMultiplier": 1,
        "towerDamageReduction": 1,
        "population": 0,
        "maxPopulation": 5
      }
    },
    "upgrades": {
      "bloodHarvest": {
        "desc": "Gain 25% more Blood Shards from enemies",
        "value": 1.25
      },
      "darkResilience": {
        "desc": "Towers take 20% less damage from enemy abilities",
        "towerDamageReduction": 0.8
      },
      "bloodEff": {
        "desc": "Towers cost 15% less Blood Shards",
        "value": 0.85
      },
      "essenceExtraction": {
        "desc": "Gain 25% more Essence from enemies",
        "value": 1.25
      },
      "necroMastery": {
        "desc": "+20% Range and projectiles pierce one additional enemy",
        "range": 1.2,
        "piercing": 1
      },
      "mistSlow": {
        "desc": "Slow effect increased by 20%",
        "slowAmount": 0.8
      },
      "overCharge": {
        "desc": "+30% Range",
        "range": 1.3
      },
      "pyreBurn": {
        "desc": "+50% Burn Damage",
        "burnDamage": 1
      },
      "sentryFrenzy": {
        "desc": "+5% Attack Speed",
        "value": 0.95
      },
      "shadowCrit": {
        "desc": "+10% Critical Chance",
        "critChance": 0.1
      },
      "bloodCore": {
        "desc": "Increase max Core HP by 20% and heal 30 HP",
        "maxHpMultiplier": 1.2,
        "healAmount": 30
      },
      "bloodFrenzy": {
        "desc": "All towers deal 20% more damage",
        "damageMultiplier": 1.2
      },
      "dematerializeSentry": {
        "desc": "Heal 0.5% Core HP per hit",
        "leech": 0.005
      },
      "mistSpread": {
        "desc": "+25% Range and +1 Piercing",
        "range": 1.25,
        "piercing": 1
      },
      "pyreSoul": {
        "desc": "+10% splash radius",
        "splashRadius": 1.1
      },
      "sentryIntelligence": {
        "desc": "+15% Damage and +10% Range",
        "damage": 1.15,
        "range": 1.1
      },
      "shadowPierce": {
        "desc": "Projectiles pierce 2 additional enemies",
        "piercing": 2
      },
      "essenceOverflow": {
        "desc": "Gain 10% more Essence when above 50% Core HP",
        "value": 1.1
      },
      "bloodRegeneration": {
        "desc": "All healing effects are 25% more effective",
        "healingMultiplier": 1.25
      },
      "necroSummon": {
        "desc": "10% chance to raise a skeleton when killing an enemy",
        "summonChance": 1.1
      },
      "pyreBlaze": {
        "desc": "+20% Damage and +10% Attack Speed",
        "damage": 1.2,
        "attackSpeed": 1.1
      }
    },
    "waves": {
      "wave2": {
        "title": "Wave 2",
        "enemies": [
          "trex",
          "trex",
          "new_trex",
          "trex",
          "trex",
          "new_trex",
          "trex",
          "redDragon"
        ]
      },
      "swarm": {
        "title": "swarm",
        "enemies": [
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "new_trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "new_trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "new_trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "new_trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "new_trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "new_trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "new_trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "new_trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "new_trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "new_trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "new_trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "new_trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "new_trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "new_trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "new_trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "new_trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "new_trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "new_trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "new_trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "new_trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "new_trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "new_trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "new_trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "new_trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "new_trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "new_trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "trex",
          "new_trex"
        ],
        "spawnRateMultiplier": 2
      },
      "wave1": {
        "title": "Wave 1",
        "enemies": [
          "trex",
          "trex",
          "new_trex",
          "trex",
          "trex",
          "new_trex",
          "trex",
          "redDragon"
        ]
      }
    },
    "wavesets": {
      "level1_start1": {
        "title": "Level 1 - Start 1",
        "waves": [
          "wave1",
          "wave1",
          "wave1",
          "wave1",
          "wave1",
          "swarm"
        ]
      },
      "swarm": {
        "title": "Swarm",
        "waves": [
          "swarm"
        ]
      },
      "level1_start2": {
        "title": "Level 1 - Start 2",
        "waves": [
          "wave2",
          "wave2",
          "wave2",
          "wave2",
          "wave2",
          "swarm"
        ],
        "startDelay": 5
      }
    },
    "cameras": {
      "main": {
        "title": "Main",
        "fov": 45,
        "near": 0.1,
        "far": 5000,
        "position": "{ \"x\": 384, \"y\": 500, \"z\": 1152 }",
        "lookAt": "{ \"x\": 384, \"y\": 15, \"z\": 384 }"
      }
    },
    "fogs": {
      "sunnyDayFog": {
        "title": "Sunny Day Fog",
        "color": "#b3e5fc",
        "density": 0.0004,
        "enabled": true
      }
    },
    "heightMaps": {
      "fiveStep": {
        "title": "Five Step and Smoothing",
        "heightStep": 4,
        "smoothing": true,
        "enabled": true,
        "resolutionDivisor": 4
      }
    },
    "lightings": {
      "sunnyDayLighting": {
        "title": "Sunny Day Lighting",
        "ambientColor": "#b3e5fc",
        "ambientIntensity": 0.4,
        "directionalColor": "#ffcc80",
        "directionalIntensity": 0.7,
        "skyColor": "#b3e5fc",
        "groundColor": "#5a8a4f",
        "hemisphereIntensity": 0.5
      }
    },
    "shadows": {
      "sunnyDayShadows": {
        "title": "Sunny Day Shadows",
        "mapSize": 2048,
        "bias": -0.0003,
        "normalBias": 0,
        "radius": 512,
        "enabled": true
      }
    },
    "worlds": {
      "shire": {
        "title": "Shire",
        "lighting": "sunnyDayLighting",
        "shadow": "sunnyDayShadows",
        "fog": "sunnyDayFog",
        "heightMap": "fiveStep",
        "camera": "main",
        "extensionSize": 768,
        "worldObjects": [
          "tree",
          "rock"
        ],
        "backgroundColor": "#b3e5fc"
      }
    },
    "enemies": {
      "armoredBeast": {
        "speed": 0.9,
        "essence": 20,
        "value": 30,
        "hp": 100,
        "render": {
          "animations": {
            "idle": [
              {}
            ],
            "walk": [
              {},
              {
                "shapes": {
                  "shapes": [
                    {
                      "x": -0.4465238854292495,
                      "z": 0.039065777968608106,
                      "id": 0
                    },
                    {
                      "x": -0.4465238854292495,
                      "z": 0.039065777968608106,
                      "id": 1
                    },
                    {
                      "x": 15.31040016276608,
                      "z": -2.7393050647022767,
                      "rotationX": -10,
                      "id": 2
                    },
                    {
                      "x": -16.203447933624577,
                      "z": 2.8174366206394934,
                      "rotationX": 10,
                      "id": 3
                    },
                    {
                      "x": 21.219246680839326,
                      "z": -1.9,
                      "id": 4
                    },
                    {
                      "x": -22.112294451697828,
                      "z": 2.1,
                      "id": 5
                    },
                    {
                      "x": 9.40155364469283,
                      "z": -1.6974159987006954,
                      "id": 6
                    },
                    {
                      "x": -10.294601415551329,
                      "z": 1.7755475546379114,
                      "id": 7
                    },
                    {
                      "x": 5.866700300967233,
                      "z": 7.0492869137316205,
                      "id": 8
                    },
                    {
                      "x": -3.9813772291548464,
                      "z": 8.785768690400923,
                      "id": 9
                    },
                    {
                      "x": 6.213996656301093,
                      "z": 9.018902419756037,
                      "id": 10
                    },
                    {
                      "x": -3.6340808738209858,
                      "z": 10.75538419642534,
                      "id": 11
                    },
                    {
                      "x": -10.294601415551329,
                      "z": 1.7755475546379114,
                      "id": 12
                    },
                    {
                      "x": 9.40155364469283,
                      "z": -1.6974159987006954,
                      "id": 13
                    },
                    {
                      "x": -0.4465238854292495,
                      "z": 0.039065777968608106,
                      "id": 14
                    },
                    {
                      "x": -0.4465238854292495,
                      "z": 0.039065777968608106,
                      "id": 15
                    }
                  ]
                }
              },
              {},
              {
                "shapes": {
                  "shapes": [
                    {
                      "x": 0.4465238854292495,
                      "z": 0.039065777968608106,
                      "id": 0
                    },
                    {
                      "x": 0.4465238854292495,
                      "z": 0.039065777968608106,
                      "id": 1
                    },
                    {
                      "x": 16.203447933624577,
                      "z": 2.8174366206394934,
                      "rotationX": 10,
                      "id": 2
                    },
                    {
                      "x": -15.31040016276608,
                      "z": -2.7393050647022767,
                      "rotationX": -10,
                      "id": 3
                    },
                    {
                      "x": 22.112294451697828,
                      "z": 1.9,
                      "id": 4
                    },
                    {
                      "x": -21.219246680839326,
                      "z": -1.6,
                      "id": 5
                    },
                    {
                      "x": 10.294601415551329,
                      "z": 1.7755475546379114,
                      "id": 6
                    },
                    {
                      "x": -9.40155364469283,
                      "z": -1.6974159987006954,
                      "id": 7
                    },
                    {
                      "x": 3.9813772291548464,
                      "z": 8.785768690400923,
                      "id": 8
                    },
                    {
                      "x": -5.866700300967233,
                      "z": 7.0492869137316205,
                      "id": 9
                    },
                    {
                      "x": 3.6340808738209858,
                      "z": 10.75538419642534,
                      "id": 10
                    },
                    {
                      "x": -6.213996656301093,
                      "z": 9.018902419756037,
                      "id": 11
                    },
                    {
                      "x": -9.40155364469283,
                      "z": -1.6974159987006954,
                      "id": 12
                    },
                    {
                      "x": 10.294601415551329,
                      "z": 1.7755475546379114,
                      "id": 13
                    },
                    {
                      "x": 0.44650238854292496,
                      "z": 0.039065777968608106,
                      "id": 14
                    },
                    {
                      "x": 0.4465238854292495,
                      "z": 0.039065777968608106,
                      "id": 15
                    }
                  ]
                }
              }
            ]
          },
          "model": {
            "shapes": {
              "shapes": [
                {
                  "type": "sphere",
                  "width": 26,
                  "height": 20,
                  "depth": 24,
                  "color": "#A52A2A",
                  "x": 0,
                  "y": 20,
                  "z": 0,
                  "size": 28,
                  "scaleX": 1
                },
                {
                  "type": "sphere",
                  "size": 18,
                  "color": "#A52A2A",
                  "x": 0,
                  "y": 36,
                  "z": 0
                },
                {
                  "type": "cylinder",
                  "size": 8,
                  "height": 14,
                  "color": "#8B4513",
                  "x": 16,
                  "y": 24,
                  "z": 0,
                  "rotationZ": 45
                },
                {
                  "type": "cylinder",
                  "size": 8,
                  "height": 14,
                  "color": "#8B4513",
                  "x": -16,
                  "y": 24,
                  "z": 0,
                  "rotationZ": -45
                },
                {
                  "type": "sphere",
                  "size": 9,
                  "color": "#A52A2A",
                  "x": 22,
                  "y": 18,
                  "z": 0
                },
                {
                  "type": "sphere",
                  "size": 9,
                  "color": "#A52A2A",
                  "x": -22,
                  "y": 18,
                  "z": 0
                },
                {
                  "type": "cylinder",
                  "size": 8,
                  "height": 16,
                  "color": "#8B4513",
                  "x": 10,
                  "y": 8,
                  "z": 0,
                  "rotationZ": 0
                },
                {
                  "type": "cylinder",
                  "size": 8,
                  "height": 16,
                  "color": "#8B4513",
                  "x": -10,
                  "y": 8,
                  "z": 0,
                  "rotationZ": 0
                },
                {
                  "type": "sphere",
                  "size": 6,
                  "color": "#FFFFFF",
                  "x": 5,
                  "y": 38,
                  "z": 8
                },
                {
                  "type": "sphere",
                  "size": 6,
                  "color": "#FFFFFF",
                  "x": -5,
                  "y": 38,
                  "z": 8
                },
                {
                  "type": "sphere",
                  "size": 3,
                  "color": "#000000",
                  "x": 5,
                  "y": 38,
                  "z": 10
                },
                {
                  "type": "sphere",
                  "size": 3,
                  "color": "#000000",
                  "x": -5,
                  "y": 38,
                  "z": 10
                },
                {
                  "type": "cone",
                  "size": 6,
                  "height": 12,
                  "color": "#8B4513",
                  "x": -10,
                  "y": 42,
                  "z": 0,
                  "rotationZ": 45
                },
                {
                  "type": "cone",
                  "size": 6,
                  "height": 12,
                  "color": "#8B4513",
                  "x": 10,
                  "y": 42,
                  "z": 0,
                  "rotationZ": -45
                },
                {
                  "type": "sphere",
                  "width": 26,
                  "height": 20,
                  "depth": 24,
                  "color": "#676767",
                  "x": 0,
                  "y": 22,
                  "z": 0,
                  "size": 30
                },
                {
                  "type": "sphere",
                  "size": 17,
                  "color": "#676767",
                  "x": 0,
                  "y": 37,
                  "z": 0
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            }
          }
        },
        "armor": 100,
        "title": "Armored Beast"
      },
      "bloodBeast": {
        "hp": 50,
        "speed": 0.6,
        "value": 15,
        "essence": 20,
        "regen": 0.5,
        "render": {
          "animations": {
            "idle": [
              {}
            ],
            "walk": [
              {},
              {
                "shapes": {
                  "shapes": [
                    {
                      "x": -0.4465238854292495,
                      "z": 0.039065777968608106,
                      "id": 0
                    },
                    {
                      "x": -0.4465238854292495,
                      "z": 0.039065777968608106,
                      "id": 1
                    },
                    {
                      "x": 15.31040016276608,
                      "z": -2.7393050647022767,
                      "rotationX": -10,
                      "id": 2
                    },
                    {
                      "x": -16.203447933624577,
                      "z": 2.8174366206394934,
                      "rotationX": 10,
                      "id": 3
                    },
                    {
                      "x": 21.219246680839326,
                      "z": -1.9,
                      "id": 4
                    },
                    {
                      "x": -22.112294451697828,
                      "z": 2.1,
                      "id": 5
                    },
                    {
                      "x": 9.40155364469283,
                      "z": -1.6974159987006954,
                      "id": 6
                    },
                    {
                      "x": -10.294601415551329,
                      "z": 1.7755475546379114,
                      "id": 7
                    },
                    {
                      "x": 5.866700300967233,
                      "z": 7.0492869137316205,
                      "id": 8
                    },
                    {
                      "x": -3.9813772291548464,
                      "z": 8.785768690400923,
                      "id": 9
                    },
                    {
                      "x": 6.213996656301093,
                      "z": 9.018902419756037,
                      "id": 10
                    },
                    {
                      "x": -3.6340808738209858,
                      "z": 10.75538419642534,
                      "id": 11
                    },
                    {
                      "x": -10.294601415551329,
                      "z": 1.7755475546379114,
                      "id": 12
                    },
                    {
                      "x": 9.40155364469283,
                      "z": -1.6974159987006954,
                      "id": 13
                    }
                  ]
                }
              },
              {},
              {
                "shapes": {
                  "shapes": [
                    {
                      "x": 0.4465238854292495,
                      "z": 0.039065777968608106,
                      "id": 0
                    },
                    {
                      "x": 0.4465238854292495,
                      "z": 0.039065777968608106,
                      "id": 1
                    },
                    {
                      "x": 16.203447933624577,
                      "z": 2.8174366206394934,
                      "rotationX": 10,
                      "id": 2
                    },
                    {
                      "x": -15.31040016276608,
                      "z": -2.7393050647022767,
                      "rotationX": -10,
                      "id": 3
                    },
                    {
                      "x": 22.112294451697828,
                      "z": 1.9,
                      "id": 4
                    },
                    {
                      "x": -21.219246680839326,
                      "z": -1.6,
                      "id": 5
                    },
                    {
                      "x": 10.294601415551329,
                      "z": 1.7755475546379114,
                      "id": 6
                    },
                    {
                      "x": -9.40155364469283,
                      "z": -1.6974159987006954,
                      "id": 7
                    },
                    {
                      "x": 3.9813772291548464,
                      "z": 8.785768690400923,
                      "id": 8
                    },
                    {
                      "x": -5.866700300967233,
                      "z": 7.0492869137316205,
                      "id": 9
                    },
                    {
                      "x": 3.6340808738209858,
                      "z": 10.75538419642534,
                      "id": 10
                    },
                    {
                      "x": -6.213996656301093,
                      "z": 9.018902419756037,
                      "id": 11
                    },
                    {
                      "x": -9.40155364469283,
                      "z": -1.6974159987006954,
                      "id": 12
                    },
                    {
                      "x": 10.294601415551329,
                      "z": 1.7755475546379114,
                      "id": 13
                    }
                  ]
                }
              }
            ]
          },
          "model": {
            "shapes": {
              "shapes": [
                {
                  "type": "sphere",
                  "width": 26,
                  "height": 20,
                  "depth": 24,
                  "color": "#A52A2A",
                  "x": 0,
                  "y": 20,
                  "z": 0,
                  "size": 28,
                  "scaleX": 1
                },
                {
                  "type": "sphere",
                  "size": 18,
                  "color": "#A52A2A",
                  "x": 0,
                  "y": 36,
                  "z": 0
                },
                {
                  "type": "cylinder",
                  "size": 8,
                  "height": 14,
                  "color": "#8B4513",
                  "x": 16,
                  "y": 24,
                  "z": 0,
                  "rotationZ": 45
                },
                {
                  "type": "cylinder",
                  "size": 8,
                  "height": 14,
                  "color": "#8B4513",
                  "x": -16,
                  "y": 24,
                  "z": 0,
                  "rotationZ": -45
                },
                {
                  "type": "sphere",
                  "size": 9,
                  "color": "#A52A2A",
                  "x": 22,
                  "y": 18,
                  "z": 0
                },
                {
                  "type": "sphere",
                  "size": 9,
                  "color": "#A52A2A",
                  "x": -22,
                  "y": 18,
                  "z": 0
                },
                {
                  "type": "cylinder",
                  "size": 8,
                  "height": 16,
                  "color": "#8B4513",
                  "x": 10,
                  "y": 8,
                  "z": 0,
                  "rotationZ": 0
                },
                {
                  "type": "cylinder",
                  "size": 8,
                  "height": 16,
                  "color": "#8B4513",
                  "x": -10,
                  "y": 8,
                  "z": 0,
                  "rotationZ": 0
                },
                {
                  "type": "sphere",
                  "size": 6,
                  "color": "#FFFFFF",
                  "x": 5,
                  "y": 38,
                  "z": 8
                },
                {
                  "type": "sphere",
                  "size": 6,
                  "color": "#FFFFFF",
                  "x": -5,
                  "y": 38,
                  "z": 8
                },
                {
                  "type": "sphere",
                  "size": 3,
                  "color": "#000000",
                  "x": 5,
                  "y": 38,
                  "z": 10
                },
                {
                  "type": "sphere",
                  "size": 3,
                  "color": "#000000",
                  "x": -5,
                  "y": 38,
                  "z": 10
                },
                {
                  "type": "cone",
                  "size": 6,
                  "height": 12,
                  "color": "#8B4513",
                  "x": -10,
                  "y": 42,
                  "z": 0,
                  "rotationZ": 45
                },
                {
                  "type": "cone",
                  "size": 6,
                  "height": 12,
                  "color": "#8B4513",
                  "x": 10,
                  "y": 42,
                  "z": 0,
                  "rotationZ": -45
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            }
          }
        },
        "armor": 50,
        "title": "blood beast"
      },
      "ghost": {
        "hp": 1,
        "speed": 1.5,
        "value": 10,
        "essence": 15,
        "render": {
          "animations": {
            "idle": [
              {}
            ],
            "walk": [
              {},
              {},
              {
                "shapes": {
                  "shapes": [
                    {
                      "y": 32,
                      "id": 0
                    },
                    {
                      "y": 22,
                      "id": 1
                    },
                    {
                      "y": 12,
                      "id": 2
                    },
                    {
                      "y": 7,
                      "id": 3
                    },
                    {
                      "y": 7,
                      "id": 4
                    },
                    {
                      "y": 7,
                      "id": 5
                    },
                    {
                      "y": 32,
                      "id": 6
                    },
                    {
                      "y": 32,
                      "id": 7
                    },
                    {
                      "y": 29,
                      "id": 8
                    }
                  ]
                }
              },
              {
                "shapes": {
                  "shapes": [
                    {
                      "y": 32,
                      "id": 0
                    },
                    {
                      "y": 22,
                      "id": 1
                    },
                    {
                      "y": 12,
                      "id": 2
                    },
                    {
                      "y": 7,
                      "id": 3
                    },
                    {
                      "y": 7,
                      "id": 4
                    },
                    {
                      "y": 7,
                      "id": 5
                    },
                    {
                      "y": 32,
                      "id": 6
                    },
                    {
                      "y": 32,
                      "id": 7
                    },
                    {
                      "y": 29,
                      "id": 8
                    }
                  ]
                }
              }
            ]
          },
          "model": {
            "shapes": {
              "shapes": [
                {
                  "type": "sphere",
                  "size": 16,
                  "color": "#C2E8F7",
                  "x": 0,
                  "y": 31,
                  "z": 0,
                  "scaleX": 1
                },
                {
                  "type": "sphere",
                  "size": 14,
                  "color": "#D8F0F9",
                  "x": 0,
                  "y": 21,
                  "z": 0
                },
                {
                  "type": "sphere",
                  "size": 12,
                  "color": "#E5F6FC",
                  "x": 0,
                  "y": 11,
                  "z": 0
                },
                {
                  "type": "cone",
                  "size": 8,
                  "height": 14,
                  "color": "#E5F6FC",
                  "x": 6,
                  "y": 6,
                  "z": 0,
                  "rotationX": 180
                },
                {
                  "type": "cone",
                  "size": 8,
                  "height": 14,
                  "color": "#E5F6FC",
                  "x": -6,
                  "y": 6,
                  "z": 0,
                  "rotationX": 180
                },
                {
                  "type": "cone",
                  "size": 8,
                  "height": 14,
                  "color": "#E5F6FC",
                  "x": 0,
                  "y": 6,
                  "z": 0,
                  "rotationX": 180
                },
                {
                  "type": "sphere",
                  "size": 4,
                  "color": "#1A1A1A",
                  "x": 4,
                  "y": 31,
                  "z": 7
                },
                {
                  "type": "sphere",
                  "size": 4,
                  "color": "#1A1A1A",
                  "x": -4,
                  "y": 31,
                  "z": 7
                },
                {
                  "type": "sphere",
                  "size": 8,
                  "color": "#1A1A1A",
                  "x": 0,
                  "y": 28,
                  "z": 4,
                  "rotationX": 45,
                  "rotationY": 0,
                  "rotationZ": 0
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            }
          }
        },
        "evasion": 75,
        "energyShield": 30,
        "title": "ghost"
      },
      "new_trex": {
        "title": "New T-Rex",
        "hp": 200,
        "speed": 1.5,
        "value": 10,
        "essence": 15,
        "render": {
          "animations": {
            "idle": [
              {
                "head": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "redMColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "redMColor"
                      },
                      "id": 3
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 4
                    },
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 5
                    },
                    {
                      "color": {
                        "paletteColor": "greenMColor"
                      },
                      "id": 6
                    },
                    {
                      "color": {
                        "paletteColor": "greenMColor"
                      },
                      "id": 7
                    }
                  ]
                },
                "jaw": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 3
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 4
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 5
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 6
                    }
                  ]
                },
                "left arm": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "greyMColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 3
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 4
                    }
                  ]
                },
                "right arm": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "greyMColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 3
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 4
                    }
                  ]
                },
                "left leg": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 3
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 4
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 5
                    }
                  ]
                },
                "right leg": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 3
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 4
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 5
                    }
                  ]
                },
                "body": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 3
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 4
                    }
                  ]
                },
                "tail base": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 3
                    }
                  ]
                },
                "tail tip": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 3
                    }
                  ]
                }
              }
            ],
            "walk": [
              {
                "head": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "redMColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "redMColor"
                      },
                      "id": 3
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 4
                    },
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 5
                    },
                    {
                      "color": {
                        "paletteColor": "greenMColor"
                      },
                      "id": 6
                    },
                    {
                      "color": {
                        "paletteColor": "greenMColor"
                      },
                      "id": 7
                    }
                  ]
                },
                "jaw": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 3
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 4
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 5
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 6
                    }
                  ]
                },
                "left arm": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "greyMColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 3
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 4
                    }
                  ]
                },
                "right arm": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "greyMColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 3
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 4
                    }
                  ]
                },
                "left leg": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 3
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 4
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 5
                    }
                  ]
                },
                "right leg": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 3
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 4
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 5
                    }
                  ]
                },
                "body": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 3
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 4
                    }
                  ]
                },
                "tail base": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 3
                    }
                  ]
                },
                "tail tip": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 3
                    }
                  ]
                }
              },
              {
                "head": {
                  "rotation": {
                    "x": 0,
                    "y": 0.1,
                    "z": 0
                  }
                },
                "jaw": {
                  "rotation": {
                    "x": 0.3,
                    "y": 0,
                    "z": 0
                  }
                },
                "left arm": {
                  "position": {
                    "x": 1.5,
                    "y": -2.7,
                    "z": 0
                  },
                  "rotation": {
                    "x": 0.5,
                    "y": 0,
                    "z": 0.1
                  }
                },
                "right arm": {
                  "position": {
                    "x": 0,
                    "y": -2.7,
                    "z": 15
                  },
                  "rotation": {
                    "x": -0.2,
                    "y": 0,
                    "z": -0.1
                  }
                },
                "left leg": {
                  "position": {
                    "x": 0,
                    "y": 5,
                    "z": -15
                  },
                  "rotation": {
                    "x": 0.4,
                    "y": 0,
                    "z": 0
                  }
                },
                "right leg": {
                  "position": {
                    "x": 0,
                    "y": 2.5,
                    "z": 8
                  },
                  "rotation": {
                    "x": -0.3,
                    "y": 0,
                    "z": 0
                  }
                },
                "body": {
                  "rotation": {
                    "x": 0.7,
                    "y": 0.05,
                    "z": 0
                  }
                },
                "tail base": {
                  "rotation": {
                    "x": 0.1,
                    "y": 0.2,
                    "z": 0
                  }
                },
                "tail tip": {
                  "rotation": {
                    "x": 0.05,
                    "y": 0.3,
                    "z": 0
                  }
                }
              },
              {
                "head": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "redMColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "redMColor"
                      },
                      "id": 3
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 4
                    },
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 5
                    },
                    {
                      "color": {
                        "paletteColor": "greenMColor"
                      },
                      "id": 6
                    },
                    {
                      "color": {
                        "paletteColor": "greenMColor"
                      },
                      "id": 7
                    }
                  ]
                },
                "jaw": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 3
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 4
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 5
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 6
                    }
                  ]
                },
                "left arm": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "greyMColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 3
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 4
                    }
                  ]
                },
                "right arm": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "greyMColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 3
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 4
                    }
                  ]
                },
                "left leg": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 3
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 4
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 5
                    }
                  ]
                },
                "right leg": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 3
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 4
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 5
                    }
                  ]
                },
                "body": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 3
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 4
                    }
                  ]
                },
                "tail base": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 3
                    }
                  ]
                },
                "tail tip": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 3
                    }
                  ]
                }
              },
              {
                "head": {
                  "position": {
                    "x": 0,
                    "y": 2.3,
                    "z": 18.5
                  },
                  "rotation": {
                    "x": 0,
                    "y": -0.1,
                    "z": 0
                  }
                },
                "jaw": {
                  "position": {
                    "x": 0,
                    "y": 9.8,
                    "z": 7.8
                  },
                  "rotation": {
                    "x": 0.3,
                    "y": 0,
                    "z": 0
                  }
                },
                "left arm": {
                  "position": {
                    "x": 0,
                    "y": -2.7,
                    "z": 15
                  },
                  "rotation": {
                    "x": -0.2,
                    "y": 0,
                    "z": 0.1028404567909271
                  }
                },
                "right arm": {
                  "position": {
                    "x": -1.5,
                    "y": -2.7,
                    "z": 0
                  },
                  "rotation": {
                    "x": 0.5,
                    "y": 0,
                    "z": -0.1
                  }
                },
                "left leg": {
                  "position": {
                    "x": 0,
                    "y": 2.7,
                    "z": 8
                  },
                  "rotation": {
                    "x": -0.2956793085731574,
                    "y": 0,
                    "z": 0
                  }
                },
                "right leg": {
                  "position": {
                    "x": 0,
                    "y": 5,
                    "z": -15
                  },
                  "rotation": {
                    "x": 0.4,
                    "y": 0,
                    "z": 0
                  }
                },
                "body": {
                  "position": {
                    "x": 0,
                    "y": 9.3,
                    "z": -10
                  },
                  "rotation": {
                    "x": 0.7,
                    "y": -0.05,
                    "z": 0
                  }
                },
                "tail base": {
                  "rotation": {
                    "x": 0.1,
                    "y": -0.2,
                    "z": 0
                  }
                },
                "tail tip": {
                  "rotation": {
                    "x": 0.05,
                    "y": -0.3,
                    "z": 0
                  }
                }
              }
            ]
          },
          "model": {
            "head": {
              "shapes": [
                {
                  "type": "box",
                  "width": 16,
                  "height": 14,
                  "depth": 22,
                  "x": 0,
                  "y": 42,
                  "z": 14,
                  "color": {
                    "paletteColor": "greenDColor"
                  },
                  "name": "head-main",
                  "texture": "scales",
                  "roughness": 0.8
                },
                {
                  "type": "sphere",
                  "size": 4.5,
                  "x": -8,
                  "y": 46,
                  "z": 16,
                  "color": {
                    "paletteColor": "redMColor"
                  },
                  "name": "eye-right",
                  "emissive": "#B8860B"
                },
                {
                  "type": "sphere",
                  "size": 2.2,
                  "x": -8,
                  "y": 46,
                  "z": 17.5,
                  "color": {
                    "paletteColor": "brownDColor"
                  },
                  "name": "pupil-right"
                },
                {
                  "type": "sphere",
                  "size": 4.5,
                  "x": 8,
                  "y": 46,
                  "z": 16,
                  "color": {
                    "paletteColor": "redMColor"
                  },
                  "name": "eye-left",
                  "emissive": "#B8860B"
                },
                {
                  "type": "sphere",
                  "size": 2.2,
                  "x": 8,
                  "y": 46,
                  "z": 17.5,
                  "color": {
                    "paletteColor": "brownDColor"
                  },
                  "name": "pupil-left"
                },
                {
                  "type": "box",
                  "width": 16,
                  "height": 2,
                  "depth": 6,
                  "x": 0,
                  "y": 50,
                  "z": 14,
                  "color": {
                    "paletteColor": "greenDColor"
                  },
                  "name": "brow-ridge",
                  "texture": "rough"
                },
                {
                  "type": "sphere",
                  "size": 2,
                  "x": -4.5,
                  "y": 48.7,
                  "z": 23.6,
                  "color": {
                    "paletteColor": "greenDColor"
                  },
                  "name": "nostril-right",
                  "rotationX": 0,
                  "rotationY": 0,
                  "rotationZ": 0,
                  "scaleX": 1,
                  "scaleY": 1,
                  "scaleZ": 1
                },
                {
                  "type": "sphere",
                  "size": 2,
                  "x": 4.5,
                  "y": 48.7,
                  "z": 23.6,
                  "color": {
                    "paletteColor": "greenDColor"
                  },
                  "name": "nostril-left",
                  "rotationX": 0,
                  "rotationY": 0,
                  "rotationZ": 0,
                  "scaleX": 1,
                  "scaleY": 1,
                  "scaleZ": 1
                }
              ],
              "position": {
                "x": 0,
                "y": 2.5,
                "z": 18.5
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            },
            "jaw": {
              "shapes": [
                {
                  "type": "box",
                  "width": 18.3,
                  "height": 6,
                  "depth": 20.9,
                  "x": 0,
                  "y": 30,
                  "z": 16,
                  "color": {
                    "paletteColor": "greenDColor"
                  },
                  "name": "jaw-main",
                  "texture": "scales"
                },
                {
                  "type": "box",
                  "width": 12,
                  "height": 2,
                  "depth": 2,
                  "x": 0,
                  "y": 32.5,
                  "z": 24.7,
                  "color": {
                    "paletteColor": "redDColor"
                  },
                  "name": "gums",
                  "roughness": 0.7
                },
                {
                  "type": "box",
                  "width": 1.8,
                  "height": 4,
                  "depth": 1.8,
                  "x": -5,
                  "y": 33,
                  "z": 25,
                  "color": {
                    "paletteColor": "greyLColor"
                  },
                  "name": "tooth-front-right",
                  "shininess": 90
                },
                {
                  "type": "box",
                  "width": 1.8,
                  "height": 4,
                  "depth": 1.8,
                  "x": 0,
                  "y": 33,
                  "z": 25,
                  "color": {
                    "paletteColor": "greyLColor"
                  },
                  "name": "tooth-front-middle",
                  "shininess": 90
                },
                {
                  "type": "box",
                  "width": 1.8,
                  "height": 4,
                  "depth": 1.8,
                  "x": 5,
                  "y": 33,
                  "z": 25,
                  "color": {
                    "paletteColor": "greyLColor"
                  },
                  "name": "tooth-front-left",
                  "shininess": 90
                },
                {
                  "type": "box",
                  "width": 1.5,
                  "height": 3,
                  "depth": 1.5,
                  "x": -7,
                  "y": 33,
                  "z": 22,
                  "color": {
                    "paletteColor": "greyLColor"
                  },
                  "name": "tooth-side-right1",
                  "shininess": 90
                },
                {
                  "type": "box",
                  "width": 1.5,
                  "height": 3,
                  "depth": 1.5,
                  "x": 7,
                  "y": 33,
                  "z": 22,
                  "color": {
                    "paletteColor": "greyLColor"
                  },
                  "name": "tooth-side-left1",
                  "shininess": 90
                }
              ],
              "position": {
                "x": 0,
                "y": 10,
                "z": 7.8
              },
              "rotation": {
                "x": 0.3121059368272202,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            },
            "left arm": {
              "shapes": [
                {
                  "type": "box",
                  "width": 5,
                  "height": 8,
                  "depth": 5,
                  "x": 11,
                  "y": 28,
                  "z": 0,
                  "rotationX": -45,
                  "color": {
                    "paletteColor": "greenDColor"
                  },
                  "name": "upper-arm-left",
                  "texture": "scales"
                },
                {
                  "type": "box",
                  "width": 4,
                  "height": 6,
                  "depth": 4,
                  "x": 11,
                  "y": 24,
                  "z": 4,
                  "rotationX": -20,
                  "color": {
                    "paletteColor": "greenDColor"
                  },
                  "name": "lower-arm-left",
                  "texture": "scales"
                },
                {
                  "type": "box",
                  "width": 3.8,
                  "height": 3.5,
                  "depth": 3,
                  "x": 11,
                  "y": 22,
                  "z": 6,
                  "color": {
                    "paletteColor": "greyMColor"
                  },
                  "name": "hand-left",
                  "metalness": 0.5,
                  "roughness": 0.7
                },
                {
                  "type": "box",
                  "width": 1.2,
                  "height": 3,
                  "depth": 1.2,
                  "x": 12.5,
                  "y": 21,
                  "z": 8,
                  "color": {
                    "paletteColor": "greyLColor"
                  },
                  "name": "claw-left-1",
                  "metalness": 0.6
                },
                {
                  "type": "box",
                  "width": 1.2,
                  "height": 2.5,
                  "depth": 1.2,
                  "x": 9.5,
                  "y": 21.5,
                  "z": 7.5,
                  "color": {
                    "paletteColor": "greyLColor"
                  },
                  "name": "claw-left-2",
                  "metalness": 0.6
                }
              ],
              "position": {
                "x": 0,
                "y": -2.7,
                "z": 10
              },
              "rotation": {
                "x": 0.18890622492173986,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            },
            "right arm": {
              "shapes": [
                {
                  "type": "box",
                  "width": 5,
                  "height": 8,
                  "depth": 5,
                  "x": -11,
                  "y": 28,
                  "z": 0,
                  "rotationX": -45,
                  "color": {
                    "paletteColor": "greenDColor"
                  },
                  "name": "upper-arm-right",
                  "texture": "scales"
                },
                {
                  "type": "box",
                  "width": 4,
                  "height": 6,
                  "depth": 4,
                  "x": -11,
                  "y": 24,
                  "z": 4,
                  "rotationX": -20,
                  "color": {
                    "paletteColor": "greenDColor"
                  },
                  "name": "lower-arm-right",
                  "texture": "scales"
                },
                {
                  "type": "box",
                  "width": 3.8,
                  "height": 3.5,
                  "depth": 3,
                  "x": -11,
                  "y": 22,
                  "z": 6,
                  "color": {
                    "paletteColor": "greyMColor"
                  },
                  "name": "hand-right",
                  "metalness": 0.5,
                  "roughness": 0.7
                },
                {
                  "type": "box",
                  "width": 1.2,
                  "height": 3,
                  "depth": 1.2,
                  "x": -12.5,
                  "y": 21,
                  "z": 8,
                  "color": {
                    "paletteColor": "greyLColor"
                  },
                  "name": "claw-right-1",
                  "metalness": 0.6
                },
                {
                  "type": "box",
                  "width": 1.2,
                  "height": 2.5,
                  "depth": 1.2,
                  "x": -9.5,
                  "y": 21.5,
                  "z": 7.5,
                  "color": {
                    "paletteColor": "greyLColor"
                  },
                  "name": "claw-right-2",
                  "metalness": 0.6
                }
              ],
              "position": {
                "x": 0,
                "y": -2.7,
                "z": 10
              },
              "rotation": {
                "x": 0.19949192295270599,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            },
            "left leg": {
              "shapes": [
                {
                  "type": "box",
                  "width": 8,
                  "height": 14,
                  "depth": 10,
                  "x": 9,
                  "y": 20,
                  "z": 0,
                  "color": {
                    "paletteColor": "greenDColor"
                  },
                  "name": "thigh-left",
                  "texture": "scales",
                  "roughness": 0.7,
                  "rotationX": -15,
                  "rotationY": 0,
                  "rotationZ": 0,
                  "scaleX": 1,
                  "scaleY": 1,
                  "scaleZ": 1
                },
                {
                  "type": "box",
                  "width": 7,
                  "height": 16,
                  "depth": 7,
                  "x": 9,
                  "y": 9,
                  "z": 0,
                  "color": {
                    "paletteColor": "greenDColor"
                  },
                  "name": "shin-left",
                  "texture": "scales",
                  "rotationX": 30
                },
                {
                  "type": "box",
                  "width": 10,
                  "height": 4,
                  "depth": 16,
                  "x": 9,
                  "y": 1,
                  "z": 0,
                  "color": {
                    "paletteColor": "greenDColor"
                  },
                  "name": "foot-left",
                  "roughness": 0.8,
                  "rotationX": 20,
                  "rotationY": 0,
                  "rotationZ": 0,
                  "scaleX": 1,
                  "scaleY": 1,
                  "scaleZ": 1,
                  "texture": "scales"
                },
                {
                  "type": "cone",
                  "size": 2.5,
                  "height": 5,
                  "x": 6,
                  "y": -2,
                  "z": 8.5,
                  "rotationX": 90,
                  "color": {
                    "paletteColor": "greyLColor"
                  },
                  "name": "toe-left-1",
                  "metalness": 0.3
                },
                {
                  "type": "cone",
                  "size": 2.5,
                  "height": 5,
                  "x": 12,
                  "y": -2,
                  "z": 8.5,
                  "rotationX": 90,
                  "color": {
                    "paletteColor": "greyLColor"
                  },
                  "name": "toe-left-2",
                  "metalness": 0.3
                },
                {
                  "type": "cone",
                  "size": 2.5,
                  "height": 5,
                  "x": 9,
                  "y": -2,
                  "z": 9,
                  "rotationX": 90,
                  "color": {
                    "paletteColor": "greyLColor"
                  },
                  "name": "toe-left-3",
                  "metalness": 0.3
                }
              ],
              "position": {
                "x": 0,
                "y": 2.5,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            },
            "right leg": {
              "shapes": [
                {
                  "type": "box",
                  "width": 8,
                  "height": 14,
                  "depth": 10,
                  "x": -9,
                  "y": 20,
                  "z": 0,
                  "color": {
                    "paletteColor": "greenDColor"
                  },
                  "name": "thigh-right",
                  "texture": "scales",
                  "roughness": 0.7,
                  "rotationX": -15,
                  "rotationY": 0,
                  "rotationZ": 0,
                  "scaleX": 1,
                  "scaleY": 1,
                  "scaleZ": 1
                },
                {
                  "type": "box",
                  "width": 7,
                  "height": 16,
                  "depth": 7,
                  "x": -9,
                  "y": 9,
                  "z": 0,
                  "color": {
                    "paletteColor": "greenDColor"
                  },
                  "name": "shin-right",
                  "texture": "scales",
                  "rotationX": 30,
                  "rotationY": 0,
                  "rotationZ": 0,
                  "scaleX": 1,
                  "scaleY": 1,
                  "scaleZ": 1
                },
                {
                  "type": "box",
                  "width": 10,
                  "height": 4,
                  "depth": 16,
                  "x": -9,
                  "y": 1,
                  "z": 0,
                  "color": {
                    "paletteColor": "greenDColor"
                  },
                  "name": "foot-right",
                  "roughness": 0.8,
                  "rotationX": 20,
                  "texture": "scales"
                },
                {
                  "type": "cone",
                  "size": 2.5,
                  "height": 5,
                  "x": -6,
                  "y": -2,
                  "z": 8.5,
                  "rotationX": 90,
                  "color": {
                    "paletteColor": "greyLColor"
                  },
                  "name": "toe-right-1",
                  "metalness": 0.3
                },
                {
                  "type": "cone",
                  "size": 2.5,
                  "height": 5,
                  "x": -12,
                  "y": -2,
                  "z": 8.5,
                  "rotationX": 90,
                  "color": {
                    "paletteColor": "greyLColor"
                  },
                  "name": "toe-right-2",
                  "metalness": 0.3
                },
                {
                  "type": "cone",
                  "size": 2.5,
                  "height": 5,
                  "x": -9,
                  "y": -2,
                  "z": 9,
                  "rotationX": 90,
                  "color": {
                    "paletteColor": "greyLColor"
                  },
                  "name": "toe-right-3",
                  "metalness": 0.3
                }
              ],
              "position": {
                "x": 0,
                "y": 2.5,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            },
            "body": {
              "shapes": [
                {
                  "type": "box",
                  "width": 18,
                  "height": 32,
                  "depth": 16,
                  "x": 0,
                  "y": 24,
                  "z": -3,
                  "rotationX": 40,
                  "color": {
                    "paletteColor": "greenDColor"
                  },
                  "name": "torso-main",
                  "texture": "scales",
                  "roughness": 0.7
                },
                {
                  "type": "box",
                  "width": 13,
                  "height": 11.5,
                  "depth": 12.8,
                  "x": 0,
                  "y": 38,
                  "z": 7.3,
                  "rotationX": 10,
                  "color": {
                    "paletteColor": "greenDColor"
                  },
                  "name": "neck",
                  "texture": "scales",
                  "rotationY": 0,
                  "rotationZ": 0,
                  "scaleX": 1,
                  "scaleY": 1,
                  "scaleZ": 1
                },
                {
                  "type": "cone",
                  "size": 6,
                  "height": 10,
                  "x": 0,
                  "y": 40,
                  "z": -5,
                  "rotationX": -55,
                  "color": {
                    "paletteColor": "greyDColor"
                  },
                  "name": "dorsal-spike-1",
                  "metalness": 0.3,
                  "roughness": 0.8
                },
                {
                  "type": "cone",
                  "size": 5.5,
                  "height": 9,
                  "x": 0,
                  "y": 34,
                  "z": -10,
                  "rotationX": -50,
                  "color": {
                    "paletteColor": "greyDColor"
                  },
                  "name": "dorsal-spike-2",
                  "metalness": 0.3,
                  "roughness": 0.8
                },
                {
                  "type": "cone",
                  "size": 5,
                  "height": 8,
                  "x": 0,
                  "y": 28,
                  "z": -14,
                  "rotationX": -45,
                  "color": {
                    "paletteColor": "greyDColor"
                  },
                  "name": "dorsal-spike-3",
                  "metalness": 0.3,
                  "roughness": 0.8
                }
              ],
              "position": {
                "x": 0,
                "y": 9.5,
                "z": -10
              },
              "rotation": {
                "x": 0.7145583290517965,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            },
            "tail base": {
              "shapes": [
                {
                  "type": "box",
                  "width": 10,
                  "height": 8,
                  "depth": 18,
                  "x": 0,
                  "y": 20,
                  "z": -20,
                  "rotationX": -20,
                  "color": {
                    "paletteColor": "greenDColor"
                  },
                  "name": "tail-base-segment",
                  "texture": "scales"
                },
                {
                  "type": "cone",
                  "size": 5,
                  "height": 8,
                  "x": 0,
                  "y": 24,
                  "z": -22,
                  "rotationX": -25,
                  "color": {
                    "paletteColor": "greyDColor"
                  },
                  "name": "tail-spike-1",
                  "metalness": 0.3,
                  "roughness": 0.8
                },
                {
                  "type": "box",
                  "width": 8,
                  "height": 6,
                  "depth": 16,
                  "x": 0,
                  "y": 18,
                  "z": -36,
                  "rotationX": -15,
                  "color": {
                    "paletteColor": "greenDColor"
                  },
                  "name": "tail-mid-segment",
                  "texture": "scales"
                },
                {
                  "type": "cone",
                  "size": 4,
                  "height": 7,
                  "x": 0,
                  "y": 22,
                  "z": -38,
                  "rotationX": -20,
                  "color": {
                    "paletteColor": "greyDColor"
                  },
                  "name": "tail-spike-2",
                  "metalness": 0.3,
                  "roughness": 0.8
                }
              ],
              "position": {
                "x": 0,
                "y": 5,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            },
            "tail tip": {
              "shapes": [
                {
                  "type": "box",
                  "width": 6,
                  "height": 5,
                  "depth": 14,
                  "x": 0,
                  "y": 16,
                  "z": -50,
                  "rotationX": -10,
                  "color": {
                    "paletteColor": "greenDColor"
                  },
                  "name": "tail-end-segment",
                  "texture": "scales"
                },
                {
                  "type": "cone",
                  "size": 3.5,
                  "height": 6,
                  "x": 0,
                  "y": 19,
                  "z": -52,
                  "rotationX": -15,
                  "color": {
                    "paletteColor": "greyDColor"
                  },
                  "name": "tail-spike-3",
                  "metalness": 0.3,
                  "roughness": 0.8
                },
                {
                  "type": "box",
                  "width": 4,
                  "height": 3,
                  "depth": 10,
                  "x": 0,
                  "y": 14.5,
                  "z": -62,
                  "rotationX": -5,
                  "color": {
                    "paletteColor": "greenDColor"
                  },
                  "name": "tail-tip-segment",
                  "texture": "scales"
                },
                {
                  "type": "cone",
                  "size": 2.5,
                  "height": 4,
                  "x": 0,
                  "y": 16.5,
                  "z": -64,
                  "rotationX": -10,
                  "color": {
                    "paletteColor": "greyDColor"
                  },
                  "name": "tail-spike-4",
                  "metalness": 0.3,
                  "roughness": 0.8
                }
              ],
              "position": {
                "x": 0,
                "y": 5,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            }
          }
        }
      },
      "pterodactyl": {
        "speed": 2,
        "value": 10,
        "hp": 5,
        "essence": 5,
        "render": {
          "animations": {
            "idle": [
              {}
            ],
            "walk": [
              {
                "shapes": {
                  "shapes": [
                    {
                      "size": 7.2,
                      "height": 14.4,
                      "y": 47.5,
                      "z": -2.4,
                      "id": 0
                    },
                    {
                      "y": 49.3,
                      "z": 9.6,
                      "id": 1
                    },
                    {
                      "y": 52.8,
                      "z": 15.9,
                      "id": 2
                    },
                    {
                      "y": 59.5,
                      "z": 13.5,
                      "id": 3
                    },
                    {
                      "y": 50,
                      "z": -2.4,
                      "rotationZ": -10,
                      "id": 4
                    },
                    {
                      "y": 50,
                      "z": -2.4,
                      "rotationZ": 10,
                      "id": 5
                    },
                    {
                      "y": 50,
                      "rotationZ": -10,
                      "id": 6
                    },
                    {
                      "y": 53,
                      "rotationZ": 10,
                      "id": 7
                    },
                    {
                      "y": 47.5,
                      "z": -16.9,
                      "id": 8
                    },
                    {
                      "y": 47.5,
                      "z": -19.6,
                      "id": 9
                    },
                    {
                      "y": 42.7,
                      "z": -4.8,
                      "rotationX": 0,
                      "id": 10
                    },
                    {
                      "y": 42.7,
                      "z": -4.8,
                      "rotationX": 0,
                      "id": 11
                    },
                    {
                      "y": 39.5,
                      "z": -4.8,
                      "rotationX": -90,
                      "id": 12
                    },
                    {
                      "y": 39.5,
                      "z": -4.8,
                      "rotationX": -90,
                      "id": 13
                    },
                    {
                      "y": 54.7,
                      "z": 15.4,
                      "id": 14
                    },
                    {
                      "y": 54.7,
                      "z": 15.4,
                      "id": 15
                    },
                    {
                      "y": 50,
                      "rotationZ": 10,
                      "id": 16
                    },
                    {
                      "y": 53,
                      "rotationZ": -10,
                      "id": 17
                    }
                  ]
                }
              },
              {
                "shapes": {
                  "shapes": [
                    {
                      "size": 7.2,
                      "height": 14.4,
                      "y": 48.5,
                      "z": -2.4,
                      "id": 0
                    },
                    {
                      "y": 50.3,
                      "z": 9.6,
                      "id": 1
                    },
                    {
                      "y": 53.8,
                      "z": 15.9,
                      "id": 2
                    },
                    {
                      "y": 60.5,
                      "z": 13.5,
                      "id": 3
                    },
                    {
                      "y": 45,
                      "z": -2.4,
                      "rotationZ": 30,
                      "id": 4
                    },
                    {
                      "y": 45,
                      "z": -2.4,
                      "rotationZ": -30,
                      "id": 5
                    },
                    {
                      "y": 45,
                      "rotationZ": 30,
                      "id": 6
                    },
                    {
                      "y": 38,
                      "id": 7
                    },
                    {
                      "y": 48.5,
                      "z": -16.9,
                      "id": 8
                    },
                    {
                      "y": 48.5,
                      "z": -19.6,
                      "id": 9
                    },
                    {
                      "y": 43.7,
                      "z": -4.8,
                      "id": 10
                    },
                    {
                      "y": 43.7,
                      "z": -4.8,
                      "id": 11
                    },
                    {
                      "y": 41,
                      "z": -4.8,
                      "id": 12
                    },
                    {
                      "y": 41,
                      "z": -4.8,
                      "id": 13
                    },
                    {
                      "y": 55.7,
                      "z": 15.4,
                      "id": 14
                    },
                    {
                      "y": 55.7,
                      "z": 15.4,
                      "id": 15
                    },
                    {
                      "y": 45,
                      "rotationZ": -30,
                      "id": 16
                    },
                    {
                      "y": 38,
                      "id": 17
                    }
                  ]
                }
              },
              {
                "shapes": {
                  "shapes": [
                    {
                      "size": 7.2,
                      "height": 14.4,
                      "y": 47.5,
                      "z": -2.4,
                      "id": 0
                    },
                    {
                      "y": 49.3,
                      "z": 9.6,
                      "id": 1
                    },
                    {
                      "y": 52.8,
                      "z": 15.9,
                      "id": 2
                    },
                    {
                      "y": 59.5,
                      "z": 13.5,
                      "id": 3
                    },
                    {
                      "y": 50,
                      "z": -2.4,
                      "rotationZ": -10,
                      "id": 4
                    },
                    {
                      "y": 50,
                      "z": -2.4,
                      "rotationZ": 10,
                      "id": 5
                    },
                    {
                      "y": 50,
                      "rotationZ": -10,
                      "id": 6
                    },
                    {
                      "y": 53,
                      "rotationZ": 10,
                      "id": 7
                    },
                    {
                      "y": 47.5,
                      "z": -16.9,
                      "id": 8
                    },
                    {
                      "y": 47.5,
                      "z": -19.6,
                      "id": 9
                    },
                    {
                      "y": 42.7,
                      "z": -4.8,
                      "rotationX": 0,
                      "id": 10
                    },
                    {
                      "y": 42.7,
                      "z": -4.8,
                      "rotationX": 0,
                      "id": 11
                    },
                    {
                      "y": 39.5,
                      "z": -4.8,
                      "rotationX": -90,
                      "id": 12
                    },
                    {
                      "y": 39.5,
                      "z": -4.8,
                      "rotationX": -90,
                      "id": 13
                    },
                    {
                      "y": 54.7,
                      "z": 15.4,
                      "id": 14
                    },
                    {
                      "y": 54.7,
                      "z": 15.4,
                      "id": 15
                    },
                    {
                      "y": 50,
                      "rotationZ": 10,
                      "id": 16
                    },
                    {
                      "y": 53,
                      "rotationZ": -10,
                      "id": 17
                    }
                  ]
                }
              },
              {
                "shapes": {
                  "shapes": [
                    {
                      "size": 7.2,
                      "height": 14.4,
                      "y": 46.5,
                      "z": -2.4,
                      "id": 0
                    },
                    {
                      "y": 48.3,
                      "z": 9.6,
                      "id": 1
                    },
                    {
                      "y": 51.8,
                      "z": 15.9,
                      "id": 2
                    },
                    {
                      "y": 58.5,
                      "z": 13.5,
                      "id": 3
                    },
                    {
                      "y": 43,
                      "z": -2.4,
                      "rotationZ": 30,
                      "id": 4
                    },
                    {
                      "y": 43,
                      "z": -2.4,
                      "rotationZ": -30,
                      "id": 5
                    },
                    {
                      "y": 43,
                      "rotationZ": 50,
                      "id": 6
                    },
                    {
                      "y": 35,
                      "rotationZ": -50,
                      "id": 7
                    },
                    {
                      "y": 46.5,
                      "z": -16.9,
                      "id": 8
                    },
                    {
                      "y": 46.5,
                      "z": -19.6,
                      "id": 9
                    },
                    {
                      "y": 41.7,
                      "z": -4.8,
                      "rotationX": 40,
                      "id": 10
                    },
                    {
                      "y": 41.7,
                      "z": -4.8,
                      "rotationX": 40,
                      "id": 11
                    },
                    {
                      "y": 38,
                      "z": -5.7,
                      "rotationX": -30,
                      "id": 12
                    },
                    {
                      "y": 38,
                      "z": -5.7,
                      "rotationX": -30,
                      "id": 13
                    },
                    {
                      "y": 53.7,
                      "z": 15.4,
                      "id": 14
                    },
                    {
                      "y": 53.7,
                      "z": 15.4,
                      "id": 15
                    },
                    {
                      "y": 43,
                      "rotationZ": 50,
                      "id": 16
                    },
                    {
                      "y": 35,
                      "rotationZ": 50,
                      "id": 17
                    }
                  ]
                }
              }
            ]
          },
          "model": {
            "shapes": {
              "shapes": [
                {
                  "type": "cylinder",
                  "size": 7.199999999999999,
                  "height": 14.399999999999999,
                  "x": 0,
                  "y": 47.48726562500001,
                  "z": -2.3686718749999995,
                  "color": "#7d6d5e",
                  "rotationX": 90,
                  "rotationZ": 0,
                  "name": "body",
                  "scaleX": 1
                },
                {
                  "type": "cylinder",
                  "size": 2.88,
                  "height": 12,
                  "x": 0,
                  "y": 49.294765625,
                  "z": 9.631328125000001,
                  "color": "#7D6B5D",
                  "rotationX": 45,
                  "rotationZ": 0,
                  "name": "neck"
                },
                {
                  "type": "cone",
                  "size": 2.4,
                  "height": 10.56,
                  "x": 0,
                  "y": 52.76726562500002,
                  "z": 15.871328125,
                  "color": "#7D6B5D",
                  "rotationX": 120,
                  "rotationZ": 0,
                  "name": "beak"
                },
                {
                  "type": "cone",
                  "size": 0.96,
                  "height": 9.6,
                  "x": 0,
                  "y": 59.48726562500001,
                  "z": 13.471328125,
                  "color": "#6D5D4D",
                  "rotationX": 0,
                  "rotationZ": 0,
                  "name": "head-spike"
                },
                {
                  "type": "box",
                  "width": 24,
                  "height": 0.48,
                  "depth": 9.6,
                  "x": -12,
                  "y": 47.48726562500001,
                  "z": -2.3686718749999995,
                  "color": "#8D7B6D",
                  "rotationY": 0,
                  "rotationZ": 15,
                  "name": "wing-right"
                },
                {
                  "type": "box",
                  "width": 24,
                  "height": 0.48,
                  "depth": 9.6,
                  "x": 12,
                  "y": 47.48726562500001,
                  "z": -2.3686718749999995,
                  "color": "#8D7B6D",
                  "rotationY": 0,
                  "rotationZ": -15,
                  "name": "wing-left"
                },
                {
                  "type": "box",
                  "width": 4,
                  "height": 0.24,
                  "depth": 2,
                  "x": -12,
                  "y": 47,
                  "z": 3,
                  "color": "#8D7B6D",
                  "rotationY": 90,
                  "rotationZ": 15,
                  "name": "hand-right"
                },
                {
                  "type": "box",
                  "width": 10,
                  "height": 0.24,
                  "depth": 6,
                  "x": 25,
                  "y": 43.2,
                  "z": -4.1,
                  "color": "#8D7B6D",
                  "rotationY": 40,
                  "rotationZ": -30,
                  "rotationX": 16,
                  "name": "wingtip-left"
                },
                {
                  "type": "cone",
                  "size": 1.92,
                  "height": 12,
                  "x": 0,
                  "y": 47.48726562500001,
                  "z": -16.851171875000002,
                  "color": "#7D6B5D",
                  "rotationX": -90,
                  "rotationZ": 0,
                  "name": "tail"
                },
                {
                  "type": "box",
                  "width": 5.76,
                  "height": 0.48,
                  "depth": 4.8,
                  "x": 0,
                  "y": 47.48726562500001,
                  "z": -19.648671875,
                  "color": "#8D7B6D",
                  "rotationX": 0,
                  "rotationZ": 0,
                  "name": "tail-tip"
                },
                {
                  "type": "cylinder",
                  "size": 0.72,
                  "height": 5.76,
                  "x": -2.4,
                  "y": 42.68726562500001,
                  "z": -4.768671874999999,
                  "color": "#6D5D4D",
                  "rotationX": 20,
                  "rotationZ": 0,
                  "name": "leg-right"
                },
                {
                  "type": "cylinder",
                  "size": 0.72,
                  "height": 5.76,
                  "x": 2.4,
                  "y": 42.68726562500001,
                  "z": -4.768671874999999,
                  "color": "#6D5D4D",
                  "rotationX": 20,
                  "rotationZ": 0,
                  "name": "leg-left"
                },
                {
                  "type": "cone",
                  "size": 1.44,
                  "height": 2.4,
                  "x": -2.4,
                  "y": 40.04726562500001,
                  "z": -4.851171875,
                  "color": "#6D5D4D",
                  "rotationX": -60,
                  "rotationZ": 0,
                  "name": "foot-right"
                },
                {
                  "type": "cone",
                  "size": 1.44,
                  "height": 2.4,
                  "x": 2.4,
                  "y": 40.04726562500001,
                  "z": -4.851171875,
                  "color": "#6D5D4D",
                  "rotationX": -60,
                  "rotationZ": 0,
                  "name": "foot-left"
                },
                {
                  "type": "sphere",
                  "size": 0.72,
                  "x": -0.96,
                  "y": 54.68726562500001,
                  "z": 15.391328125000001,
                  "color": "#000000",
                  "name": "eye-right"
                },
                {
                  "type": "sphere",
                  "size": 0.72,
                  "x": 0.96,
                  "y": 54.68726562500001,
                  "z": 15.391328125000001,
                  "color": "#000000",
                  "name": "eye-left"
                },
                {
                  "type": "box",
                  "width": 4,
                  "height": 0.24,
                  "depth": 2,
                  "x": 12,
                  "y": 47,
                  "z": 3,
                  "color": "#8D7B6D",
                  "rotationY": 90,
                  "rotationZ": 15,
                  "name": "hand-left"
                },
                {
                  "type": "box",
                  "width": 10,
                  "height": 0.24,
                  "depth": 6,
                  "x": -25,
                  "y": 43.2,
                  "z": -4.1,
                  "color": "#8D7B6D",
                  "rotationY": -40,
                  "rotationZ": 30,
                  "rotationX": 16,
                  "name": "wingtip-right"
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            }
          }
        },
        "title": "Pterodactyl"
      },
      "redDragon": {
        "hp": 500,
        "speed": 0.5,
        "essence": 50,
        "value": 50,
        "boss": true,
        "render": {
          "animations": {
            "idle": [
              {}
            ],
            "walk": [
              {
                "right wing": {
                  "shapes": [
                    {
                      "rotationX": 0.1,
                      "rotationY": -0.7,
                      "id": 1
                    }
                  ]
                },
                "head": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "redMColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "redMColor"
                      },
                      "id": 3
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 4
                    },
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 5
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 6
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 7
                    }
                  ]
                },
                "jaw": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "redMColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 3
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 4
                    }
                  ]
                },
                "left arm": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 3
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 4
                    }
                  ]
                },
                "right arm": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 3
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 4
                    }
                  ]
                },
                "left leg": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 3
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 4
                    }
                  ]
                },
                "right leg": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 3
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 4
                    }
                  ]
                },
                "body": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 3
                    }
                  ]
                },
                "left wing": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 3
                    }
                  ]
                },
                "tail base": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 2
                    }
                  ]
                },
                "tail tip": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 3
                    }
                  ]
                }
              },
              {
                "head": {
                  "position": {
                    "x": 0,
                    "y": 3.2,
                    "z": 20
                  },
                  "rotation": {
                    "x": 0,
                    "y": 0.15,
                    "z": 0
                  }
                },
                "jaw": {
                  "rotation": {
                    "x": 0.35,
                    "y": 0,
                    "z": 0
                  }
                },
                "left arm": {
                  "position": {
                    "x": 1.5,
                    "y": -1,
                    "z": 6.5
                  },
                  "rotation": {
                    "x": 0.4,
                    "y": 0,
                    "z": 0.1
                  }
                },
                "right arm": {
                  "position": {
                    "x": 0,
                    "y": -2,
                    "z": 14
                  },
                  "rotation": {
                    "x": -0.1,
                    "y": 0,
                    "z": -0.1
                  }
                },
                "left leg": {
                  "position": {
                    "x": 0,
                    "y": 5,
                    "z": -10
                  },
                  "rotation": {
                    "x": 0.5,
                    "y": 0,
                    "z": 0
                  }
                },
                "right leg": {
                  "position": {
                    "x": 0,
                    "y": 3,
                    "z": 8
                  },
                  "rotation": {
                    "x": -0.4,
                    "y": 0,
                    "z": 0
                  }
                },
                "body": {
                  "rotation": {
                    "x": 0.6,
                    "y": 0.05,
                    "z": 0
                  }
                },
                "left wing": {
                  "position": {
                    "x": 5,
                    "y": 5.5,
                    "z": 15
                  },
                  "rotation": {
                    "x": 0.2,
                    "y": 0.7,
                    "z": 0
                  },
                  "shapes": [
                    {
                      "rotationX": 0.3,
                      "rotationY": 0.9,
                      "id": 1
                    }
                  ]
                },
                "right wing": {
                  "position": {
                    "x": -5,
                    "y": 5.5,
                    "z": 15
                  },
                  "rotation": {
                    "x": 0.2,
                    "y": -0.7,
                    "z": 0
                  },
                  "shapes": [
                    {
                      "rotationX": 0.3,
                      "rotationY": -0.9,
                      "id": 1
                    }
                  ]
                },
                "tail base": {
                  "rotation": {
                    "x": 0.1,
                    "y": 0.3,
                    "z": 0
                  }
                },
                "tail tip": {
                  "rotation": {
                    "x": 0.05,
                    "y": 0.4,
                    "z": 0
                  }
                }
              },
              {
                "left wing": {
                  "shapes": [
                    {
                      "rotationX": 0.1,
                      "rotationY": 0.7,
                      "id": 1
                    }
                  ]
                },
                "right wing": {
                  "shapes": [
                    {
                      "rotationX": 0.1,
                      "rotationY": -0.7,
                      "id": 1
                    }
                  ]
                },
                "head": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "redMColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "redMColor"
                      },
                      "id": 3
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 4
                    },
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 5
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 6
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 7
                    }
                  ]
                },
                "jaw": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "redMColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 3
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 4
                    }
                  ]
                },
                "left arm": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 3
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 4
                    }
                  ]
                },
                "right arm": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 3
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 4
                    }
                  ]
                },
                "left leg": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 3
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 4
                    }
                  ]
                },
                "right leg": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 3
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 4
                    }
                  ]
                },
                "body": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 3
                    }
                  ]
                },
                "tail base": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 2
                    }
                  ]
                },
                "tail tip": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "brownDColor"
                      },
                      "id": 3
                    }
                  ]
                }
              },
              {
                "head": {
                  "position": {
                    "x": 0,
                    "y": 2.8,
                    "z": 20
                  },
                  "rotation": {
                    "x": 0,
                    "y": -0.15,
                    "z": 0
                  }
                },
                "jaw": {
                  "position": {
                    "x": 0,
                    "y": 10.3,
                    "z": 8
                  },
                  "rotation": {
                    "x": 0.35,
                    "y": 0,
                    "z": 0
                  }
                },
                "left arm": {
                  "position": {
                    "x": 0,
                    "y": -2,
                    "z": 14
                  },
                  "rotation": {
                    "x": -0.1,
                    "y": 0,
                    "z": 0.1
                  }
                },
                "right arm": {
                  "position": {
                    "x": -1.5,
                    "y": -1,
                    "z": 6.5
                  },
                  "rotation": {
                    "x": 0.4,
                    "y": 0,
                    "z": -0.1
                  }
                },
                "left leg": {
                  "position": {
                    "x": 0,
                    "y": 3,
                    "z": 8
                  },
                  "rotation": {
                    "x": -0.4,
                    "y": 0,
                    "z": 0
                  }
                },
                "right leg": {
                  "position": {
                    "x": 0,
                    "y": 5,
                    "z": -10
                  },
                  "rotation": {
                    "x": 0.5,
                    "y": 0,
                    "z": 0
                  }
                },
                "body": {
                  "position": {
                    "x": 0,
                    "y": 9.8,
                    "z": -8
                  },
                  "rotation": {
                    "x": 0.6,
                    "y": -0.05,
                    "z": 0
                  }
                },
                "left wing": {
                  "position": {
                    "x": 5,
                    "y": 4.5,
                    "z": 15
                  },
                  "rotation": {
                    "x": 0.2,
                    "y": 0.6,
                    "z": 0
                  },
                  "shapes": [
                    {
                      "rotationX": 0.2,
                      "rotationY": 0.8,
                      "id": 1
                    }
                  ]
                },
                "right wing": {
                  "position": {
                    "x": -5,
                    "y": 4.5,
                    "z": 15
                  },
                  "rotation": {
                    "x": 0.2,
                    "y": -0.6,
                    "z": 0
                  },
                  "shapes": [
                    {
                      "rotationX": 0.2,
                      "rotationY": -0.8,
                      "id": 1
                    }
                  ]
                },
                "tail base": {
                  "rotation": {
                    "x": 0.1,
                    "y": -0.3,
                    "z": 0
                  }
                },
                "tail tip": {
                  "rotation": {
                    "x": 0.05,
                    "y": -0.4,
                    "z": 0
                  }
                }
              }
            ]
          },
          "model": {
            "head": {
              "shapes": [
                {
                  "type": "box",
                  "width": 18,
                  "height": 16,
                  "depth": 24,
                  "x": 0,
                  "y": 44,
                  "z": 16,
                  "color": {
                    "paletteColor": "redDColor"
                  },
                  "name": "head-main"
                },
                {
                  "type": "sphere",
                  "size": 5,
                  "x": -9,
                  "y": 48,
                  "z": 18,
                  "color": {
                    "paletteColor": "redMColor"
                  },
                  "name": "eye-right",
                  "emissive": "#FFA500"
                },
                {
                  "type": "sphere",
                  "size": 2.5,
                  "x": -9,
                  "y": 48,
                  "z": 19.5,
                  "color": {
                    "paletteColor": "brownDColor"
                  },
                  "name": "pupil-right"
                },
                {
                  "type": "sphere",
                  "size": 5,
                  "x": 9,
                  "y": 48,
                  "z": 18,
                  "color": {
                    "paletteColor": "redMColor"
                  },
                  "name": "eye-left",
                  "emissive": "#FFA500"
                },
                {
                  "type": "sphere",
                  "size": 2.5,
                  "x": 9,
                  "y": 48,
                  "z": 19.5,
                  "color": {
                    "paletteColor": "brownDColor"
                  },
                  "name": "pupil-left"
                },
                {
                  "type": "box",
                  "width": 16,
                  "height": 3,
                  "depth": 8,
                  "x": 0,
                  "y": 52,
                  "z": 16,
                  "color": {
                    "paletteColor": "redDColor"
                  },
                  "name": "brow-ridge"
                },
                {
                  "type": "cone",
                  "size": 3,
                  "height": 6,
                  "x": -6,
                  "y": 52,
                  "z": 26,
                  "color": {
                    "paletteColor": "brownDColor"
                  },
                  "name": "horn-right"
                },
                {
                  "type": "cone",
                  "size": 3,
                  "height": 6,
                  "x": 6,
                  "y": 52,
                  "z": 26,
                  "color": {
                    "paletteColor": "brownDColor"
                  },
                  "name": "horn-left"
                }
              ],
              "position": {
                "x": 0,
                "y": 3,
                "z": 20
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            },
            "jaw": {
              "shapes": [
                {
                  "type": "box",
                  "width": 20,
                  "height": 8,
                  "depth": 22,
                  "x": 0,
                  "y": 32,
                  "z": 18,
                  "color": {
                    "paletteColor": "redDColor"
                  },
                  "name": "jaw-main"
                },
                {
                  "type": "box",
                  "width": 16,
                  "height": 3,
                  "depth": 3,
                  "x": 0,
                  "y": 35,
                  "z": 26,
                  "color": {
                    "paletteColor": "redMColor"
                  },
                  "name": "gums"
                },
                {
                  "type": "cone",
                  "width": 2,
                  "height": 2,
                  "depth": 2,
                  "x": -6,
                  "y": 36.7,
                  "z": 26,
                  "color": {
                    "paletteColor": "greyLColor"
                  },
                  "name": "tooth-right",
                  "shininess": 80,
                  "size": 2
                },
                {
                  "type": "cone",
                  "width": 2,
                  "height": 2,
                  "depth": 2,
                  "x": 6,
                  "y": 36.7,
                  "z": 26,
                  "color": {
                    "paletteColor": "greyLColor"
                  },
                  "name": "tooth-left",
                  "shininess": 80,
                  "size": 2
                },
                {
                  "type": "cone",
                  "width": 2,
                  "height": 2,
                  "depth": 2,
                  "x": 0,
                  "y": 36.5,
                  "z": 26,
                  "color": {
                    "paletteColor": "greyLColor"
                  },
                  "name": "tooth-middle",
                  "shininess": 80,
                  "size": 2
                }
              ],
              "position": {
                "x": 0,
                "y": 10.5,
                "z": 8
              },
              "rotation": {
                "x": 0.3,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            },
            "left arm": {
              "shapes": [
                {
                  "type": "box",
                  "width": 6,
                  "height": 10,
                  "depth": 6,
                  "x": 12,
                  "y": 30,
                  "z": 2,
                  "rotationX": -30,
                  "color": {
                    "paletteColor": "redDColor"
                  },
                  "name": "upper-arm-left"
                },
                {
                  "type": "box",
                  "width": 5,
                  "height": 8,
                  "depth": 5,
                  "x": 12,
                  "y": 26,
                  "z": 6,
                  "rotationX": -15,
                  "color": {
                    "paletteColor": "redDColor"
                  },
                  "name": "lower-arm-left"
                },
                {
                  "type": "box",
                  "width": 4,
                  "height": 4,
                  "depth": 4,
                  "x": 12,
                  "y": 24,
                  "z": 8,
                  "color": {
                    "paletteColor": "redDColor"
                  },
                  "name": "hand-left"
                },
                {
                  "type": "cone",
                  "size": 1.5,
                  "height": 4,
                  "x": 13,
                  "y": 23,
                  "z": 10,
                  "color": {
                    "paletteColor": "brownDColor"
                  },
                  "name": "claw-left-1",
                  "rotationX": 180
                },
                {
                  "type": "cone",
                  "size": 1.5,
                  "height": 4,
                  "x": 11,
                  "y": 23,
                  "z": 10,
                  "color": {
                    "paletteColor": "brownDColor"
                  },
                  "name": "claw-left-2",
                  "rotationX": 180
                }
              ],
              "position": {
                "x": 0,
                "y": -2,
                "z": 12
              },
              "rotation": {
                "x": 0.2,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            },
            "right arm": {
              "shapes": [
                {
                  "type": "box",
                  "width": 6,
                  "height": 10,
                  "depth": 6,
                  "x": -12,
                  "y": 30,
                  "z": 2,
                  "rotationX": -30,
                  "color": {
                    "paletteColor": "redDColor"
                  },
                  "name": "upper-arm-right"
                },
                {
                  "type": "box",
                  "width": 5,
                  "height": 8,
                  "depth": 5,
                  "x": -12,
                  "y": 26,
                  "z": 6,
                  "rotationX": -15,
                  "color": {
                    "paletteColor": "redDColor"
                  },
                  "name": "lower-arm-right"
                },
                {
                  "type": "box",
                  "width": 4,
                  "height": 4,
                  "depth": 4,
                  "x": -12,
                  "y": 24,
                  "z": 8,
                  "color": {
                    "paletteColor": "redDColor"
                  },
                  "name": "hand-right"
                },
                {
                  "type": "cone",
                  "size": 1.5,
                  "height": 4,
                  "x": -13,
                  "y": 23,
                  "z": 10,
                  "color": {
                    "paletteColor": "brownDColor"
                  },
                  "name": "claw-right-1",
                  "rotationX": 180
                },
                {
                  "type": "cone",
                  "size": 1.5,
                  "height": 4,
                  "x": -11,
                  "y": 23,
                  "z": 10,
                  "color": {
                    "paletteColor": "brownDColor"
                  },
                  "name": "claw-right-2",
                  "rotationX": 180,
                  "rotationY": 0,
                  "rotationZ": 0,
                  "scaleX": 1,
                  "scaleY": 1,
                  "scaleZ": 1
                }
              ],
              "position": {
                "x": 0,
                "y": -2,
                "z": 12
              },
              "rotation": {
                "x": 0.2,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            },
            "left leg": {
              "shapes": [
                {
                  "type": "box",
                  "width": 10,
                  "height": 16,
                  "depth": 12,
                  "x": 10,
                  "y": 22,
                  "z": 2,
                  "color": {
                    "paletteColor": "redDColor"
                  },
                  "name": "thigh-left",
                  "rotationX": -10
                },
                {
                  "type": "box",
                  "width": 8,
                  "height": 18,
                  "depth": 8,
                  "x": 10,
                  "y": 10,
                  "z": 2,
                  "color": {
                    "paletteColor": "redDColor"
                  },
                  "name": "shin-left",
                  "rotationX": 20
                },
                {
                  "type": "box",
                  "width": 12,
                  "height": 5,
                  "depth": 18,
                  "x": 10,
                  "y": 2,
                  "z": 2,
                  "color": {
                    "paletteColor": "redDColor"
                  },
                  "name": "foot-left",
                  "rotationX": 15
                },
                {
                  "type": "cone",
                  "size": 3,
                  "height": 6,
                  "x": 7,
                  "y": 0,
                  "z": 11,
                  "rotationX": 90,
                  "color": {
                    "paletteColor": "brownDColor"
                  },
                  "name": "toe-left-1"
                },
                {
                  "type": "cone",
                  "size": 3,
                  "height": 6,
                  "x": 13,
                  "y": 0,
                  "z": 11,
                  "rotationX": 90,
                  "color": {
                    "paletteColor": "brownDColor"
                  },
                  "name": "toe-left-2"
                }
              ],
              "position": {
                "x": 0,
                "y": 3,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            },
            "right leg": {
              "shapes": [
                {
                  "type": "box",
                  "width": 10,
                  "height": 16,
                  "depth": 12,
                  "x": -10,
                  "y": 22,
                  "z": 2,
                  "color": {
                    "paletteColor": "redDColor"
                  },
                  "name": "thigh-right",
                  "rotationX": -10
                },
                {
                  "type": "box",
                  "width": 8,
                  "height": 18,
                  "depth": 8,
                  "x": -10,
                  "y": 10,
                  "z": 2,
                  "color": {
                    "paletteColor": "redDColor"
                  },
                  "name": "shin-right",
                  "rotationX": 20
                },
                {
                  "type": "box",
                  "width": 12,
                  "height": 5,
                  "depth": 18,
                  "x": -10,
                  "y": 2,
                  "z": 2,
                  "color": {
                    "paletteColor": "redDColor"
                  },
                  "name": "foot-right",
                  "rotationX": 15
                },
                {
                  "type": "cone",
                  "size": 3,
                  "height": 6,
                  "x": -7,
                  "y": 0,
                  "z": 11,
                  "rotationX": 90,
                  "color": {
                    "paletteColor": "brownDColor"
                  },
                  "name": "toe-right-1"
                },
                {
                  "type": "cone",
                  "size": 3,
                  "height": 6,
                  "x": -13,
                  "y": 0,
                  "z": 11,
                  "rotationX": 90,
                  "color": {
                    "paletteColor": "brownDColor"
                  },
                  "name": "toe-right-2"
                }
              ],
              "position": {
                "x": 0,
                "y": 3,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            },
            "body": {
              "shapes": [
                {
                  "type": "box",
                  "width": 20,
                  "height": 34,
                  "depth": 18,
                  "x": 0,
                  "y": 26,
                  "z": -2,
                  "rotationX": 30,
                  "color": {
                    "paletteColor": "redDColor"
                  },
                  "name": "torso-main"
                },
                {
                  "type": "box",
                  "width": 14,
                  "height": 15.3,
                  "depth": 14,
                  "x": 0,
                  "y": 45.46875,
                  "z": 8,
                  "rotationX": 10,
                  "color": {
                    "paletteColor": "redDColor"
                  },
                  "name": "neck",
                  "rotationY": 0,
                  "rotationZ": 0,
                  "scaleX": 1,
                  "scaleY": 1,
                  "scaleZ": 1
                },
                {
                  "type": "cone",
                  "size": 6,
                  "height": 12,
                  "x": 0,
                  "y": 38.39468690702089,
                  "z": -6.745098039215698,
                  "rotationX": -65,
                  "color": {
                    "paletteColor": "brownDColor"
                  },
                  "name": "spike-1",
                  "rotationY": 0,
                  "rotationZ": 0,
                  "scaleX": 1,
                  "scaleY": 1,
                  "scaleZ": 1
                },
                {
                  "type": "cone",
                  "size": 5,
                  "height": 10,
                  "x": 0,
                  "y": 28.979127134724877,
                  "z": -14.513725490196073,
                  "rotationX": -66,
                  "color": {
                    "paletteColor": "brownDColor"
                  },
                  "name": "spike-2",
                  "rotationY": 0,
                  "rotationZ": 0,
                  "scaleX": 1,
                  "scaleY": 1,
                  "scaleZ": 1
                }
              ],
              "position": {
                "x": 0,
                "y": 10,
                "z": -8
              },
              "rotation": {
                "x": 0.6,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            },
            "left wing": {
              "shapes": [
                {
                  "type": "box",
                  "width": 10,
                  "height": 2,
                  "depth": 20,
                  "x": 15,
                  "y": 35,
                  "z": -5,
                  "rotationX": 10,
                  "rotationY": 60,
                  "color": {
                    "paletteColor": "redDColor"
                  },
                  "name": "wing-base-left"
                },
                {
                  "type": "box",
                  "width": 40,
                  "height": 1,
                  "depth": 30,
                  "x": 35,
                  "y": 35,
                  "z": -2.5,
                  "rotationX": 0,
                  "rotationY": 1,
                  "color": {
                    "paletteColor": "redDColor"
                  },
                  "name": "wing-membrane-left"
                },
                {
                  "type": "cone",
                  "size": 2,
                  "height": 5,
                  "x": 14,
                  "y": 34.8,
                  "z": 14,
                  "rotationX": 90,
                  "rotationY": 0,
                  "color": {
                    "paletteColor": "brownDColor"
                  },
                  "name": "wing-claw-left",
                  "rotationZ": 45,
                  "scaleX": 1,
                  "scaleY": 1,
                  "scaleZ": 1
                },
                {
                  "type": "box",
                  "width": 20,
                  "height": 1,
                  "depth": 10,
                  "x": 60,
                  "y": 35,
                  "z": -5.5,
                  "rotationX": 5,
                  "rotationY": 40,
                  "color": {
                    "paletteColor": "redDColor"
                  },
                  "name": "wing-membrane-left",
                  "rotationZ": 0,
                  "scaleX": 1,
                  "scaleY": 1,
                  "scaleZ": 1
                }
              ],
              "position": {
                "x": 5,
                "y": 5,
                "z": 15
              },
              "rotation": {
                "x": 0,
                "y": 0.5,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            },
            "right wing": {
              "shapes": [
                {
                  "type": "box",
                  "width": 10,
                  "height": 2,
                  "depth": 20,
                  "x": -15,
                  "y": 35,
                  "z": -5,
                  "rotationX": 10,
                  "rotationY": -60,
                  "color": {
                    "paletteColor": "redDColor"
                  },
                  "name": "wing-base-right"
                },
                {
                  "type": "box",
                  "width": 40,
                  "height": 1,
                  "depth": 30,
                  "x": -35,
                  "y": 35,
                  "z": -2.5,
                  "rotationX": 0,
                  "rotationY": -1,
                  "color": {
                    "paletteColor": "redDColor"
                  },
                  "name": "wing-membrane-right"
                },
                {
                  "type": "cone",
                  "size": 2,
                  "height": 5,
                  "x": -14,
                  "y": 34.8,
                  "z": 14,
                  "rotationX": 90,
                  "rotationY": 0,
                  "color": {
                    "paletteColor": "brownDColor"
                  },
                  "name": "wing-claw-right",
                  "rotationZ": -45,
                  "scaleX": 1,
                  "scaleY": 1,
                  "scaleZ": 1
                },
                {
                  "type": "box",
                  "width": 20,
                  "height": 1,
                  "depth": 10,
                  "x": -60,
                  "y": 35,
                  "z": -5.5,
                  "rotationX": 5,
                  "rotationY": -40,
                  "color": {
                    "paletteColor": "redDColor"
                  },
                  "name": "wing-membrane-right",
                  "rotationZ": 0,
                  "scaleX": 1,
                  "scaleY": 1,
                  "scaleZ": 1
                }
              ],
              "position": {
                "x": -5,
                "y": 5,
                "z": 15
              },
              "rotation": {
                "x": 0,
                "y": -0.5,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            },
            "tail base": {
              "shapes": [
                {
                  "type": "box",
                  "width": 12,
                  "height": 10,
                  "depth": 20,
                  "x": 0,
                  "y": 22,
                  "z": -18,
                  "rotationX": -15,
                  "color": {
                    "paletteColor": "redDColor"
                  },
                  "name": "tail-base-segment"
                },
                {
                  "type": "cone",
                  "size": 5,
                  "height": 10,
                  "x": 0,
                  "y": 26,
                  "z": -20,
                  "rotationX": -20,
                  "color": {
                    "paletteColor": "brownDColor"
                  },
                  "name": "tail-spike-1"
                },
                {
                  "type": "box",
                  "width": 10,
                  "height": 8,
                  "depth": 18,
                  "x": 0,
                  "y": 20,
                  "z": -34,
                  "rotationX": -10,
                  "color": {
                    "paletteColor": "redDColor"
                  },
                  "name": "tail-mid-segment"
                }
              ],
              "position": {
                "x": 0,
                "y": 6,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            },
            "tail tip": {
              "shapes": [
                {
                  "type": "box",
                  "width": 8,
                  "height": 6,
                  "depth": 16,
                  "x": 0,
                  "y": 18,
                  "z": -48,
                  "rotationX": -5,
                  "color": {
                    "paletteColor": "redDColor"
                  },
                  "name": "tail-end-segment"
                },
                {
                  "type": "cone",
                  "size": 4,
                  "height": 8,
                  "x": 0,
                  "y": 21,
                  "z": -50,
                  "rotationX": -10,
                  "color": {
                    "paletteColor": "brownDColor"
                  },
                  "name": "tail-spike-2"
                },
                {
                  "type": "box",
                  "width": 6,
                  "height": 4,
                  "depth": 12,
                  "x": 0,
                  "y": 16,
                  "z": -60,
                  "rotationX": 0,
                  "color": {
                    "paletteColor": "redDColor"
                  },
                  "name": "tail-tip-segment"
                },
                {
                  "type": "cone",
                  "size": 3,
                  "height": 6,
                  "x": 0,
                  "y": 18,
                  "z": -62,
                  "rotationX": -5,
                  "color": {
                    "paletteColor": "brownDColor"
                  },
                  "name": "tail-spike-3"
                }
              ],
              "position": {
                "x": 0,
                "y": 6,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            }
          }
        },
        "fireResistance": 75,
        "coldResistance": 25,
        "electricResistance": 25,
        "title": "Red Dragon"
      },
      "trex": {
        "title": "T-Rex",
        "hp": 50,
        "speed": 1.5,
        "value": 10,
        "essence": 15,
        "render": {
          "animations": {
            "idle": [
              {}
            ],
            "walk": [
              {
                "shapes": {
                  "shapes": [
                    {
                      "y": 23,
                      "color": {
                        "paletteColor": "greenMColor"
                      },
                      "id": 0
                    },
                    {
                      "y": 37.5,
                      "id": 1
                    },
                    {
                      "y": 29.5,
                      "id": 2
                    },
                    {
                      "y": 31.5,
                      "id": 3
                    },
                    {
                      "y": 31.5,
                      "id": 4
                    },
                    {
                      "y": 31.5,
                      "id": 5
                    },
                    {
                      "y": 31.5,
                      "id": 6
                    },
                    {
                      "y": 42.5,
                      "id": 7
                    },
                    {
                      "y": 42.5,
                      "id": 8
                    },
                    {
                      "y": 42.5,
                      "id": 9
                    },
                    {
                      "y": 42.5,
                      "id": 10
                    },
                    {
                      "x": 1.5,
                      "rotationZ": 10,
                      "id": 11
                    },
                    {
                      "x": 3,
                      "rotationZ": 15,
                      "id": 12
                    },
                    {
                      "z": 3,
                      "rotationX": 15,
                      "id": 13
                    },
                    {
                      "y": 8,
                      "z": -5,
                      "rotationX": -25,
                      "id": 14
                    },
                    {
                      "y": 3,
                      "z": 9,
                      "rotationX": 15,
                      "id": 15
                    },
                    {
                      "z": -10,
                      "rotationX": -25,
                      "id": 16
                    },
                    {
                      "z": -1,
                      "rotationX": -20,
                      "id": 17
                    },
                    {
                      "z": 2,
                      "rotationX": -60,
                      "id": 18
                    },
                    {
                      "z": 1,
                      "id": 19
                    },
                    {
                      "y": 22,
                      "z": 5,
                      "id": 20
                    },
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 21
                    },
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 22
                    },
                    {
                      "x": 1.5,
                      "rotationZ": 10,
                      "id": 23
                    },
                    {
                      "x": 3,
                      "rotationZ": 15,
                      "id": 24
                    }
                  ]
                }
              },
              {
                "shapes": {
                  "shapes": [
                    {
                      "type": "box",
                      "width": 12,
                      "height": 25,
                      "depth": 12,
                      "x": 0,
                      "y": 22.8,
                      "z": 0,
                      "rotationX": 46,
                      "color": {
                        "paletteColor": "greenMColor"
                      },
                      "name": "body",
                      "scaleX": 1,
                      "rotationY": 0,
                      "rotationZ": 0,
                      "scaleY": 1,
                      "scaleZ": 1,
                      "texture": "scales",
                      "id": 0
                    },
                    {
                      "y": 37.3,
                      "id": 1
                    },
                    {
                      "y": 29.3,
                      "id": 2
                    },
                    {
                      "y": 31.3,
                      "id": 3
                    },
                    {
                      "y": 31.3,
                      "id": 4
                    },
                    {
                      "y": 31.3,
                      "id": 5
                    },
                    {
                      "y": 31.3,
                      "id": 6
                    },
                    {
                      "y": 42.3,
                      "id": 7
                    },
                    {
                      "y": 42.3,
                      "id": 8
                    },
                    {
                      "y": 42.3,
                      "id": 9
                    },
                    {
                      "y": 42.3,
                      "id": 10
                    },
                    {
                      "y": 9,
                      "rotationX": -5,
                      "id": 13
                    },
                    {
                      "y": 11,
                      "rotationX": 5,
                      "id": 14
                    },
                    {
                      "y": 0.5,
                      "z": -1,
                      "rotationX": -5,
                      "id": 15
                    },
                    {
                      "y": 1.5,
                      "z": 1,
                      "rotationX": 5,
                      "id": 16
                    },
                    {
                      "rotationX": -50,
                      "id": 17
                    },
                    {
                      "rotationX": -30,
                      "id": 18
                    },
                    {
                      "y": 23,
                      "z": 4,
                      "id": 19
                    },
                    {
                      "y": 25,
                      "z": 2,
                      "id": 20
                    },
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 21
                    },
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 22
                    }
                  ]
                }
              },
              {
                "shapes": {
                  "shapes": [
                    {
                      "type": "box",
                      "width": 12,
                      "height": 25,
                      "depth": 12,
                      "x": 0,
                      "y": 23,
                      "z": 0,
                      "rotationX": 46,
                      "color": {
                        "paletteColor": "greenMColor"
                      },
                      "name": "body",
                      "scaleX": 1,
                      "rotationY": 0,
                      "rotationZ": 0,
                      "scaleY": 1,
                      "scaleZ": 1,
                      "texture": "scales",
                      "id": 0
                    },
                    {
                      "y": 37.5,
                      "id": 1
                    },
                    {
                      "y": 29.5,
                      "id": 2
                    },
                    {
                      "y": 31.5,
                      "id": 3
                    },
                    {
                      "y": 31.5,
                      "id": 4
                    },
                    {
                      "y": 31.5,
                      "id": 5
                    },
                    {
                      "y": 31.5,
                      "id": 6
                    },
                    {
                      "y": 42.5,
                      "id": 7
                    },
                    {
                      "y": 42.5,
                      "id": 8
                    },
                    {
                      "y": 42.5,
                      "id": 9
                    },
                    {
                      "y": 42.5,
                      "id": 10
                    },
                    {
                      "x": -1.5,
                      "rotationZ": -10,
                      "id": 11
                    },
                    {
                      "x": -3,
                      "rotationZ": -15,
                      "id": 12
                    },
                    {
                      "y": 8,
                      "z": -5,
                      "rotationX": -25,
                      "id": 13
                    },
                    {
                      "z": 3,
                      "rotationX": 15,
                      "id": 14
                    },
                    {
                      "z": -10,
                      "rotationX": -25,
                      "id": 15
                    },
                    {
                      "y": 3,
                      "z": 9,
                      "rotationX": 15,
                      "id": 16
                    },
                    {
                      "z": 2,
                      "rotationX": -60,
                      "id": 17
                    },
                    {
                      "z": -1,
                      "rotationX": -20,
                      "id": 18
                    },
                    {
                      "y": 22,
                      "z": 5,
                      "id": 19
                    },
                    {
                      "z": 1,
                      "id": 20
                    },
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 21
                    },
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 22
                    },
                    {
                      "x": -1.5,
                      "rotationZ": -10,
                      "id": 23
                    },
                    {
                      "x": -3,
                      "rotationZ": -15,
                      "id": 24
                    }
                  ]
                }
              },
              {
                "shapes": {
                  "shapes": [
                    {
                      "type": "box",
                      "width": 12,
                      "height": 25,
                      "depth": 12,
                      "x": 0,
                      "y": 22.8,
                      "z": 0,
                      "rotationX": 46,
                      "color": {
                        "paletteColor": "greenMColor"
                      },
                      "name": "body",
                      "scaleX": 1,
                      "rotationY": 0,
                      "rotationZ": 0,
                      "scaleY": 1,
                      "scaleZ": 1,
                      "texture": "scales",
                      "id": 0
                    },
                    {
                      "y": 37.3,
                      "id": 1
                    },
                    {
                      "y": 29.3,
                      "id": 2
                    },
                    {
                      "y": 31.3,
                      "id": 3
                    },
                    {
                      "y": 31.3,
                      "id": 4
                    },
                    {
                      "y": 31.3,
                      "id": 5
                    },
                    {
                      "y": 31.3,
                      "id": 6
                    },
                    {
                      "y": 42.3,
                      "id": 7
                    },
                    {
                      "y": 42.3,
                      "id": 8
                    },
                    {
                      "y": 42.3,
                      "id": 9
                    },
                    {
                      "y": 42.3,
                      "id": 10
                    },
                    {
                      "y": 11,
                      "rotationX": 5,
                      "id": 13
                    },
                    {
                      "y": 9,
                      "rotationX": -5,
                      "id": 14
                    },
                    {
                      "y": 1.5,
                      "z": 1,
                      "rotationX": 5,
                      "id": 15
                    },
                    {
                      "y": 0.5,
                      "z": -1,
                      "rotationX": -5,
                      "id": 16
                    },
                    {
                      "rotationX": -30,
                      "id": 17
                    },
                    {
                      "rotationX": -50,
                      "id": 18
                    },
                    {
                      "y": 25,
                      "z": 2,
                      "id": 19
                    },
                    {
                      "y": 23,
                      "z": 4,
                      "id": 20
                    },
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 21
                    },
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 22
                    }
                  ]
                }
              }
            ]
          },
          "model": {
            "shapes": {
              "shapes": [
                {
                  "type": "box",
                  "width": 12,
                  "height": 25,
                  "depth": 12,
                  "x": 0,
                  "y": 22.6,
                  "z": 0,
                  "rotationX": 46,
                  "color": {
                    "paletteColor": "greenMColor"
                  },
                  "name": "body",
                  "scaleX": 1,
                  "rotationY": 0,
                  "rotationZ": 0,
                  "scaleY": 1,
                  "scaleZ": 1,
                  "texture": "scales"
                },
                {
                  "type": "box",
                  "width": 13,
                  "height": 10,
                  "depth": 16,
                  "x": 0,
                  "y": 37,
                  "z": 12,
                  "color": {
                    "paletteColor": "greenMColor"
                  },
                  "name": "head-top",
                  "texture": "scales"
                },
                {
                  "type": "box",
                  "width": 10,
                  "height": 4,
                  "depth": 14,
                  "x": 0,
                  "y": 29,
                  "z": 14,
                  "color": {
                    "paletteColor": "greenMColor"
                  },
                  "name": "jaw",
                  "texture": "scales"
                },
                {
                  "type": "box",
                  "width": 8,
                  "height": 1,
                  "depth": 1,
                  "x": 0,
                  "y": 31,
                  "z": 20,
                  "color": {
                    "paletteColor": "redDColor"
                  },
                  "name": "gums"
                },
                {
                  "type": "box",
                  "width": 1,
                  "height": 2,
                  "depth": 1,
                  "x": -3,
                  "y": 31,
                  "z": 20.1,
                  "color": {
                    "paletteColor": "greyLColor"
                  },
                  "name": "tooth-right"
                },
                {
                  "type": "box",
                  "width": 1,
                  "height": 2,
                  "depth": 1,
                  "x": 0,
                  "y": 31,
                  "z": 20.1,
                  "color": {
                    "paletteColor": "greyLColor"
                  },
                  "name": "tooth-middle"
                },
                {
                  "type": "box",
                  "width": 1,
                  "height": 2,
                  "depth": 1,
                  "x": 3,
                  "y": 31,
                  "z": 20.1,
                  "color": {
                    "paletteColor": "greyLColor"
                  },
                  "name": "tooth-left"
                },
                {
                  "type": "sphere",
                  "size": 3,
                  "x": -7,
                  "y": 42,
                  "z": 14,
                  "color": {
                    "paletteColor": "redLColor"
                  },
                  "name": "eye-right"
                },
                {
                  "type": "sphere",
                  "size": 1.5,
                  "x": -7,
                  "y": 42,
                  "z": 15,
                  "color": {
                    "paletteColor": "brownDColor"
                  },
                  "name": "pupil-right"
                },
                {
                  "type": "sphere",
                  "size": 3,
                  "x": 7,
                  "y": 42,
                  "z": 14,
                  "color": {
                    "paletteColor": "redLColor"
                  },
                  "name": "eye-left"
                },
                {
                  "type": "sphere",
                  "size": 1.5,
                  "x": 7,
                  "y": 42,
                  "z": 15,
                  "color": {
                    "paletteColor": "brownDColor"
                  },
                  "name": "pupil-left"
                },
                {
                  "type": "box",
                  "width": 6,
                  "height": 4,
                  "depth": 14,
                  "x": 0,
                  "y": 18,
                  "z": -17.9,
                  "rotationX": -20,
                  "color": {
                    "paletteColor": "greenMColor"
                  },
                  "name": "tail-base",
                  "texture": "scales"
                },
                {
                  "type": "box",
                  "width": 4,
                  "height": 3,
                  "depth": 10,
                  "x": 0,
                  "y": 15,
                  "z": -30,
                  "rotationX": -10,
                  "color": {
                    "paletteColor": "greenMColor"
                  },
                  "name": "tail-tip",
                  "texture": "scales"
                },
                {
                  "type": "box",
                  "width": 5,
                  "height": 16,
                  "depth": 5,
                  "x": 6,
                  "y": 10,
                  "z": 0,
                  "color": {
                    "paletteColor": "greenMColor"
                  },
                  "name": "leg-left",
                  "texture": "scales"
                },
                {
                  "type": "box",
                  "width": 5,
                  "height": 16,
                  "depth": 5,
                  "x": -6,
                  "y": 10,
                  "z": 0,
                  "color": {
                    "paletteColor": "greenMColor"
                  },
                  "name": "leg-right",
                  "texture": "scales"
                },
                {
                  "type": "box",
                  "width": 7,
                  "height": 2,
                  "depth": 9,
                  "x": 6,
                  "y": 1,
                  "z": 0,
                  "color": {
                    "paletteColor": "greenMColor"
                  },
                  "name": "foot-left",
                  "texture": "scales"
                },
                {
                  "type": "box",
                  "width": 7,
                  "height": 2,
                  "depth": 9,
                  "x": -6,
                  "y": 1,
                  "z": 0,
                  "color": {
                    "paletteColor": "greenMColor"
                  },
                  "name": "foot-right",
                  "texture": "scales"
                },
                {
                  "type": "box",
                  "width": 3,
                  "height": 5,
                  "depth": 3,
                  "x": 8,
                  "y": 26,
                  "z": 0,
                  "rotationX": -40,
                  "color": {
                    "paletteColor": "greenMColor"
                  },
                  "name": "arm-left",
                  "texture": "scales"
                },
                {
                  "type": "box",
                  "width": 3,
                  "height": 5,
                  "depth": 3,
                  "x": -8,
                  "y": 26,
                  "z": 0,
                  "rotationX": -40,
                  "color": {
                    "paletteColor": "greenMColor"
                  },
                  "name": "arm-right",
                  "texture": "scales"
                },
                {
                  "type": "box",
                  "width": 2,
                  "height": 2,
                  "depth": 1,
                  "x": 8,
                  "y": 24,
                  "z": 3,
                  "color": {
                    "paletteColor": "greyMColor"
                  },
                  "name": "hand-left"
                },
                {
                  "type": "box",
                  "width": 2,
                  "height": 2,
                  "depth": 1,
                  "x": -8,
                  "y": 24,
                  "z": 3,
                  "color": {
                    "paletteColor": "greyMColor"
                  },
                  "name": "hand-right"
                },
                {
                  "type": "cone",
                  "size": 4,
                  "height": 6,
                  "x": 0,
                  "y": 32,
                  "z": -2,
                  "rotationX": -60,
                  "color": {
                    "paletteColor": "greenDColor"
                  },
                  "name": "spike1",
                  "rotationY": 0,
                  "rotationZ": 0,
                  "scaleX": 1,
                  "scaleY": 1,
                  "scaleZ": 1
                },
                {
                  "type": "cone",
                  "size": 4,
                  "height": 6,
                  "x": 0,
                  "y": 25,
                  "z": -8,
                  "rotationX": -75,
                  "color": {
                    "paletteColor": "greenDColor"
                  },
                  "name": "spike2",
                  "rotationY": 0,
                  "rotationZ": 0,
                  "scaleX": 1,
                  "scaleY": 1,
                  "scaleZ": 1
                },
                {
                  "type": "cone",
                  "size": 3,
                  "height": 4,
                  "x": 0,
                  "y": 19.923156801661484,
                  "z": -20,
                  "rotationX": -25,
                  "color": {
                    "paletteColor": "greenDColor"
                  },
                  "name": "spike3",
                  "rotationY": 0,
                  "rotationZ": 0,
                  "scaleX": 1,
                  "scaleY": 1,
                  "scaleZ": 1
                },
                {
                  "type": "cone",
                  "size": 2,
                  "height": 3,
                  "x": 0,
                  "y": 18,
                  "z": -28,
                  "rotationX": -25,
                  "color": {
                    "paletteColor": "greenDColor"
                  },
                  "name": "spike4"
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            }
          }
        }
      },
      "wraith": {
        "hp": 1,
        "speed": 1.8,
        "value": 12,
        "essence": 18,
        "dodgeChance": 0.2,
        "render": {
          "animations": {
            "idle": [
              {}
            ],
            "walk": [
              {},
              {},
              {
                "shapes": {
                  "shapes": [
                    {
                      "y": 25,
                      "id": 0
                    },
                    {
                      "y": 25,
                      "id": 1
                    },
                    {
                      "y": 25,
                      "id": 2
                    },
                    {
                      "y": 23,
                      "id": 3
                    },
                    {
                      "y": 23,
                      "id": 4
                    }
                  ]
                }
              },
              {
                "shapes": {
                  "shapes": [
                    {
                      "y": 25,
                      "id": 0
                    },
                    {
                      "y": 25,
                      "id": 1
                    },
                    {
                      "y": 25,
                      "id": 2
                    },
                    {
                      "y": 23,
                      "id": 3
                    },
                    {
                      "y": 23,
                      "id": 4
                    }
                  ]
                }
              }
            ]
          },
          "model": {
            "shapes": {
              "shapes": [
                {
                  "type": "sphere",
                  "size": 16,
                  "color": "#3A6A8A",
                  "x": 0,
                  "y": 24,
                  "z": 0,
                  "scaleX": 1
                },
                {
                  "type": "sphere",
                  "size": 8,
                  "color": "#FFFFFF",
                  "x": 0,
                  "y": 24,
                  "z": 6
                },
                {
                  "type": "sphere",
                  "size": 4,
                  "color": "#000000",
                  "x": 0,
                  "y": 24,
                  "z": 8.5
                },
                {
                  "type": "cylinder",
                  "size": 6,
                  "height": 4,
                  "color": "#2A5A7A",
                  "x": -8,
                  "y": 22,
                  "z": 0,
                  "rotationZ": 30
                },
                {
                  "type": "cylinder",
                  "size": 6,
                  "height": 4,
                  "color": "#2A5A7A",
                  "x": 8,
                  "y": 22,
                  "z": 0,
                  "rotationZ": -30
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            }
          }
        },
        "energyShield": 50,
        "title": "wraith"
      },
      "banshee": {
        "hp": 20,
        "speed": 1.4,
        "value": 8,
        "essence": 14,
        "screamDamage": 5,
        "render": {
          "animations": {
            "idle": [
              {}
            ],
            "walk": [
              {},
              {},
              {
                "shapes": {
                  "shapes": [
                    {
                      "y": 38,
                      "id": 0
                    },
                    {
                      "y": 20,
                      "id": 1
                    },
                    {
                      "y": 38,
                      "id": 2
                    },
                    {
                      "y": 38,
                      "id": 3
                    },
                    {
                      "y": 30,
                      "id": 4
                    },
                    {
                      "y": 30,
                      "id": 5
                    },
                    {
                      "y": 35,
                      "id": 6
                    },
                    {
                      "y": 35,
                      "id": 7
                    },
                    {
                      "y": 34,
                      "id": 8
                    },
                    {
                      "y": 20,
                      "id": 9
                    },
                    {
                      "y": 20,
                      "id": 10
                    },
                    {
                      "y": 20,
                      "id": 11
                    }
                  ]
                }
              },
              {
                "shapes": {
                  "shapes": [
                    {
                      "y": 38,
                      "id": 0
                    },
                    {
                      "y": 20,
                      "id": 1
                    },
                    {
                      "y": 38,
                      "id": 2
                    },
                    {
                      "y": 38,
                      "id": 3
                    },
                    {
                      "y": 30,
                      "id": 4
                    },
                    {
                      "y": 30,
                      "id": 5
                    },
                    {
                      "y": 35,
                      "id": 6
                    },
                    {
                      "y": 35,
                      "id": 7
                    },
                    {
                      "y": 34,
                      "id": 8
                    },
                    {
                      "y": 20,
                      "id": 9
                    },
                    {
                      "y": 20,
                      "id": 10
                    },
                    {
                      "y": 20,
                      "id": 11
                    }
                  ]
                }
              }
            ]
          },
          "model": {
            "shapes": {
              "shapes": [
                {
                  "type": "sphere",
                  "size": 12,
                  "color": "#BCA9DF",
                  "x": 0,
                  "y": 36,
                  "z": 2,
                  "scaleX": 1
                },
                {
                  "type": "cone",
                  "size": 16,
                  "height": 30,
                  "color": "#9F8AC7",
                  "x": 0,
                  "y": 18,
                  "z": 0,
                  "rotationX": 180
                },
                {
                  "type": "sphere",
                  "size": 4,
                  "color": "#FF3366",
                  "x": 4,
                  "y": 36,
                  "z": 7
                },
                {
                  "type": "sphere",
                  "size": 4,
                  "color": "#FF3366",
                  "x": -4,
                  "y": 36,
                  "z": 7
                },
                {
                  "type": "cylinder",
                  "size": 3,
                  "height": 16,
                  "color": "#BCA9DF",
                  "x": -8,
                  "y": 28,
                  "z": 10,
                  "rotationX": 90,
                  "rotationZ": 30
                },
                {
                  "type": "cylinder",
                  "size": 3,
                  "height": 16,
                  "color": "#BCA9DF",
                  "x": 8,
                  "y": 28,
                  "z": 10,
                  "rotationX": 90,
                  "rotationZ": -30
                },
                {
                  "type": "cylinder",
                  "size": 2,
                  "height": 12,
                  "color": "#BCA9DF",
                  "x": 3,
                  "y": 33,
                  "z": -10,
                  "rotationX": -40
                },
                {
                  "type": "cylinder",
                  "size": 2,
                  "height": 12,
                  "color": "#BCA9DF",
                  "x": -3,
                  "y": 33,
                  "z": -10,
                  "rotationX": -40
                },
                {
                  "type": "sphere",
                  "size": 6,
                  "color": "#000000",
                  "x": 0,
                  "y": 32,
                  "z": 7.8,
                  "rotationX": 45
                },
                {
                  "type": "sphere",
                  "size": 6,
                  "color": "#BCA9DF",
                  "x": 15,
                  "y": 18,
                  "z": 0
                },
                {
                  "type": "sphere",
                  "size": 6,
                  "color": "#BCA9DF",
                  "x": -15,
                  "y": 18,
                  "z": 0
                },
                {
                  "type": "sphere",
                  "size": 6,
                  "color": "#BCA9DF",
                  "x": 0,
                  "y": 18,
                  "z": -15
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            }
          }
        },
        "evasion": 75,
        "title": "banshee"
      },
      "blueDragon": {
        "hp": 500,
        "speed": 0.5,
        "essence": 50,
        "value": 50,
        "boss": true,
        "render": {
          "animations": {
            "idle": [
              {}
            ],
            "walk": [
              {
                "shapes": {
                  "shapes": [
                    {
                      "type": "box",
                      "width": 18,
                      "height": 10,
                      "depth": 28,
                      "x": 0,
                      "y": 19,
                      "z": -6.4,
                      "rotationX": -19,
                      "color": "#00008b",
                      "scaleX": 1,
                      "id": 0
                    },
                    {
                      "y": 29,
                      "id": 1
                    },
                    {
                      "y": 39,
                      "id": 2
                    },
                    {
                      "y": 41,
                      "id": 3
                    },
                    {
                      "x": 1.5,
                      "y": 12,
                      "rotationZ": 5,
                      "id": 4
                    },
                    {
                      "x": 3,
                      "y": 8,
                      "rotationZ": 8,
                      "id": 5
                    },
                    {
                      "x": 4,
                      "y": 6,
                      "rotationZ": 10,
                      "id": 6
                    },
                    {
                      "y": 25,
                      "id": 7
                    },
                    {
                      "y": 45,
                      "id": 8
                    },
                    {
                      "y": 47,
                      "id": 9
                    },
                    {
                      "y": 47,
                      "id": 10
                    },
                    {
                      "y": 47,
                      "id": 11
                    },
                    {
                      "y": 47,
                      "id": 12
                    },
                    {
                      "y": 39,
                      "id": 13
                    },
                    {
                      "y": 41,
                      "id": 14
                    },
                    {
                      "y": 39,
                      "id": 15
                    },
                    {
                      "y": 39,
                      "id": 16
                    },
                    {
                      "y": 39,
                      "id": 17
                    },
                    {
                      "y": 10,
                      "z": 5,
                      "rotationX": 20,
                      "id": 18
                    },
                    {
                      "z": -10,
                      "rotationX": -30,
                      "id": 19
                    },
                    {
                      "z": -21,
                      "rotationX": -30,
                      "id": 20
                    },
                    {
                      "y": 12,
                      "z": -11,
                      "rotationX": 20,
                      "id": 21
                    },
                    {
                      "y": 5,
                      "z": 10,
                      "rotationX": 20,
                      "id": 22
                    },
                    {
                      "z": -14,
                      "rotationX": -30,
                      "id": 23
                    },
                    {
                      "z": -25,
                      "rotationX": -30,
                      "id": 24
                    },
                    {
                      "y": 7,
                      "z": -6,
                      "rotationX": 20,
                      "id": 25
                    },
                    {
                      "y": 35,
                      "id": 26
                    },
                    {
                      "y": 33,
                      "id": 27
                    },
                    {
                      "x": 1.5,
                      "y": 20,
                      "rotationZ": 5,
                      "id": 28
                    },
                    {
                      "x": 3,
                      "y": 14,
                      "rotationZ": 8,
                      "id": 29
                    }
                  ]
                }
              },
              {
                "shapes": {
                  "shapes": [
                    {
                      "type": "box",
                      "width": 18,
                      "height": 10,
                      "depth": 28,
                      "x": 0,
                      "y": 20.5,
                      "z": -6.4,
                      "rotationX": -19,
                      "color": "#00008b",
                      "scaleX": 1,
                      "id": 0
                    },
                    {
                      "y": 30.5,
                      "id": 1
                    },
                    {
                      "y": 40.5,
                      "id": 2
                    },
                    {
                      "y": 42.5,
                      "id": 3
                    },
                    {
                      "y": 14,
                      "id": 4
                    },
                    {
                      "y": 10,
                      "id": 5
                    },
                    {
                      "y": 8,
                      "id": 6
                    },
                    {
                      "y": 26.5,
                      "id": 7
                    },
                    {
                      "y": 46.5,
                      "id": 8
                    },
                    {
                      "y": 48.5,
                      "id": 9
                    },
                    {
                      "y": 48.5,
                      "id": 10
                    },
                    {
                      "y": 48.5,
                      "id": 11
                    },
                    {
                      "y": 48.5,
                      "id": 12
                    },
                    {
                      "y": 40.5,
                      "id": 13
                    },
                    {
                      "y": 42.5,
                      "id": 14
                    },
                    {
                      "y": 40.5,
                      "id": 15
                    },
                    {
                      "y": 40.5,
                      "id": 16
                    },
                    {
                      "y": 40.5,
                      "id": 17
                    },
                    {
                      "y": 11,
                      "rotationX": -5,
                      "id": 18
                    },
                    {
                      "y": 11,
                      "rotationX": -5,
                      "id": 19
                    },
                    {
                      "y": 11,
                      "rotationX": -15,
                      "id": 20
                    },
                    {
                      "y": 13,
                      "rotationX": 5,
                      "id": 21
                    },
                    {
                      "y": 4,
                      "z": -1,
                      "rotationX": -5,
                      "id": 22
                    },
                    {
                      "y": 4,
                      "z": -1,
                      "rotationX": -5,
                      "id": 23
                    },
                    {
                      "y": 5,
                      "z": -18,
                      "rotationX": -15,
                      "id": 24
                    },
                    {
                      "y": 7,
                      "z": -14,
                      "rotationX": 5,
                      "id": 25
                    },
                    {
                      "y": 36.5,
                      "id": 26
                    },
                    {
                      "y": 34.5,
                      "id": 27
                    },
                    {
                      "y": 22,
                      "id": 28
                    },
                    {
                      "y": 16,
                      "id": 29
                    },
                    {
                      "y": 25.5,
                      "id": 30
                    },
                    {
                      "y": 20,
                      "id": 32
                    },
                    {
                      "y": 20,
                      "id": 33
                    },
                    {
                      "y": 25.5,
                      "id": 35
                    }
                  ]
                }
              },
              {
                "shapes": {
                  "shapes": [
                    {
                      "type": "box",
                      "width": 18,
                      "height": 10,
                      "depth": 28,
                      "x": 0,
                      "y": 21,
                      "z": -6.4,
                      "rotationX": -19,
                      "color": "#00008b",
                      "scaleX": 1,
                      "id": 0
                    },
                    {
                      "y": 31,
                      "id": 1
                    },
                    {
                      "y": 41,
                      "id": 2
                    },
                    {
                      "y": 43,
                      "id": 3
                    },
                    {
                      "x": -1.5,
                      "y": 14,
                      "rotationZ": -5,
                      "id": 4
                    },
                    {
                      "x": -3,
                      "y": 10,
                      "rotationZ": -8,
                      "id": 5
                    },
                    {
                      "x": -4,
                      "y": 8,
                      "rotationZ": -10,
                      "id": 6
                    },
                    {
                      "y": 27,
                      "id": 7
                    },
                    {
                      "y": 47,
                      "id": 8
                    },
                    {
                      "y": 49,
                      "id": 9
                    },
                    {
                      "y": 49,
                      "id": 10
                    },
                    {
                      "y": 49,
                      "id": 11
                    },
                    {
                      "y": 49,
                      "id": 12
                    },
                    {
                      "y": 41,
                      "id": 13
                    },
                    {
                      "y": 43,
                      "id": 14
                    },
                    {
                      "y": 41,
                      "id": 15
                    },
                    {
                      "y": 41,
                      "id": 16
                    },
                    {
                      "y": 41,
                      "id": 17
                    },
                    {
                      "y": 10,
                      "z": -10,
                      "rotationX": -30,
                      "id": 18
                    },
                    {
                      "y": 12,
                      "z": 5,
                      "rotationX": 20,
                      "id": 19
                    },
                    {
                      "y": 14,
                      "z": -11,
                      "rotationX": 20,
                      "id": 20
                    },
                    {
                      "y": 10,
                      "z": -21,
                      "rotationX": -30,
                      "id": 21
                    },
                    {
                      "y": 3,
                      "z": -14,
                      "rotationX": -30,
                      "id": 22
                    },
                    {
                      "y": 7,
                      "z": 10,
                      "rotationX": 20,
                      "id": 23
                    },
                    {
                      "y": 9,
                      "z": -6,
                      "rotationX": 20,
                      "id": 24
                    },
                    {
                      "y": 4,
                      "z": -25,
                      "rotationX": -30,
                      "id": 25
                    },
                    {
                      "y": 37,
                      "id": 26
                    },
                    {
                      "y": 35,
                      "id": 27
                    },
                    {
                      "x": -1.5,
                      "y": 22,
                      "rotationZ": -5,
                      "id": 28
                    },
                    {
                      "x": -3,
                      "y": 16,
                      "rotationZ": -8,
                      "id": 29
                    },
                    {
                      "y": 26,
                      "id": 30
                    },
                    {
                      "y": 12.5,
                      "id": 31
                    },
                    {
                      "y": 20,
                      "id": 32
                    },
                    {
                      "y": 20,
                      "id": 33
                    },
                    {
                      "y": 12.5,
                      "id": 34
                    },
                    {
                      "y": 26,
                      "id": 35
                    }
                  ]
                }
              },
              {
                "shapes": {
                  "shapes": [
                    {
                      "type": "box",
                      "width": 18,
                      "height": 10,
                      "depth": 28,
                      "x": 0,
                      "y": 20.5,
                      "z": -6.4,
                      "rotationX": -19,
                      "color": "#00008b",
                      "scaleX": 1,
                      "id": 0
                    },
                    {
                      "y": 30.5,
                      "id": 1
                    },
                    {
                      "y": 40.5,
                      "id": 2
                    },
                    {
                      "y": 42.5,
                      "id": 3
                    },
                    {
                      "y": 14,
                      "id": 4
                    },
                    {
                      "y": 10,
                      "id": 5
                    },
                    {
                      "y": 8,
                      "id": 6
                    },
                    {
                      "y": 26.5,
                      "id": 7
                    },
                    {
                      "y": 46.5,
                      "id": 8
                    },
                    {
                      "y": 48.5,
                      "id": 9
                    },
                    {
                      "y": 48.5,
                      "id": 10
                    },
                    {
                      "y": 48.5,
                      "id": 11
                    },
                    {
                      "y": 48.5,
                      "id": 12
                    },
                    {
                      "y": 40.5,
                      "id": 13
                    },
                    {
                      "y": 42.5,
                      "id": 14
                    },
                    {
                      "y": 40.5,
                      "id": 15
                    },
                    {
                      "y": 40.5,
                      "id": 16
                    },
                    {
                      "y": 40.5,
                      "id": 17
                    },
                    {
                      "y": 11,
                      "rotationX": -5,
                      "id": 18
                    },
                    {
                      "y": 11,
                      "rotationX": -5,
                      "id": 19
                    },
                    {
                      "y": 11,
                      "rotationX": -15,
                      "id": 20
                    },
                    {
                      "y": 13,
                      "rotationX": 5,
                      "id": 21
                    },
                    {
                      "y": 4,
                      "z": -1,
                      "rotationX": -5,
                      "id": 22
                    },
                    {
                      "y": 4,
                      "z": -1,
                      "rotationX": -5,
                      "id": 23
                    },
                    {
                      "y": 5,
                      "z": -18,
                      "rotationX": -15,
                      "id": 24
                    },
                    {
                      "y": 7,
                      "z": -14,
                      "rotationX": 5,
                      "id": 25
                    },
                    {
                      "y": 36.5,
                      "id": 26
                    },
                    {
                      "y": 34.5,
                      "id": 27
                    },
                    {
                      "y": 22,
                      "id": 28
                    },
                    {
                      "y": 16,
                      "id": 29
                    },
                    {
                      "y": 25.5,
                      "id": 30
                    },
                    {
                      "y": 20,
                      "id": 32
                    },
                    {
                      "y": 20,
                      "id": 33
                    },
                    {
                      "y": 25.5,
                      "id": 35
                    }
                  ]
                }
              }
            ]
          },
          "model": {
            "shapes": {
              "shapes": [
                {
                  "type": "box",
                  "width": 18,
                  "height": 10,
                  "depth": 28,
                  "x": 0,
                  "y": 16,
                  "z": -6.4,
                  "rotationX": -19,
                  "color": "#00008b",
                  "scaleX": 1
                },
                {
                  "type": "box",
                  "width": 14,
                  "height": 8,
                  "depth": 20,
                  "x": 0,
                  "y": 26,
                  "z": 18,
                  "rotationX": -10,
                  "color": "#00008b"
                },
                {
                  "type": "box",
                  "width": 12,
                  "height": 6,
                  "depth": 16,
                  "x": 0,
                  "y": 36,
                  "z": 30,
                  "rotationX": -20,
                  "color": "#00008b"
                },
                {
                  "type": "cone",
                  "size": 10,
                  "height": 20,
                  "x": 0,
                  "y": 38,
                  "z": 42,
                  "rotationX": 90,
                  "color": "#00008b"
                },
                {
                  "type": "box",
                  "width": 12,
                  "height": 6,
                  "depth": 16,
                  "x": 0,
                  "y": 10,
                  "z": -24,
                  "rotationX": -5,
                  "color": "#00008b"
                },
                {
                  "type": "box",
                  "width": 8,
                  "height": 4,
                  "depth": 20,
                  "x": 0,
                  "y": 6,
                  "z": -42,
                  "rotationX": -5,
                  "color": "#00008b"
                },
                {
                  "type": "cone",
                  "size": 6,
                  "height": 12,
                  "x": 0,
                  "y": 4,
                  "z": -54,
                  "rotationX": -90,
                  "color": "#00008b"
                },
                {
                  "type": "box",
                  "width": 22,
                  "height": 10,
                  "depth": 18,
                  "x": 0,
                  "y": 22,
                  "z": 0,
                  "rotationX": -14,
                  "color": "#00008b"
                },
                {
                  "type": "sphere",
                  "size": 8,
                  "x": 0,
                  "y": 42,
                  "z": 34,
                  "color": "#00008b"
                },
                {
                  "type": "sphere",
                  "size": 3,
                  "x": -4,
                  "y": 44,
                  "z": 36,
                  "color": "#FFFF00"
                },
                {
                  "type": "sphere",
                  "size": 1.5,
                  "x": -4,
                  "y": 44,
                  "z": 37,
                  "color": "#000000"
                },
                {
                  "type": "sphere",
                  "size": 3,
                  "x": 4,
                  "y": 44,
                  "z": 36,
                  "color": "#FFFF00"
                },
                {
                  "type": "sphere",
                  "size": 1.5,
                  "x": 4,
                  "y": 44,
                  "z": 37,
                  "color": "#000000"
                },
                {
                  "type": "box",
                  "width": 5,
                  "height": 3,
                  "depth": 10,
                  "x": 0,
                  "y": 36,
                  "z": 40,
                  "color": "#2A2AA5"
                },
                {
                  "type": "box",
                  "width": 4,
                  "height": 2,
                  "depth": 1,
                  "x": 0,
                  "y": 38,
                  "z": 46,
                  "color": "#FFFFFF"
                },
                {
                  "type": "box",
                  "width": 1,
                  "height": 2,
                  "depth": 1,
                  "x": -2,
                  "y": 36,
                  "z": 46,
                  "color": "#FFFFFF"
                },
                {
                  "type": "box",
                  "width": 1,
                  "height": 2,
                  "depth": 1,
                  "x": 0,
                  "y": 36,
                  "z": 46,
                  "color": "#FFFFFF"
                },
                {
                  "type": "box",
                  "width": 1,
                  "height": 2,
                  "depth": 1,
                  "x": 2,
                  "y": 36,
                  "z": 46,
                  "color": "#FFFFFF"
                },
                {
                  "type": "box",
                  "width": 5,
                  "height": 12,
                  "depth": 5,
                  "x": 10,
                  "y": 8,
                  "z": 0,
                  "color": "#00008b"
                },
                {
                  "type": "box",
                  "width": 5,
                  "height": 12,
                  "depth": 5,
                  "x": -10,
                  "y": 8,
                  "z": 0,
                  "color": "#00008b"
                },
                {
                  "type": "box",
                  "width": 5,
                  "height": 12,
                  "depth": 5,
                  "x": 10,
                  "y": 8,
                  "z": -16,
                  "color": "#00008b"
                },
                {
                  "type": "box",
                  "width": 5,
                  "height": 12,
                  "depth": 5,
                  "x": -10,
                  "y": 8,
                  "z": -16,
                  "color": "#00008b"
                },
                {
                  "type": "box",
                  "width": 7,
                  "height": 2,
                  "depth": 7,
                  "x": 10,
                  "y": 1,
                  "z": 0,
                  "color": "#00008b"
                },
                {
                  "type": "box",
                  "width": 7,
                  "height": 2,
                  "depth": 7,
                  "x": -10,
                  "y": 1,
                  "z": 0,
                  "color": "#00008b"
                },
                {
                  "type": "box",
                  "width": 7,
                  "height": 2,
                  "depth": 7,
                  "x": 10,
                  "y": 2,
                  "z": -16,
                  "color": "#00008b"
                },
                {
                  "type": "box",
                  "width": 7,
                  "height": 2,
                  "depth": 7,
                  "x": -10,
                  "y": 2,
                  "z": -16,
                  "color": "#00008b"
                },
                {
                  "type": "cone",
                  "size": 6,
                  "height": 10,
                  "x": 0,
                  "y": 32,
                  "z": 10,
                  "rotationX": -20,
                  "color": "#2A2AA5"
                },
                {
                  "type": "cone",
                  "size": 6,
                  "height": 10,
                  "x": 0,
                  "y": 30,
                  "z": -8,
                  "rotationX": -32,
                  "color": "#2A2AA5"
                },
                {
                  "type": "cone",
                  "size": 5,
                  "height": 8,
                  "x": 0,
                  "y": 18,
                  "z": -24,
                  "rotationX": -75,
                  "color": "#2A2AA5"
                },
                {
                  "type": "cone",
                  "size": 4,
                  "height": 6,
                  "x": 0,
                  "y": 12,
                  "z": -38,
                  "rotationX": -75,
                  "color": "#2A2AA5"
                },
                {
                  "type": "box",
                  "width": 20,
                  "height": 1,
                  "depth": 28,
                  "x": 18,
                  "y": 24,
                  "z": -4,
                  "rotationY": -30,
                  "rotationZ": 12,
                  "color": "#2A2AA5",
                  "rotationX": -5,
                  "name": "wing-left-0"
                },
                {
                  "type": "box",
                  "width": 6,
                  "height": 1,
                  "depth": 20,
                  "x": -40,
                  "y": 12,
                  "z": -25,
                  "rotationY": 15,
                  "rotationZ": 15,
                  "color": "#2A2AA5",
                  "rotationX": -25,
                  "name": "wing-right-2"
                },
                {
                  "type": "box",
                  "width": 18,
                  "height": 1,
                  "depth": 24,
                  "x": 30,
                  "y": 19,
                  "z": -15,
                  "rotationY": 15,
                  "rotationZ": -15,
                  "color": "#2A2AA5",
                  "rotationX": -15,
                  "name": "wing-left-1"
                },
                {
                  "type": "box",
                  "width": 18,
                  "height": 1,
                  "depth": 24,
                  "x": -30,
                  "y": 19,
                  "z": -15,
                  "rotationY": -15,
                  "rotationZ": 15,
                  "color": "#2A2AA5",
                  "rotationX": -15,
                  "name": "wing-right-1"
                },
                {
                  "type": "box",
                  "width": 6,
                  "height": 1,
                  "depth": 20,
                  "x": 40,
                  "y": 12,
                  "z": -25,
                  "rotationY": -15,
                  "rotationZ": -15,
                  "color": "#2A2AA5",
                  "rotationX": -25,
                  "name": "wing-left-2"
                },
                {
                  "type": "box",
                  "width": 20,
                  "height": 1,
                  "depth": 28,
                  "x": -18,
                  "y": 24,
                  "z": -4,
                  "rotationY": 30,
                  "rotationZ": -12,
                  "color": "#2A2AA5",
                  "rotationX": -5,
                  "name": "wing-right-0"
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            }
          }
        },
        "fireResistance": 25,
        "coldResistance": 75,
        "electricResistance": 25,
        "title": "Blue Dragon"
      },
      "greenDragon": {
        "hp": 500,
        "speed": 0.5,
        "essence": 50,
        "value": 50,
        "boss": true,
        "render": {
          "animations": {
            "idle": [
              {}
            ],
            "walk": [
              {
                "shapes": {
                  "shapes": [
                    {
                      "y": 19,
                      "id": 0
                    },
                    {
                      "y": 29,
                      "id": 1
                    },
                    {
                      "y": 39,
                      "id": 2
                    },
                    {
                      "y": 41,
                      "id": 3
                    },
                    {
                      "x": 1.5,
                      "y": 12,
                      "rotationZ": 5,
                      "id": 4
                    },
                    {
                      "x": 3,
                      "y": 8,
                      "rotationZ": 8,
                      "id": 5
                    },
                    {
                      "x": 4,
                      "y": 6,
                      "rotationZ": 10,
                      "id": 6
                    },
                    {
                      "y": 25,
                      "id": 7
                    },
                    {
                      "y": 45,
                      "id": 8
                    },
                    {
                      "y": 47,
                      "id": 9
                    },
                    {
                      "y": 47,
                      "id": 10
                    },
                    {
                      "y": 47,
                      "id": 11
                    },
                    {
                      "y": 47,
                      "id": 12
                    },
                    {
                      "y": 39,
                      "id": 13
                    },
                    {
                      "y": 41,
                      "id": 14
                    },
                    {
                      "y": 39,
                      "id": 15
                    },
                    {
                      "y": 39,
                      "id": 16
                    },
                    {
                      "y": 39,
                      "id": 17
                    },
                    {
                      "y": 10,
                      "z": 5,
                      "rotationX": 20,
                      "id": 18
                    },
                    {
                      "z": -10,
                      "rotationX": -30,
                      "id": 19
                    },
                    {
                      "z": -21,
                      "rotationX": -30,
                      "id": 20
                    },
                    {
                      "y": 12,
                      "z": -11,
                      "rotationX": 20,
                      "id": 21
                    },
                    {
                      "y": 5,
                      "z": 10,
                      "rotationX": 20,
                      "id": 22
                    },
                    {
                      "z": -14,
                      "rotationX": -30,
                      "id": 23
                    },
                    {
                      "z": -25,
                      "rotationX": -30,
                      "id": 24
                    },
                    {
                      "y": 7,
                      "z": -6,
                      "rotationX": 20,
                      "id": 25
                    },
                    {
                      "y": 35,
                      "id": 26
                    },
                    {
                      "y": 33,
                      "id": 27
                    },
                    {
                      "x": 1.5,
                      "y": 20,
                      "rotationZ": 5,
                      "id": 28
                    },
                    {
                      "x": 3,
                      "y": 14,
                      "rotationZ": 8,
                      "id": 29
                    }
                  ]
                }
              },
              {
                "shapes": {
                  "shapes": [
                    {
                      "y": 20.5,
                      "id": 0
                    },
                    {
                      "y": 30.5,
                      "id": 1
                    },
                    {
                      "y": 40.5,
                      "id": 2
                    },
                    {
                      "y": 42.5,
                      "id": 3
                    },
                    {
                      "y": 14,
                      "id": 4
                    },
                    {
                      "y": 10,
                      "id": 5
                    },
                    {
                      "y": 8,
                      "id": 6
                    },
                    {
                      "y": 26.5,
                      "id": 7
                    },
                    {
                      "y": 46.5,
                      "id": 8
                    },
                    {
                      "y": 48.5,
                      "id": 9
                    },
                    {
                      "y": 48.5,
                      "id": 10
                    },
                    {
                      "y": 48.5,
                      "id": 11
                    },
                    {
                      "y": 48.5,
                      "id": 12
                    },
                    {
                      "y": 40.5,
                      "id": 13
                    },
                    {
                      "y": 42.5,
                      "id": 14
                    },
                    {
                      "y": 40.5,
                      "id": 15
                    },
                    {
                      "y": 40.5,
                      "id": 16
                    },
                    {
                      "y": 40.5,
                      "id": 17
                    },
                    {
                      "y": 11,
                      "rotationX": -5,
                      "id": 18
                    },
                    {
                      "y": 11,
                      "rotationX": -5,
                      "id": 19
                    },
                    {
                      "y": 11,
                      "rotationX": -15,
                      "id": 20
                    },
                    {
                      "y": 13,
                      "rotationX": 5,
                      "id": 21
                    },
                    {
                      "y": 4,
                      "z": -1,
                      "rotationX": -5,
                      "id": 22
                    },
                    {
                      "y": 4,
                      "z": -1,
                      "rotationX": -5,
                      "id": 23
                    },
                    {
                      "y": 5,
                      "z": -18,
                      "rotationX": -15,
                      "id": 24
                    },
                    {
                      "y": 7,
                      "z": -14,
                      "rotationX": 5,
                      "id": 25
                    },
                    {
                      "y": 36.5,
                      "id": 26
                    },
                    {
                      "y": 34.5,
                      "id": 27
                    },
                    {
                      "y": 22,
                      "id": 28
                    },
                    {
                      "y": 16,
                      "id": 29
                    },
                    {
                      "y": 25.5,
                      "id": 30
                    },
                    {
                      "y": 20,
                      "id": 32
                    },
                    {
                      "y": 20,
                      "id": 33
                    },
                    {
                      "y": 25.5,
                      "id": 35
                    }
                  ]
                }
              },
              {
                "shapes": {
                  "shapes": [
                    {
                      "y": 21,
                      "id": 0
                    },
                    {
                      "y": 31,
                      "id": 1
                    },
                    {
                      "y": 41,
                      "id": 2
                    },
                    {
                      "y": 43,
                      "id": 3
                    },
                    {
                      "x": -1.5,
                      "y": 14,
                      "rotationZ": -5,
                      "id": 4
                    },
                    {
                      "x": -3,
                      "y": 10,
                      "rotationZ": -8,
                      "id": 5
                    },
                    {
                      "x": -4,
                      "y": 8,
                      "rotationZ": -10,
                      "id": 6
                    },
                    {
                      "y": 27,
                      "id": 7
                    },
                    {
                      "y": 47,
                      "id": 8
                    },
                    {
                      "y": 49,
                      "id": 9
                    },
                    {
                      "y": 49,
                      "id": 10
                    },
                    {
                      "y": 49,
                      "id": 11
                    },
                    {
                      "y": 49,
                      "id": 12
                    },
                    {
                      "y": 41,
                      "id": 13
                    },
                    {
                      "y": 43,
                      "id": 14
                    },
                    {
                      "y": 41,
                      "id": 15
                    },
                    {
                      "y": 41,
                      "id": 16
                    },
                    {
                      "y": 41,
                      "id": 17
                    },
                    {
                      "y": 10,
                      "z": -10,
                      "rotationX": -30,
                      "id": 18
                    },
                    {
                      "y": 12,
                      "z": 5,
                      "rotationX": 20,
                      "id": 19
                    },
                    {
                      "y": 14,
                      "z": -11,
                      "rotationX": 20,
                      "id": 20
                    },
                    {
                      "y": 10,
                      "z": -21,
                      "rotationX": -30,
                      "id": 21
                    },
                    {
                      "y": 3,
                      "z": -14,
                      "rotationX": -30,
                      "id": 22
                    },
                    {
                      "y": 7,
                      "z": 10,
                      "rotationX": 20,
                      "id": 23
                    },
                    {
                      "y": 9,
                      "z": -6,
                      "rotationX": 20,
                      "id": 24
                    },
                    {
                      "y": 4,
                      "z": -25,
                      "rotationX": -30,
                      "id": 25
                    },
                    {
                      "y": 37,
                      "id": 26
                    },
                    {
                      "y": 35,
                      "id": 27
                    },
                    {
                      "x": -1.5,
                      "y": 22,
                      "rotationZ": -5,
                      "id": 28
                    },
                    {
                      "x": -3,
                      "y": 16,
                      "rotationZ": -8,
                      "id": 29
                    },
                    {
                      "y": 26,
                      "id": 30
                    },
                    {
                      "y": 12.5,
                      "id": 31
                    },
                    {
                      "y": 20,
                      "id": 32
                    },
                    {
                      "y": 20,
                      "id": 33
                    },
                    {
                      "y": 12.5,
                      "id": 34
                    },
                    {
                      "y": 26,
                      "id": 35
                    }
                  ]
                }
              },
              {
                "shapes": {
                  "shapes": [
                    {
                      "y": 20.5,
                      "id": 0
                    },
                    {
                      "y": 30.5,
                      "id": 1
                    },
                    {
                      "y": 40.5,
                      "id": 2
                    },
                    {
                      "y": 42.5,
                      "id": 3
                    },
                    {
                      "y": 14,
                      "id": 4
                    },
                    {
                      "y": 10,
                      "id": 5
                    },
                    {
                      "y": 8,
                      "id": 6
                    },
                    {
                      "y": 26.5,
                      "id": 7
                    },
                    {
                      "y": 46.5,
                      "id": 8
                    },
                    {
                      "y": 48.5,
                      "id": 9
                    },
                    {
                      "y": 48.5,
                      "id": 10
                    },
                    {
                      "y": 48.5,
                      "id": 11
                    },
                    {
                      "y": 48.5,
                      "id": 12
                    },
                    {
                      "y": 40.5,
                      "id": 13
                    },
                    {
                      "y": 42.5,
                      "id": 14
                    },
                    {
                      "y": 40.5,
                      "id": 15
                    },
                    {
                      "y": 40.5,
                      "id": 16
                    },
                    {
                      "y": 40.5,
                      "id": 17
                    },
                    {
                      "y": 11,
                      "rotationX": -5,
                      "id": 18
                    },
                    {
                      "y": 11,
                      "rotationX": -5,
                      "id": 19
                    },
                    {
                      "y": 11,
                      "rotationX": -15,
                      "id": 20
                    },
                    {
                      "y": 13,
                      "rotationX": 5,
                      "id": 21
                    },
                    {
                      "y": 4,
                      "z": -1,
                      "rotationX": -5,
                      "id": 22
                    },
                    {
                      "y": 4,
                      "z": -1,
                      "rotationX": -5,
                      "id": 23
                    },
                    {
                      "y": 5,
                      "z": -18,
                      "rotationX": -15,
                      "id": 24
                    },
                    {
                      "y": 7,
                      "z": -14,
                      "rotationX": 5,
                      "id": 25
                    },
                    {
                      "y": 36.5,
                      "id": 26
                    },
                    {
                      "y": 34.5,
                      "id": 27
                    },
                    {
                      "y": 22,
                      "id": 28
                    },
                    {
                      "y": 16,
                      "id": 29
                    },
                    {
                      "y": 25.5,
                      "id": 30
                    },
                    {
                      "y": 20,
                      "id": 32
                    },
                    {
                      "y": 20,
                      "id": 33
                    },
                    {
                      "y": 25.5,
                      "id": 35
                    }
                  ]
                }
              }
            ]
          },
          "model": {
            "shapes": {
              "shapes": [
                {
                  "type": "box",
                  "width": 18,
                  "height": 10,
                  "depth": 28,
                  "x": 0,
                  "y": 16,
                  "z": -6.4,
                  "rotationX": -19,
                  "color": "#008b00",
                  "scaleX": 1
                },
                {
                  "type": "box",
                  "width": 14,
                  "height": 8,
                  "depth": 20,
                  "x": 0,
                  "y": 26,
                  "z": 18,
                  "rotationX": -10,
                  "color": "#008b00"
                },
                {
                  "type": "box",
                  "width": 12,
                  "height": 6,
                  "depth": 16,
                  "x": 0,
                  "y": 36,
                  "z": 30,
                  "rotationX": -20,
                  "color": "#008b00"
                },
                {
                  "type": "cone",
                  "size": 10,
                  "height": 20,
                  "x": 0,
                  "y": 38,
                  "z": 42,
                  "rotationX": 90,
                  "color": "#008b00"
                },
                {
                  "type": "box",
                  "width": 12,
                  "height": 6,
                  "depth": 16,
                  "x": 0,
                  "y": 10,
                  "z": -24,
                  "rotationX": -5,
                  "color": "#008b00"
                },
                {
                  "type": "box",
                  "width": 8,
                  "height": 4,
                  "depth": 20,
                  "x": 0,
                  "y": 6,
                  "z": -42,
                  "rotationX": -5,
                  "color": "#008b00"
                },
                {
                  "type": "cone",
                  "size": 6,
                  "height": 12,
                  "x": 0,
                  "y": 4,
                  "z": -54,
                  "rotationX": -90,
                  "color": "#008b00"
                },
                {
                  "type": "box",
                  "width": 22,
                  "height": 10,
                  "depth": 18,
                  "x": 0,
                  "y": 22,
                  "z": 0,
                  "rotationX": -14,
                  "color": "#008b00"
                },
                {
                  "type": "sphere",
                  "size": 8,
                  "x": 0,
                  "y": 42,
                  "z": 34,
                  "color": "#008b00"
                },
                {
                  "type": "sphere",
                  "size": 3,
                  "x": -4,
                  "y": 44,
                  "z": 36,
                  "color": "#FFFF00"
                },
                {
                  "type": "sphere",
                  "size": 1.5,
                  "x": -4,
                  "y": 44,
                  "z": 37,
                  "color": "#000000"
                },
                {
                  "type": "sphere",
                  "size": 3,
                  "x": 4,
                  "y": 44,
                  "z": 36,
                  "color": "#FFFF00"
                },
                {
                  "type": "sphere",
                  "size": 1.5,
                  "x": 4,
                  "y": 44,
                  "z": 37,
                  "color": "#000000"
                },
                {
                  "type": "box",
                  "width": 5,
                  "height": 3,
                  "depth": 10,
                  "x": 0,
                  "y": 36,
                  "z": 40,
                  "color": "#2AA52A"
                },
                {
                  "type": "box",
                  "width": 4,
                  "height": 2,
                  "depth": 1,
                  "x": 0,
                  "y": 38,
                  "z": 46,
                  "color": "#FFFFFF"
                },
                {
                  "type": "box",
                  "width": 1,
                  "height": 2,
                  "depth": 1,
                  "x": -2,
                  "y": 36,
                  "z": 46,
                  "color": "#FFFFFF"
                },
                {
                  "type": "box",
                  "width": 1,
                  "height": 2,
                  "depth": 1,
                  "x": 0,
                  "y": 36,
                  "z": 46,
                  "color": "#FFFFFF"
                },
                {
                  "type": "box",
                  "width": 1,
                  "height": 2,
                  "depth": 1,
                  "x": 2,
                  "y": 36,
                  "z": 46,
                  "color": "#FFFFFF"
                },
                {
                  "type": "box",
                  "width": 5,
                  "height": 12,
                  "depth": 5,
                  "x": 10,
                  "y": 8,
                  "z": 0,
                  "color": "#008b00"
                },
                {
                  "type": "box",
                  "width": 5,
                  "height": 12,
                  "depth": 5,
                  "x": -10,
                  "y": 8,
                  "z": 0,
                  "color": "#008b00"
                },
                {
                  "type": "box",
                  "width": 5,
                  "height": 12,
                  "depth": 5,
                  "x": 10,
                  "y": 8,
                  "z": -16,
                  "color": "#008b00"
                },
                {
                  "type": "box",
                  "width": 5,
                  "height": 12,
                  "depth": 5,
                  "x": -10,
                  "y": 8,
                  "z": -16,
                  "color": "#008b00"
                },
                {
                  "type": "box",
                  "width": 7,
                  "height": 2,
                  "depth": 7,
                  "x": 10,
                  "y": 1,
                  "z": 0,
                  "color": "#008b00"
                },
                {
                  "type": "box",
                  "width": 7,
                  "height": 2,
                  "depth": 7,
                  "x": -10,
                  "y": 1,
                  "z": 0,
                  "color": "#008b00"
                },
                {
                  "type": "box",
                  "width": 7,
                  "height": 2,
                  "depth": 7,
                  "x": 10,
                  "y": 2,
                  "z": -16,
                  "color": "#008b00"
                },
                {
                  "type": "box",
                  "width": 7,
                  "height": 2,
                  "depth": 7,
                  "x": -10,
                  "y": 2,
                  "z": -16,
                  "color": "#008b00"
                },
                {
                  "type": "cone",
                  "size": 6,
                  "height": 10,
                  "x": 0,
                  "y": 32,
                  "z": 10,
                  "rotationX": -20,
                  "color": "#2AA52A"
                },
                {
                  "type": "cone",
                  "size": 6,
                  "height": 10,
                  "x": 0,
                  "y": 30,
                  "z": -8,
                  "rotationX": -32,
                  "color": "#2AA52A"
                },
                {
                  "type": "cone",
                  "size": 5,
                  "height": 8,
                  "x": 0,
                  "y": 18,
                  "z": -24,
                  "rotationX": -75,
                  "color": "#2AA52A"
                },
                {
                  "type": "cone",
                  "size": 4,
                  "height": 6,
                  "x": 0,
                  "y": 12,
                  "z": -38,
                  "rotationX": -75,
                  "color": "#2AA52A"
                },
                {
                  "type": "box",
                  "width": 20,
                  "height": 1,
                  "depth": 28,
                  "x": 18,
                  "y": 24,
                  "z": -4,
                  "rotationY": -30,
                  "rotationZ": 12,
                  "color": "#2AA52A",
                  "rotationX": -5,
                  "name": "wing-left-0"
                },
                {
                  "type": "box",
                  "width": 6,
                  "height": 1,
                  "depth": 20,
                  "x": -40,
                  "y": 12,
                  "z": -25,
                  "rotationY": 15,
                  "rotationZ": 15,
                  "color": "#2AA52A",
                  "rotationX": -25,
                  "name": "wing-right-2"
                },
                {
                  "type": "box",
                  "width": 18,
                  "height": 1,
                  "depth": 24,
                  "x": 30,
                  "y": 19,
                  "z": -15,
                  "rotationY": 15,
                  "rotationZ": -15,
                  "color": "#2AA52A",
                  "rotationX": -15,
                  "name": "wing-left-1"
                },
                {
                  "type": "box",
                  "width": 18,
                  "height": 1,
                  "depth": 24,
                  "x": -30,
                  "y": 19,
                  "z": -15,
                  "rotationY": -15,
                  "rotationZ": 15,
                  "color": "#2AA52A",
                  "rotationX": -15,
                  "name": "wing-right-1"
                },
                {
                  "type": "box",
                  "width": 6,
                  "height": 1,
                  "depth": 20,
                  "x": 40,
                  "y": 12,
                  "z": -25,
                  "rotationY": -15,
                  "rotationZ": -15,
                  "color": "#2AA52A",
                  "rotationX": -25,
                  "name": "wing-left-2"
                },
                {
                  "type": "box",
                  "width": 20,
                  "height": 1,
                  "depth": 28,
                  "x": -18,
                  "y": 24,
                  "z": -4,
                  "rotationY": 30,
                  "rotationZ": -12,
                  "color": "#2AA52A",
                  "rotationX": -5,
                  "name": "wing-right-0"
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            }
          }
        },
        "fireResistance": 50,
        "coldResistance": 50,
        "electricResistance": 50,
        "title": "Green Dragon"
      },
      "orc": {
        "essence": 5,
        "speed": 1,
        "value": 1,
        "hp": 10,
        "render": {
          "animations": {
            "idle": [
              {}
            ],
            "walk": [
              {},
              {
                "shapes": {
                  "shapes": [
                    {
                      "y": 26.757142857142853,
                      "rotationY": -10,
                      "id": 0
                    },
                    {
                      "y": 41.75714285714285,
                      "id": 1
                    },
                    {
                      "y": 41.75714285714285,
                      "id": 2
                    },
                    {
                      "y": 38.257142857142846,
                      "id": 3
                    },
                    {
                      "y": 43.75714285714285,
                      "id": 4
                    },
                    {
                      "y": 43.75714285714285,
                      "id": 5
                    },
                    {
                      "y": 43.75714285714285,
                      "id": 6
                    },
                    {
                      "y": 43.75714285714285,
                      "id": 7
                    },
                    {
                      "y": 27.75714285714285,
                      "z": -1,
                      "rotationX": 11,
                      "id": 8
                    },
                    {
                      "y": 27.75714285714285,
                      "z": 3.6,
                      "rotationX": -14,
                      "id": 9
                    },
                    {
                      "x": 11.6,
                      "y": 15.757142857142853,
                      "z": -3.2,
                      "rotationX": 10,
                      "id": 10
                    },
                    {
                      "x": -12.4,
                      "y": 15.757142857142853,
                      "z": 6.5,
                      "rotationX": -14,
                      "id": 11
                    },
                    {
                      "y": 7.757142857142849,
                      "z": 3,
                      "rotationX": -4,
                      "id": 12
                    },
                    {
                      "y": 7.757142857142849,
                      "z": -1,
                      "rotationX": 21,
                      "id": 13
                    },
                    {
                      "y": -0.24285714285715443,
                      "z": 5.1,
                      "id": 14
                    },
                    {
                      "x": -4.1,
                      "y": 1,
                      "z": -1.6,
                      "rotationX": 26,
                      "id": 15
                    },
                    {
                      "y": 44.75714285714285,
                      "id": 16
                    },
                    {
                      "y": 44.75714285714285,
                      "id": 17
                    },
                    {
                      "y": 48.2,
                      "id": 18
                    },
                    {
                      "y": 36.75714285714285,
                      "id": 19
                    },
                    {
                      "y": 36.75714285714285,
                      "id": 20
                    },
                    {
                      "y": 17.757142857142853,
                      "rotationY": -10,
                      "id": 21
                    },
                    {
                      "y": 40.75714285714285,
                      "id": 22
                    },
                    {
                      "y": 12.999999999999996,
                      "z": 2.6,
                      "rotationX": -60,
                      "id": 23
                    },
                    {
                      "x": 12.1,
                      "y": 5,
                      "z": 17,
                      "id": 24
                    },
                    {
                      "y": 9.5,
                      "z": 19.7,
                      "rotationY": 0,
                      "rotationX": 30,
                      "id": 25
                    },
                    {
                      "y": 0,
                      "z": 14.5,
                      "rotationX": -150,
                      "id": 26
                    },
                    {
                      "x": 7.5,
                      "y": 4.8,
                      "z": 17.3,
                      "id": 27
                    },
                    {
                      "x": 16.6,
                      "y": 4.8,
                      "z": 17.3,
                      "id": 28
                    },
                    {
                      "x": 12.1,
                      "y": 2.5999999999999996,
                      "z": 21,
                      "rotationX": 120,
                      "id": 29
                    },
                    {
                      "y": 21.757142857142853,
                      "id": 30
                    },
                    {
                      "y": 38,
                      "z": 1,
                      "rotationX": 105,
                      "id": 31
                    },
                    {
                      "y": 38,
                      "z": 1,
                      "rotationX": 75,
                      "id": 32
                    }
                  ]
                }
              },
              {
                "shapes": {
                  "shapes": [
                    {
                      "y": 29.757142857142853,
                      "id": 8
                    },
                    {
                      "y": 29.757142857142853,
                      "id": 9
                    },
                    {
                      "y": 14.999999999999993,
                      "id": 29
                    }
                  ]
                }
              },
              {
                "shapes": {
                  "shapes": [
                    {
                      "y": 26.757142857142853,
                      "rotationY": 10,
                      "id": 0
                    },
                    {
                      "y": 41.75714285714285,
                      "id": 1
                    },
                    {
                      "y": 41.75714285714285,
                      "id": 2
                    },
                    {
                      "y": 38.257142857142846,
                      "id": 3
                    },
                    {
                      "y": 43.75714285714285,
                      "id": 4
                    },
                    {
                      "y": 43.75714285714285,
                      "id": 5
                    },
                    {
                      "y": 43.75714285714285,
                      "id": 6
                    },
                    {
                      "y": 43.75714285714285,
                      "id": 7
                    },
                    {
                      "y": 27.75714285714285,
                      "z": 3,
                      "rotationX": -14,
                      "id": 8
                    },
                    {
                      "x": -11.9,
                      "y": 27.75714285714285,
                      "rotationX": 16,
                      "id": 9
                    },
                    {
                      "y": 15.757142857142853,
                      "z": 6,
                      "rotationX": -14,
                      "id": 10
                    },
                    {
                      "y": 16,
                      "z": -1.7,
                      "rotationX": 11,
                      "id": 11
                    },
                    {
                      "y": 7.757142857142849,
                      "z": -1.3,
                      "rotationX": 16,
                      "id": 12
                    },
                    {
                      "y": 7.757142857142849,
                      "z": 5,
                      "rotationY": 0,
                      "rotationX": -15,
                      "id": 13
                    },
                    {
                      "y": 0.20000000000000018,
                      "z": -1.4,
                      "rotationX": 16,
                      "id": 14
                    },
                    {
                      "y": -0.24285714285715443,
                      "z": 8.1,
                      "id": 15
                    },
                    {
                      "y": 44.75714285714285,
                      "id": 16
                    },
                    {
                      "y": 44.75714285714285,
                      "id": 17
                    },
                    {
                      "y": 48.2,
                      "id": 18
                    },
                    {
                      "y": 36.75714285714285,
                      "id": 19
                    },
                    {
                      "y": 36.75714285714285,
                      "id": 20
                    },
                    {
                      "y": 17.757142857142853,
                      "rotationY": 10,
                      "id": 21
                    },
                    {
                      "y": 40.75714285714285,
                      "id": 22
                    },
                    {
                      "y": 12.999999999999996,
                      "rotationX": 60,
                      "id": 23
                    },
                    {
                      "x": 12.1,
                      "y": 20,
                      "z": 20,
                      "id": 24
                    },
                    {
                      "y": 24.4,
                      "rotationX": -24,
                      "id": 25
                    },
                    {
                      "y": 15.2,
                      "z": 21.8,
                      "rotationX": 160,
                      "id": 26
                    },
                    {
                      "x": 7.6,
                      "y": 20,
                      "z": 20,
                      "id": 27
                    },
                    {
                      "x": 16.700000000000003,
                      "y": 20,
                      "z": 20,
                      "id": 28
                    },
                    {
                      "y": 22.3,
                      "rotationX": 60,
                      "id": 29
                    },
                    {
                      "y": 21.757142857142853,
                      "id": 30
                    },
                    {
                      "y": 38,
                      "z": 0,
                      "rotationX": 75,
                      "id": 31
                    },
                    {
                      "y": 38,
                      "z": 4,
                      "rotationX": 105,
                      "id": 32
                    }
                  ]
                }
              }
            ]
          },
          "model": {
            "shapes": {
              "shapes": [
                {
                  "type": "box",
                  "width": 14,
                  "height": 18,
                  "depth": 10,
                  "x": 0,
                  "y": 28.757142857142853,
                  "z": 1.4857142857142973,
                  "color": "#496a29",
                  "name": "torso",
                  "scaleX": 1
                },
                {
                  "type": "sphere",
                  "size": 15,
                  "x": 0,
                  "y": 43.75714285714285,
                  "z": 1.4857142857143,
                  "color": "#5c6628",
                  "name": "head"
                },
                {
                  "type": "box",
                  "width": 5,
                  "height": 4,
                  "depth": 6,
                  "x": 0,
                  "y": 43.75714285714285,
                  "z": 7.485714285714296,
                  "color": "#686f20",
                  "name": "nose"
                },
                {
                  "type": "box",
                  "width": 12,
                  "height": 3,
                  "depth": 6,
                  "x": 0,
                  "y": 40.257142857142846,
                  "z": 5.485714285714296,
                  "color": "#7d4023",
                  "name": "jaw"
                },
                {
                  "type": "sphere",
                  "size": 4,
                  "x": 4.5,
                  "y": 45.75714285714285,
                  "z": 5.985714285714293,
                  "color": "#c5c5c5",
                  "name": "eye-right"
                },
                {
                  "type": "sphere",
                  "size": 1.5,
                  "x": 5,
                  "y": 45.75714285714285,
                  "z": 7.4857142857143,
                  "color": "#000000",
                  "name": "pupil-right"
                },
                {
                  "type": "sphere",
                  "size": 4,
                  "x": -4.5,
                  "y": 45.75714285714285,
                  "z": 5.985714285714293,
                  "color": "#c5c5c5",
                  "name": "eye-left"
                },
                {
                  "type": "sphere",
                  "size": 1.5,
                  "x": -5,
                  "y": 45.75714285714285,
                  "z": 7.4857142857143,
                  "color": "#000000",
                  "name": "pupil-left"
                },
                {
                  "type": "box",
                  "width": 6,
                  "height": 20,
                  "depth": 6,
                  "x": 11.999999999999998,
                  "y": 29.75714285714285,
                  "z": 1.4857142857142973,
                  "color": "#496a29",
                  "name": "arm-right"
                },
                {
                  "type": "box",
                  "width": 6,
                  "height": 20,
                  "depth": 6,
                  "x": -12.000000000000002,
                  "y": 29.75714285714285,
                  "z": 1.4857142857142973,
                  "color": "#496a29",
                  "name": "arm-left"
                },
                {
                  "type": "box",
                  "width": 8,
                  "height": 5,
                  "depth": 7,
                  "x": 11.999999999999998,
                  "y": 17.757142857142853,
                  "z": 2.4857142857142978,
                  "color": "#496a29",
                  "name": "hand-right"
                },
                {
                  "type": "box",
                  "width": 8,
                  "height": 5,
                  "depth": 7,
                  "x": -12.000000000000002,
                  "y": 17.757142857142853,
                  "z": 2.4857142857142978,
                  "color": "#496a29",
                  "name": "hand-left"
                },
                {
                  "type": "box",
                  "width": 6,
                  "height": 15,
                  "depth": 6,
                  "x": 4,
                  "y": 9.75714285714285,
                  "z": 1.4857142857142982,
                  "color": "#496a29",
                  "name": "leg-right"
                },
                {
                  "type": "box",
                  "width": 6,
                  "height": 15,
                  "depth": 6,
                  "x": -4,
                  "y": 9.75714285714285,
                  "z": 1.4857142857142982,
                  "color": "#496a29",
                  "name": "leg-left"
                },
                {
                  "type": "box",
                  "width": 7,
                  "height": 3,
                  "depth": 10,
                  "x": 4,
                  "y": 1.7571428571428456,
                  "z": 3.4857142857143026,
                  "color": "#3B3B3B",
                  "name": "foot-right"
                },
                {
                  "type": "box",
                  "width": 7,
                  "height": 3,
                  "depth": 10,
                  "x": -4,
                  "y": 1.7571428571428456,
                  "z": 3.4857142857143026,
                  "color": "#3B3B3B",
                  "name": "foot-left"
                },
                {
                  "type": "box",
                  "width": 3,
                  "height": 6,
                  "depth": 2,
                  "x": 6.499999999999998,
                  "y": 46.75714285714285,
                  "z": 0.4857142857142964,
                  "color": "#686b23",
                  "name": "ear-right"
                },
                {
                  "type": "box",
                  "width": 3,
                  "height": 6,
                  "depth": 2,
                  "x": -6.5,
                  "y": 46.75714285714285,
                  "z": 0.4857142857142964,
                  "color": "#686b23",
                  "name": "ear-left"
                },
                {
                  "type": "cone",
                  "size": 16,
                  "height": 5,
                  "x": 0,
                  "y": 50.2,
                  "z": 1.4857142857142929,
                  "rotationX": 0,
                  "color": "#555555",
                  "name": "helmet"
                },
                {
                  "type": "box",
                  "width": 1.5,
                  "height": 3,
                  "depth": 0.7,
                  "x": 4,
                  "y": 38.75714285714285,
                  "z": 8.485714285714296,
                  "color": "#c5c5c5",
                  "name": "tusk-right"
                },
                {
                  "type": "box",
                  "width": 1.5,
                  "height": 3,
                  "depth": 0.7,
                  "x": -4,
                  "y": 38.75714285714285,
                  "z": 8.485714285714296,
                  "color": "#c5c5c5",
                  "name": "tusk-left"
                },
                {
                  "type": "box",
                  "width": 15,
                  "height": 3,
                  "depth": 11,
                  "x": 0,
                  "y": 19.757142857142853,
                  "z": 1.4857142857142982,
                  "color": "#8B4513",
                  "name": "belt"
                },
                {
                  "type": "box",
                  "width": 7,
                  "height": 9,
                  "depth": 3,
                  "x": 0,
                  "y": 42.75714285714285,
                  "z": -4.514285714285706,
                  "color": "#222222",
                  "name": "hair"
                },
                {
                  "type": "cylinder",
                  "size": 3,
                  "height": 30,
                  "x": 11.999999999999998,
                  "y": 14.999999999999996,
                  "z": 7.000000000000014,
                  "color": "#8B4513",
                  "name": "club-handle",
                  "rotationZ": 0,
                  "rotationX": 90
                },
                {
                  "type": "sphere",
                  "size": 9,
                  "x": 11.999999999999998,
                  "y": 14.999999999999996,
                  "z": 18.000000000000014,
                  "color": "#8B4513",
                  "name": "club-head"
                },
                {
                  "type": "cone",
                  "size": 4,
                  "height": 5,
                  "x": 12.1,
                  "y": 19.999999999999996,
                  "z": 18.000000000000014,
                  "rotationY": 90,
                  "color": "#808080",
                  "name": "club-spike-1"
                },
                {
                  "type": "cone",
                  "size": 4,
                  "height": 5,
                  "x": 12.1,
                  "y": 9.999999999999996,
                  "z": 18.000000000000014,
                  "rotationY": 0,
                  "color": "#808080",
                  "name": "club-spike-2",
                  "rotationX": 180
                },
                {
                  "type": "cone",
                  "size": 4,
                  "height": 5,
                  "x": 6.6,
                  "y": 14.999999999999996,
                  "z": 18.000000000000014,
                  "rotationY": 0,
                  "color": "#808080",
                  "name": "club-spike-3",
                  "rotationZ": 90,
                  "rotationX": 0
                },
                {
                  "type": "cone",
                  "size": 4,
                  "height": 5,
                  "x": 17.6,
                  "y": 14.999999999999996,
                  "z": 18.000000000000014,
                  "rotationY": 0,
                  "color": "#808080",
                  "name": "club-spike-4",
                  "rotationX": 90,
                  "rotationZ": -90
                },
                {
                  "type": "cone",
                  "size": 4,
                  "height": 5,
                  "x": 11.999999999999998,
                  "y": 14.999999999999995,
                  "z": 24.00000000000002,
                  "rotationX": 90,
                  "color": "#808080",
                  "name": "club-spike-top"
                },
                {
                  "type": "box",
                  "width": 12,
                  "height": 4,
                  "depth": 4,
                  "x": 0,
                  "y": 23.757142857142853,
                  "z": -3.5142857142857027,
                  "color": "#333333",
                  "name": "back-armor"
                },
                {
                  "type": "box",
                  "width": 7,
                  "height": 7,
                  "depth": 2,
                  "x": 12,
                  "y": 40,
                  "z": 1.4857142857142973,
                  "color": "#796020",
                  "name": "shoulder-pad-right",
                  "rotationX": 90
                },
                {
                  "type": "box",
                  "width": 7,
                  "height": 7,
                  "depth": 2,
                  "x": -12,
                  "y": 40,
                  "z": 1.4857142857142973,
                  "color": "#796020",
                  "name": "shoulder-pad-left",
                  "rotationX": 90
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            }
          }
        },
        "armor": 100,
        "title": "Orc"
      },
      "pirate": {
        "title": "Pirate",
        "render": {
          "animations": {
            "idle": [
              {}
            ]
          },
          "model": {
            "shapes": {
              "shapes": [
                {
                  "type": "box",
                  "width": 12,
                  "height": 16,
                  "depth": 7,
                  "x": 0,
                  "y": 24,
                  "z": 0,
                  "color": "#2F1A4A",
                  "name": "torso",
                  "scaleX": 1
                },
                {
                  "type": "sphere",
                  "size": 10,
                  "x": 0,
                  "y": 35,
                  "z": 0,
                  "color": "#E8C9A0",
                  "name": "head"
                },
                {
                  "type": "box",
                  "width": 3,
                  "height": 2,
                  "depth": 4,
                  "x": 0,
                  "y": 35,
                  "z": 4,
                  "color": "#E8C9A0",
                  "name": "nose"
                },
                {
                  "type": "box",
                  "width": 8,
                  "height": 2,
                  "depth": 4,
                  "x": 0,
                  "y": 32,
                  "z": 3,
                  "color": "#ECB69B",
                  "name": "jaw"
                },
                {
                  "type": "sphere",
                  "size": 2,
                  "x": -3,
                  "y": 36,
                  "z": 4,
                  "color": "#87CEFA",
                  "name": "eye-right"
                },
                {
                  "type": "sphere",
                  "size": 1,
                  "x": -3.5,
                  "y": 36,
                  "z": 4.5,
                  "color": "#000000",
                  "name": "pupil-right"
                },
                {
                  "type": "box",
                  "width": 3,
                  "height": 2,
                  "depth": 1,
                  "x": 2,
                  "y": 36,
                  "z": 5,
                  "color": "#000000",
                  "name": "eyepatch-left"
                },
                {
                  "type": "box",
                  "width": 4,
                  "height": 12,
                  "depth": 4,
                  "x": -8,
                  "y": 24,
                  "z": 0,
                  "color": "#2F1A4A",
                  "name": "arm-right",
                  "rotationZ": -15
                },
                {
                  "type": "box",
                  "width": 4,
                  "height": 12,
                  "depth": 4,
                  "x": 8,
                  "y": 24,
                  "z": 0,
                  "color": "#2F1A4A",
                  "name": "arm-left",
                  "rotationZ": 15
                },
                {
                  "type": "box",
                  "width": 5,
                  "height": 3,
                  "depth": 5,
                  "x": -8,
                  "y": 16,
                  "z": 1,
                  "color": "#E8C9A0",
                  "name": "hand-right",
                  "rotationX": 90
                },
                {
                  "type": "box",
                  "width": 2,
                  "height": 4,
                  "depth": 2,
                  "x": 8,
                  "y": 16,
                  "z": 1,
                  "color": "#C0C0C0",
                  "name": "hook-left",
                  "rotationZ": -45
                },
                {
                  "type": "box",
                  "width": 4,
                  "height": 12,
                  "depth": 4,
                  "x": -3,
                  "y": 8,
                  "z": 0,
                  "color": "#3B3B3B",
                  "name": "leg-right"
                },
                {
                  "type": "cylinder",
                  "size": 3,
                  "height": 13,
                  "x": 3,
                  "y": 7.5,
                  "z": 0,
                  "color": "#8B4513",
                  "name": "peg-leg-left"
                },
                {
                  "type": "box",
                  "width": 5,
                  "height": 2,
                  "depth": 6,
                  "x": -3,
                  "y": 2,
                  "z": 2,
                  "color": "#3B3B3B",
                  "name": "boot-right"
                },
                {
                  "type": "cylinder",
                  "size": 4,
                  "height": 2,
                  "x": 3,
                  "y": 2,
                  "z": 2,
                  "color": "#8B4513",
                  "name": "peg-foot-left"
                },
                {
                  "type": "box",
                  "width": 11,
                  "height": 10,
                  "depth": 8,
                  "x": 0,
                  "y": 15,
                  "z": 0,
                  "color": "#FF0000",
                  "name": "pants"
                },
                {
                  "type": "box",
                  "width": 12,
                  "height": 8,
                  "depth": 2,
                  "x": 0,
                  "y": 32,
                  "z": 3,
                  "color": "#000000",
                  "name": "beard"
                },
                {
                  "type": "box",
                  "width": 14,
                  "height": 6,
                  "depth": 10,
                  "x": 0,
                  "y": 40,
                  "z": 0,
                  "color": "#000000",
                  "name": "hat"
                },
                {
                  "type": "box",
                  "width": 2,
                  "height": 4,
                  "depth": 2,
                  "x": -9,
                  "y": 14,
                  "z": 1,
                  "color": "#8B4513",
                  "name": "sword-handle",
                  "rotationZ": 0,
                  "rotationX": -45
                },
                {
                  "type": "box",
                  "width": 2,
                  "height": 2.2,
                  "depth": 6,
                  "x": -9,
                  "y": 13,
                  "z": 2,
                  "color": "#C0C0C0",
                  "name": "sword-guard",
                  "rotationZ": 45,
                  "rotationX": 0,
                  "rotationY": 90
                },
                {
                  "type": "box",
                  "width": 1,
                  "height": 1,
                  "depth": 18,
                  "x": -9,
                  "y": 8,
                  "z": 7,
                  "color": "#C0C0C0",
                  "name": "sword-blade",
                  "rotationZ": 45,
                  "rotationX": 45
                },
                {
                  "type": "box",
                  "width": 8,
                  "height": 2,
                  "depth": 10,
                  "x": 0,
                  "y": 16,
                  "z": 0,
                  "color": "#FFD700",
                  "name": "sash"
                },
                {
                  "type": "box",
                  "width": 2,
                  "height": 2,
                  "depth": 2,
                  "x": -2,
                  "y": 43,
                  "z": 0,
                  "color": "#FF0000",
                  "name": "hat-feather-right",
                  "rotationZ": 45
                },
                {
                  "type": "box",
                  "width": 2,
                  "height": 2,
                  "depth": 2,
                  "x": 2,
                  "y": 43,
                  "z": 0,
                  "color": "#FF0000",
                  "name": "hat-feather-left",
                  "rotationZ": -45
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            }
          }
        }
      },
      "skeleton": {
        "hp": 20,
        "speed": 1.2,
        "value": 7,
        "essence": 12,
        "render": {
          "animations": {
            "idle": [
              {}
            ],
            "walk": [
              {},
              {
                "shapes": {
                  "shapes": [
                    {
                      "y": 40,
                      "id": 0
                    },
                    {
                      "rotationZ": 0,
                      "rotationY": 10,
                      "id": 1
                    },
                    {
                      "y": 41,
                      "id": 2
                    },
                    {
                      "y": 41,
                      "id": 3
                    },
                    {
                      "y": 29,
                      "rotationX": 90,
                      "id": 4
                    },
                    {
                      "y": 25,
                      "rotationX": 120,
                      "id": 5
                    },
                    {
                      "y": 29,
                      "id": 6
                    },
                    {
                      "y": 20,
                      "id": 7
                    },
                    {
                      "z": -2,
                      "rotationX": 15,
                      "rotationY": 0,
                      "id": 8
                    },
                    {
                      "z": 2,
                      "rotationX": -15,
                      "id": 9
                    },
                    {
                      "z": -4,
                      "id": 10
                    },
                    {
                      "z": 6,
                      "id": 11
                    }
                  ]
                }
              },
              {},
              {
                "shapes": {
                  "shapes": [
                    {
                      "y": 40,
                      "id": 0
                    },
                    {
                      "rotationY": -10,
                      "id": 1
                    },
                    {
                      "y": 41,
                      "id": 2
                    },
                    {
                      "y": 41,
                      "id": 3
                    },
                    {
                      "y": 25,
                      "rotationX": 120,
                      "id": 4
                    },
                    {
                      "y": 29,
                      "rotationX": 90,
                      "id": 5
                    },
                    {
                      "y": 20,
                      "id": 6
                    },
                    {
                      "y": 29,
                      "id": 7
                    },
                    {
                      "z": 2,
                      "rotationX": -15,
                      "id": 8
                    },
                    {
                      "z": -2,
                      "rotationX": 15,
                      "id": 9
                    },
                    {
                      "z": 6,
                      "id": 10
                    },
                    {
                      "z": -4,
                      "id": 11
                    }
                  ]
                }
              }
            ]
          },
          "model": {
            "shapes": {
              "shapes": [
                {
                  "type": "sphere",
                  "size": 14,
                  "color": "#E0DED8",
                  "x": 0,
                  "y": 41,
                  "z": 0,
                  "name": "head"
                },
                {
                  "type": "box",
                  "width": 16,
                  "height": 20,
                  "depth": 8,
                  "color": "#CFCBC0",
                  "x": 0,
                  "y": 24,
                  "z": 0,
                  "name": "body",
                  "scaleX": 1
                },
                {
                  "type": "sphere",
                  "size": 3,
                  "color": "#000000",
                  "x": 4,
                  "y": 42,
                  "z": 5,
                  "name": "eye-left"
                },
                {
                  "type": "sphere",
                  "size": 3,
                  "color": "#000000",
                  "x": -4,
                  "y": 42,
                  "z": 5,
                  "name": "eye-right"
                },
                {
                  "type": "cylinder",
                  "size": 3,
                  "height": 18,
                  "color": "#E0DED8",
                  "x": 8,
                  "y": 27,
                  "z": 10,
                  "rotationX": 105,
                  "rotationZ": 15,
                  "name": "arm-left"
                },
                {
                  "type": "cylinder",
                  "size": 3,
                  "height": 18,
                  "color": "#E0DED8",
                  "x": -8,
                  "y": 27,
                  "z": 10,
                  "rotationX": 105,
                  "rotationZ": -15,
                  "name": "arm-right"
                },
                {
                  "type": "sphere",
                  "size": 5,
                  "color": "#E0DED8",
                  "x": 6,
                  "y": 25,
                  "z": 20,
                  "name": "hand-left"
                },
                {
                  "type": "sphere",
                  "size": 5,
                  "color": "#E0DED8",
                  "x": -6,
                  "y": 25,
                  "z": 20,
                  "name": "hand-right"
                },
                {
                  "type": "cylinder",
                  "size": 3,
                  "height": 22,
                  "color": "#E0DED8",
                  "x": 5,
                  "y": 14,
                  "z": 0,
                  "rotationZ": 0,
                  "name": "leg-left",
                  "rotationX": 0
                },
                {
                  "type": "cylinder",
                  "size": 3,
                  "height": 22,
                  "color": "#E0DED8",
                  "x": -5,
                  "y": 14,
                  "z": 0,
                  "rotationZ": 0,
                  "name": "leg-right"
                },
                {
                  "type": "sphere",
                  "size": 5,
                  "color": "#E0DED8",
                  "x": 5,
                  "y": 2,
                  "z": 0,
                  "name": "foot-left"
                },
                {
                  "type": "sphere",
                  "size": 5,
                  "color": "#E0DED8",
                  "x": -5,
                  "y": 2,
                  "z": 0,
                  "name": "foot-right"
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            }
          }
        },
        "electricResistance": 75,
        "title": "skeleton"
      },
      "stegosaurus": {
        "speed": 1,
        "hp": 30,
        "essence": 10,
        "value": 5,
        "render": {
          "animations": {
            "idle": [
              {}
            ],
            "walk": [
              {
                "shapes": {
                  "shapes": [
                    {
                      "x": 1,
                      "id": 1
                    },
                    {
                      "x": 1,
                      "id": 2
                    },
                    {
                      "x": 1,
                      "id": 3
                    },
                    {
                      "x": -8,
                      "id": 4
                    },
                    {
                      "x": -9,
                      "id": 5
                    },
                    {
                      "x": 10,
                      "id": 6
                    },
                    {
                      "x": 11,
                      "id": 7
                    },
                    {
                      "x": -2,
                      "id": 8
                    },
                    {
                      "x": -6,
                      "rotationY": 15,
                      "id": 9
                    },
                    {
                      "y": 9,
                      "id": 10
                    },
                    {
                      "y": 12,
                      "id": 11
                    },
                    {
                      "y": 12,
                      "id": 12
                    },
                    {
                      "y": 9,
                      "id": 13
                    },
                    {
                      "y": 2,
                      "id": 14
                    },
                    {
                      "y": 5,
                      "id": 15
                    },
                    {
                      "y": 5,
                      "id": 16
                    },
                    {
                      "y": 2,
                      "id": 17
                    },
                    {
                      "x": -2,
                      "id": 20
                    },
                    {
                      "x": -6,
                      "rotationX": 15,
                      "id": 21
                    },
                    {
                      "x": 1,
                      "id": 22
                    }
                  ]
                }
              },
              {
                "shapes": {
                  "shapes": [
                    {
                      "x": -1,
                      "id": 1
                    },
                    {
                      "x": -1,
                      "id": 2
                    },
                    {
                      "x": -1,
                      "id": 3
                    },
                    {
                      "x": -10,
                      "id": 4
                    },
                    {
                      "x": -11,
                      "id": 5
                    },
                    {
                      "x": 8,
                      "id": 6
                    },
                    {
                      "x": 9,
                      "id": 7
                    },
                    {
                      "x": 2,
                      "id": 8
                    },
                    {
                      "x": 6,
                      "rotationY": -15,
                      "id": 9
                    },
                    {
                      "y": 12,
                      "id": 10
                    },
                    {
                      "y": 9,
                      "id": 11
                    },
                    {
                      "y": 9,
                      "id": 12
                    },
                    {
                      "y": 12,
                      "id": 13
                    },
                    {
                      "y": 5,
                      "id": 14
                    },
                    {
                      "y": 2,
                      "id": 15
                    },
                    {
                      "y": 2,
                      "id": 16
                    },
                    {
                      "y": 5,
                      "id": 17
                    },
                    {
                      "x": 2,
                      "id": 20
                    },
                    {
                      "x": 6,
                      "rotationX": -15,
                      "id": 21
                    },
                    {
                      "x": -1,
                      "id": 22
                    }
                  ]
                }
              },
              {
                "shapes": {
                  "shapes": [
                    {
                      "x": 1,
                      "id": 1
                    },
                    {
                      "x": 1,
                      "id": 2
                    },
                    {
                      "x": 1,
                      "id": 3
                    },
                    {
                      "x": -8,
                      "id": 4
                    },
                    {
                      "x": -9,
                      "id": 5
                    },
                    {
                      "x": 10,
                      "id": 6
                    },
                    {
                      "x": 11,
                      "id": 7
                    },
                    {
                      "x": -2,
                      "id": 8
                    },
                    {
                      "x": -6,
                      "rotationY": 15,
                      "id": 9
                    },
                    {
                      "y": 12,
                      "id": 10
                    },
                    {
                      "y": 9,
                      "id": 11
                    },
                    {
                      "y": 9,
                      "id": 12
                    },
                    {
                      "y": 12,
                      "id": 13
                    },
                    {
                      "y": 5,
                      "id": 14
                    },
                    {
                      "y": 2,
                      "id": 15
                    },
                    {
                      "y": 2,
                      "id": 16
                    },
                    {
                      "y": 5,
                      "id": 17
                    },
                    {
                      "x": -2,
                      "id": 20
                    },
                    {
                      "x": -6,
                      "rotationX": 15,
                      "id": 21
                    },
                    {
                      "x": 1,
                      "id": 22
                    }
                  ]
                }
              },
              {
                "shapes": {
                  "shapes": [
                    {
                      "x": -1,
                      "id": 1
                    },
                    {
                      "x": -1,
                      "id": 2
                    },
                    {
                      "x": -1,
                      "id": 3
                    },
                    {
                      "x": -10,
                      "id": 4
                    },
                    {
                      "x": -11,
                      "id": 5
                    },
                    {
                      "x": 8,
                      "id": 6
                    },
                    {
                      "x": 9,
                      "id": 7
                    },
                    {
                      "x": 2,
                      "id": 8
                    },
                    {
                      "x": 6,
                      "rotationY": -15,
                      "id": 9
                    },
                    {
                      "y": 9,
                      "id": 10
                    },
                    {
                      "y": 12,
                      "id": 11
                    },
                    {
                      "y": 12,
                      "id": 12
                    },
                    {
                      "y": 9,
                      "id": 13
                    },
                    {
                      "y": 2,
                      "id": 14
                    },
                    {
                      "y": 5,
                      "id": 15
                    },
                    {
                      "y": 5,
                      "id": 16
                    },
                    {
                      "y": 2,
                      "id": 17
                    },
                    {
                      "x": 2,
                      "id": 20
                    },
                    {
                      "x": 6,
                      "rotationX": -15,
                      "id": 21
                    },
                    {
                      "x": -1,
                      "id": 22
                    }
                  ]
                }
              }
            ]
          },
          "model": {
            "shapes": {
              "shapes": [
                {
                  "type": "box",
                  "width": 24,
                  "height": 12,
                  "depth": 32,
                  "x": 0,
                  "y": 18,
                  "z": 0,
                  "color": "#5D8233",
                  "name": "body",
                  "scaleX": 1
                },
                {
                  "type": "box",
                  "width": 16,
                  "height": 12,
                  "depth": 22,
                  "x": 0,
                  "y": 28,
                  "z": 24,
                  "color": "#5D8233",
                  "name": "head"
                },
                {
                  "type": "box",
                  "width": 14,
                  "height": 5,
                  "depth": 20,
                  "x": 0,
                  "y": 23,
                  "z": 26,
                  "color": "#4E6C2A",
                  "name": "jaw"
                },
                {
                  "type": "box",
                  "width": 12,
                  "height": 2,
                  "depth": 1,
                  "x": 0,
                  "y": 23,
                  "z": 36,
                  "color": "#FFFFFF",
                  "name": "teeth"
                },
                {
                  "type": "sphere",
                  "size": 4,
                  "x": -9,
                  "y": 32,
                  "z": 28,
                  "color": "#FFFF00",
                  "name": "eye-right"
                },
                {
                  "type": "sphere",
                  "size": 2,
                  "x": -10,
                  "y": 32,
                  "z": 29,
                  "color": "#000000",
                  "name": "pupil-right"
                },
                {
                  "type": "sphere",
                  "size": 4,
                  "x": 9,
                  "y": 32,
                  "z": 28,
                  "color": "#FFFF00",
                  "name": "eye-left"
                },
                {
                  "type": "sphere",
                  "size": 2,
                  "x": 10,
                  "y": 32,
                  "z": 29,
                  "color": "#000000",
                  "name": "pupil-left"
                },
                {
                  "type": "box",
                  "width": 8,
                  "height": 6,
                  "depth": 20,
                  "x": 0,
                  "y": 16,
                  "z": -20,
                  "color": "#5D8233",
                  "name": "tail-base"
                },
                {
                  "type": "box",
                  "width": 6,
                  "height": 4,
                  "depth": 16,
                  "x": 0,
                  "y": 15,
                  "z": -38,
                  "rotationY": 0,
                  "color": "#5D8233",
                  "name": "tail-tip"
                },
                {
                  "type": "box",
                  "width": 6,
                  "height": 12,
                  "depth": 6,
                  "x": 10,
                  "y": 10,
                  "z": 10,
                  "color": "#4E6C2A",
                  "name": "leg-front-left"
                },
                {
                  "type": "box",
                  "width": 6,
                  "height": 12,
                  "depth": 6,
                  "x": 10,
                  "y": 10,
                  "z": -10,
                  "color": "#4E6C2A",
                  "name": "leg-back-left"
                },
                {
                  "type": "box",
                  "width": 6,
                  "height": 12,
                  "depth": 6,
                  "x": -10,
                  "y": 10,
                  "z": 10,
                  "color": "#4E6C2A",
                  "name": "leg-front-right"
                },
                {
                  "type": "box",
                  "width": 6,
                  "height": 12,
                  "depth": 6,
                  "x": -10,
                  "y": 10,
                  "z": -10,
                  "color": "#4E6C2A",
                  "name": "leg-back-right"
                },
                {
                  "type": "box",
                  "width": 8,
                  "height": 3,
                  "depth": 10,
                  "x": 10,
                  "y": 3,
                  "z": 12,
                  "color": "#4E6C2A",
                  "name": "foot-front-left"
                },
                {
                  "type": "box",
                  "width": 8,
                  "height": 3,
                  "depth": 10,
                  "x": 10,
                  "y": 3,
                  "z": -8,
                  "color": "#4E6C2A",
                  "name": "foot-back-left"
                },
                {
                  "type": "box",
                  "width": 8,
                  "height": 3,
                  "depth": 10,
                  "x": -10,
                  "y": 3,
                  "z": 12,
                  "color": "#4E6C2A",
                  "name": "foot-front-right"
                },
                {
                  "type": "box",
                  "width": 8,
                  "height": 3,
                  "depth": 10,
                  "x": -10,
                  "y": 3,
                  "z": -8,
                  "color": "#4E6C2A",
                  "name": "foot-back-right"
                },
                {
                  "type": "cone",
                  "size": 6,
                  "height": 8,
                  "x": 0,
                  "y": 27,
                  "z": 0,
                  "rotationX": 0,
                  "color": "#436026",
                  "name": "spike-back-1"
                },
                {
                  "type": "cone",
                  "size": 6,
                  "height": 8,
                  "x": 0,
                  "y": 26,
                  "z": -10,
                  "rotationX": 0,
                  "color": "#436026",
                  "name": "spike-back-2"
                },
                {
                  "type": "cone",
                  "size": 5,
                  "height": 6,
                  "x": 0,
                  "y": 22,
                  "z": -24,
                  "rotationX": 0,
                  "color": "#436026",
                  "name": "spike-tail-base"
                },
                {
                  "type": "cone",
                  "size": 4,
                  "height": 5,
                  "x": 0,
                  "y": 20,
                  "z": -36,
                  "rotationX": 0,
                  "color": "#436026",
                  "name": "spike-tail-tip"
                },
                {
                  "type": "cone",
                  "size": 6,
                  "height": 8,
                  "x": 0,
                  "y": 34,
                  "z": 20,
                  "rotationX": 0,
                  "color": "#436026",
                  "name": "spike-head"
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            }
          }
        },
        "title": "stegosaurus"
      },
      "zombie": {
        "hp": 30,
        "speed": 0.8,
        "value": 5,
        "essence": 10,
        "render": {
          "animations": {
            "idle": [
              {
                "shapes": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "greenMColor"
                      },
                      "id": 6
                    },
                    {
                      "color": {
                        "paletteColor": "greenMColor"
                      },
                      "id": 7
                    },
                    {
                      "color": {
                        "paletteColor": "greenMColor"
                      },
                      "id": 8
                    },
                    {
                      "color": {
                        "paletteColor": "greenMColor"
                      },
                      "id": 9
                    }
                  ]
                }
              }
            ],
            "walk": [
              {
                "shapes": {
                  "shapes": [
                    {
                      "color": "#FFFFFF",
                      "id": 2
                    },
                    {
                      "x": 12,
                      "rotationZ": -20,
                      "id": 6
                    },
                    {
                      "x": -12,
                      "rotationZ": 20,
                      "id": 7
                    },
                    {
                      "height": 20,
                      "y": 10,
                      "z": -2,
                      "rotationX": 30,
                      "id": 8
                    },
                    {
                      "rotationX": -10,
                      "id": 9
                    }
                  ]
                }
              },
              {
                "shapes": {
                  "shapes": [
                    {
                      "y": 33,
                      "id": 0
                    },
                    {
                      "y": 25,
                      "id": 1
                    },
                    {
                      "color": "#FFFFFF",
                      "y": 46,
                      "id": 2
                    },
                    {
                      "y": 46,
                      "id": 3
                    },
                    {
                      "y": 46,
                      "id": 4
                    },
                    {
                      "y": 46,
                      "id": 5
                    },
                    {
                      "x": 10,
                      "id": 6
                    },
                    {
                      "x": -10,
                      "id": 7
                    },
                    {
                      "y": 10,
                      "z": -2,
                      "rotationX": 30,
                      "id": 8
                    },
                    {
                      "height": 20,
                      "y": 10,
                      "z": -2,
                      "rotationX": 30,
                      "id": 9
                    }
                  ]
                }
              },
              {
                "shapes": {
                  "shapes": [
                    {
                      "y": 33,
                      "id": 0
                    },
                    {
                      "color": "#FFFFFF",
                      "y": 46,
                      "id": 2
                    },
                    {
                      "y": 46,
                      "id": 3
                    },
                    {
                      "y": 46,
                      "id": 4
                    },
                    {
                      "y": 46,
                      "id": 5
                    },
                    {
                      "rotationZ": 20,
                      "id": 6
                    },
                    {
                      "rotationZ": -20,
                      "id": 7
                    },
                    {
                      "y": 10,
                      "z": -2,
                      "rotationX": 30,
                      "id": 8
                    },
                    {
                      "height": 20,
                      "y": 10,
                      "z": -2,
                      "rotationX": 30,
                      "id": 9
                    }
                  ]
                }
              },
              {
                "shapes": {
                  "shapes": [
                    {
                      "y": 25,
                      "id": 1
                    },
                    {
                      "color": "#FFFFFF",
                      "id": 2
                    },
                    {
                      "x": 10,
                      "id": 6
                    },
                    {
                      "x": -10,
                      "id": 7
                    },
                    {
                      "height": 20,
                      "y": 10,
                      "z": -2,
                      "rotationX": 30,
                      "id": 8
                    },
                    {
                      "rotationX": 10,
                      "id": 9
                    }
                  ]
                }
              }
            ]
          },
          "model": {
            "shapes": {
              "shapes": [
                {
                  "type": "gltf",
                  "size": 16,
                  "color": "#60A060",
                  "x": 0,
                  "y": 32,
                  "z": 0,
                  "name": "head",
                  "scaleX": 500,
                  "scaleY": 500,
                  "scaleZ": 500,
                  "url": "samples/models/Avocado/Avocado.gltf"
                },
                {
                  "type": "cylinder",
                  "width": 20,
                  "height": 24,
                  "depth": 10,
                  "color": {
                    "paletteColor": "greenDColor"
                  },
                  "x": 0,
                  "y": 24,
                  "z": 0,
                  "size": 16,
                  "name": "body",
                  "scaleX": 1
                },
                {
                  "type": "sphere",
                  "size": 5,
                  "color": "#ffffff",
                  "x": 4,
                  "y": 45,
                  "z": 7,
                  "name": "eye-left",
                  "scaleX": 1
                },
                {
                  "type": "sphere",
                  "size": 5,
                  "color": "#FFFFFF",
                  "x": -4,
                  "y": 45,
                  "z": 7,
                  "name": "eye-right"
                },
                {
                  "type": "sphere",
                  "size": 2,
                  "color": "#000000",
                  "x": 4,
                  "y": 45,
                  "z": 9,
                  "name": "pupil-left"
                },
                {
                  "type": "sphere",
                  "size": 2,
                  "color": "#000000",
                  "x": -4,
                  "y": 45,
                  "z": 9,
                  "name": "pupil-right"
                },
                {
                  "type": "cylinder",
                  "size": 4,
                  "height": 20,
                  "color": {
                    "paletteColor": "greenMColor"
                  },
                  "x": 8,
                  "y": 29,
                  "z": 10,
                  "rotationX": 90,
                  "rotationZ": 0,
                  "name": "arm-left"
                },
                {
                  "type": "cylinder",
                  "size": 4,
                  "height": 20,
                  "color": {
                    "paletteColor": "greenMColor"
                  },
                  "x": -8,
                  "y": 29,
                  "z": 10,
                  "rotationX": 90,
                  "rotationZ": 0,
                  "name": "arm-right"
                },
                {
                  "type": "cylinder",
                  "size": 4,
                  "height": 24,
                  "color": {
                    "paletteColor": "greenMColor"
                  },
                  "x": 5,
                  "y": 12,
                  "z": 0,
                  "rotationZ": 0,
                  "name": "leg-left"
                },
                {
                  "type": "cylinder",
                  "size": 4,
                  "height": 24,
                  "color": {
                    "paletteColor": "greenMColor"
                  },
                  "x": -5,
                  "y": 12,
                  "z": 0,
                  "rotationZ": 0,
                  "rotationX": 0,
                  "name": "leg-right"
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            }
          }
        },
        "title": "zombie"
      },
      "viking": {
        "hp": 20,
        "value": 10,
        "essence": 15,
        "speed": 1,
        "render": {
          "animations": {
            "idle": [
              {}
            ],
            "walk": [
              {},
              {
                "shapes": {
                  "shapes": [
                    {
                      "z": 5.48,
                      "id": 0
                    },
                    {
                      "z": 5.48,
                      "id": 1
                    },
                    {
                      "z": 11.48,
                      "id": 2
                    },
                    {
                      "z": 9.48,
                      "id": 3
                    },
                    {
                      "z": 9.98,
                      "name": "eye-left",
                      "id": 4
                    },
                    {
                      "z": 11.48,
                      "name": "pupil-left",
                      "id": 5
                    },
                    {
                      "z": 9.98,
                      "name": "eye-right",
                      "id": 6
                    },
                    {
                      "z": 11.48,
                      "name": "pupil-right",
                      "id": 7
                    },
                    {
                      "y": 31.75,
                      "z": 5.48,
                      "name": "arm-left",
                      "rotationX": -20,
                      "id": 8
                    },
                    {
                      "y": 31.75,
                      "z": 5.48,
                      "name": "arm-right",
                      "rotationX": 20,
                      "id": 9
                    },
                    {
                      "y": 24.75,
                      "z": 15.48,
                      "name": "hand-left",
                      "id": 10
                    },
                    {
                      "y": 24.75,
                      "z": 2,
                      "name": "hand-right",
                      "rotationX": 105,
                      "id": 11
                    },
                    {
                      "z": 10,
                      "name": "leg-left",
                      "rotationX": -15,
                      "id": 12
                    },
                    {
                      "y": 12.75,
                      "name": "leg-right",
                      "rotationX": 5,
                      "id": 13
                    },
                    {
                      "y": 2.75,
                      "z": 13,
                      "name": "foot-left",
                      "id": 14
                    },
                    {
                      "y": 4.75,
                      "z": 2,
                      "name": "foot-right",
                      "id": 15
                    },
                    {
                      "z": 5.48,
                      "id": 16
                    },
                    {
                      "z": 8.5,
                      "id": 17
                    },
                    {
                      "z": 5.5,
                      "id": 18
                    },
                    {
                      "z": 5,
                      "id": 19
                    },
                    {
                      "z": -1,
                      "id": 20
                    },
                    {
                      "z": -1,
                      "rotationX": -10,
                      "id": 21
                    },
                    {
                      "y": 30,
                      "z": 5,
                      "rotationX": 20,
                      "id": 22
                    },
                    {
                      "y": 30,
                      "z": 6,
                      "rotationX": -20,
                      "id": 23
                    },
                    {
                      "x": -14,
                      "y": 25,
                      "z": 8,
                      "rotationZ": 30,
                      "rotationX": 110,
                      "id": 24
                    },
                    {
                      "x": -14,
                      "y": 25,
                      "z": 7,
                      "rotationZ": 30,
                      "rotationX": 110,
                      "id": 25
                    },
                    {
                      "y": 25,
                      "z": 15.48,
                      "rotationX": 0,
                      "id": 26
                    },
                    {
                      "y": 38,
                      "z": 15.5,
                      "rotationX": 90,
                      "id": 27
                    },
                    {
                      "y": 46,
                      "z": 15.5,
                      "rotationY": 90,
                      "id": 28
                    },
                    {
                      "z": 5.5,
                      "id": 29
                    },
                    {
                      "z": 5.5,
                      "id": 30
                    }
                  ]
                }
              },
              {},
              {
                "shapes": {
                  "shapes": [
                    {
                      "y": 27.75,
                      "z": 5.48,
                      "id": 0
                    },
                    {
                      "y": 42.75,
                      "z": 5.48,
                      "id": 1
                    },
                    {
                      "y": 42.75,
                      "z": 11.48,
                      "id": 2
                    },
                    {
                      "y": 39.25,
                      "z": 9.48,
                      "id": 3
                    },
                    {
                      "y": 44.75,
                      "z": 9.98,
                      "id": 4
                    },
                    {
                      "y": 44.75,
                      "z": 11.48,
                      "id": 5
                    },
                    {
                      "y": 44.75,
                      "z": 9.98,
                      "id": 6
                    },
                    {
                      "y": 44.75,
                      "z": 11.48,
                      "id": 7
                    },
                    {
                      "y": 28.75,
                      "z": 5.48,
                      "rotationX": 20,
                      "id": 8
                    },
                    {
                      "y": 28.75,
                      "z": 5.48,
                      "rotationX": -20,
                      "id": 9
                    },
                    {
                      "y": 20.75,
                      "z": -4.52,
                      "id": 10
                    },
                    {
                      "y": 20.75,
                      "z": 15,
                      "id": 11
                    },
                    {
                      "y": 12.75,
                      "rotationX": 5,
                      "id": 12
                    },
                    {
                      "z": 10,
                      "rotationX": -15,
                      "id": 13
                    },
                    {
                      "y": 4.75,
                      "z": 1.48,
                      "id": 14
                    },
                    {
                      "y": 2.75,
                      "z": 13,
                      "id": 15
                    },
                    {
                      "y": 18.75,
                      "z": 5.48,
                      "id": 16
                    },
                    {
                      "y": 39,
                      "z": 8.5,
                      "id": 17
                    },
                    {
                      "y": 50,
                      "z": 5.5,
                      "id": 18
                    },
                    {
                      "y": 48.1,
                      "z": 5,
                      "id": 19
                    },
                    {
                      "y": 44,
                      "z": -1,
                      "id": 20
                    },
                    {
                      "y": 27,
                      "z": -1,
                      "rotationX": -10,
                      "id": 21
                    },
                    {
                      "z": 7,
                      "rotationX": -20,
                      "id": 22
                    },
                    {
                      "z": 4,
                      "rotationX": 15,
                      "id": 23
                    },
                    {
                      "y": 21,
                      "z": 19,
                      "rotationX": 75,
                      "id": 24
                    },
                    {
                      "y": 21,
                      "z": 17.48,
                      "rotationX": 75,
                      "id": 25
                    },
                    {
                      "y": 21,
                      "z": -4.52,
                      "rotationX": 0,
                      "id": 26
                    },
                    {
                      "height": 12,
                      "depth": 14,
                      "y": 10,
                      "z": -4.5,
                      "id": 27
                    },
                    {
                      "y": 2,
                      "z": -5,
                      "rotationX": 180,
                      "id": 28
                    },
                    {
                      "y": 57,
                      "z": 5.5,
                      "id": 29
                    },
                    {
                      "y": 57,
                      "z": 5.5,
                      "id": 30
                    }
                  ]
                }
              }
            ]
          },
          "model": {
            "shapes": {
              "shapes": [
                {
                  "type": "box",
                  "width": 14,
                  "height": 18,
                  "depth": 10,
                  "x": 0,
                  "y": 28.75,
                  "z": 1.48,
                  "color": "#8B4513",
                  "name": "torso",
                  "scaleX": 1
                },
                {
                  "type": "sphere",
                  "size": 15,
                  "x": 0,
                  "y": 43.75,
                  "z": 1.48,
                  "color": "#e8c9a0",
                  "name": "head"
                },
                {
                  "type": "box",
                  "width": 5,
                  "height": 4,
                  "depth": 6,
                  "x": 0,
                  "y": 43.75,
                  "z": 7.48,
                  "color": "#E8C9A0",
                  "name": "nose"
                },
                {
                  "type": "box",
                  "width": 12,
                  "height": 3,
                  "depth": 6,
                  "x": 0,
                  "y": 40.25,
                  "z": 5.48,
                  "color": "#ecb69b",
                  "name": "jaw"
                },
                {
                  "type": "sphere",
                  "size": 4,
                  "x": 4.5,
                  "y": 45.75,
                  "z": 5.98,
                  "color": "#87CEFA",
                  "name": "eye-right"
                },
                {
                  "type": "sphere",
                  "size": 1.5,
                  "x": 5,
                  "y": 45.75,
                  "z": 7.48,
                  "color": "#000000",
                  "name": "pupil-right"
                },
                {
                  "type": "sphere",
                  "size": 4,
                  "x": -4.5,
                  "y": 45.75,
                  "z": 5.98,
                  "color": "#87CEFA",
                  "name": "eye-left"
                },
                {
                  "type": "sphere",
                  "size": 1.5,
                  "x": -5,
                  "y": 45.75,
                  "z": 7.48,
                  "color": "#000000",
                  "name": "pupil-left"
                },
                {
                  "type": "box",
                  "width": 6,
                  "height": 20,
                  "depth": 6,
                  "x": 12,
                  "y": 29.75,
                  "z": 1.48,
                  "color": "#8B4513",
                  "name": "arm-right"
                },
                {
                  "type": "box",
                  "width": 6,
                  "height": 20,
                  "depth": 6,
                  "x": -12,
                  "y": 29.75,
                  "z": 1.48,
                  "color": "#8B4513",
                  "name": "arm-left"
                },
                {
                  "type": "box",
                  "width": 8,
                  "height": 5,
                  "depth": 7,
                  "x": 12,
                  "y": 17.75,
                  "z": 2.48,
                  "color": "#E8C9A0",
                  "name": "hand-right"
                },
                {
                  "type": "box",
                  "width": 8,
                  "height": 5,
                  "depth": 7,
                  "x": -12,
                  "y": 17.75,
                  "z": 2.48,
                  "color": "#E8C9A0",
                  "name": "hand-left"
                },
                {
                  "type": "box",
                  "width": 6,
                  "height": 15,
                  "depth": 6,
                  "x": 4,
                  "y": 9.75,
                  "z": 1.48,
                  "color": "#8B4513",
                  "name": "leg-right"
                },
                {
                  "type": "box",
                  "width": 6,
                  "height": 15,
                  "depth": 6,
                  "x": -4,
                  "y": 9.75,
                  "z": 1.48,
                  "color": "#8B4513",
                  "name": "leg-left"
                },
                {
                  "type": "box",
                  "width": 7,
                  "height": 3,
                  "depth": 10,
                  "x": 4,
                  "y": 1.75,
                  "z": 3.48,
                  "color": "#3B3B3B",
                  "name": "foot-right"
                },
                {
                  "type": "box",
                  "width": 7,
                  "height": 3,
                  "depth": 10,
                  "x": -4,
                  "y": 1.75,
                  "z": 3.48,
                  "color": "#3B3B3B",
                  "name": "foot-left"
                },
                {
                  "type": "box",
                  "width": 15,
                  "height": 3,
                  "depth": 11,
                  "x": 0,
                  "y": 19.75,
                  "z": 1.48,
                  "color": "#8B4513",
                  "name": "belt"
                },
                {
                  "type": "box",
                  "width": 18,
                  "height": 12,
                  "depth": 3,
                  "x": 0,
                  "y": 40,
                  "z": 4.5,
                  "color": "#FFD700",
                  "name": "beard"
                },
                {
                  "type": "box",
                  "width": 20,
                  "height": 8,
                  "depth": 8,
                  "x": 0,
                  "y": 51,
                  "z": 1.5,
                  "color": "#A0522D",
                  "name": "helmet-top"
                },
                {
                  "type": "box",
                  "width": 22,
                  "height": 4.7,
                  "depth": 14.5,
                  "x": 0,
                  "y": 49.1,
                  "z": 1,
                  "color": "#A9A9A9",
                  "name": "helmet-band"
                },
                {
                  "type": "box",
                  "width": 12,
                  "height": 6,
                  "depth": 2,
                  "x": 0,
                  "y": 45,
                  "z": -5,
                  "color": "#ffd700",
                  "name": "hair"
                },
                {
                  "type": "box",
                  "width": 16,
                  "height": 20,
                  "depth": 2,
                  "x": 0,
                  "y": 28,
                  "z": -6,
                  "color": "#CD853F",
                  "name": "cape"
                },
                {
                  "type": "cylinder",
                  "size": 9,
                  "height": 5,
                  "x": -12,
                  "y": 24,
                  "z": 1.5,
                  "color": "#A9A9A9",
                  "name": "bracelet-right",
                  "rotationZ": 0,
                  "rotationX": 0
                },
                {
                  "type": "cylinder",
                  "size": 9,
                  "height": 5,
                  "x": 12,
                  "y": 24,
                  "z": 1.5,
                  "color": "#A9A9A9",
                  "name": "bracelet-left",
                  "rotationZ": 0,
                  "rotationX": 0
                },
                {
                  "type": "cylinder",
                  "size": 12,
                  "height": 1,
                  "x": -12,
                  "y": 18,
                  "z": 9,
                  "color": "#cd853f",
                  "name": "shield-wood",
                  "rotationZ": 0,
                  "rotationX": 90
                },
                {
                  "type": "cylinder",
                  "size": 16,
                  "height": 2,
                  "x": -12,
                  "y": 18,
                  "z": 8,
                  "color": "#A9A9A9",
                  "name": "shield",
                  "rotationZ": 0,
                  "rotationX": 90
                },
                {
                  "type": "cylinder",
                  "size": 2,
                  "height": 35,
                  "x": 12,
                  "y": 18,
                  "z": 1.48,
                  "color": "#8B4513",
                  "name": "axe-handle",
                  "rotationZ": 0,
                  "rotationX": 90
                },
                {
                  "type": "box",
                  "width": 2,
                  "height": 14,
                  "depth": 12,
                  "x": 12,
                  "y": 18,
                  "z": 15,
                  "color": "#A9A9A9",
                  "name": "axe-head",
                  "rotationY": 0,
                  "rotationZ": 0,
                  "rotationX": 0
                },
                {
                  "type": "cone",
                  "size": 6,
                  "height": 4,
                  "x": 12,
                  "y": 18,
                  "z": 21.5,
                  "rotationX": 90,
                  "color": "#A9A9A9",
                  "name": "axe-spike"
                },
                {
                  "type": "cone",
                  "size": 4,
                  "height": 10,
                  "x": 5,
                  "y": 58,
                  "z": 1.5,
                  "rotationX": 0,
                  "color": "#858585",
                  "name": "helmet-horn-right",
                  "rotationZ": -30
                },
                {
                  "type": "cone",
                  "size": 4,
                  "height": 10,
                  "x": -5,
                  "y": 58,
                  "z": 1.5,
                  "rotationX": 0,
                  "color": "#858585",
                  "name": "helmet-horn-left",
                  "rotationZ": 30
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            }
          }
        },
        "coldResistance": 75,
        "title": "Viking"
      },
      "spike_ball": {
        "hp": 50,
        "speed": 0.5,
        "value": 10,
        "essence": 15,
        "render": {
          "animations": {
            "walk": [
              {},
              {},
              {
                "shapes": {
                  "shapes": [
                    {
                      "y": 26,
                      "id": 0
                    },
                    {
                      "y": 26,
                      "id": 1
                    },
                    {
                      "y": 26,
                      "id": 2
                    },
                    {
                      "y": 26,
                      "id": 3
                    },
                    {
                      "y": 26,
                      "id": 4
                    },
                    {
                      "y": 26,
                      "id": 5
                    },
                    {
                      "y": 26,
                      "id": 6
                    }
                  ]
                }
              },
              {
                "shapes": {
                  "shapes": [
                    {
                      "y": 26,
                      "id": 0
                    },
                    {
                      "y": 26,
                      "id": 1
                    },
                    {
                      "y": 26,
                      "id": 2
                    },
                    {
                      "y": 26,
                      "id": 3
                    },
                    {
                      "y": 26,
                      "id": 4
                    },
                    {
                      "y": 26,
                      "id": 5
                    },
                    {
                      "y": 26,
                      "id": 6
                    }
                  ]
                }
              }
            ],
            "idle": [
              {},
              {},
              {
                "shapes": {
                  "shapes": [
                    {
                      "y": 26,
                      "id": 0
                    },
                    {
                      "y": 26,
                      "id": 1
                    },
                    {
                      "y": 26,
                      "id": 2
                    },
                    {
                      "y": 26,
                      "id": 3
                    },
                    {
                      "y": 26,
                      "id": 4
                    },
                    {
                      "y": 26,
                      "id": 5
                    },
                    {
                      "y": 26,
                      "id": 6
                    }
                  ]
                }
              },
              {
                "shapes": {
                  "shapes": [
                    {
                      "y": 26,
                      "id": 0
                    },
                    {
                      "y": 26,
                      "id": 1
                    },
                    {
                      "y": 26,
                      "id": 2
                    },
                    {
                      "y": 26,
                      "id": 3
                    },
                    {
                      "y": 26,
                      "id": 4
                    },
                    {
                      "y": 26,
                      "id": 5
                    },
                    {
                      "y": 26,
                      "id": 6
                    }
                  ]
                }
              }
            ]
          },
          "model": {
            "shapes": {
              "shapes": [
                {
                  "type": "sphere",
                  "size": 12,
                  "color": "#800000",
                  "x": 0,
                  "y": 24,
                  "z": 0,
                  "rotationX": 0,
                  "rotationY": 0,
                  "rotationZ": 0,
                  "name": "core",
                  "scaleX": 1
                },
                {
                  "type": "cylinder",
                  "size": 2.4,
                  "height": 4.8,
                  "color": "#663300",
                  "x": 0,
                  "y": 24,
                  "z": -12,
                  "rotationX": 90,
                  "rotationY": 0,
                  "rotationZ": 0,
                  "name": "spike-1"
                },
                {
                  "type": "cylinder",
                  "size": 2.4,
                  "height": 4.8,
                  "color": "#663300",
                  "x": 10.392,
                  "y": 24,
                  "z": -6,
                  "rotationX": 90,
                  "rotationY": null,
                  "rotationZ": 60,
                  "name": "spike-2"
                },
                {
                  "type": "cylinder",
                  "size": 2.4,
                  "height": 4.8,
                  "color": "#663300",
                  "x": 10.392,
                  "y": 24,
                  "z": 6,
                  "rotationX": 90,
                  "rotationY": null,
                  "rotationZ": 120,
                  "name": "spike-3"
                },
                {
                  "type": "cylinder",
                  "size": 2.4,
                  "height": 4.8,
                  "color": "#663300",
                  "x": -10.392,
                  "y": 24,
                  "z": -6,
                  "rotationX": -90,
                  "rotationY": null,
                  "rotationZ": 60,
                  "name": "spike-4"
                },
                {
                  "type": "cylinder",
                  "size": 2.4,
                  "height": 4.8,
                  "color": "#663300",
                  "x": -10.392,
                  "y": 24,
                  "z": 6,
                  "rotationX": 90,
                  "rotationY": null,
                  "rotationZ": 240,
                  "name": "spike-5"
                },
                {
                  "type": "cylinder",
                  "size": 2.4,
                  "height": 4.8,
                  "color": "#663300",
                  "x": 0,
                  "y": 24,
                  "z": 12,
                  "rotationX": 90,
                  "rotationY": 300,
                  "rotationZ": 0,
                  "name": "spike-6"
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            }
          }
        },
        "title": "spike_ball",
        "description": "A rolling spike ball monster with spinning spikes",
        "id": "spike_ball"
      }
    },
    "particles": {
      "smoke": {
        "title": "Smoke",
        "render": {
          "animations": {
            "idle": [
              {
                "shapes": {
                  "shapes": [
                    {
                      "type": "sphere",
                      "size": 1,
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "x": 0,
                      "y": 0,
                      "z": 0,
                      "rotationX": 0,
                      "rotationY": 0,
                      "rotationZ": 0,
                      "id": 0
                    }
                  ]
                }
              },
              {
                "shapes": {
                  "shapes": [
                    {
                      "type": "sphere",
                      "size": 1,
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "x": 0,
                      "y": 0,
                      "z": 0,
                      "rotationX": 0,
                      "rotationY": 0,
                      "rotationZ": 0,
                      "id": 0
                    }
                  ],
                  "scale": {
                    "x": 2,
                    "y": 2,
                    "z": 2
                  }
                }
              },
              {
                "shapes": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 0
                    }
                  ],
                  "scale": {
                    "x": 4,
                    "y": 4,
                    "z": 4
                  }
                }
              },
              {
                "shapes": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 0
                    }
                  ],
                  "scale": {
                    "x": 8,
                    "y": 8,
                    "z": 8
                  }
                }
              }
            ]
          },
          "model": {
            "shapes": {
              "shapes": [
                {
                  "type": "sphere",
                  "size": 1,
                  "color": "#000000",
                  "x": 0,
                  "y": 0,
                  "z": 0,
                  "rotationX": 0,
                  "rotationY": 0,
                  "rotationZ": 0
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            }
          }
        },
        "lifeSpan": 0.66
      }
    },
    "projectiles": {
      "lightning": {
        "customRenderer": "lightning",
        "damageType": "electric",
        "speed": 5,
        "title": "Lightning"
      },
      "nanoOrb": {
        "render": {
          "animations": {
            "idle": [
              {}
            ]
          },
          "model": {
            "main": {
              "shapes": [
                {
                  "name": "ball",
                  "type": "sphere",
                  "size": 6,
                  "x": 0,
                  "y": 5,
                  "z": 0,
                  "rotationX": 90,
                  "color": "#ee6060",
                  "rotationY": 0,
                  "rotationZ": 0,
                  "scaleX": 1,
                  "scaleY": 1,
                  "scaleZ": 1
                }
              ],
              "position": {
                "x": -3.00653594771243,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            }
          }
        },
        "speed": 25,
        "damageType": "physical",
        "title": "Nano Orb"
      },
      "plasmaBolt": {
        "damageType": "physical",
        "render": {
          "animations": {
            "idle": [
              {
                "shapes": {
                  "shapes": [
                    {
                      "type": "cube",
                      "size": 6,
                      "x": 0,
                      "y": 24,
                      "z": 0,
                      "rotationX": 90,
                      "color": "#ee6060",
                      "scaleX": 1
                    }
                  ]
                }
              },
              {
                "shapes": {
                  "shapes": [
                    {
                      "type": "sphere",
                      "size": 6,
                      "x": 0,
                      "y": 24,
                      "z": 0,
                      "rotationX": 90,
                      "color": "#ee6060"
                    },
                    {
                      "type": "sphere",
                      "id": 0
                    }
                  ]
                }
              },
              {
                "shapes": {
                  "shapes": [
                    {
                      "type": "cube",
                      "size": 8,
                      "x": 0,
                      "y": 24,
                      "z": 0,
                      "rotationX": 90,
                      "color": "#ee6060"
                    }
                  ]
                }
              },
              {
                "shapes": {
                  "shapes": [
                    {
                      "type": "sphere",
                      "size": 8,
                      "x": 0,
                      "y": 24,
                      "z": 0,
                      "rotationX": 90,
                      "color": "#ee6060"
                    },
                    {
                      "type": "sphere",
                      "id": 0
                    }
                  ]
                }
              }
            ]
          },
          "model": {
            "shapes": {
              "shapes": [
                {
                  "type": "cube",
                  "size": 6,
                  "x": 0,
                  "y": 24,
                  "z": 0,
                  "rotationX": 90,
                  "color": "#ee6060",
                  "scaleX": 1
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            }
          }
        },
        "speed": 50,
        "title": "Plasma Bolt",
        "attackSound": "plasma",
        "hitSound": "plasma"
      },
      "cryoMist": {
        "damageType": "cold",
        "render": {
          "animations": {
            "idle": [
              {
                "shapes": {
                  "shapes": [
                    {
                      "type": "sphere",
                      "size": 6,
                      "x": 0,
                      "y": 25,
                      "z": 0,
                      "rotationX": 90,
                      "scaleX": 1,
                      "id": 0
                    }
                  ]
                }
              },
              {
                "shapes": {
                  "shapes": [
                    {
                      "scaleX": 1.5,
                      "scaleY": 1.5,
                      "scaleZ": 1.5,
                      "id": 0
                    }
                  ]
                }
              }
            ]
          },
          "model": {
            "shapes": {
              "shapes": [
                {
                  "type": "sphere",
                  "size": 6,
                  "x": 0,
                  "y": 25,
                  "z": 0,
                  "rotationX": 90,
                  "color": "#6771e7",
                  "scaleX": 1
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            }
          }
        },
        "speed": 5,
        "title": "Cryomist"
      },
      "neutronFragment": {
        "render": {
          "animations": {
            "idle": [
              {}
            ]
          },
          "model": {
            "shapes": {
              "shapes": [
                {
                  "type": "sphere",
                  "size": 6,
                  "x": 0,
                  "y": 25,
                  "z": 0,
                  "rotationX": 90,
                  "color": "#ee6060",
                  "scaleX": 1
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            }
          }
        },
        "speed": 5,
        "damageType": "physical",
        "title": "Neutron Fragment"
      },
      "missile": {
        "damageType": "fire",
        "render": {
          "animations": {
            "idle": [
              {},
              {
                "shapes": {
                  "rotation": {
                    "x": 0,
                    "y": 0,
                    "z": 0.7884781561950853
                  },
                  "shapes": [
                    {
                      "type": "cylinder",
                      "size": 5,
                      "color": "#888888",
                      "x": 0,
                      "y": 0,
                      "z": -1.4,
                      "rotationX": 90,
                      "rotationY": 0,
                      "rotationZ": 0,
                      "height": 25,
                      "scaleX": 1,
                      "id": 0
                    }
                  ]
                }
              }
            ],
            "ascend": [
              {
                "shapes": {
                  "rotation": {
                    "x": -0.7884781561950848,
                    "y": 0,
                    "z": 0
                  },
                  "shapes": [
                    {
                      "type": "cylinder",
                      "size": 5,
                      "color": "#888888",
                      "x": 0,
                      "y": 0,
                      "z": -1.4,
                      "rotationX": 90,
                      "rotationY": 0,
                      "rotationZ": 0,
                      "height": 25,
                      "scaleX": 1,
                      "id": 0
                    }
                  ]
                }
              },
              {
                "shapes": {
                  "rotation": {
                    "x": -0.788478156195085,
                    "y": 0,
                    "z": -0.7802648420680536
                  },
                  "shapes": [
                    {
                      "type": "cylinder",
                      "size": 5,
                      "color": "#888888",
                      "x": 0,
                      "y": 0,
                      "z": -1.4,
                      "rotationX": 90,
                      "rotationY": 0,
                      "rotationZ": 0,
                      "height": 25,
                      "scaleX": 1,
                      "id": 0
                    }
                  ]
                }
              }
            ],
            "descend": [
              {
                "shapes": {
                  "rotation": {
                    "x": 0.7802648420680531,
                    "y": 0,
                    "z": 0
                  },
                  "shapes": [
                    {
                      "type": "cylinder",
                      "size": 5,
                      "color": "#888888",
                      "x": 0,
                      "y": 0,
                      "z": -1.4,
                      "rotationX": 90,
                      "rotationY": 0,
                      "rotationZ": 0,
                      "height": 25,
                      "scaleX": 1,
                      "id": 0
                    }
                  ]
                }
              },
              {
                "shapes": {
                  "rotation": {
                    "x": 0.7802648420680529,
                    "y": 0,
                    "z": 0.7802648420680495
                  },
                  "shapes": [
                    {
                      "type": "cylinder",
                      "size": 5,
                      "color": "#888888",
                      "x": 0,
                      "y": 0,
                      "z": -1.4,
                      "rotationX": 90,
                      "rotationY": 0,
                      "rotationZ": 0,
                      "height": 25,
                      "scaleX": 1,
                      "id": 0
                    }
                  ]
                }
              }
            ],
            "launch": [
              {
                "shapes": {
                  "rotation": {
                    "x": -1.5769563123901744,
                    "y": 0,
                    "z": 0
                  },
                  "shapes": [
                    {
                      "type": "cylinder",
                      "size": 5,
                      "color": "#888888",
                      "x": 0,
                      "y": 0,
                      "z": -1.4,
                      "rotationX": 90,
                      "rotationY": 0,
                      "rotationZ": 0,
                      "height": 25,
                      "scaleX": 1,
                      "id": 0
                    }
                  ]
                }
              },
              {
                "shapes": {
                  "rotation": {
                    "x": -1.576956312390172,
                    "y": -0.008213314127032096,
                    "z": 0.780264842068052
                  },
                  "shapes": [
                    {
                      "type": "cylinder",
                      "size": 5,
                      "color": "#888888",
                      "x": 0,
                      "y": 0,
                      "z": -1.4,
                      "rotationX": 90,
                      "rotationY": 0,
                      "rotationZ": 0,
                      "height": 25,
                      "scaleX": 1,
                      "id": 0
                    }
                  ]
                }
              }
            ],
            "land": [
              {
                "shapes": {
                  "rotation": {
                    "x": 1.5769563123901817,
                    "y": 0,
                    "z": 0
                  }
                }
              },
              {
                "shapes": {
                  "rotation": {
                    "x": 1.5667186747652215,
                    "y": 0.0061889906291131246,
                    "z": 0.786453832697165
                  },
                  "shapes": [
                    {
                      "type": "cylinder",
                      "size": 5,
                      "color": "#888888",
                      "x": 0,
                      "y": 0,
                      "z": -1.4,
                      "rotationX": 90,
                      "rotationY": 0,
                      "rotationZ": 0,
                      "height": 25,
                      "scaleX": 1,
                      "id": 0
                    }
                  ]
                }
              }
            ]
          },
          "model": {
            "shapes": {
              "shapes": [
                {
                  "type": "cylinder",
                  "size": 5,
                  "color": "#888888",
                  "x": 0,
                  "y": 0,
                  "z": -1.4,
                  "rotationX": 90,
                  "rotationY": 0,
                  "rotationZ": 0,
                  "height": 25,
                  "scaleX": 1
                },
                {
                  "type": "cone",
                  "size": 5,
                  "color": "#ff1117",
                  "x": 0,
                  "y": 0,
                  "z": 13.6,
                  "rotationX": 90,
                  "rotationY": 0,
                  "rotationZ": 0,
                  "height": 5
                },
                {
                  "type": "cone",
                  "size": 2.5,
                  "color": "#ff1117",
                  "x": 0,
                  "y": 0,
                  "z": -13.8,
                  "rotationX": 90,
                  "rotationY": 0,
                  "rotationZ": 0,
                  "height": 2.5
                },
                {
                  "type": "cylinder",
                  "size": 6.25,
                  "color": "#888888",
                  "x": 0,
                  "y": 0,
                  "z": -11,
                  "rotationX": 90,
                  "rotationY": 0,
                  "rotationZ": 0,
                  "height": 5
                },
                {
                  "type": "box",
                  "size": 5,
                  "color": "#888888",
                  "x": 0,
                  "y": 3,
                  "z": -11.631250000000001,
                  "rotationX": 45,
                  "rotationY": 0,
                  "rotationZ": 0,
                  "width": 0.25,
                  "height": 2.5,
                  "depth": 8.5
                },
                {
                  "type": "box",
                  "size": 5,
                  "color": "#888888",
                  "x": 0,
                  "y": -3,
                  "z": -11.631250000000001,
                  "rotationX": -45,
                  "rotationY": 0,
                  "rotationZ": 0,
                  "width": 0.25,
                  "height": 2.5,
                  "depth": 8.5
                },
                {
                  "type": "box",
                  "size": 5,
                  "color": "#888888",
                  "x": -3,
                  "y": 0,
                  "z": -11.631250000000001,
                  "rotationX": 0,
                  "rotationY": 45,
                  "rotationZ": 90,
                  "width": 0.25,
                  "height": 2.5,
                  "depth": 8.5
                },
                {
                  "type": "box",
                  "size": 5,
                  "color": "#888888",
                  "x": 3,
                  "y": 0,
                  "z": -11.631250000000001,
                  "rotationX": 0,
                  "rotationY": -45,
                  "rotationZ": -90,
                  "width": 0.25,
                  "height": 2.5,
                  "depth": 8.5
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            }
          }
        },
        "speed": 1,
        "title": "Missile",
        "isBallistic": true,
        "particle": "smoke",
        "shadows": false,
        "hitSound": "explosion",
        "attackSound": "missileLaunch"
      }
    },
    "towers": {
      "drone": {
        "title": "Drone",
        "info": "Raise the dead.",
        "drawOffsetY": -12,
        "population": 1,
        "range": 2,
        "damage": 5,
        "attackSpeed": 1,
        "projectile": "neutronFragment",
        "critMultiplier": 1,
        "lifeSpan": 5,
        "render": {
          "animations": {
            "idle": [
              {
                "shapes": {
                  "shapes": [
                    {
                      "type": "torus",
                      "size": 9,
                      "tubeSize": 1.5,
                      "x": 0,
                      "y": 33.85714285714286,
                      "z": 0,
                      "rotationX": 90,
                      "color": {
                        "paletteColor": "blueDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "blueDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "blueLColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 3
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 4
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 5
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 6
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 7
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 8
                    },
                    {
                      "color": {
                        "paletteColor": "blueDColor"
                      },
                      "id": 9
                    },
                    {
                      "color": {
                        "paletteColor": "blueDColor"
                      },
                      "id": 10
                    },
                    {
                      "color": {
                        "paletteColor": "blueDColor"
                      },
                      "id": 11
                    },
                    {
                      "color": {
                        "paletteColor": "blueDColor"
                      },
                      "id": 12
                    }
                  ]
                }
              }
            ]
          },
          "model": {
            "shapes": {
              "shapes": [
                {
                  "type": "torus",
                  "size": 9,
                  "tubeSize": 1.5,
                  "x": 0,
                  "y": 33.85714285714286,
                  "z": 0,
                  "rotationX": 90,
                  "color": {
                    "paletteColor": "blueDColor"
                  }
                },
                {
                  "type": "torus",
                  "size": 9,
                  "tubeSize": 1.5,
                  "x": 0,
                  "y": 33.85714285714286,
                  "z": 0,
                  "rotationY": 90,
                  "color": {
                    "paletteColor": "blueDColor"
                  }
                },
                {
                  "type": "sphere",
                  "size": 2.25,
                  "x": 0,
                  "y": 39.85714285714286,
                  "z": 0,
                  "color": {
                    "paletteColor": "blueLColor"
                  }
                },
                {
                  "type": "cylinder",
                  "size": 10,
                  "height": 0.75,
                  "x": 0,
                  "y": 34,
                  "z": 0,
                  "rotationX": 90,
                  "rotationY": 0,
                  "color": {
                    "paletteColor": "greyDColor"
                  }
                },
                {
                  "type": "cylinder",
                  "size": 11,
                  "height": 0.75,
                  "x": 0,
                  "y": 34,
                  "z": 0,
                  "rotationX": 0,
                  "rotationY": 90,
                  "color": {
                    "paletteColor": "greyDColor"
                  },
                  "rotationZ": 0,
                  "scaleX": 1,
                  "scaleY": 1,
                  "scaleZ": 1
                },
                {
                  "type": "cylinder",
                  "size": 3,
                  "height": 0.75,
                  "x": 10.5,
                  "y": 32.35714285714286,
                  "z": 10.5,
                  "color": {
                    "paletteColor": "greyDColor"
                  }
                },
                {
                  "type": "cylinder",
                  "size": 3,
                  "height": 0.75,
                  "x": -10.5,
                  "y": 32.35714285714286,
                  "z": 10.5,
                  "color": {
                    "paletteColor": "greyDColor"
                  }
                },
                {
                  "type": "cylinder",
                  "size": 3,
                  "height": 0.75,
                  "x": 10.5,
                  "y": 32.35714285714286,
                  "z": -10.5,
                  "color": {
                    "paletteColor": "greyDColor"
                  }
                },
                {
                  "type": "cylinder",
                  "size": 3,
                  "height": 0.75,
                  "x": -10.5,
                  "y": 32.35714285714286,
                  "z": -10.5,
                  "color": {
                    "paletteColor": "greyDColor"
                  }
                },
                {
                  "type": "torus",
                  "size": 4.5,
                  "tubeSize": 0.75,
                  "x": 10.5,
                  "y": 33.10714285714286,
                  "z": 10.5,
                  "rotationX": 90,
                  "color": {
                    "paletteColor": "blueDColor"
                  }
                },
                {
                  "type": "torus",
                  "size": 4.5,
                  "tubeSize": 0.75,
                  "x": -10.5,
                  "y": 33.10714285714286,
                  "z": 10.5,
                  "rotationX": 90,
                  "color": {
                    "paletteColor": "blueDColor"
                  }
                },
                {
                  "type": "torus",
                  "size": 4.5,
                  "tubeSize": 0.75,
                  "x": 10.5,
                  "y": 33.10714285714286,
                  "z": -10.5,
                  "rotationX": 90,
                  "color": {
                    "paletteColor": "blueDColor"
                  }
                },
                {
                  "type": "torus",
                  "size": 4.5,
                  "tubeSize": 0.75,
                  "x": -10.5,
                  "y": 33.10714285714286,
                  "z": -10.5,
                  "rotationX": 90,
                  "color": {
                    "paletteColor": "blueDColor"
                  }
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            }
          }
        }
      },
      "fabricator": {
        "title": "Fabricator",
        "info": "Can be upgraded to summon drones from defeated enemies.",
        "summonType": "drone",
        "cost": 200,
        "population": 4,
        "range": 5,
        "damage": 8,
        "attackSpeed": 0.5,
        "projectile": "nanoOrb",
        "piercing": 1,
        "critChance": 0.15,
        "critMultiplier": 1.8,
        "render": {
          "animations": {
            "idle": [
              {
                "shapes": {
                  "shapes": [
                    {
                      "type": "box",
                      "width": 40,
                      "height": 6,
                      "depth": 40,
                      "x": 0,
                      "y": 3,
                      "z": 0,
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "greyMColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "greyMColor"
                      },
                      "id": 3
                    },
                    {
                      "color": {
                        "paletteColor": "blueDColor"
                      },
                      "id": 4
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 5
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 6
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 7
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 8
                    },
                    {
                      "color": {
                        "paletteColor": "blueMColor"
                      },
                      "id": 9
                    },
                    {
                      "color": {
                        "paletteColor": "blueMColor"
                      },
                      "id": 10
                    },
                    {
                      "color": {
                        "paletteColor": "blueMColor"
                      },
                      "id": 11
                    },
                    {
                      "color": {
                        "paletteColor": "blueMColor"
                      },
                      "id": 12
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 13
                    },
                    {
                      "color": {
                        "paletteColor": "blueDColor"
                      },
                      "id": 14
                    },
                    {
                      "color": {
                        "paletteColor": "blueMColor"
                      },
                      "id": 15
                    }
                  ]
                }
              }
            ]
          },
          "model": {
            "shapes": {
              "shapes": [
                {
                  "type": "box",
                  "width": 40,
                  "height": 6,
                  "depth": 40,
                  "x": 0,
                  "y": 3,
                  "z": 0,
                  "color": {
                    "paletteColor": "greyDColor"
                  }
                },
                {
                  "type": "cylinder",
                  "size": 36,
                  "height": 14,
                  "x": 0,
                  "y": 13,
                  "z": 0,
                  "color": {
                    "paletteColor": "greyMColor"
                  }
                },
                {
                  "type": "cylinder",
                  "size": 28,
                  "height": 4,
                  "x": 0,
                  "y": 22,
                  "z": 0,
                  "color": {
                    "paletteColor": "greyDColor"
                  }
                },
                {
                  "type": "cylinder",
                  "size": 24,
                  "height": 16,
                  "x": 0,
                  "y": 32,
                  "z": 0,
                  "color": {
                    "paletteColor": "greyMColor"
                  }
                },
                {
                  "type": "torus",
                  "size": 20,
                  "tubeSize": 2,
                  "x": 0,
                  "y": 42,
                  "z": 0,
                  "color": {
                    "paletteColor": "blueDColor"
                  },
                  "rotationX": 90,
                  "rotationY": 0,
                  "rotationZ": 0,
                  "scaleX": 1,
                  "scaleY": 1,
                  "scaleZ": 1
                },
                {
                  "type": "box",
                  "width": 6,
                  "height": 28,
                  "depth": 6,
                  "x": 16,
                  "y": 20,
                  "z": 16,
                  "color": {
                    "paletteColor": "greyDColor"
                  }
                },
                {
                  "type": "box",
                  "width": 6,
                  "height": 28,
                  "depth": 6,
                  "x": -16,
                  "y": 20,
                  "z": 16,
                  "color": {
                    "paletteColor": "greyDColor"
                  }
                },
                {
                  "type": "box",
                  "width": 6,
                  "height": 28,
                  "depth": 6,
                  "x": 16,
                  "y": 20,
                  "z": -16,
                  "color": {
                    "paletteColor": "greyDColor"
                  }
                },
                {
                  "type": "box",
                  "width": 6,
                  "height": 28,
                  "depth": 6,
                  "x": -16,
                  "y": 20,
                  "z": -16,
                  "color": {
                    "paletteColor": "greyDColor"
                  }
                },
                {
                  "type": "sphere",
                  "size": 4,
                  "x": 16,
                  "y": 38,
                  "z": 16,
                  "color": {
                    "paletteColor": "blueMColor"
                  }
                },
                {
                  "type": "sphere",
                  "size": 4,
                  "x": -16,
                  "y": 38,
                  "z": 16,
                  "color": {
                    "paletteColor": "blueMColor"
                  }
                },
                {
                  "type": "sphere",
                  "size": 4,
                  "x": 16,
                  "y": 38,
                  "z": -16,
                  "color": {
                    "paletteColor": "blueMColor"
                  }
                },
                {
                  "type": "sphere",
                  "size": 4,
                  "x": -16,
                  "y": 38,
                  "z": -16,
                  "color": {
                    "paletteColor": "blueMColor"
                  }
                },
                {
                  "type": "cylinder",
                  "size": 10,
                  "height": 4,
                  "x": 0,
                  "y": 42,
                  "z": 0,
                  "color": {
                    "paletteColor": "greyDColor"
                  }
                },
                {
                  "type": "cylinder",
                  "size": 6,
                  "height": 8,
                  "x": 0,
                  "y": 48,
                  "z": 0,
                  "color": {
                    "paletteColor": "blueDColor"
                  }
                },
                {
                  "type": "torus",
                  "size": 8,
                  "tubeSize": 1,
                  "x": 0,
                  "y": 48,
                  "z": 0,
                  "rotationX": 90,
                  "color": {
                    "paletteColor": "blueMColor"
                  }
                },
                {
                  "type": "sphere",
                  "size": 2,
                  "x": 6,
                  "y": 48,
                  "z": 0,
                  "color": "#FFFFFF"
                },
                {
                  "type": "sphere",
                  "size": 2,
                  "x": -6,
                  "y": 48,
                  "z": 0,
                  "color": "#FFFFFF"
                },
                {
                  "type": "sphere",
                  "size": 2,
                  "x": 0,
                  "y": 48,
                  "z": 6,
                  "color": "#FFFFFF"
                },
                {
                  "type": "sphere",
                  "size": 2,
                  "x": 0,
                  "y": 48,
                  "z": -6,
                  "color": "#FFFFFF"
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            }
          }
        }
      },
      "keep": {
        "title": "Citadel",
        "mineAmt": 1,
        "attackSpeed": 1,
        "render": {
          "animations": {
            "idle": [
              {}
            ]
          },
          "model": {
            "shapes": {
              "shapes": [
                {
                  "type": "sphere",
                  "width": 24,
                  "height": 16,
                  "depth": 24,
                  "color": "#cfd8dc",
                  "x": 0,
                  "y": 32,
                  "z": 0,
                  "size": 24,
                  "name": "dome",
                  "scaleX": 1
                },
                {
                  "type": "cylinder",
                  "size": 12,
                  "height": 22,
                  "color": "#cfd8dc",
                  "x": 0,
                  "y": 42,
                  "z": 0,
                  "name": "spire"
                },
                {
                  "type": "cone",
                  "size": 14,
                  "height": 20,
                  "color": "#ab47bc",
                  "x": 0,
                  "y": 62,
                  "z": 0,
                  "name": "spire roof"
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 0.7,
                "z": 1
              }
            },
            "base": {
              "shapes": [
                {
                  "type": "box",
                  "width": 40,
                  "height": 12,
                  "depth": 40,
                  "color": "#3e4f57",
                  "x": 0,
                  "y": 6,
                  "z": 0,
                  "scaleX": 1,
                  "name": "base"
                },
                {
                  "type": "box",
                  "width": 44,
                  "height": 4,
                  "depth": 44,
                  "color": "#3e4f57",
                  "x": 0,
                  "y": 2,
                  "z": 0,
                  "name": "foundation"
                },
                {
                  "type": "box",
                  "width": 32,
                  "height": 12,
                  "depth": 32,
                  "color": "#78909c",
                  "x": 0,
                  "y": 17,
                  "z": 0,
                  "name": "main structure"
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            },
            "towers": {
              "shapes": [
                {
                  "type": "cylinder",
                  "size": 6,
                  "height": 30,
                  "color": "#cfd8dc",
                  "x": 16,
                  "y": 22,
                  "z": 16,
                  "name": "tower1"
                },
                {
                  "type": "cylinder",
                  "size": 6,
                  "height": 30,
                  "color": "#cfd8dc",
                  "x": -16,
                  "y": 22,
                  "z": 16,
                  "name": "tower2"
                },
                {
                  "type": "cylinder",
                  "size": 6,
                  "height": 30,
                  "color": "#cfd8dc",
                  "x": 16,
                  "y": 22,
                  "z": -16,
                  "name": "tower3"
                },
                {
                  "type": "cylinder",
                  "size": 6,
                  "height": 30,
                  "color": "#cfd8dc",
                  "x": -16,
                  "y": 22,
                  "z": -16,
                  "name": "tower4"
                },
                {
                  "type": "cone",
                  "size": 8,
                  "height": 10,
                  "color": "#0288d1",
                  "x": 16,
                  "y": 42,
                  "z": 16,
                  "name": "tower1roof"
                },
                {
                  "type": "cone",
                  "size": 8,
                  "height": 10,
                  "color": "#0288d1",
                  "x": -16,
                  "y": 42,
                  "z": 16,
                  "name": "tower2roof"
                },
                {
                  "type": "cone",
                  "size": 8,
                  "height": 10,
                  "color": "#0288d1",
                  "x": 16,
                  "y": 42,
                  "z": -16,
                  "name": "tower3roof"
                },
                {
                  "type": "cone",
                  "size": 8,
                  "height": 10,
                  "color": "#0288d1",
                  "x": -16,
                  "y": 42,
                  "z": -16,
                  "name": "tower4roof"
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 0.7,
                "z": 1
              }
            }
          }
        }
      },
      "fusionCore": {
        "title": "Fusion Core",
        "info": "Creates additional energy every second.",
        "cost": 50,
        "population": 1,
        "attackSpeed": 1,
        "critMultiplier": 1,
        "mineAmt": 1,
        "render": {
          "animations": {
            "idle": [
              {
                "energy": {
                  "shapes": [
                    {
                      "rotationX": 0,
                      "id": 1,
                      "rotationZ": 45
                    },
                    {
                      "rotationX": 90,
                      "id": 2,
                      "rotationZ": 0
                    }
                  ]
                }
              },
              {
                "shapes": [],
                "energy": {
                  "shapes": [
                    {
                      "rotationX": 90,
                      "id": 2,
                      "rotationY": -45
                    }
                  ]
                }
              },
              {
                "energy": {
                  "shapes": [
                    {
                      "rotationX": 90,
                      "id": 1
                    },
                    {
                      "id": 2,
                      "rotationY": -90
                    }
                  ]
                }
              },
              {
                "shapes": [],
                "energy": {
                  "shapes": [
                    {
                      "id": 1,
                      "rotationX": 135
                    },
                    {
                      "rotationX": -90,
                      "id": 2,
                      "rotationY": 135
                    }
                  ]
                }
              }
            ]
          },
          "model": {
            "main": {
              "shapes": [
                {
                  "type": "cylinder",
                  "size": 24,
                  "height": 8,
                  "color": "#3e4f57",
                  "x": 0,
                  "y": 0,
                  "z": 0,
                  "scaleX": 1,
                  "name": "Foundation"
                },
                {
                  "type": "cylinder",
                  "size": 20,
                  "height": 12,
                  "color": "#78909c",
                  "x": 0,
                  "y": 10,
                  "z": 0,
                  "name": "main structure"
                },
                {
                  "type": "box",
                  "width": 8,
                  "height": 4,
                  "depth": 8,
                  "color": "#3e4f57",
                  "x": 16,
                  "y": 2,
                  "z": 0,
                  "name": "module1"
                },
                {
                  "type": "box",
                  "width": 8,
                  "height": 4,
                  "depth": 8,
                  "color": "#3e4f57",
                  "x": -16,
                  "y": 2,
                  "z": 0,
                  "name": "module2"
                },
                {
                  "type": "box",
                  "width": 8,
                  "height": 4,
                  "depth": 8,
                  "color": "#3e4f57",
                  "x": 0,
                  "y": 2,
                  "z": 16,
                  "name": "module3"
                },
                {
                  "type": "box",
                  "width": 8,
                  "height": 4,
                  "depth": 8,
                  "color": "#3e4f57",
                  "x": 0,
                  "y": 2,
                  "z": -16,
                  "name": "module4"
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            },
            "pillar1": {
              "shapes": [
                {
                  "type": "cylinder",
                  "size": 4,
                  "height": 10,
                  "color": "#3e4f57",
                  "x": 12,
                  "y": 6,
                  "z": 12,
                  "name": "pillar1"
                },
                {
                  "type": "sphere",
                  "size": 3,
                  "color": "#4fc3f7",
                  "x": 12,
                  "y": 12,
                  "z": 12,
                  "name": "pillar1sphere"
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            },
            "pillar2": {
              "shapes": [
                {
                  "type": "cylinder",
                  "size": 4,
                  "height": 10,
                  "color": "#3e4f57",
                  "x": -12,
                  "y": 6,
                  "z": 12,
                  "name": "pillar2"
                },
                {
                  "type": "sphere",
                  "size": 3,
                  "color": "#4fc3f7",
                  "x": -12,
                  "y": 12,
                  "z": 12,
                  "name": "pillar2sphere"
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            },
            "pillar3": {
              "shapes": [
                {
                  "type": "cylinder",
                  "size": 4,
                  "height": 10,
                  "color": "#3e4f57",
                  "x": 12,
                  "y": 6,
                  "z": -12,
                  "name": "pillar3"
                },
                {
                  "type": "sphere",
                  "size": 3,
                  "color": "#4fc3f7",
                  "x": 12,
                  "y": 12,
                  "z": -12,
                  "name": "pillar3sphere"
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            },
            "pillar4": {
              "shapes": [
                {
                  "type": "cylinder",
                  "size": 4,
                  "height": 10,
                  "color": "#3e4f57",
                  "x": -12,
                  "y": 6,
                  "z": -12,
                  "name": "pillar4"
                },
                {
                  "type": "sphere",
                  "size": 3,
                  "color": "#4fc3f7",
                  "x": -12,
                  "y": 12,
                  "z": -12,
                  "name": "pillar4sphere"
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            },
            "energy": {
              "shapes": [
                {
                  "type": "sphere",
                  "size": 14,
                  "color": "#6a1b9a",
                  "x": 0,
                  "y": 30,
                  "z": 0,
                  "name": "energy sphere"
                },
                {
                  "type": "torus",
                  "size": 22,
                  "tubeSize": 2,
                  "color": "#0288d1",
                  "x": 0,
                  "y": 30,
                  "z": 0,
                  "rotationX": 45,
                  "name": "rotating thing 1"
                },
                {
                  "type": "torus",
                  "size": 22,
                  "tubeSize": 2,
                  "color": "#0288d1",
                  "x": 0,
                  "y": 30,
                  "z": 0,
                  "rotationX": -45,
                  "rotationZ": 45,
                  "name": "rotating thing 2"
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            }
          }
        }
      },
      "sentry": {
        "title": "Photon Sentry",
        "info": "Defensive attack sentry.",
        "cost": 25,
        "population": 1,
        "range": 4,
        "damage": 5,
        "attackSpeed": 0.5,
        "projectile": "plasmaBolt",
        "critChance": 0.05,
        "critMultiplier": 1.5,
        "render": {
          "animations": {
            "idle": [
              {}
            ]
          },
          "model": {
            "shapes": {
              "shapes": [
                {
                  "type": "cylinder",
                  "size": 20,
                  "height": 4,
                  "color": "#78909c",
                  "x": 0,
                  "y": 2,
                  "z": 0,
                  "name": "base",
                  "rotationX": 0,
                  "rotationY": 0,
                  "rotationZ": 0,
                  "scaleX": 1,
                  "scaleY": 1,
                  "scaleZ": 1
                },
                {
                  "type": "cylinder",
                  "size": 14,
                  "height": 26,
                  "color": "#78909c",
                  "x": 0,
                  "y": 17,
                  "z": 0,
                  "name": "body"
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            },
            "rampart": {
              "shapes": [
                {
                  "type": "cylinder",
                  "size": 12,
                  "height": 8,
                  "color": "#3e4f57",
                  "x": 0,
                  "y": 30,
                  "z": 0,
                  "name": "rampartbase"
                },
                {
                  "type": "box",
                  "width": 3,
                  "height": 5,
                  "depth": 3,
                  "color": "#3e4f57",
                  "x": 4,
                  "y": 34,
                  "z": 4,
                  "name": "rampartblock1"
                },
                {
                  "type": "box",
                  "width": 3,
                  "height": 5,
                  "depth": 3,
                  "color": "#3e4f57",
                  "x": -4,
                  "y": 34,
                  "z": 4,
                  "name": "rampartblock2"
                },
                {
                  "type": "box",
                  "width": 3,
                  "height": 5,
                  "depth": 3,
                  "color": "#3e4f57",
                  "x": 4,
                  "y": 34,
                  "z": -4,
                  "name": "rampartblock3"
                },
                {
                  "type": "box",
                  "width": 3,
                  "height": 5,
                  "depth": 3,
                  "color": "#3e4f57",
                  "x": -4,
                  "y": 34,
                  "z": -4,
                  "name": "rampartblock4"
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1.5,
                "y": 1,
                "z": 1.5
              }
            },
            "attacker": {
              "shapes": [
                {
                  "type": "cylinder",
                  "size": 5.7,
                  "height": 14,
                  "color": "#cfd8dc",
                  "x": 0,
                  "y": 39.6,
                  "z": 0,
                  "name": "attackerbody"
                },
                {
                  "type": "sphere",
                  "size": 6,
                  "color": "#ff8c00",
                  "x": 0,
                  "y": 48.89655172413794,
                  "z": 0,
                  "name": "attacker head",
                  "rotationX": 0,
                  "rotationY": 0,
                  "rotationZ": 0,
                  "scaleX": 1,
                  "scaleY": 1,
                  "scaleZ": 1
                },
                {
                  "type": "cylinder",
                  "size": 2,
                  "height": 12,
                  "color": "#cfd8dc",
                  "x": 0,
                  "y": 42,
                  "z": 0,
                  "rotationX": 90,
                  "name": "attacker arms"
                },
                {
                  "type": "sphere",
                  "size": 3,
                  "color": "#bf360c",
                  "x": 0,
                  "y": 42,
                  "z": 6,
                  "name": "attacker weapon"
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            }
          }
        },
        "projectileCount": 0,
        "projectileAngle": 10
      },
      "chrono": {
        "title": "Chrono Defibrilator",
        "info": "Projectiles explode in AoE and slow.",
        "cost": 100,
        "population": 3,
        "range": 90,
        "damage": 2,
        "attackSpeed": 0.5,
        "projectile": "cryoMist",
        "critMultiplier": 1,
        "splashRadius": 2,
        "slowAmount": 0.7,
        "render": {
          "animations": {
            "idle": [
              {
                "shapes": {
                  "shapes": [
                    {
                      "type": "torus",
                      "size": 36,
                      "tubeSize": 4,
                      "x": 0,
                      "y": 8,
                      "z": 0,
                      "rotationY": 0,
                      "color": {
                        "paletteColor": "blueDColor"
                      },
                      "rotationZ": 0,
                      "rotationX": 90,
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "greyMColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "greyMColor"
                      },
                      "id": 5
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 6
                    },
                    {
                      "color": {
                        "paletteColor": "blueMColor"
                      },
                      "id": 7
                    },
                    {
                      "color": {
                        "paletteColor": "blueMColor"
                      },
                      "id": 8
                    },
                    {
                      "color": {
                        "paletteColor": "blueMColor"
                      },
                      "id": 9
                    },
                    {
                      "color": {
                        "paletteColor": "blueMColor"
                      },
                      "id": 10
                    },
                    {
                      "color": {
                        "paletteColor": "blueDColor"
                      },
                      "id": 11
                    }
                  ]
                }
              }
            ]
          },
          "model": {
            "shapes": {
              "shapes": [
                {
                  "type": "torus",
                  "size": 36,
                  "tubeSize": 4,
                  "x": 0,
                  "y": 8,
                  "z": 0,
                  "rotationY": 0,
                  "color": {
                    "paletteColor": "blueDColor"
                  },
                  "rotationZ": 0,
                  "rotationX": 90
                },
                {
                  "type": "cylinder",
                  "size": 22,
                  "height": 10,
                  "x": 0,
                  "y": 5,
                  "z": 0,
                  "color": {
                    "paletteColor": "greyMColor"
                  }
                },
                {
                  "type": "cylinder",
                  "size": 16,
                  "height": 14,
                  "x": 0,
                  "y": 17,
                  "z": 0,
                  "color": {
                    "paletteColor": "greyDColor"
                  }
                },
                {
                  "type": "sphere",
                  "size": 12,
                  "x": 0,
                  "y": 16,
                  "z": 0,
                  "color": "#A0E6FF"
                },
                {
                  "type": "tetrahedron",
                  "size": 10,
                  "x": 0,
                  "y": 16,
                  "z": 0,
                  "rotationY": 45,
                  "color": "#203040"
                },
                {
                  "type": "cone",
                  "size": 8,
                  "height": 16,
                  "x": 0,
                  "y": 32,
                  "z": 0,
                  "rotationX": 0,
                  "color": {
                    "paletteColor": "greyMColor"
                  }
                },
                {
                  "type": "box",
                  "width": 38,
                  "height": 4,
                  "depth": 38,
                  "x": 0,
                  "y": 2,
                  "z": 0,
                  "color": {
                    "paletteColor": "greyDColor"
                  }
                },
                {
                  "type": "sphere",
                  "size": 4,
                  "x": 24,
                  "y": 24,
                  "z": 24,
                  "color": {
                    "paletteColor": "blueMColor"
                  }
                },
                {
                  "type": "sphere",
                  "size": 4,
                  "x": -24,
                  "y": 24,
                  "z": 24,
                  "color": {
                    "paletteColor": "blueMColor"
                  }
                },
                {
                  "type": "sphere",
                  "size": 4,
                  "x": 24,
                  "y": 24,
                  "z": -24,
                  "color": {
                    "paletteColor": "blueMColor"
                  }
                },
                {
                  "type": "sphere",
                  "size": 4,
                  "x": -24,
                  "y": 24,
                  "z": -24,
                  "color": {
                    "paletteColor": "blueMColor"
                  }
                },
                {
                  "type": "torus",
                  "size": 48,
                  "color": {
                    "paletteColor": "blueDColor"
                  },
                  "x": 0,
                  "y": 38,
                  "z": 0,
                  "rotationX": 90,
                  "rotationY": 0,
                  "rotationZ": 0,
                  "tubeSize": 2
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            }
          }
        }
      },
      "missileLauncher": {
        "title": "Missile Launcher",
        "info": "Projectiles explode in an AoE.",
        "cost": 90,
        "population": 3,
        "range": 15,
        "damage": 100,
        "attackSpeed": 3,
        "projectile": "missile",
        "critChance": 0.05,
        "critMultiplier": 2,
        "splashRadius": 3,
        "burnDamage": 2,
        "render": {
          "animations": {
            "idle": [
              {
                "shapes": {
                  "shapes": [
                    {
                      "type": "box",
                      "width": 30,
                      "height": 6,
                      "depth": 30,
                      "x": 0,
                      "y": 3,
                      "z": 1.8,
                      "color": {
                        "paletteColor": "greyMColor"
                      },
                      "name": "base",
                      "scaleX": 1,
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 3
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 4
                    },
                    {
                      "color": {
                        "paletteColor": "greyMColor"
                      },
                      "id": 5
                    },
                    {
                      "color": {
                        "paletteColor": "greyMColor"
                      },
                      "id": 6
                    },
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 7
                    },
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 8
                    }
                  ]
                }
              }
            ]
          },
          "model": {
            "shapes": {
              "shapes": [
                {
                  "type": "box",
                  "width": 30,
                  "height": 6,
                  "depth": 30,
                  "x": 0,
                  "y": 3,
                  "z": 1.8,
                  "color": {
                    "paletteColor": "greyMColor"
                  },
                  "name": "base",
                  "scaleX": 1
                },
                {
                  "type": "cylinder",
                  "size": 24,
                  "height": 7.5,
                  "x": 0,
                  "y": 10,
                  "z": 1.8,
                  "color": {
                    "paletteColor": "greyDColor"
                  },
                  "name": "body"
                },
                {
                  "type": "box",
                  "width": 18,
                  "height": 10.5,
                  "depth": 22.5,
                  "x": 0,
                  "y": 19.5,
                  "z": 1.8,
                  "color": {
                    "paletteColor": "greyDColor"
                  },
                  "rotationX": 15,
                  "name": "missile-box"
                },
                {
                  "type": "cylinder",
                  "size": 6,
                  "height": 27,
                  "x": -6,
                  "y": 24,
                  "z": 3.3,
                  "rotationX": 105,
                  "color": {
                    "paletteColor": "greyDColor"
                  },
                  "name": "left missile container"
                },
                {
                  "type": "cylinder",
                  "size": 6,
                  "height": 27,
                  "x": 6,
                  "y": 24,
                  "z": 3.3,
                  "rotationX": 105,
                  "color": {
                    "paletteColor": "greyDColor"
                  },
                  "name": "right missile container"
                },
                {
                  "type": "cylinder",
                  "size": 4.5,
                  "height": 4,
                  "x": -6,
                  "y": 28.2,
                  "z": -11.5,
                  "rotationX": 105,
                  "color": {
                    "paletteColor": "greyMColor"
                  },
                  "rotationZ": 0,
                  "name": "left missile",
                  "rotationY": 0,
                  "scaleX": 1,
                  "scaleY": 1,
                  "scaleZ": 1
                },
                {
                  "type": "cylinder",
                  "size": 4.5,
                  "height": 4,
                  "x": 6,
                  "y": 28.2,
                  "z": -11.5,
                  "rotationX": 105,
                  "color": {
                    "paletteColor": "greyMColor"
                  },
                  "name": "right missile"
                },
                {
                  "type": "cone",
                  "size": 4.35,
                  "height": 6,
                  "x": -6,
                  "y": 29.4,
                  "z": -16.2,
                  "rotationX": -75,
                  "color": {
                    "paletteColor": "redDColor"
                  },
                  "name": "left missile tip"
                },
                {
                  "type": "cone",
                  "size": 4.35,
                  "height": 6,
                  "x": 6,
                  "y": 29.4,
                  "z": -16.2,
                  "rotationX": -75,
                  "color": {
                    "paletteColor": "redDColor"
                  },
                  "name": "right missile tip"
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            }
          }
        }
      },
      "guardTower": {
        "id": "guardTower",
        "title": "Guard Tower",
        "info": "A robust defensive structure that deals consistent damage while slowing enemies within a radius.",
        "cost": 70,
        "population": 3,
        "range": 4,
        "damage": 8,
        "attackSpeed": 4,
        "projectile": "plasmaBolt",
        "critChance": 0.05,
        "critMultiplier": 2,
        "splashRadius": 2,
        "render": {
          "animations": {
            "idle": [
              {
                "shapes": {
                  "shapes": [
                    {
                      "points": [
                        {
                          "x": -1,
                          "y": 4
                        },
                        {
                          "x": 1,
                          "y": 4
                        }
                      ],
                      "id": 5
                    }
                  ]
                }
              }
            ]
          },
          "model": {
            "shapes": {
              "shapes": [
                {
                  "type": "box",
                  "width": 15,
                  "height": 30,
                  "color": {
                    "paletteColor": "greyMColor"
                  },
                  "x": 2.25,
                  "y": 6.75,
                  "z": 0
                },
                {
                  "type": "box",
                  "x": 0.2,
                  "y": 21.75,
                  "width": 10,
                  "height": 15,
                  "color": {
                    "paletteColor": "redMColor"
                  },
                  "z": 0,
                  "scaleX": 1
                },
                {
                  "type": "box",
                  "x": -5.25,
                  "y": 36.75,
                  "width": 25,
                  "height": 5,
                  "color": {
                    "paletteColor": "greyDColor"
                  },
                  "z": 0
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            }
          }
        }
      },
      "barracks": {
        "title": "Barracks",
        "info": "Provides 5 additional max population.",
        "cost": 100,
        "attackSpeed": 1000,
        "critChance": 0.1,
        "critMultiplier": 2,
        "supply": 5,
        "render": {
          "animations": {
            "idle": [
              {
                "shapes": {
                  "shapes": [
                    {
                      "type": "box",
                      "width": 40,
                      "height": 4,
                      "depth": 40,
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "x": 0,
                      "y": 2,
                      "z": 0,
                      "scaleX": 1,
                      "name": "foundation",
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "greyMColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "blueDColor"
                      },
                      "id": 3
                    },
                    {
                      "color": {
                        "paletteColor": "blueMColor"
                      },
                      "id": 4
                    },
                    {
                      "color": {
                        "paletteColor": "blueMColor"
                      },
                      "id": 5
                    },
                    {
                      "color": {
                        "paletteColor": "blueMColor"
                      },
                      "id": 6
                    },
                    {
                      "color": {
                        "paletteColor": "blueDColor"
                      },
                      "id": 7
                    },
                    {
                      "color": {
                        "paletteColor": "blueMColor"
                      },
                      "id": 8
                    },
                    {
                      "color": {
                        "paletteColor": "blueMColor"
                      },
                      "id": 9
                    },
                    {
                      "color": {
                        "paletteColor": "blueMColor"
                      },
                      "id": 10
                    },
                    {
                      "color": {
                        "paletteColor": "greyMColor"
                      },
                      "id": 11
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 12
                    },
                    {
                      "color": {
                        "paletteColor": "blueDColor"
                      },
                      "id": 13
                    },
                    {
                      "color": {
                        "paletteColor": "blueMColor"
                      },
                      "id": 14
                    },
                    {
                      "color": {
                        "paletteColor": "greyMColor"
                      },
                      "id": 15
                    },
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 16
                    },
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 17
                    },
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 18
                    },
                    {
                      "color": {
                        "paletteColor": "redDColor"
                      },
                      "id": 19
                    }
                  ]
                }
              }
            ]
          },
          "model": {
            "shapes": {
              "shapes": [
                {
                  "type": "box",
                  "width": 40,
                  "height": 4,
                  "depth": 40,
                  "color": {
                    "paletteColor": "greyDColor"
                  },
                  "x": 0,
                  "y": 2,
                  "z": 0,
                  "scaleX": 1,
                  "name": "foundation"
                },
                {
                  "type": "box",
                  "width": 36,
                  "height": 12,
                  "depth": 36,
                  "color": {
                    "paletteColor": "greyMColor"
                  },
                  "x": 0,
                  "y": 10,
                  "z": 0,
                  "name": "structure"
                },
                {
                  "type": "box",
                  "width": 40,
                  "height": 2,
                  "depth": 40,
                  "color": {
                    "paletteColor": "greyDColor"
                  },
                  "x": 0,
                  "y": 17,
                  "z": 0,
                  "name": "roof"
                },
                {
                  "type": "cylinder",
                  "size": 12,
                  "height": 12,
                  "color": {
                    "paletteColor": "blueDColor"
                  },
                  "x": -16,
                  "y": 24,
                  "z": 0,
                  "name": "terminal1"
                },
                {
                  "type": "torus",
                  "size": 12,
                  "tubeSize": 1,
                  "color": {
                    "paletteColor": "blueMColor"
                  },
                  "x": -16,
                  "y": 24,
                  "z": 0,
                  "rotationX": 90,
                  "name": "terminal1coil2"
                },
                {
                  "type": "torus",
                  "size": 12,
                  "tubeSize": 1,
                  "color": {
                    "paletteColor": "blueMColor"
                  },
                  "x": -16,
                  "y": 28,
                  "z": 0,
                  "rotationX": 90,
                  "name": "terminal1coil3"
                },
                {
                  "type": "torus",
                  "size": 12,
                  "tubeSize": 1,
                  "color": {
                    "paletteColor": "blueMColor"
                  },
                  "x": -16,
                  "y": 20,
                  "z": 0,
                  "rotationX": 90,
                  "name": "terminal1coil1"
                },
                {
                  "type": "cylinder",
                  "size": 12,
                  "height": 12,
                  "color": {
                    "paletteColor": "blueDColor"
                  },
                  "x": 16,
                  "y": 24,
                  "z": 0
                },
                {
                  "type": "torus",
                  "size": 12,
                  "tubeSize": 1,
                  "color": {
                    "paletteColor": "blueMColor"
                  },
                  "x": 16,
                  "y": 24,
                  "z": 0,
                  "rotationX": 90,
                  "name": "terminal2coil2"
                },
                {
                  "type": "torus",
                  "size": 12,
                  "tubeSize": 1,
                  "color": {
                    "paletteColor": "blueMColor"
                  },
                  "x": 16,
                  "y": 28,
                  "z": 0,
                  "rotationX": 90,
                  "name": "terminal2coil3"
                },
                {
                  "type": "torus",
                  "size": 12,
                  "tubeSize": 1,
                  "color": {
                    "paletteColor": "blueMColor"
                  },
                  "x": 16,
                  "y": 20,
                  "z": 0,
                  "rotationX": 90,
                  "name": "terminal2coil1"
                },
                {
                  "type": "cylinder",
                  "size": 16,
                  "height": 6,
                  "color": {
                    "paletteColor": "greyMColor"
                  },
                  "x": 0,
                  "y": 20,
                  "z": 0,
                  "name": "center1"
                },
                {
                  "type": "cylinder",
                  "size": 14,
                  "height": 2,
                  "color": {
                    "paletteColor": "greyDColor"
                  },
                  "x": 0,
                  "y": 24,
                  "z": 0,
                  "name": "center2"
                },
                {
                  "type": "cylinder",
                  "size": 12,
                  "height": 2,
                  "color": {
                    "paletteColor": "blueDColor"
                  },
                  "x": 0,
                  "y": 26,
                  "z": 0,
                  "name": "centerterminal"
                },
                {
                  "type": "sphere",
                  "size": 3,
                  "color": {
                    "paletteColor": "blueMColor"
                  },
                  "x": 0,
                  "y": 28,
                  "z": 0,
                  "name": "centersphere"
                },
                {
                  "type": "box",
                  "width": 40,
                  "height": 1,
                  "depth": 24,
                  "color": {
                    "paletteColor": "greyMColor"
                  },
                  "x": 0,
                  "y": 18.5,
                  "z": 0
                },
                {
                  "type": "cylinder",
                  "size": 2,
                  "height": 4,
                  "color": {
                    "paletteColor": "redDColor"
                  },
                  "x": -18,
                  "y": 20.5,
                  "z": -8,
                  "name": "redthing1"
                },
                {
                  "type": "cylinder",
                  "size": 2,
                  "height": 4,
                  "color": {
                    "paletteColor": "redDColor"
                  },
                  "x": 18,
                  "y": 20.5,
                  "z": -8,
                  "name": "redthing2"
                },
                {
                  "type": "cylinder",
                  "size": 2,
                  "height": 4,
                  "color": {
                    "paletteColor": "redDColor"
                  },
                  "x": -18,
                  "y": 20.5,
                  "z": 8,
                  "name": "redthing3"
                },
                {
                  "type": "cylinder",
                  "size": 2,
                  "height": 4,
                  "color": {
                    "paletteColor": "redDColor"
                  },
                  "x": 18,
                  "y": 20.5,
                  "z": 8,
                  "name": "redthing4"
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            }
          }
        }
      },
      "teslaCoil": {
        "title": "Tesla Coil",
        "info": "Projectiles chain between enemies.",
        "projectileStartOffsetY": 24,
        "cost": 70,
        "population": 3,
        "range": 5,
        "damage": 10,
        "attackSpeed": 0.5,
        "projectile": "lightning",
        "piercing": 2,
        "critChance": 0.1,
        "critMultiplier": 1.7,
        "render": {
          "animations": {
            "idle": [
              {
                "shapes": {
                  "shapes": [
                    {
                      "type": "cylinder",
                      "size": 16,
                      "height": 4,
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "x": 0,
                      "y": 2,
                      "z": 0,
                      "id": 0
                    },
                    {
                      "color": {
                        "paletteColor": "greyMColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "greyDColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "greyMColor"
                      },
                      "id": 3
                    },
                    {
                      "color": {
                        "paletteColor": "blueMColor"
                      },
                      "id": 4
                    },
                    {
                      "color": {
                        "paletteColor": "blueLColor"
                      },
                      "id": 5
                    },
                    {
                      "color": {
                        "paletteColor": "blueMColor"
                      },
                      "id": 6
                    },
                    {
                      "color": {
                        "paletteColor": "blueDColor"
                      },
                      "id": 7
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 8
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 9
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 10
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 11
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 12
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 13
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 14
                    },
                    {
                      "color": {
                        "paletteColor": "greyLColor"
                      },
                      "id": 15
                    }
                  ]
                }
              }
            ]
          },
          "model": {
            "shapes": {
              "shapes": [
                {
                  "type": "cylinder",
                  "size": 16,
                  "height": 4,
                  "color": {
                    "paletteColor": "greyDColor"
                  },
                  "x": 0,
                  "y": 2,
                  "z": 0
                },
                {
                  "type": "cylinder",
                  "size": 12,
                  "height": 8,
                  "color": {
                    "paletteColor": "greyMColor"
                  },
                  "x": 0,
                  "y": 8,
                  "z": 0
                },
                {
                  "type": "cylinder",
                  "size": 10,
                  "height": 20,
                  "color": {
                    "paletteColor": "greyDColor"
                  },
                  "x": 0,
                  "y": 22,
                  "z": 0
                },
                {
                  "type": "cylinder",
                  "size": 12,
                  "height": 3,
                  "color": {
                    "paletteColor": "greyMColor"
                  },
                  "x": 0,
                  "y": 33.5,
                  "z": 0
                },
                {
                  "type": "sphere",
                  "size": 14,
                  "color": {
                    "paletteColor": "blueMColor"
                  },
                  "x": 0,
                  "y": 42,
                  "z": 0
                },
                {
                  "type": "torus",
                  "size": 20,
                  "tubeSize": 1.6,
                  "color": {
                    "paletteColor": "blueLColor"
                  },
                  "x": 0,
                  "y": 18,
                  "z": 0,
                  "rotationX": 90
                },
                {
                  "type": "torus",
                  "size": 18,
                  "tubeSize": 1.6,
                  "color": {
                    "paletteColor": "blueMColor"
                  },
                  "x": 0,
                  "y": 24,
                  "z": 0,
                  "rotationX": 90
                },
                {
                  "type": "torus",
                  "size": 16,
                  "tubeSize": 1.6,
                  "color": {
                    "paletteColor": "blueDColor"
                  },
                  "x": 0,
                  "y": 30,
                  "z": 0,
                  "rotationX": 90
                },
                {
                  "type": "cone",
                  "size": 6,
                  "height": 16,
                  "color": {
                    "paletteColor": "greyLColor"
                  },
                  "x": 7,
                  "y": 34,
                  "z": 0,
                  "rotationZ": -90
                },
                {
                  "type": "cone",
                  "size": 6,
                  "height": 16,
                  "color": {
                    "paletteColor": "greyLColor"
                  },
                  "x": -7,
                  "y": 34,
                  "z": 0,
                  "rotationZ": 90
                },
                {
                  "type": "cone",
                  "size": 6,
                  "height": 16,
                  "color": {
                    "paletteColor": "greyLColor"
                  },
                  "x": 0,
                  "y": 34,
                  "z": 7,
                  "rotationX": 90
                },
                {
                  "type": "cone",
                  "size": 6,
                  "height": 16,
                  "color": {
                    "paletteColor": "greyLColor"
                  },
                  "x": 0,
                  "y": 34,
                  "z": -7,
                  "rotationX": -90
                },
                {
                  "type": "box",
                  "width": 3,
                  "height": 14,
                  "depth": 3,
                  "color": {
                    "paletteColor": "greyLColor"
                  },
                  "x": 6,
                  "y": 16,
                  "z": 6,
                  "rotationY": 45
                },
                {
                  "type": "box",
                  "width": 3,
                  "height": 14,
                  "depth": 3,
                  "color": {
                    "paletteColor": "greyLColor"
                  },
                  "x": -6,
                  "y": 16,
                  "z": 6,
                  "rotationY": -45
                },
                {
                  "type": "box",
                  "width": 3,
                  "height": 14,
                  "depth": 3,
                  "color": {
                    "paletteColor": "greyLColor"
                  },
                  "x": 6,
                  "y": 16,
                  "z": -6,
                  "rotationY": -45
                },
                {
                  "type": "box",
                  "width": 3,
                  "height": 14,
                  "depth": 3,
                  "color": {
                    "paletteColor": "greyLColor"
                  },
                  "x": -6,
                  "y": 16,
                  "z": -6,
                  "rotationY": 45
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            }
          }
        }
      },
      "laserTurret": {
        "title": "Laser Turret",
        "info": "Fires focused laser beams dealing high damage at mid range.",
        "cost": 120,
        "population": 3,
        "range": 5,
        "damage": 20,
        "attackSpeed": 0.5,
        "projectile": "lightning",
        "critChance": 0,
        "critMultiplier": 0,
        "piercing": 0,
        "burnDamage": 0,
        "render": {
          "animations": {
            "idle": [
              {}
            ]
          },
          "model": {
            "shapes": {
              "shapes": [
                {
                  "type": "box",
                  "width": 32,
                  "height": 8,
                  "depth": 32,
                  "x": 0,
                  "y": 4,
                  "z": 1.8,
                  "color": {
                    "paletteColor": "greyMColor"
                  },
                  "name": "base"
                },
                {
                  "type": "cylinder",
                  "size": 22,
                  "height": 10,
                  "x": 0,
                  "y": 14,
                  "z": 1.8,
                  "color": {
                    "paletteColor": "greyDColor"
                  },
                  "name": "core"
                },
                {
                  "type": "box",
                  "width": 12,
                  "height": 12,
                  "depth": 18,
                  "x": 0,
                  "y": 24,
                  "z": 1.8,
                  "color": {
                    "paletteColor": "greyMColor"
                  },
                  "rotationX": 12,
                  "name": "cannon-head"
                },
                {
                  "type": "cylinder",
                  "size": 6,
                  "height": 18,
                  "x": 0,
                  "y": 28,
                  "z": 12,
                  "rotationX": 90,
                  "color": {
                    "paletteColor": "greyDColor"
                  },
                  "name": "plasma-barrel"
                },
                {
                  "type": "cone",
                  "size": 5,
                  "height": 8,
                  "x": 0,
                  "y": 28,
                  "z": 20,
                  "rotationX": 90,
                  "color": {
                    "paletteColor": "greyLColor"
                  },
                  "name": "plasma-emitter"
                },
                {
                  "type": "cylinder",
                  "size": 3,
                  "height": 10,
                  "x": -8,
                  "y": 20,
                  "z": 1.8,
                  "color": {
                    "paletteColor": "blueMColor"
                  },
                  "name": "left-energy-coil"
                },
                {
                  "type": "cylinder",
                  "size": 3,
                  "height": 10,
                  "x": 8,
                  "y": 20,
                  "z": 1.8,
                  "color": {
                    "paletteColor": "blueMColor"
                  },
                  "name": "right-energy-coil"
                },
                {
                  "type": "sphere",
                  "size": 4,
                  "x": 0,
                  "y": 28,
                  "z": 20,
                  "color": {
                    "paletteColor": "purpleMColor"
                  },
                  "name": "charge-orb"
                },
                {
                  "type": "box",
                  "width": 6,
                  "height": 6,
                  "depth": 24,
                  "x": -12,
                  "y": 14,
                  "z": 1.8,
                  "color": {
                    "paletteColor": "blueMColor"
                  },
                  "name": "left-glow-panel"
                },
                {
                  "type": "box",
                  "width": 6,
                  "height": 6,
                  "depth": 24,
                  "x": 12,
                  "y": 14,
                  "z": 1.8,
                  "color": {
                    "paletteColor": "blueMColor"
                  },
                  "name": "right-glow-panel"
                },
                {
                  "type": "cylinder",
                  "size": 8,
                  "height": 4,
                  "x": 0,
                  "y": 32,
                  "z": 1.8,
                  "color": {
                    "paletteColor": "purpleMColor"
                  },
                  "name": "top-energy-ring"
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            }
          }
        }
      }
    },
    "worldObjects": {
      "rock": {
        "title": "Rock",
        "render": {
          "animations": {
            "idle": [
              {}
            ]
          },
          "model": {
            "shapes": {
              "shapes": [
                {
                  "type": "tetrahedron",
                  "size": 16,
                  "color": {
                    "paletteColor": "greyDColor"
                  },
                  "x": 3.5,
                  "y": 2,
                  "z": 2.5,
                  "rotationX": 50,
                  "rotationY": 140,
                  "rotationZ": 10,
                  "scaleX": 1
                },
                {
                  "type": "tetrahedron",
                  "size": 12,
                  "color": {
                    "paletteColor": "greyDColor"
                  },
                  "x": 10.5,
                  "y": 2,
                  "z": 7.5,
                  "rotationX": 50,
                  "rotationY": 150,
                  "rotationZ": 10
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            }
          }
        }
      },
      "tree": {
        "title": "Tree",
        "render": {
          "animations": {
            "idle": [
              {
                "shapes": {
                  "shapes": [
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 1
                    },
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 2
                    },
                    {
                      "color": {
                        "paletteColor": "greenDColor"
                      },
                      "id": 3
                    }
                  ]
                }
              }
            ]
          },
          "model": {
            "shapes": {
              "shapes": [
                {
                  "type": "cylinder",
                  "size": 10,
                  "color": {
                    "paletteColor": "brownDColor"
                  },
                  "x": 0,
                  "y": 10.625,
                  "z": 0,
                  "rotationX": 0,
                  "rotationY": 0,
                  "rotationZ": 0,
                  "height": 20,
                  "scaleX": 1
                },
                {
                  "type": "cone",
                  "size": 40,
                  "color": {
                    "paletteColor": "greenDColor"
                  },
                  "x": 0,
                  "y": 50.625,
                  "z": 0,
                  "rotationX": 0,
                  "rotationY": 0,
                  "rotationZ": 0,
                  "height": 60
                },
                {
                  "type": "cone",
                  "size": 35,
                  "color": {
                    "paletteColor": "greenDColor"
                  },
                  "x": 0,
                  "y": 60.625,
                  "z": 0,
                  "rotationX": 0,
                  "rotationY": 0,
                  "rotationZ": 0,
                  "height": 40
                },
                {
                  "type": "cone",
                  "size": 15,
                  "color": {
                    "paletteColor": "greenDColor"
                  },
                  "x": 0,
                  "y": 75.625,
                  "z": 0,
                  "rotationX": 0,
                  "rotationY": 0,
                  "rotationZ": 0,
                  "height": 15
                }
              ],
              "position": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "rotation": {
                "x": 0,
                "y": 0,
                "z": 0
              },
              "scale": {
                "x": 1,
                "y": 1,
                "z": 1
              }
            }
          }
        }
      }
    },
    "materials": {
      "greenL": {
        "title": "Green Light",
        "color": "#a3d39c"
      }
    },
    "palettes": {
      "main": {
        "title": "Main",
        "greenLColor": "#a3d39c",
        "greenMColor": "#5a8a4f",
        "greenDColor": "#2f4a29",
        "brownLColor": "#d9b38c",
        "brownMColor": "#8b5e3c",
        "brownDColor": "#4a2f1f",
        "blueLColor": "#b3e5fc",
        "blueMColor": "#4fc3f7",
        "blueDColor": "#0288d1",
        "redLColor": "#ffcc80",
        "redMColor": "#ff8c00",
        "redDColor": "#bf360c",
        "purpleLColor": "#e1bee7",
        "purpleMColor": "#ab47bc",
        "purpleDColor": "#6a1b9a",
        "greyLColor": "#cfd8dc",
        "greyMColor": "#78909c",
        "greyDColor": "#3e4f57"
      }
    },
    "shaders": {
      "grass": {
        "title": "Grass",
        "fragmentScript": "varying vec2 vUv;\nuniform sampler2D map;\nuniform vec3 fogColor;\nuniform float fogDensity;\nuniform vec3 directionalLightColor; // DirectionalLight color\nuniform float directionalLightIntensity; // DirectionalLight intensity\nuniform vec3 directionalLightDirection; // DirectionalLight direction (world space)\nuniform vec3 ambientLightColor; // AmbientLight color\nuniform float ambientLightIntensity; // AmbientLight intensity\nuniform vec3 skyColor; // HemisphereLight sky color\nuniform vec3 groundColor; // HemisphereLight ground color\nuniform float hemisphereIntensity; // HemisphereLight intensity\nvarying vec3 vWorldPosition;\nvarying vec3 vNormal;\n\nvoid main() {\n    vec4 texColor = texture2D(map, vUv);\n    vec3 color = texColor.rgb;\n\n    // Directional light (Lambertian diffuse)\n    vec3 lightDir = normalize(directionalLightDirection); // Ensure direction is normalized\n    float diff = max(dot(vNormal, lightDir), 0.0);\n    vec3 diffuse = directionalLightColor * directionalLightIntensity * diff * color;\n\n    // Ambient light\n    vec3 ambient = ambientLightColor * ambientLightIntensity * color;\n\n    // Hemisphere light\n    vec3 hemiDir = vec3(0.0, 1.0, 0.0); // Up direction for hemisphere\n    float hemiDot = dot(vNormal, hemiDir) * 0.5 + 0.5; // Remap to 0-1\n    vec3 hemi = mix(groundColor, skyColor, hemiDot) * hemisphereIntensity * color;\n\n    // Combine lighting contributions\n    vec3 litColor = diffuse + ambient + hemi;\n\n    // Apply fog\n    float fogDistance = length(vWorldPosition - cameraPosition);\n    float fogFactor = exp2(-fogDensity * fogDensity * fogDistance * fogDistance * 1.442695);\n    fogFactor = clamp(fogFactor, 0.0, 1.0);\n\n    vec3 finalColor = mix(fogColor, litColor, fogFactor);\n\n    gl_FragColor = vec4(finalColor, texColor.a);\n}",
        "vertexScript": "varying vec2 vUv;\nuniform float time;\nuniform float windSpeed;\nuniform float windStrength;\nuniform vec2 windDirection;\nattribute float instancePhase;\nvarying vec3 vWorldPosition;\nvarying vec3 vNormal; // Add for lighting\n\nvoid main() {\n    vUv = uv;\n    vec2 dir = normalize(windDirection);\n    float wave = sin(time * windSpeed + instancePhase) * windStrength;\n    wave *= uv.y;\n\n    vec3 displacement = vec3(\n        dir.x * wave,\n        0.0,\n        dir.y * wave\n    );\n\n    // Compute world position in world space\n    vec4 worldPosition = modelMatrix * instanceMatrix * vec4(position + displacement, 1.0);\n    vWorldPosition = worldPosition.xyz; // Store correct world position\n  \n    vec3 normal = normalize(normal); // Assuming grass geometry has normals\n    vNormal = normalize((modelMatrix * instanceMatrix * vec4(normal, 0.0)).xyz);\n\n    // Compute view position for gl_Position\n    vec4 mvPosition = viewMatrix * worldPosition;\n    gl_Position = projectionMatrix * mvPosition;\n    vUv = uv;\n}",
        "uniforms": "{ \"time\": { \"value\": 0 }, \"windSpeed\": { \"value\": 0.8 }, \"windStrength\": { \"value\": 2 }, \"windDirection\": { \"value\": [0.8, 0.6]} }",
        "vectors": "[\"windDirection\"]"
      },
      "water": {
        "title": "Water",
        "fragmentScript": "uniform float time;\nuniform float waveHeight;\nuniform vec3 liquidColor;\nuniform vec3 foamColor;\nuniform float waveFrequency;\nuniform float fresnelPower;\nuniform vec3 lightDirection;\nuniform float ambientIntensity;\nuniform float specularIntensity;\nvarying vec2 vUv;\nvarying vec3 vNormal;\nvarying vec3 vViewPosition;\nvarying float vWaveHeight;\nvarying float vNormalizedWaveHeight; // New varying for normalized height\nvarying vec3 vWorldPosition;\nuniform vec3 fogColor;\nuniform float fogDensity;\n\nvoid main() {\n    vec2 uv = vUv;\n    vec3 normal = normalize(vNormal);\n    vec3 viewDir = normalize(vViewPosition);\n    vec3 lightDir = normalize(lightDirection);\n\n    // Fresnel effect for edge transparency\n    float fresnel = pow(1.0 - max(dot(normal, viewDir), 0.0), fresnelPower);\n\n    // Diffuse lighting\n    float diffuse = max(dot(normal, lightDir), 0.0) * 0.25;\n\n    // Specular (Blinn-Phong)\n    vec3 halfwayDir = normalize(lightDir + viewDir);\n    float specular = pow(max(dot(normal, halfwayDir), 0.0), 32.0) * specularIntensity;\n\n    // Base color with subtle wave height modulation\n    vec3 baseColor = liquidColor * (0.8 + 0.2 * vNormalizedWaveHeight); // Slight tint variation\n\n    // Foam effect based on normalized wave height\n    float foamFactor = smoothstep(0.8, 1.0, vNormalizedWaveHeight); // Tighter range for foam at peaks\n    vec3 color = mix(baseColor, foamColor, foamFactor);\n  \n    float fogDistance = length(vWorldPosition - cameraPosition); // Distance from fragment to camera\n    float fogFactor = exp2(-fogDensity * fogDensity * fogDistance * fogDistance * 1.442695); // 1.442695 = ln(2)\n    fogFactor = clamp(fogFactor, 0.0, 1.0);\n    // Combine lighting components\n    vec3 lightColor = color * (ambientIntensity + diffuse) + vec3(specular);\n\t\tvec3 finalColor = mix(fogColor, lightColor, fogFactor);\n    // Apply fresnel for transparency at edges\n    float alpha = mix(0.6, 1.0, fresnel);\n\n    gl_FragColor = vec4(finalColor, alpha);\n}",
        "vertexScript": " uniform float time;\nuniform float waveHeight;\nuniform float waveFrequency;\nuniform float waveSpeed;\nvarying vec2 vUv;\nvarying vec3 vNormal;\nvarying vec3 vViewPosition;\nvarying float vWaveHeight;\nvarying float vNormalizedWaveHeight; // New varying for normalized height\nvarying vec3 vWorldPosition;\n// Simple noise function for wave variation\nfloat snoise(vec2 co) {\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main() {\n    vUv = uv;\n\n    // Combine multiple waves for more natural movement\n    float wave1 = sin(uv.x * waveFrequency + time * waveSpeed) * waveHeight;\n    float wave2 = sin(uv.y * waveFrequency * 0.7 + time * waveSpeed * 0.8) * waveHeight * 0.5;\n    float wave3 = cos((uv.x + uv.y) * waveFrequency * 0.5 + time * waveSpeed * 1.2) * waveHeight * 0.3;\n    float displacementY = (wave1 + wave2 + wave3) * 0.5;\n\n    // Store wave height for fragment shader\n    vWaveHeight = displacementY;\n\n    // Normalize wave height based on maximum possible displacement\n    float maxWaveHeight = waveHeight * (1.0 + 0.5 + 0.3) * 0.5; // Sum of wave amplitudes\n    vNormalizedWaveHeight = displacementY / maxWaveHeight;\n\n    // Update position with displacement\n    vec3 newPosition = vec3(position.x, position.y + displacementY, position.z);\n\n    // Compute normal for lighting\n    float offset = 0.01;\n    float waveX = (sin((uv.x + offset) * waveFrequency + time * waveSpeed) +\n                   sin((uv.y + offset) * waveFrequency * 0.7 + time * waveSpeed * 0.8) * 0.5 +\n                   cos((uv.x + uv.y + offset) * waveFrequency * 0.5 + time * waveSpeed * 1.2) * 0.3) * waveHeight * 0.5;\n    float waveZ = (sin((uv.x) * waveFrequency + time * waveSpeed) +\n                   sin((uv.y + offset) * waveFrequency * 0.7 + time * waveSpeed * 0.8) * 0.5 +\n                   cos((uv.x + uv.y + offset) * waveFrequency * 0.5 + time * waveSpeed * 1.2) * 0.3) * waveHeight * 0.5;\n    vec3 tangent = normalize(vec3(1.0, (waveX - displacementY) / offset, 0.0));\n    vec3 bitangent = normalize(vec3(0.0, (waveZ - displacementY) / offset, 1.0));\n    vNormal = normalize(cross(tangent, bitangent));\n\n    // Pass view position for fresnel and lighting\n    vec4 worldPosition = modelMatrix * vec4(newPosition, 1.0);\n    vViewPosition = (cameraPosition - worldPosition.xyz);\n    vWorldPosition = worldPosition.xyz;\n    // Apply projection and model-view transforms\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(newPosition, 1.0);\n}",
        "uniforms": "{\"time\":{\"value\":0},\"waveHeight\":{\"value\":3},\"waveFrequency\":{\"value\":5},\"waveSpeed\":{\"value\":0.25},\"liquidColor\":{\"value\":\"\"},\"foamColor\":{\"value\":\"\"},\"fresnelPower\":{\"value\":0},\"lightDirection\":{\"value\":[0.5,0.5,0.5]},\"ambientIntensity\":{\"value\":1},\"specularIntensity\":{\"value\":1}}",
        "vectors": "[\"foamColor\",\"liquidColor\",\"lightDirection\"]"
      }
    },
    "textures": {
      "end": {
        "title": "End",
        "image": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAAAYCAYAAAAF6fiUAAAAlklEQVRoQ+3UIQ6AMBBEUeo5D56T4zlPPQTblNTt7zYfTTIwL7PlOvZnS/Scdy2JPnf4qSUbwPdHKyGkBFgJIS3AKgipAYYHdqIX/s6mAIFIPQQBAgF6Z1MAAYIbgOPaM+QCgkEECC68jRNAALgBON4FCAA3AMe7AAHgBuB4FyAA3AAc7wIEgBuA412AAHADcLwLmAzgBfVWYBnOEmyVAAAAAElFTkSuQmCC"
      },
      "grass": {
        "title": "Grass",
        "image": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAAAYCAYAAAAF6fiUAAAAl0lEQVRoQ+3UsQ2AMBAEQVwhOYVQBIWQu0IQqWXk7NdvLTHSwY3uy3Htz5bouc9aEn3u8FNLNoDvj1ZCSAmwEkJagFUQUgMMD+xEL/ydTQECkXoIAgQC9M6mAAIENwDHtWfIBQSDCBBceBsngABwA3C8CxAAbgCOdwECwA3A8S5AALgBON4FCAA3AMe7AAHgBuB4FzAZwAsfF2AZYnfKcAAAAABJRU5ErkJggg=="
      },
      "path": {
        "title": "Path",
        "image": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAAAYCAYAAAAF6fiUAAAA+0lEQVRoQ+2UsRWDMAxEcZ8FskAmyIAMmAmyAAukJwlFCj+MfcLikCJqSzrdP5HmxzgPhr50H5MhuVWpyRqA70aeIJgE4AlCM4DndBlu11f1pEoP9tav9fVwCc0AxM5H4eJAKSxqADQSb53lGgQ1ANbN0tKfQxABiHTL8UAAwmi50aVKCED/8dExAJAzQAPg7Xcm3UcFgFQMOYyU8SoAKJtkQ0shOFs4NgFIxEpqzgCMpcHtBbAMRecGANSxz3vkymtvYQC1hoJ9fiWavffo0qyFAWiK+cfeLgFYuiSXAJBLYsPqCoC9DGL8EW9b/OgK4IilvM0IAGSiOYA3/xycGR8hN+EAAAAASUVORK5CYII="
      },
      "start": {
        "title": "Start",
        "image": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAAAYCAYAAAAF6fiUAAAAl0lEQVRoQ+3UsQ2AMBAEQVwGEb1QOL0QuQwQqWXk7NdvLTHSwY3uy33VZ0v0HOdeEn3u8FNLNoDvj1ZCSAmwEkJagFUQUgMMD+xEL/ydTQECkXoIAgQC9M6mAAIENwDHtWfIBQSDCBBceBsngABwA3C8CxAAbgCOdwECwA3A8S5AALgBON4FCAA3AMe7AAHgBuB4FzAZwAvn4mAZ8YoyRAAAAABJRU5ErkJggg=="
      },
      "lava": {
        "title": "Lava",
        "image": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAAAYCAYAAAAF6fiUAAAAkUlEQVRoQ+3UQQ6AIAxEUXpnj8GdMW4Jhl0/Jd+1yei8TGP0NlqhJ54WhT53+6lRDeD7o5sQSgLchFAW4BaE0gDbA3vQC39nU4BEpBWCAIkAq7MpgADJDcBx8xlyAckgAiQXPscJIADcABzvAgSAG4DjXYAAcANwvAsQAG4AjncBAsANwPEuQAC4ATjeBRwG8AKHQEgZvHpI7AAAAABJRU5ErkJggg=="
      },
      "scales": {
        "title": "Scales",
        "image": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAQ0lEQVQYV2OM6vL/z4ADXD1wi4GRoAJ9L83/2g5qGGaAdIPEwSaAOOgApgnFCpguZMXEK4DpRjeFEeRIkJHIDkV2EwCeFirmzbH2AwAAAABJRU5ErkJggg=="
      },
      "forest": {
        "title": "Forest",
        "image": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAAAYCAYAAAAF6fiUAAAAl0lEQVRoQ+3UsQ2AMBAEQVwOEX1QMH0QuRwQqWXk7NdvLTHSwY3uy3Huz5boua9aEn3u8FNLNoDvj1ZCSAmwEkJagFUQUgMMD+xEL/ydTQECkXoIAgQC9M6mAAIENwDHtWfIBQSDCBBceBsngABwA3C8CxAAbgCOdwECwA3A8S5AALgBON4FCAA3AMe7AAHgBuB4FzAZwAs/vWAZcNxDRQAAAABJRU5ErkJggg=="
      },
      "water": {
        "title": "Water",
        "image": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAAAYCAYAAAAF6fiUAAAAlUlEQVRoQ+3UwQ2AIBBEUbEh27ME27MhNF4Jhtt+lnzPJqPzMlv26362RE89j5Loc4efWrIBfH+0EkJKgJUQ0gKsgpAaYHhgJ3rh72wKEIjUQxAgEKB3NgUQILgBOK49Qy4gGESA4MLbOAEEgBuA412AAHADcLwLEABuAI53AQLADcDxLkAAuAE43gUIADcAx7uAyQBeDUJgGasSxlsAAAAASUVORK5CYII="
      },
      "rock": {
        "title": "Rock",
        "image": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAAAYCAYAAAAF6fiUAAAA40lEQVRoQ+3VPQ6DMAwFYHItBqQOzIw9I2PnDpUYeq2iTkgoyAnBvzzmyHn4syEN0/PXOXqW15wcxSWjJm8A/zeKhOASIBKCW4AoCK4ByA+soQNHn00ACCLlELIA/WPsvp/35dG46l4elLHgHgEbwNjsXOkmAExwu1YTQPv1qAAA5RkAAACUO6B8vdgG4IedlxYDUB40s9e7A4i2SSYAojW1Zt2KAe7cpJqG1p4tBqgtbPU81yCdrcsGcDaQVTiuXGwAXIGj1VUBwHZsY0QCWGhWaYbSc5JbRGUiASTD3vGuPcAKi06NGSIOm+IAAAAASUVORK5CYII="
      }
    },
    "components": {
      "ArrayTracker": {
        "fileName": "ArrayTracker",
        "script": "class ArrayTracker extends engine.Component {\r\n    \r\n    constructor(game, parent, params) {\r\n        super(game, parent, params);\r\n    }\r\n    \r\n    \r\n    init( {objectType}) {\r\n        this.arr = objectType;\r\n        if(!this.game.state[this.arr]){\r\n            this.game.state[this.arr] = [];\r\n        }\r\n        this.game.state[this.arr].push(this.parent);\r\n    }\r\n\r\n    destroy(){\r\n        let index = this.game.state[this.arr].indexOf(this.parent);\r\n        this.game.state[this.arr].splice(index, 1);        \r\n    }\r\n}"
      },
      "Buildable": {
        "fileName": "Buildable",
        "script": "class Buildable extends engine.Component {\r\n    \r\n    constructor(game, parent, params) {\r\n        super(game, parent, params);\r\n    }\r\n    \r\n    \r\n  init() {        \r\n        this.placed = false;\r\n    }\r\n}"
      },
      "EssenceBounty": {
        "fileName": "EssenceBounty",
        "script": "class EssenceBounty extends engine.Component {\r\n    \r\n    constructor(game, parent, params) {\r\n        super(game, parent, params);\r\n    }\r\n    \r\n    \r\n    init(){\r\n        this.statsComp = this.parent.getComponent('stats');\r\n    }\r\n    destroy() {               \r\n        this.game.state.essence += this.statsComp.stats.essence * this.game.state.stats.essenceMultiplier;        \r\n    }\r\n}"
      },
      "ChainProjectile": {
        "fileName": "ChainProjectile",
        "script": "class ChainProjectile extends engine.Component {\r\n    \r\n    constructor(game, parent, params) {\r\n        super(game, parent, params);\r\n    }\r\n    \r\n    \r\n    init( { spawnType, owner, target, stats }) {        \r\n        this.type = spawnType;\r\n        this.owner = owner;\r\n        this.target = target;\r\n        this.stats = stats;\r\n        this.piercedEnemies = [];\r\n        this.ownerStats = this.owner.getComponent(\"stats\").stats;\r\n        this.chainTargets = []; // Store all targets hit in one frame\r\n        this.hasStruck = false; // Flag to strike only once\r\n    }\r\n\r\n    update() {\r\n        if (this.hasStruck) {\r\n            this.parent.destroy(); // Destroy after one frame of striking\r\n            return;\r\n        }\r\n\r\n        if (!this.target || this.target.destroyed) {\r\n            this.parent.destroy();\r\n            return;\r\n        }\r\n\r\n        // Strike the initial target\r\n        let targetHealth = this.target.getComponent(\"health\");\r\n        let targetEnergyShield = this.target.getComponent(\"energyshield\");\r\n        let targetStats = {...this.target.getComponent(\"stats\").stats};\r\n        targetStats.energyShield = targetEnergyShield.energyShield;\r\n        let damageResult = engine.getFunction(\"calculateDamage\")(this.stats, targetStats);                    \r\n        if( damageResult.wasEvaded ) { return; }         \r\n        targetHealth.hp -= damageResult.damageDealt;\r\n        targetEnergyShield.absorbDamage(damageResult.damageAbsorbed);\r\n        this.piercedEnemies.push(this.target);\r\n        this.chainTargets.push(this.target);\r\n        this.game.spawn(this.target.position.x, this.target.position.y, \"hitEffect\", { damageType: this.stats.damageType, lifeSpan: 1});\r\n        // Chain to nearby enemies\r\n        if (this.stats.piercing > 0 && this.piercedEnemies.length <= this.stats.piercing) {\r\n            const nearbyEnemies = this.game.spatialGrid.getNearbyEntities(\r\n                this.target.gridPosition.x, \r\n                this.target.gridPosition.y, \r\n                this.ownerStats.range,\r\n                \"enemy\"\r\n            );\r\n\r\n            for (let enemy of nearbyEnemies) {\r\n                if (enemy.destroyed || this.piercedEnemies.includes(enemy)) continue;\r\n                const dx = enemy.position.x - this.target.position.x;\r\n                const dy = enemy.position.y - this.target.position.y;\r\n                const distSq = dx * dx + dy * dy;\r\n                let gridSize = this.game.config.configs.game.gridSize;\r\n                if (distSq <= this.ownerStats.range * this.ownerStats.range * gridSize * gridSize) {\r\n                    let enemyHealth = enemy.getComponent(\"health\");\r\n                    let enemyEnergyShield = enemy.getComponent(\"energyshield\");\r\n                    let enemyStats = {...enemy.getComponent(\"stats\").stats};\r\n                    enemyStats.energyShield = targetEnergyShield.energyShield;\r\n                    let damageResult = engine.getFunction(\"calculateDamage\")(this.stats, enemyStats); \r\n                    if(!damageResult.wasEvaded) {\r\n                        enemyHealth.hp -= damageResult.damageDealt;\r\n                        enemyEnergyShield.absorbDamage(damageResult.damageAbsorbed);\r\n                        this.piercedEnemies.push(enemy);\r\n                        this.chainTargets.push(enemy);\r\n                        this.game.spawn(enemy.position.x, enemy.position.y, \"hitEffect\", { damageType: this.stats.damageType, lifeSpan: 1 });\r\n                        if (this.piercedEnemies.length > this.stats.piercing) break;\r\n                    } else {\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Apply additional effects (e.g., slow, leech) to all hit targets\r\n        for (let enemy of this.chainTargets) {\r\n            if (this.ownerStats.slowAmount) {\r\n                enemy.getComponent(\"stats\").addEffect(this.game.config.effects.slow, this.game.effects.slow, this.ownerStats.slowAmount);\r\n            }\r\n            if (this.ownerStats.leech > 0) {\r\n                const healing = this.stats.damage * this.ownerStats.leech * this.game.state.stats.healingMultiplier;\r\n                this.game.state.bloodCoreHP = Math.min(this.game.state.stats.maxBloodCoreHP, this.game.state.bloodCoreHP + healing);\r\n            }\r\n            if (this.ownerStats.thief && this.ownerStats.thief != 0) {\r\n                const stealAmt = this.stats.damage * this.ownerStats.thief * this.game.state.stats.bloodShardMultiplier;\r\n                this.game.state.bloodShards += stealAmt;\r\n            }\r\n        }\r\n\r\n        this.hasStruck = true; // Mark as struck, render lightning this frame\r\n    }\r\n}"
      },
      "AudioManager": {
        "title": "AudioManager",
        "fileName": "AudioManager",
        "script": "class AudioManager extends engine.Component {\n    constructor(game, parent, params) {\n        super(game, parent, params);\n    }\n\n    init() {\n        this.isInitialized = false;\n        this.bindInitialization();\n    }\n\n    bindInitialization() {\n        const initHandler = () => {\n            if (!this.isInitialized) {\n                this.initialize();\n            }\n        };\n        \n        document.addEventListener('click', initHandler, { once: true });\n        document.addEventListener('keydown', initHandler, { once: true });\n    }\n\n    async initialize() {\n        class SoundPool {\n            constructor(audioContext, destination, poolSize = 8) {\n                this.audioContext = audioContext;\n                this.destination = destination;\n                this.poolSize = poolSize;\n                this.sources = [];\n                this.initializePool();\n            }\n\n            initializePool() {\n                for (let i = 0; i < this.poolSize; i++) {\n                    this.sources.push(this.createSource());\n                }\n            }\n\n            createSource() {\n                const source = {\n                    active: false,\n                    id: null,\n                    envelopeGain: this.audioContext.createGain(),\n                    gainNode: this.audioContext.createGain(),\n                    filter: this.audioContext.createBiquadFilter(),\n                    distortion: this.audioContext.createWaveShaper(),\n                    compressor: this.audioContext.createDynamicsCompressor(),\n                    pannerNode: this.audioContext.createStereoPanner(),\n                    delay: this.audioContext.createDelay(5.0),\n                    delayGain: this.audioContext.createGain(),\n                    convolver: this.audioContext.createConvolver(),\n                    reverbGain: this.audioContext.createGain(),\n                    noiseFilter: this.audioContext.createBiquadFilter(),\n                    noiseGain: this.audioContext.createGain(),\n                    destination: this.destination\n                };\n\n                source.filter.type = 'lowpass';\n                source.filter.frequency.setValueAtTime(20000, this.audioContext.currentTime);\n                source.filter.Q.setValueAtTime(0.5, this.audioContext.currentTime);\n\n                source.noiseFilter.type = 'lowpass';\n                source.noiseFilter.frequency.setValueAtTime(2000, this.audioContext.currentTime);\n                source.noiseFilter.Q.setValueAtTime(1, this.audioContext.currentTime);\n                \n                source.noiseGain.gain.setValueAtTime(0, this.audioContext.currentTime);\n\n                source.distortion.curve = null;\n                source.distortion.oversample = '4x';\n\n                source.compressor.threshold.setValueAtTime(-24, this.audioContext.currentTime);\n                source.compressor.knee.setValueAtTime(30, this.audioContext.currentTime);\n                source.compressor.ratio.setValueAtTime(12, this.audioContext.currentTime);\n                source.compressor.attack.setValueAtTime(0.003, this.audioContext.currentTime);\n                source.compressor.release.setValueAtTime(0.25, this.audioContext.currentTime);\n\n                source.pannerNode.pan.setValueAtTime(0, this.audioContext.currentTime);\n\n                source.delay.delayTime.setValueAtTime(0.3, this.audioContext.currentTime);\n                source.delayGain.gain.setValueAtTime(0, this.audioContext.currentTime);\n\n                source.reverbGain.gain.setValueAtTime(0, this.audioContext.currentTime);\n\n                const chain = [\n                    source.envelopeGain,\n                    source.gainNode,\n                    source.filter,\n                    source.distortion,\n                    source.compressor,\n                    source.pannerNode\n                ];\n\n                for (let i = 0; i < chain.length - 1; i++) {\n                    chain[i].connect(chain[i + 1]);\n                }\n\n                // Route delay and reverb after filter\n                source.filter.connect(source.delay);\n                source.delay.connect(source.delayGain);\n                source.delayGain.connect(source.delay);\n                source.delayGain.connect(source.pannerNode);\n\n                source.filter.connect(source.convolver);\n                source.convolver.connect(source.reverbGain);\n                source.reverbGain.connect(source.pannerNode);\n\n                source.pannerNode.connect(source.destination);\n\n                return source;\n            }\n\n            getSource() {\n                let source = this.sources.find(src => !src.active && (!src.lastUsed || this.audioContext.currentTime - src.lastUsed > 1));\n                if (!source && this.sources.length < this.poolSize * 2) {\n                    source = this.createSource();\n                    this.sources.push(source);\n                }\n                if (source) {\n                    source.active = true;\n                    source.gainNode.gain.setValueAtTime(1, this.audioContext.currentTime);\n                    source.envelopeGain.gain.setValueAtTime(0, this.audioContext.currentTime);\n                    source.delayGain.gain.setValueAtTime(0, this.audioContext.currentTime);\n                    source.reverbGain.gain.setValueAtTime(0, this.audioContext.currentTime);\n                    source.noiseGain.gain.setValueAtTime(0, this.audioContext.currentTime);\n                }\n                return source;\n            }\n\n            releaseSource(source) {\n                if (source) {\n                    source.active = false;\n                    source.id = null;\n                    const now = this.audioContext.currentTime;\n            \n                    // Reset all nodes\n                    source.filter.frequency.cancelScheduledValues(now);\n                    source.filter.frequency.setValueAtTime(20000, now);\n                    source.distortion.curve = null;\n                    source.pannerNode.pan.setValueAtTime(0, now);\n                    source.envelopeGain.gain.setValueAtTime(0, now);\n                    source.gainNode.gain.setValueAtTime(1, now);\n                    source.delayGain.gain.setValueAtTime(0, now);\n                    source.reverbGain.gain.setValueAtTime(0, now);\n                    source.noiseGain.gain.setValueAtTime(0, now);\n            \n                    // Disconnect and clear sources if they exist\n                    if (source.source) {\n                        try {\n                            source.source.stop(now);\n                            source.source.disconnect();\n                        } catch (e) {\n                            console.warn('Error stopping source:', e);\n                        }\n                        source.source = null;\n                    }\n                    \n                    if (source.noiseSource) {\n                        try {\n                            source.noiseSource.stop(now);\n                            source.noiseSource.disconnect();\n                        } catch (e) {\n                            console.warn('Error stopping noise source:', e);\n                        }\n                        source.noiseSource = null;\n                    }\n            \n                    source.lastUsed = now;\n                }\n            }\n\n            destroy() {\n                this.sources.forEach(source => {\n                    source.envelopeGain.disconnect();\n                    source.gainNode.disconnect();\n                    source.filter.disconnect();\n                    source.distortion.disconnect();\n                    source.compressor.disconnect();\n                    source.pannerNode.disconnect();\n                    source.delay.disconnect();\n                    source.delayGain.disconnect();\n                    source.convolver.disconnect();\n                    source.reverbGain.disconnect();\n                    source.noiseFilter.disconnect();\n                    source.noiseGain.disconnect();\n                });\n                this.sources = [];\n            }\n        }\n        this.audioContext = new (window.AudioContext || window.webkitAudioContext)();\n        this.masterBus = this.createAudioBus('master');\n        this.musicBus = this.createAudioBus('music');\n        this.sfxBus = this.createAudioBus('sfx');\n        this.uiBus = this.createAudioBus('ui');\n        this.musicBus.connect(this.masterBus);\n        this.sfxBus.connect(this.masterBus);\n        this.uiBus.connect(this.masterBus);\n        this.masterBus.connect(this.audioContext.destination);\n        this.soundPools = {\n            sfx: new SoundPool(this.audioContext, this.sfxBus.input, 6),\n            music: new SoundPool(this.audioContext, this.musicBus.input, 2),\n            ui: new SoundPool(this.audioContext, this.uiBus.input, 3)\n        };\n        this.buffers = {};\n        this.activeSounds = new Set();\n        if (this.audioContext.state === 'suspended') {\n            await this.audioContext.resume();\n        }\n        this.isInitialized = true;\n    }\n\n    createAudioBus(name) {\n        const bus = {\n            name,\n            input: this.audioContext.createGain(),\n            compressor: this.audioContext.createDynamicsCompressor(),\n            output: this.audioContext.createGain()\n        };\n        \n        bus.input.connect(bus.compressor);\n        bus.compressor.connect(bus.output);\n        \n        bus.connect = (destination) => {\n            bus.output.connect(destination.input || destination);\n        };\n        \n        bus.setVolume = (value) => {\n            const now = this.audioContext.currentTime;\n            bus.output.gain.cancelScheduledValues(now);\n            bus.output.gain.setTargetAtTime(\n                value <= 0 ? 0.000001 : value,\n                now,\n                0.02\n            );\n        };\n        \n        return bus;\n    }\n\n    getSynthSound(soundCollectionName, soundName) {\n        if (this.game.config[soundCollectionName]?.[soundName]) {\n            return this.game.config[soundCollectionName][soundName].audio;\n        }\n        console.warn('sound not found', soundCollectionName, soundName);\n        return null;\n    }\n\n    playSound(soundCollectionName, soundName) {\n        let data = this.getSynthSound(soundCollectionName, soundName);\n        if (data) {\n            this.playSynthSound(`${soundCollectionName}_${soundName}`, data);\n        }\n    }\n\n    playSynthSound(soundId, soundConfig, options = {}) {\n        if (!this.isInitialized) {\n            this.initialize();\n            return this.playSynthSound(soundId, soundConfig, options);\n        }\n        \n        const category = options.category || 'sfx';\n        const pool = this.soundPools[category];\n        \n        if (!pool) {\n            console.warn(`No sound pool for category ${category}`);\n            return null;\n        }\n        \n        let instanceCount = 0;\n        this.activeSounds.forEach(sound => {\n            if (sound.id === soundId) instanceCount++;\n        });\n        \n        if (instanceCount >= (options.maxInstances || 3)) {\n            console.warn(`Max instances reached for sound ${soundId}`);\n            return null;\n        }\n        \n        const sound = pool.getSource();\n        if (!sound) {\n            console.warn(`No available source for sound ${soundId}`);\n            return null;\n        }\n        \n        sound.id = soundId;\n        sound.category = category;\n        \n        // Create main oscillator\n        const oscillator = this.createSynthSource(soundConfig);\n        sound.source = oscillator;\n        oscillator.connect(sound.envelopeGain);\n        \n        // Add noise generator if configured\n        if (soundConfig.noise && soundConfig.noise.amount > 0) {\n            this.applyNoiseToSound(sound, soundConfig.noise);\n        }\n        \n        this.createEnvelopeFromConfig(soundConfig.envelope, sound.envelopeGain, soundConfig.duration);\n        \n        if (soundConfig.effects) {\n            this.applySynthEffects(sound, soundConfig.effects, soundConfig);\n        } \n        \n        this.configureSoundInstance(sound, options);\n        \n        const now = this.audioContext.currentTime;\n        oscillator.start(now);\n        \n        // Start noise generator if it exists\n        if (sound.noiseSource) {\n            sound.noiseSource.start(now);\n        }\n        \n        const duration = soundConfig.duration || 1;\n        const release = (soundConfig.envelope?.release) || 0.3;\n        let totalDuration = duration + release;\n        \n        if (soundConfig.effects?.delay?.time) {\n            const delayTail = soundConfig.effects.delay.time * 3;\n            if (totalDuration < delayTail) {\n                totalDuration = delayTail;\n            }\n        }\n        \n        oscillator.stop(now + totalDuration + 0.02);\n        if (sound.noiseSource) {\n            sound.noiseSource.stop(now + totalDuration + 0.02);\n        }\n        \n        this.activeSounds.add(sound);\n        \n        oscillator.onended = () => {\n            setTimeout(() => {\n                sound.active = false;\n                this.activeSounds.delete(sound);\n                pool.releaseSource(sound);\n            }, (soundConfig.effects?.delay?.time || 0) * 1000 * 3);\n        };\n        \n        return sound;\n    }\n\n    createSynthSource(config) {\n        // Default to oscillator unless waveform is 'noise'\n        const oscillator = config.waveform === 'noise'\n            ? this.createNoiseSource('white') \n            : this.audioContext.createOscillator();\n    \n        if (config.waveform !== 'noise') {\n            oscillator.type = config.waveform || 'sine';\n            const baseFreq = config.frequency || 440;\n            const now = this.audioContext.currentTime;\n    \n            // Initialize frequency\n            oscillator.frequency.cancelScheduledValues(now);\n            oscillator.frequency.setValueAtTime(baseFreq, now);\n    \n            // Apply pitch envelope if defined\n            if (config.pitchEnvelope) {\n                const startMultiplier = config.pitchEnvelope.start ?? 1;\n                const endMultiplier = config.pitchEnvelope.end ?? 1;\n                const envelopeTime = config.pitchEnvelope.time ?? config.duration ?? 1;\n    \n                if (startMultiplier !== 1 || endMultiplier !== 1) {\n                    const startFreq = baseFreq * startMultiplier;\n                    const endFreq = baseFreq * endMultiplier;\n    \n                    oscillator.frequency.setValueAtTime(startFreq, now);\n                    oscillator.frequency.exponentialRampToValueAtTime(\n                        Math.max(endFreq, 0.01),\n                        now + envelopeTime\n                    );\n                }\n            }\n        }\n    \n        return oscillator;\n    }\n\n    applyNoiseToSound(sound, noiseConfig) {\n        if (!noiseConfig || noiseConfig.amount <= 0) return;\n\n        const noiseType = noiseConfig.type || 'white';\n        const noiseAmount = Math.min(1, Math.max(0, noiseConfig.amount));\n        \n        // Create the noise source\n        sound.noiseSource = this.createNoiseSource(noiseType);\n        \n        // Configure noise filter if specified\n        if (noiseConfig.filter && noiseConfig.filter.type !== 'none') {\n            sound.noiseFilter.type = noiseConfig.filter.type || 'lowpass';\n            sound.noiseFilter.frequency.setValueAtTime(\n                noiseConfig.filter.frequency || 2000, \n                this.audioContext.currentTime\n            );\n        }\n        \n        // Set noise gain based on the amount\n        sound.noiseGain.gain.setValueAtTime(noiseAmount, this.audioContext.currentTime);\n        \n        // Connect noise through the filter and envelope\n        sound.noiseSource.connect(sound.noiseFilter);\n        sound.noiseFilter.connect(sound.noiseGain);\n        sound.noiseGain.connect(sound.envelopeGain);\n    }\n\n    createNoiseSource(noiseType = 'white') {\n        const bufferSize = this.audioContext.sampleRate * 2;\n        const noiseBuffer = this.audioContext.createBuffer(1, bufferSize, this.audioContext.sampleRate);\n        const output = noiseBuffer.getChannelData(0);\n        \n        // Generate different types of noise\n        switch (noiseType) {\n            case 'pink':\n                this.generatePinkNoise(output);\n                break;\n            case 'brown':\n                this.generateBrownNoise(output);\n                break;\n            case 'white':\n            default:\n                this.generateWhiteNoise(output);\n                break;\n        }\n        \n        const source = this.audioContext.createBufferSource();\n        source.buffer = noiseBuffer;\n        source.loop = true;\n        \n        return source;\n    }\n\n    generateWhiteNoise(output) {\n        for (let i = 0; i < output.length; i++) {\n            output[i] = Math.random() * 2 - 1;\n        }\n    }\n\n    generatePinkNoise(output) {\n        // Pink noise algorithm (approximation using Paul Kellet's method)\n        let b0 = 0, b1 = 0, b2 = 0, b3 = 0, b4 = 0, b5 = 0, b6 = 0;\n        \n        for (let i = 0; i < output.length; i++) {\n            const white = Math.random() * 2 - 1;\n            \n            // Filter white noise to create pink noise\n            b0 = 0.99886 * b0 + white * 0.0555179;\n            b1 = 0.99332 * b1 + white * 0.0750759;\n            b2 = 0.96900 * b2 + white * 0.1538520;\n            b3 = 0.86650 * b3 + white * 0.3104856;\n            b4 = 0.55000 * b4 + white * 0.5329522;\n            b5 = -0.7616 * b5 - white * 0.0168980;\n            \n            output[i] = (b0 + b1 + b2 + b3 + b4 + b5 + b6 + white * 0.5362) * 0.11;\n            b6 = white * 0.115926;\n        }\n    }\n\n    generateBrownNoise(output) {\n        // Brown noise algorithm (random walk)\n        let lastValue = 0;\n        \n        for (let i = 0; i < output.length; i++) {\n            // Small random change from previous value\n            const white = Math.random() * 2 - 1;\n            lastValue = (lastValue + (0.02 * white)) / 1.02;\n            \n            // Keep within range\n            output[i] = lastValue * 3.5; // Amplify to make it audible\n        }\n        \n        // Normalize to prevent clipping\n        const max = Math.max(...Array.from(output).map(Math.abs));\n        if (max > 0) {\n            for (let i = 0; i < output.length; i++) {\n                output[i] /= max;\n            }\n        }\n    }\n\n    createEnvelopeFromConfig(envelope, gainNode, duration = 1) {\n        if (!envelope) {\n            console.warn('No envelope provided, using default');\n            envelope = { attack: 0.01, decay: 0.1, sustain: 0.7, release: 0.3 };\n        }\n        \n        const now = this.audioContext.currentTime;\n        \n        const attack = Math.max(0.01, envelope.attack || 0.01);\n        const decay = Math.max(0, envelope.decay || 0.1);\n        const sustain = Math.max(0, Math.min(1, envelope.sustain || 0.7));\n        const release = Math.max(0.02, envelope.release || 0.3);\n        \n        gainNode.gain.cancelScheduledValues(now);\n        gainNode.gain.setValueAtTime(0, now);\n        gainNode.gain.linearRampToValueAtTime(1, now + attack);\n        gainNode.gain.linearRampToValueAtTime(sustain, now + attack + decay);\n        gainNode.gain.setValueAtTime(sustain, now + duration);\n        gainNode.gain.setTargetAtTime(0.0001, now + duration, release / 3);\n        gainNode.gain.setValueAtTime(0, now + duration + release); // Absolute zero\n    }\n\n    applySynthEffects(sound, effectsConfig, soundConfig) {\n        const now = this.audioContext.currentTime;\n        \n        // Filter\n        if (effectsConfig.filter) {\n            sound.filter.type = effectsConfig.filter.type || 'lowpass';\n            sound.filter.frequency.setValueAtTime(effectsConfig.filter.frequency || 20000, now);\n            sound.filter.Q.setValueAtTime(effectsConfig.filter.Q || 0.5, now);\n            \n            // Apply pitch envelope to filter for noise waveforms\n            if (sound.source.buffer && soundConfig.pitchEnvelope && (soundConfig.pitchEnvelope.start !== 1 || soundConfig.pitchEnvelope.end !== 1)) {\n                const baseFreq = soundConfig.frequency || 100;\n                const startFreq = baseFreq * (soundConfig.pitchEnvelope.start + 1);\n                const endFreq = baseFreq * soundConfig.pitchEnvelope.end;\n                const duration = soundConfig.pitchEnvelope.time || soundConfig.duration || 1;\n                \n                sound.filter.frequency.cancelScheduledValues(now);\n                sound.filter.frequency.setValueAtTime(startFreq, now);\n                sound.filter.frequency.exponentialRampToValueAtTime(\n                    Math.max(endFreq, 0.01),\n                    now + duration\n                );\n                sound.filter.frequency.exponentialRampToValueAtTime(\n                    Math.max(endFreq * 0.5, 0.01),\n                    now + soundConfig.duration + (soundConfig.envelope?.release || 0.3)\n                );\n            }\n        }\n        \n        // Distortion\n        if (effectsConfig.distortion && effectsConfig.distortion > 0) {\n            sound.distortion.curve = this.makeDistortionCurve(effectsConfig.distortion);\n        } else {\n            sound.distortion.curve = null;\n        }\n        \n        // Delay\n        if (effectsConfig.delay && effectsConfig.delay.feedback > 0) {\n            sound.delay.delayTime.setValueAtTime(effectsConfig.delay.time || 0.3, now);\n            sound.delayGain.gain.setValueAtTime(Math.min(effectsConfig.delay.feedback || 0, 0.8), now);\n            sound.delayGain.gain.setTargetAtTime(0, now + soundConfig.duration + (soundConfig.envelope?.release || 0.3), 0.1);\n        } else {\n            sound.delayGain.gain.setValueAtTime(0, now);\n        }\n        \n        // Reverb\n        if (effectsConfig.reverb && effectsConfig.reverb > 0) {\n            this.generateImpulseResponse(sound.convolver);\n            sound.reverbGain.gain.setValueAtTime(Math.min(effectsConfig.reverb, 1), now);\n            sound.reverbGain.gain.setTargetAtTime(0, now + soundConfig.duration + (soundConfig.envelope?.release || 0.3), 0.2);\n        } else {\n            sound.reverbGain.gain.setValueAtTime(0, now);\n        }\n        \n        // Panning\n        if (effectsConfig.pan !== undefined) {\n            sound.pannerNode.pan.setValueAtTime(Math.max(-1, Math.min(1, effectsConfig.pan)), now);\n        }\n    }\n\n    configureSoundInstance(sound, options) {\n        const now = this.audioContext.currentTime;\n        \n        if (options.volume !== undefined) {\n            sound.gainNode.gain.cancelScheduledValues(now);\n            sound.gainNode.gain.setTargetAtTime(\n                options.volume <= 0 ? 0.000001 : Math.max(0, Math.min(options.volume, 1)),\n                now,\n                0.02\n            );\n        }\n        \n        if (options.position && sound.pannerNode.positionX) {\n            const pos = options.position;\n            sound.pannerNode.positionX.setValueAtTime(pos.x || 0, now);\n            sound.pannerNode.positionY.setValueAtTime(pos.y || 0, now);\n            sound.pannerNode.positionZ.setValueAtTime(pos.z || 0, now);\n        }\n        \n        if (options.pitch && sound.source && sound.source.playbackRate) {\n            sound.source.playbackRate.setValueAtTime(options.pitch, now);\n        }\n    }\n\n    generateImpulseResponse(convolver) {\n        const length = this.audioContext.sampleRate * 1.5; // Shorter impulse\n        const impulse = this.audioContext.createBuffer(2, length, this.audioContext.sampleRate);\n        \n        for (let channel = 0; channel < 2; channel++) {\n            const impulseData = impulse.getChannelData(channel);\n            for (let i = 0; i < length; i++) {\n                const decay = Math.pow(1 - i / length, 2);\n                impulseData[i] = (Math.random() * 2 - 1) * decay;\n            }\n        }\n        \n        convolver.buffer = impulse;\n    }\n\n    makeDistortionCurve(amount) {\n        const k = Math.max(amount, 0) * 10;\n        const n_samples = 44100;\n        const curve = new Float32Array(n_samples);\n        const deg = Math.PI / 180;\n        for (let i = 0; i < n_samples; i++) {\n            const x = (i * 2) / n_samples - 1;\n            curve[i] = (3 + k) * x * 20 * deg / (Math.PI + k * Math.abs(x));\n        }\n        return curve;\n    }\n\n    stopSound(sound) {\n        if (!sound) return;\n        \n        const now = this.audioContext.currentTime;\n        \n        if (sound.gainNode) {\n            sound.gainNode.gain.cancelScheduledValues(now);\n            sound.gainNode.gain.setValueAtTime(sound.gainNode.gain.value || 0, now);\n            sound.gainNode.gain.linearRampToValueAtTime(0, now + 0.05);\n        }\n        \n        if (sound.source) {\n            try {\n                sound.source.stop(now + 0.06);\n            } catch (e) {\n                console.warn('Error stopping source:', e);\n            }\n        }\n        \n        if (sound.noiseSource) {\n            try {\n                sound.noiseSource.stop(now + 0.06);\n            } catch (e) {\n                console.warn('Error stopping noise source:', e);\n            }\n        }\n        \n        sound.active = false;\n        this.activeSounds.delete(sound);\n    }\n\n    stopAllSounds() {\n        this.activeSounds.forEach(sound => {\n            this.stopSound(sound);\n        });\n        this.activeSounds.clear();\n    }\n}"
      },
      "LifeSpan": {
        "fileName": "LifeSpan",
        "script": "class LifeSpan extends engine.Component {\r\n    \r\n    constructor(game, parent, params) {\r\n        super(game, parent, params);\r\n    }\r\n    \r\n    \r\n    init( {lifeSpan}) {\r\n        this.lifeSpan = lifeSpan || this.getComponent('stats').stats.lifeSpan;\r\n    }\r\n    update() {        \r\n        if( this.lifeSpan > 0 ) {\r\n            this.lifeSpan -= this.game.deltaTime;\r\n        } else {\r\n            this.parent.destroy();\r\n        }\r\n    }\r\n}"
      },
      "Game": {
        "fileName": "Game",
        "script": "class Game extends engine.Component {\r\n    \r\n    constructor(game, parent, params) {\r\n        super(game, parent, params);\r\n    }\r\n    \r\n    \r\n        \r\n    init() {\r\n        this.initEffectsAndUpgrades();\r\n        this.gridSize = this.game.config.configs.game.gridSize;\r\n        let endPath = this.game.state.paths[0][this.game.state.paths[0].length - 1];\r\n        let endY = endPath.y;\r\n        let endX = endPath.x;\r\n        this.keep = this.game.spawn(endX * this.gridSize + this.gridSize / 2, \r\n                                endY * this.gridSize + this.gridSize / 2, \"tower\",\r\n                                { spawnType: 'keep', objectType: 'towers', setDirection: 1});\r\n        this.keep.placed = true;\r\n\r\n    }\r\n\r\n    update() {\r\n        this.keep.position.z = this.getTerrainHeight(this.keep.gridPosition);\r\n        if(this.game.config.configs.game.is3D){\r\n            this.getComponent(\"MapRenderer\")?.render(this.game.state.tileMapData, this.game.state.paths);\r\n        } else {\r\n            this.getComponent(\"MapRenderer\")?.renderBG(this.game.state.tileMapData, this.game.state.paths);\r\n        }\r\n        \r\n        if (!this.game.state.isPaused) {\r\n            this.currentTime = Date.now();\r\n\r\n            // Only update if a reasonable amount of time has passed\r\n            const timeSinceLastUpdate = this.currentTime - this.lastTime;\r\n\r\n            // Skip update if more than 1 second has passed (tab was inactive)\r\n            if (timeSinceLastUpdate > 1000) {\r\n                this.lastTime = this.currentTime; // Reset timer without updating\r\n                return;\r\n            }\r\n\r\n            this.game.deltaTime = Math.min(1/30, timeSinceLastUpdate / 1000); // Cap at 1/30th of a second        \r\n            this.lastTime = this.currentTime;\r\n\r\n            // Sort entities by y position for proper drawing order\r\n            this.game.state.entities.sort((a, b) => {\r\n                return (a.position.y * this.game.state.tileMap.length + a.position.x) - (b.position.y * this.game.state.tileMap.length + b.position.x)\r\n            });\r\n\r\n            this.game.state.stats = {...this.game.state.defaultStats};//reset stats to recalculate upgrades from base stats.\r\n            // Single loop through entities for update, draw and postUpdate\r\n            const entitiesToKeep = [];\r\n            for(let i = 0; i < this.game.state.entities.length; i++) {\r\n                let e = this.game.state.entities[i];\r\n                let result = e.update();    \r\n                \r\n                if(result) {\r\n                    entitiesToKeep.push(e);\r\n                    e.draw();\r\n                    e.postUpdate();\r\n                }\r\n            }\r\n            \r\n            // Replace the entities array with only entities that should be kept\r\n            this.game.state.entities = entitiesToKeep;\r\n            \r\n            this.postUpdate();\r\n            // Add any new entities\r\n            this.game.entitiesToAdd.forEach((entity) => this.game.state.addEntity(entity));\r\n            this.game.entitiesToAdd = [];\r\n        }     \r\n        if(!this.game.config.configs.game.is3D){\r\n            this.getComponent(\"MapRenderer\")?.renderFG(this.game.state.tileMapData, this.game.state.paths);\r\n        }   \r\n        \r\n    }\r\n\r\n    getTerrainHeight(gridPosition) {\r\n        if(this.game.state.tileMap.length > gridPosition.y && gridPosition.y > 0 && this.game.state.tileMap[Math.floor(gridPosition.y)] && this.game.state.tileMap[Math.floor(gridPosition.y)].length > gridPosition.x && gridPosition.x > 0){\r\n            const tile = this.game.state.tileMap[Math.floor(gridPosition.y)][Math.floor(gridPosition.x)];\r\n            if (!tile) {\r\n                return 0;\r\n            }\r\n            \r\n            const terrainHeight = tile.typeId * this.game.heightMapConfig.heightStep;\r\n            return terrainHeight;\r\n        }\r\n        return 0;\r\n    }\r\n    postUpdate() {\r\n        \r\n            if (this.game.state.gameOver || this.game.state.victory || this.game.state.isLevelingUp) return;\r\n                    \r\n            // Game over check\r\n            if (this.game.state.bloodCoreHP <= 0 && !this.game.state.gameOver) {\r\n                this.gameOver();\r\n            }\r\n    }\r\n\r\n\r\n    // Game-over and victory functions\r\n    gameOver() {\r\n        this.game.state.gameOver = true;\r\n        this.game.state.isPaused = true;\r\n        gameOverWave.textContent = this.game.state.round + 1;\r\n        gameOverMenu.style.display = 'block';\r\n        overlay.style.display = 'block';\r\n    }\r\n\r\n    gameVictory() {\r\n        this.game.state.victory = true;\r\n        this.game.state.isPaused = true;\r\n        victoryMenu.style.display = 'block';\r\n        overlay.style.display = 'block';\r\n    }\r\n\r\n\r\n    // Tower placement system\r\n  \r\n\r\n    initEffectsAndUpgrades() {\r\n\r\n        const Upgrade = class { \r\n            constructor(id, title, desc, icon, appliesTo, condition, apply, onAcquire) {\r\n                this.id = id;\r\n                this.title = title;\r\n                this.desc = desc;\r\n                this.icon = icon;\r\n                this.appliesTo = appliesTo;\r\n                this.conditionFn = condition;\r\n                this.applyFn = apply;\r\n                this.onAcquire = onAcquire;        \r\n            }\r\n\r\n            canApply(gameState) {\r\n                return this.conditionFn(gameState);\r\n            }\r\n\r\n            apply(s, add, mul) {\r\n                this.applyFn(s, add, mul);\r\n            }\r\n        }\r\n\r\n\r\n        this.game.effects = {\r\n            slow: (stats, additiveStats, multiplicitiveStats, slowAmount) => {\r\n                stats[this.game.config.effects.slow.stat] *= slowAmount;\r\n            }\r\n        }\r\n        this.game.upgrades = [\r\n            // Bat Swarm Upgrades\r\n            new Upgrade(\r\n                'sentryFrenzy',\r\n                'Sentry Frenzy',\r\n                'Sentry Swarm: ' + this.game.config.upgrades.sentryFrenzy.desc,\r\n                '',\r\n                'sentry',\r\n                (state) => true,\r\n                (stats, additiveStats, multiplicitiveStats) => {\r\n                    multiplicitiveStats['attackSpeed'].push(this.game.config.upgrades.sentryFrenzy.value);\r\n                }\r\n            ),\r\n            new Upgrade(\r\n                'sentryIntelligence',\r\n                'Sentry Intelligence',\r\n                'Sentry Swarm: ' + this.game.config.upgrades.sentryIntelligence.desc,\r\n                '',\r\n                'sentry',\r\n                (state) => true,\r\n                (stats, additiveStats, multiplicitiveStats) => {            \r\n                    multiplicitiveStats['damage'].push(this.game.config.upgrades.sentryIntelligence.damage);\r\n                    multiplicitiveStats['range'].push(this.game.config.upgrades.sentryIntelligence.range);        \r\n                }\r\n            ),\r\n\r\n            // Necromancer Upgrades\r\n            new Upgrade(\r\n                'necroSummon',\r\n                'Raise Dead',\r\n                'Necromancer: ' + this.game.config.upgrades.necroSummon.desc,\r\n                '',\r\n                'fabricator',\r\n                (state) => true,\r\n                (stats, additiveStats, multiplicitiveStats) => {\r\n                    stats.summonChance = 1;\r\n                    if(!additiveStats.summonChance) additiveStats.summonChance = [];\r\n                    additiveStats['summonChance'].push(this.game.config.upgrades.necroSummon.summonChance);\r\n                }\r\n            ),\r\n\r\n            // Shadow Turret Upgrades\r\n            new Upgrade(\r\n                'overCharge',\r\n                'Overcharge',\r\n                'Tesla Coil: ' + this.game.config.upgrades.overCharge.desc,\r\n                '',\r\n                'teslaCoil',\r\n                (state) => true,\r\n                (stats, additiveStats, multiplicitiveStats) => {\r\n                    additiveStats['range'].push(this.game.config.upgrades.overCharge.range);\r\n                }\r\n            ),\r\n\r\n            // Soul Pyre Upgrades\r\n            new Upgrade(\r\n                'pyreSoul',\r\n                'Radiant Soul',\r\n                'Soul Pyre: ' + this.game.config.upgrades.pyreSoul.desc,\r\n                '',\r\n                'soulPyre',\r\n                (state) => true,\r\n                (stats, additiveStats, multiplicitiveStats) => {\r\n                    additiveStats['splashRadius'].push(this.game.config.upgrades.pyreSoul.splashRadius);\r\n                }\r\n            ),\r\n\r\n            // Mist Shrine Upgrades\r\n            new Upgrade(\r\n                'mistSlow',\r\n                'Chilling Mist',\r\n                'Mist Shrine: ' + this.game.config.upgrades.mistSlow.desc,\r\n                '',\r\n                'mistShrine',\r\n                (state) => true,\r\n                (stats, additiveStats, multiplicitiveStats) => {\r\n                    multiplicitiveStats['slowAmount'].push(this.game.config.upgrades.mistSlow.slowAmount);\r\n                }\r\n            ),\r\n            // Global Upgrades\r\n            new Upgrade(\r\n                'homeReinforcement',\r\n                'Reinforcement',\r\n                this.game.config.upgrades.bloodCore.desc,\r\n                '',\r\n                'global',\r\n                (state) => true,\r\n                (stats) => {\r\n                    stats.maxBloodCoreHP *= this.game.config.upgrades.bloodCore.maxHpMultiplier;\r\n                },\r\n                (state) => {\r\n                    state.bloodCoreHP = Math.min(state.stats.maxBloodCoreHP, state.bloodCoreHP + this.game.config.upgrades.bloodCore.healAmount);\r\n                }\r\n            ),\r\n            new Upgrade(\r\n                'essenceExtraction',\r\n                'Essence Extraction',\r\n                this.game.config.upgrades.essenceExtraction.desc,\r\n                '',\r\n                'global',\r\n                (state) => true,\r\n                (stats) => {\r\n                    stats.essenceMultiplier *= this.game.config.upgrades.essenceExtraction.value;\r\n                }\r\n            ),\r\n            new Upgrade(\r\n                'essenceOverflow',\r\n                'Essence Overflow',\r\n                this.game.config.upgrades.essenceOverflow.desc,\r\n                '',\r\n                'global',\r\n                (state) => state.bloodCoreHP > state.stats.maxBloodCoreHP / 2,\r\n                (stats) => {\r\n                    stats.essenceMultiplier *= this.game.config.upgrades.essenceOverflow.value;\r\n                }\r\n            ),\r\n\r\n        ];\r\n\r\n    }\r\n}"
      },
      "HitEffectParticle": {
        "fileName": "HitEffectParticle",
        "script": "class HitEffectParticle extends engine.Component {\r\n    \r\n    constructor(game, parent, params) {\r\n        super(game, parent, params);\r\n    }\r\n    \r\n    \r\n  init( {damageType}) {\r\n        this.damageType = damageType || \"default\";\r\n        this.particles = [];\r\n        \r\n        // Spawn particles based on damage type\r\n        const particleCount = 5;\r\n        for (let i = 0; i < particleCount; i++) {\r\n            this.particles.push({\r\n                x: 0, // Relative to parent\r\n                y: 0,\r\n                vx: (Math.random() - 0.5) * 4, // Velocity (-2 to 2)\r\n                vy: (Math.random() - 0.5) * 4,\r\n                size: Math.random() * 3 + 1, // 1-4 pixels\r\n                alpha: 1, // Fades from 1 to 0\r\n                color: this.getColor()\r\n            });\r\n        }\r\n    }\r\n\r\n    getColor() {\r\n        switch (this.damageType) {\r\n            case \"electric\": return \"rgba(0, 255, 255, \"; // Cyan for electric\r\n            case \"fire\": return \"rgba(255, 165, 0, \"; // Orange for fire\r\n            case \"ice\": return \"rgba(128, 128, 255, \"; // Blue for ice\r\n            case \"plasma\": return \"rgba(255, 0, 255, \"; // Purple for plasma\r\n            default: return \"rgba(255, 255, 255, \"; // White fallback\r\n        }\r\n    }\r\n\r\n    update() {\r\n        const lifespanComp = this.parent.getComponent(\"LifeSpan\");\r\n        if (!lifespanComp) return; // Safety check\r\n\r\n        const fadeFactor = lifespanComp.lifeSpan / 30; // Normalize to initial lifespan (30 frames)\r\n        for (let particle of this.particles) {\r\n            particle.x += particle.vx * this.game.state.timeScale;\r\n            particle.y += particle.vy * this.game.state.timeScale;\r\n            particle.alpha = fadeFactor; // Fade based on remaining lifespan\r\n            particle.size *= 0.98; // Slight shrink per frame\r\n        }\r\n    }\r\n}"
      },
      "PlanckWorld": {
        "fileName": "PlanckWorld",
        "script": "class PlanckWorld extends engine.Component {\r\n    \r\n    constructor(game, parent, params) {\r\n        super(game, parent, params);\r\n    }\r\n    \r\n    \r\n//planckWorld component\r\ninit({gravity = 10, gravityX = 0, gravityY = 0}) {\r\n  this.velocityIterations = 6;\r\n  this.positionIterations = 2;\r\n  this.physicsUpdateTimer = 0;\r\n  this.timeStep = 1 / 60; // Fixed timestep of 60fps\r\n  \r\n   const { World } = planck;\r\n    this.game.planckWorld = new World();\r\n}\r\n\r\npostUpdate() {\r\n    this.game.planckWorld.step(this.timeStep, this.velocityIterations, this.positionIterations);\r\n}\r\n}"
      },
      "WaveManager": {
        "fileName": "WaveManager",
        "title": "AudioManager",
        "script": "class WaveManager extends engine.Component {\r\n    \r\n    constructor(game, parent, params) {\r\n        super(game, parent, params);\r\n    }\r\n    \r\n    \r\n    init() {   \r\n        \r\n        this.resetWaveState();\r\n    }\r\n\r\n    resetWaveState() {\r\n        this.game.state.waveSets = this.game.config.levels[this.game.state.level].wavesets;\r\n        this.game.state.currentWaveIds = [];\r\n        this.game.state.currentWaveEnemies = [];\r\n        this.game.state.enemiesSpawned = [];\r\n        this.game.state.spawnTimers = []; // Array for individual spawn timers\r\n        this.game.state.spawnRate = 1;    // Base spawn rate (can be modified per waveset if needed)\r\n        this.game.state.waveTimer = 0;\r\n        this.game.state.startDelayTimer = 0;\r\n        this.game.state.round = 0;\r\n    }\r\n\r\n    update() {\r\n        // Skip wave updates if game is over or in certain states\r\n        if (this.game.state.gameOver || this.game.state.victory || this.game.state.isLevelingUp) return;\r\n\r\n        this.game.state.startDelayTimer += this.game.deltaTime;\r\n\r\n        // Process all wavesets in parallel\r\n        for (let i = 0; i < this.game.state.currentWaveIds.length; i++) {\r\n            let waveSet = this.game.config.wavesets[this.game.state.waveSets[i]];\r\n            \r\n            // Skip if still in start delay\r\n            if (waveSet.startDelay && this.game.state.startDelayTimer < waveSet.startDelay) continue;\r\n            \r\n            if(this.game.deltaTime){\r\n            // Update individual spawn timer for this waveset\r\n                this.game.state.spawnTimers[i] += this.game.deltaTime;\r\n            }\r\n            // If this waveset still has enemies to spawn\r\n            if (this.game.state.enemiesSpawned[i] < this.game.state.currentWaveEnemies[i].length) {\r\n                if (this.game.state.spawnTimers[i] >= this.game.state.spawnRate) {\r\n                    // Create enemy from the appropriate waveset using the enemy type and start point index\r\n                    const enemyType = this.game.state.currentWaveEnemies[i][this.game.state.enemiesSpawned[i]];\r\n                    const startPointIndex = i;\r\n                    \r\n                    \r\n        \t\t\t\t\t  this.game.spawn(0, 0, 'enemy', { objectType: \"enemies\", spawnType: enemyType, pathIndex: startPointIndex, friction: 1000, density: 1000});\r\n                    this.game.state.enemiesSpawned[i]++;\r\n                    this.game.state.spawnTimers[i] = 0; // Reset this waveset's timer\r\n                    \r\n                    // Calculate total progress across all wavesets\r\n                    const totalEnemies = this.game.state.currentWaveEnemies.reduce((sum, wave) => sum + wave.length, 0);\r\n                    const totalSpawned = this.game.state.enemiesSpawned.reduce((sum, count) => sum + count, 0);\r\n                    \r\n                    // Update wave progress bar\r\n                    document.getElementById('waveProgress').style.width = (totalSpawned / totalEnemies * 100) + '%';\r\n                }\r\n            }\r\n        }\r\n        \r\n        // Check if all wavesets have completed spawning\r\n        const allWavesetsComplete = this.game.state.enemiesSpawned.every((spawned, index) => \r\n            spawned >= this.game.state.currentWaveEnemies[index].length\r\n        );\r\n        \r\n        // Move to next wave if all enemies defeated and all wavesets have completed spawning\r\n        if (this.game.state.enemies.length === 0 && allWavesetsComplete) {\r\n            this.game.state.waveTimer++;\r\n            \r\n            if (this.game.state.waveTimer >= this.game.state.waveDelay) {\r\n                this.startNextWave();\r\n            }\r\n        }\r\n    }\r\n\r\n    startNextWave() {\r\n        document.getElementById('waveDisplay').textContent = this.game.state.round + 1;\r\n        \r\n        this.game.state.currentWaveIds = [];\r\n        this.game.state.currentWaveEnemies = [];\r\n        this.game.state.enemiesSpawned = [];\r\n        this.game.state.spawnTimers = [];\r\n        \r\n        let totalWaves = 0;\r\n        for (let i = 0; i < this.game.state.waveSets.length; i++) {\r\n            const waveSetId = this.game.state.waveSets[i];\r\n            const waveSet = this.game.config.wavesets[waveSetId];\r\n            \r\n            // Check if this waveset has enough waves for the current round\r\n            if (this.game.state.round < waveSet.waves.length) {\r\n                const currentWaveId = waveSet.waves[this.game.state.round];\r\n                \r\n                // Add this wave to the current active waves\r\n                this.game.state.currentWaveIds.push(currentWaveId);\r\n                this.game.state.currentWaveEnemies.push(this.game.config.waves[currentWaveId].enemies);\r\n                this.game.state.enemiesSpawned.push(0);\r\n                this.game.state.spawnTimers.push(0); // Initialize spawn timer for this waveset\r\n            }\r\n            \r\n            totalWaves = Math.max(totalWaves, waveSet.waves.length);\r\n        }\r\n        \r\n        // If all wavesets are exhausted, end the game\r\n        if (this.game.state.currentWaveIds.length === 0) {\r\n            this.game.state.victory = true;\r\n            this.game.state.isPaused = true;\r\n            document.getElementById('victoryMenu').style.display = 'block';\r\n            document.getElementById('overlay').style.display = 'block';\r\n            return;\r\n        }\r\n        \r\n        this.game.state.maxWaves = totalWaves;\r\n        this.game.state.spawnRate = 5;\r\n        this.game.state.waveTimer = 0;\r\n        this.game.state.startDelayTimer = 0;\r\n        \r\n        // Reset wave progress bar\r\n        document.getElementById('waveProgress').style.width = '0%';\r\n        this.game.state.round++;\r\n    }\r\n}"
      },
      "Stats": {
        "fileName": "Stats",
        "script": "class Stats extends engine.Component {\r\n    \r\n    constructor(game, parent, params) {\r\n        super(game, parent, params);\r\n    }\r\n    \r\n    \r\n  init( {objectType, spawnType} ) {        \r\n        \r\n        let stats = this.game.config[objectType][spawnType];\r\n        this.type = spawnType;\r\n        this.stats = {...stats};\r\n        this.defaultStats = {...this.stats};\r\n        this.activeEffects = {};\r\n    }\r\n    update() {\r\n        this.stats = {...this.defaultStats};\r\n        this.applyEffects();\r\n        this.applyUpgrades();\r\n    }\r\n    addStat(statName, statValue) {\r\n        this.stats[statName] = statValue;\r\n        this.defaultStats[statName] = statValue;\r\n    }\r\n    addEffect(effectConfig, effectFn, effectAmt) {        \r\n        this.activeEffects[effectConfig.id] = this.parent.addComponent(\"effect\", { config: effectConfig, applyFn: effectFn, amount: effectAmt });\r\n    }\r\n    applyEffects() {\r\n        let effectArr = [];\r\n        for(let effectId in this.activeEffects) {\r\n            if(this.activeEffects[effectId] && this.activeEffects[effectId].lifeTime > 0){\r\n                effectArr.push(this.activeEffects[effectId]);\r\n            } else {\r\n                this.activeEffects[effectId] = undefined;\r\n            }\r\n        }        \r\n        \r\n        engine.getFunction(\"calculateStats\")(this.stats, effectArr);\r\n    }\r\n    \r\n    applyUpgrades() {\r\n        engine.getFunction(\"calculateStats\")(this.stats, this.game.state.activeUpgrades[this.type]);        \r\n    }\r\n}"
      },
      "BallisticProjectile": {
        "fileName": "BallisticProjectile",
        "script": "class BallisticProjectile extends engine.Component {\r\n    \r\n    constructor(game, parent, params) {\r\n        super(game, parent, params);\r\n    }\r\n    \r\n    \r\ninit({ spawnType, owner, target, stats }) {\r\n    this.type = spawnType;\r\n    this.def = this.game.config.projectiles[this.type];\r\n    this.owner = owner;\r\n    this.target = target;\r\n    this.stats = stats;\r\n    this.piercedEnemies = [];\r\n    this.ownerStats = this.owner.getComponent(\"stats\").stats;\r\n    this.distanceTraveled = 0;\r\n    this.distanceToSpawnParticle = 1;\r\n    \r\n    // Ballistic trajectory variables\r\n    this.startPosition = { ...this.parent.position, z: 10 }; // Start 10 units above ground\r\n    this.targetPosition = { ...this.target.position, z: 0 };\r\n    this.time = 0;\r\n    \r\n    this.totalDist = Math.sqrt(\r\n        (this.targetPosition.x - this.startPosition.x) ** 2 + \r\n        (this.targetPosition.y - this.startPosition.y) ** 2\r\n    );\r\n    this.maxHeight = this.totalDist / Math.PI;\r\n    \r\n    // Initialize position with Z component\r\n    this.parent.position.z = this.startPosition.z;\r\n    this.positionZ = this.startPosition.z;\r\n    \r\n    // Animation state variables\r\n    this.lastZPosition = this.positionZ;\r\n\r\n    \r\n    this.peakThreshold = this.maxHeight * 0.1; // 10% threshold for idle at peak\r\n    this.currentAnimState = 'ascend';\r\n    if(this.stats.attackSound){\r\n        this.game.audioManager.playSound('attackSounds', this.stats.attackSound);\r\n    }\r\n}\r\n\r\nsetAnimation(anim) {\r\n\r\n    if(this.game.config.configs.game.is3D) {\r\n        this.modelRenderer = this.parent.getComponent('modelRenderer');\r\n        this.modelRenderer?.setAnimation(anim);\r\n    } else {\r\n        this.animator = this.parent.getComponent('animator');\r\n        this.animator?.setAnimation(anim);\r\n    }\r\n}\r\n\r\nupdate() {\r\n    this.parent.position.z = this.positionZ;\r\n    \r\n    // Save previous z position to detect direction change\r\n    this.lastZPosition = this.positionZ;\r\n\r\n    // Calculate progress (0 to 1)\r\n    this.time += this.game.deltaTime;\r\n    const dx = this.targetPosition.x - this.parent.position.x;\r\n    const dy = this.targetPosition.y - this.parent.position.y;\r\n    const distSq = dx * dx + dy * dy;\r\n    let dist = Math.sqrt(distSq);\r\n    const speed = this.stats.speed;\r\n    this.parent.position.x += (dx / dist) * speed / (Math.PI);\r\n    this.parent.position.y += (dy / dist) * speed / (Math.PI);\r\n\r\n\r\n    const currentDist = Math.sqrt(\r\n        (this.parent.position.x - this.startPosition.x) ** 2 + \r\n        (this.parent.position.y - this.startPosition.y) ** 2\r\n    );\r\n    const xyprogressToTarget = Math.min(1, currentDist / this.totalDist);\r\n\r\n    // Parabolic trajectory calculation (2:1 isometric adjusted)\r\n    this.parent.position.z = this.maxHeight * (1 - Math.pow(2 * xyprogressToTarget - 1, 2));\r\n\r\n    this.positionZ = this.parent.position.z;\r\n    \r\n    // Calculate distance from peak height to determine if we're near the top\r\n    const distanceFromPeak = Math.abs(this.positionZ - this.maxHeight);\r\n    \r\n    // Check if animation state needs to change based on z movement and proximity to peak\r\n    if( xyprogressToTarget < .075 ) {\r\n        if (this.currentAnimState !== 'launch') {\r\n            this.setAnimation('launch');\r\n            this.currentAnimState = 'launch';\r\n        }\r\n    // } else if( xyprogressToTarget > .95 ) {\r\n    //     if (this.currentAnimState !== 'land') {\r\n    //         this.animator.setAnimation('land');\r\n    //         this.currentAnimState = 'land';\r\n    //     }\r\n    } else if (distanceFromPeak <= this.peakThreshold) {\r\n        // We're near the peak of the trajectory\r\n        if (this.currentAnimState !== 'idle') {\r\n            this.setAnimation('idle');\r\n            this.currentAnimState = 'idle';\r\n        }\r\n    } else if (this.positionZ < this.lastZPosition) {\r\n        // We're descending and not near the peak\r\n        if (this.currentAnimState !== 'descend') {\r\n            this.setAnimation('descend');\r\n            this.currentAnimState = 'descend';\r\n        }\r\n    } else if (this.positionZ > this.lastZPosition) {\r\n        // We're ascending and not near the peak\r\n        if (this.currentAnimState !== 'ascend') {\r\n            this.setAnimation('ascend');\r\n            this.currentAnimState = 'ascend';\r\n        }\r\n    }\r\n    \r\n    // Check if we've hit the ground (Z <= 0)\r\n    if (this.parent.position.z <= 0) {\r\n        this.parent.position.z = 0; // Snap to ground\r\n\r\n        // Hit detection - same as before but at current position\r\n        const targetDistSq = (this.parent.position.x - this.target.position.x) ** 2 + \r\n                            (this.parent.position.y - this.target.position.y) ** 2;\r\n\r\n\r\n\r\n            // We missed the target but hit the ground - maybe still do splash damage\r\n        if (this.stats.splashRadius > 0) {\r\n            this.processSplashDamage();\r\n        }\r\n        this.parent.destroy();\r\n        if(this.stats.hitSound){\r\n            this.game.audioManager.playSound('hitSounds', this.stats.hitSound);\r\n        }\r\n\r\n        return;\r\n    }\r\n    \r\n    // Update distance traveled for particles\r\n    const tDx = this.parent.lastPosition.x - this.parent.position.x;\r\n    const tDy = this.parent.lastPosition.y - this.parent.position.y;\r\n    const tDist = Math.sqrt(tDx * tDx + tDy * tDy);\r\n    this.distanceTraveled += tDist;\r\n    \r\n    if (this.def.particle && this.distanceTraveled > this.distanceToSpawnParticle) {\r\n\r\n        let particle = this.game.spawn(this.parent.lastPosition.x + Math.random() * 4 - 2, this.parent.lastPosition.y + Math.random() * 4 - 2, \"particle\", { objectType: \"particles\", spawnType: this.def.particle });\r\n        particle.position.z = this.parent.position.z + Math.random() * 4 - 2;\r\n        this.distanceTraveled = 0;\r\n        this.distanceToSpawnParticle += Math.random() * 2;\r\n    }\r\n}\r\n\r\n\r\nprocessSplashDamage() {\r\n    const nearbyEnemies = this.game.spatialGrid.getNearbyEntities(\r\n        this.parent.gridPosition.x, \r\n        this.parent.gridPosition.y, \r\n        this.stats.splashRadius,\r\n        \"enemy\"\r\n    );\r\n    let explosion = this.game.spawn(this.parent.position.x, this.parent.position.y, \"explosion\", { radius: this.stats.splashRadius });\r\n    for (const enemy of nearbyEnemies) {\r\n        if (enemy.isDead) continue;\r\n        \r\n        const dx = enemy.position.x - this.parent.position.x;\r\n        const dy = enemy.position.y - this.parent.position.y;\r\n        const distSq = dx * dx + dy * dy;\r\n        \r\n        let gridSize = this.game.config.configs.game.gridSize;\r\n        const splashRadiusSq = this.stats.splashRadius * this.stats.splashRadius * gridSize * gridSize;\r\n        \r\n        if (distSq <= splashRadiusSq) {\r\n            let enemyHealth = enemy.getComponent(\"health\");\r\n            let enemyEnergyShield = enemy.getComponent(\"energyshield\");\r\n            let enemyStats = enemy.getComponent(\"stats\");\r\n            let enemyStatClone = { ...enemyStats.stats };\r\n            enemyStatClone.energyShield = enemyEnergyShield.energyShield;\r\n            \r\n            let damageResult = engine.getFunction(\"calculateDamage\")(this.stats, enemyStatClone);\r\n            if (!damageResult.wasEvaded) {\r\n                enemyHealth.hp -= damageResult.damageDealt;\r\n                enemyEnergyShield.absorbDamage(damageResult.damageAbsorbed);\r\n                this.game.spawn(enemy.position.x, enemy.position.y, \"hitEffect\", { damageType: this.stats.damageType , lifeSpan: .3});\r\n                if (this.ownerStats.slowAmount) {\r\n                    enemyStats.addEffect(this.game.config.effects.slow, this.game.effects.slow, this.ownerStats.slowAmount);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n}"
      },
      "PlanckBody": {
        "fileName": "PlanckBody",
        "script": "class PlanckBody extends engine.Component {\r\n    \r\n    constructor(game, parent, params) {\r\n        super(game, parent, params);\r\n    }\r\n    \r\n    \r\ninit({box2DBodySize = 1, density = 1, friction= 0, layer = 0x0001, collidesWith = 0x0001}) {\r\n  \r\n   const { Box } = planck;\r\n  this.body = this.game.planckWorld.createBody({\r\n    type: \"dynamic\",\r\n    position: {x: this.parent.position.x, y: this.parent.position.y}\r\n  });\r\n  this.body.createFixture({\r\n      shape: new Box(1.0, 1.0),\r\n      density: density,\r\n      friction: friction,\r\n  });\r\n  this.speedScale = 10;\r\n}\r\n\r\nupdate() {\r\n  if (!this.body) return;\r\n  const bodyPos = this.body.getTransform().p;\r\n\r\n  // Update game object position\r\n  this.parent.position.x = bodyPos.x;\r\n  this.parent.position.y = bodyPos.y;\r\n\r\n}\r\n\r\nsetVelocity(vel) {\r\n\tthis.body.setLinearVelocity({ x: vel.x*this.speedScale, y: vel.y * this.speedScale });\r\n}\r\ngetVelocity() {\r\n  let vel = this.body.getLinearVelocity();\r\n  return { x: vel.x / this.speedScale, y: vel.y / this.speedScale };\r\n}\r\npostUpdate() {\r\n  //this.body.applyForce({ x: 10, y: 0}, { x: this.parent.position.x, y: this.parent.position.y});\r\n}\r\n}"
      },
      "PopulationBurden": {
        "fileName": "PopulationBurden",
        "script": "class PopulationBurden extends engine.Component {\r\n    \r\n    constructor(game, parent, params) {\r\n        super(game, parent, params);\r\n    }\r\n    \r\n    \r\n    init(){\r\n        this.stats = this.parent.getComponent('stats').stats;        \r\n    }\r\n    update() {\r\n        if(this.stats){ \r\n            if( this.stats.population ) {\r\n                this.game.state.stats.population += this.stats.population;\r\n            } \r\n            if( this.stats.supply ) {\r\n                this.game.state.stats.maxPopulation += this.stats.supply;\r\n            }\r\n        }\r\n    }\r\n}"
      },
      "PlanckProjectile": {
        "fileName": "PlanckProjectile",
        "script": "class PlanckProjectile extends engine.Component {\r\n    \r\n    constructor(game, parent, params) {\r\n        super(game, parent, params);\r\n    }\r\n    \r\n    \r\ninit({ spawnType, owner, target, targetPosition, stats }) {\r\n  this.type = spawnType;\r\n  this.def = this.game.config.projectiles[this.type];\r\n  this.owner = owner;\r\n  this.target = target;\r\n  this.targetPosition = targetPosition;\r\n  this.stats = stats;\r\n  this.piercedEnemies = [];\r\n  this.ownerStats = this.owner.getComponent(\"stats\").stats;\r\n  this.distanceTraveled = 0;\r\n  this.distanceToSpawnParticle = 24;\r\n\r\n  // Add lifespan for projectile\r\n  this.maxLifespan = this.stats.lifespan || 5; // Default to 5 seconds\r\n  this.currentLifespan = 0;\r\n  \r\n  // Get the planck body from the component\r\n  this.planckBody = this.parent.getComponent('planckBody');\r\n  \r\n  // Calculate direction and set velocity\r\n  const currentPosition = {\r\n    x: this.parent.position.x,\r\n    y: this.parent.position.y\r\n  };\r\n  \r\n  const targetPos = this.targetPosition ? this.targetPosition : this.target.position;\r\n  const dx = targetPos.x - currentPosition.x;\r\n  const dy = targetPos.y - currentPosition.y;\r\n  const dist = Math.sqrt(dx * dx + dy * dy);\r\n  \r\n  // Normalize direction and multiply by speed\r\n  this.speed = this.stats.speed;\r\n  const velocityX = (dx / dist) * this.speed;\r\n  const velocityY = (dy / dist) * this.speed;\r\n  \r\n  // Set the linear velocity on the planck body\r\n  this.planckBody.setVelocity({ x: velocityX, y: velocityY });\r\n  \r\n  // Store a reference to this projectile in the body's user data\r\n  this.planckBody.body.setUserData(this);\r\n  \r\n  // Setup contact listener if not already done\r\n  if (!this.game.contactListenerSetup) {\r\n    this.setupContactListener();\r\n    this.game.contactListenerSetup = true;\r\n  }\r\n}\r\n\r\nsetupContactListener() {\r\n  const world = this.game.planckWorld;\r\n  \r\n  world.on('begin-contact', (contact) => {\r\n    const fixtureA = contact.getFixtureA();\r\n    const fixtureB = contact.getFixtureB();\r\n    \r\n    const bodyA = fixtureA.getBody();\r\n    const bodyB = fixtureB.getBody();\r\n    \r\n    const entityA = bodyA.getUserData();\r\n    const entityB = bodyB.getUserData();\r\n    \r\n    // Check if one is a projectile and one is an enemy\r\n    if (entityA && entityB) {\r\n      let projectile = null;\r\n      let enemy = null;\r\n      \r\n      if (entityA.parent && entityA.parent.type === \"projectile\" && !entityB.parent) {\r\n        projectile = entityA;\r\n        enemy = entityB;\r\n\r\n      } else if (entityB.parent && entityB.parent.type === \"projectile\" && !entityA.parent) {\r\n        projectile = entityB;\r\n        enemy = entityA;        \r\n      }\r\n      \r\n      if (projectile && enemy) {\r\n        // Handle collision in the next frame to avoid modifying physics during step\r\n        this.game.queuePostPhysicsCallback(() => {\r\n          projectile.handleEnemyCollision(enemy);\r\n        });\r\n      }\r\n    }\r\n  });\r\n}\r\n\r\nhandleEnemyCollision(enemy) {\r\n  // Skip if already hit this enemy or enemy is dead\r\n  if (enemy.isDead || this.piercedEnemies.includes(enemy)) {\r\n    return;\r\n  }\r\n  \r\n  // Apply damage\r\n  let enemyHealth = enemy.getComponent(\"health\");\r\n  let enemyEnergyShield = enemy.getComponent(\"energyshield\");\r\n  let enemyStats = enemy.getComponent(\"stats\");\r\n  let enemyStatClone = { ...enemyStats.stats };\r\n  enemyStatClone.energyShield = enemyEnergyShield.energyShield;\r\n\r\n  // Apply damage\r\n  let damageResult = engine.getFunction(\"calculateDamage\")(this.stats, enemyStatClone);\r\n  if (!damageResult.wasEvaded) {\r\n    enemyHealth.hp -= damageResult.damageDealt;\r\n    enemyEnergyShield.absorbDamage(damageResult.damageAbsorbed);\r\n    this.game.spawn(enemy.position.x, enemy.position.y, \"hitEffect\", {\r\n      damageType: this.stats.damageType,\r\n      lifeSpan: 0.3\r\n    });\r\n    if (this.ownerStats.slowAmount) {\r\n      enemyStats.addEffect(\r\n        this.game.config.effects.slow,\r\n        this.game.effects.slow,\r\n        this.ownerStats.slowAmount\r\n      );\r\n    }\r\n  }\r\n\r\n  // Special effects logic (summon, leech, thief)\r\n  if (\r\n    this.ownerStats.summonChance > 0 &&\r\n    enemyHealth.hp <= 0 &&\r\n    Math.random() < this.ownerStats.summonChance - 1\r\n  ) {\r\n    this.game.spawn(enemy.position.x, enemy.position.y, \"summonedTower\", {\r\n      objectType: \"towers\",\r\n      spawnType: this.ownerStats.summonType,\r\n      owner: this.owner\r\n    });\r\n  }\r\n  if (this.ownerStats.leech > 0) {\r\n    const healing = this.stats.damage * this.ownerStats.leech * this.game.state.stats.healingMultiplier;\r\n    this.game.state.bloodCoreHP = Math.min(\r\n      this.game.state.stats.maxBloodCoreHP,\r\n      this.game.state.bloodCoreHP + healing\r\n    );\r\n  }\r\n  if (this.ownerStats.thief && this.ownerStats.thief != 0) {\r\n    const stealAmt = this.stats.damage * this.ownerStats.thief * this.game.state.stats.bloodShardMultiplier;\r\n    this.game.state.bloodShards += stealAmt;\r\n  }\r\n\r\n  // Splash damage if applicable\r\n  if (this.stats.splashRadius > 0) {\r\n    this.applySplashDamage(enemy);\r\n    this.game.spawn(this.parent.position.x, this.parent.position.y, \"explosion\", {\r\n      radius: this.stats.splashRadius\r\n    });\r\n  }\r\n\r\n  // Piercing logic\r\n  if (this.stats.piercing > 0 && this.piercedEnemies.length < this.stats.piercing) {\r\n    this.piercedEnemies.push(enemy);\r\n    const nearbyEnemies = this.game.spatialGrid.getNearbyEntities(\r\n      this.parent.gridPosition.x,\r\n      this.parent.gridPosition.y,\r\n      this.ownerStats.range,\r\n      \"enemy\"\r\n    );\r\n    const newTarget = this.findNewTarget(nearbyEnemies);\r\n    if (newTarget) {\r\n      this.target = newTarget;\r\n      this.targetPosition = null; // Switch to target-based tracking\r\n      \r\n      // Recalculate velocity toward the new target\r\n      const currentPosition = {\r\n        x: this.parent.position.x,\r\n        y: this.parent.position.y\r\n      };\r\n      \r\n      const dx = newTarget.position.x - currentPosition.x;\r\n      const dy = newTarget.position.y - currentPosition.y;\r\n      const dist = Math.sqrt(dx * dx + dy * dy);\r\n      \r\n      if (dist > 0) {\r\n        const velocityX = (dx / dist) * this.speed;\r\n        const velocityY = (dy / dist) * this.speed;\r\n        this.planckBody.setVelocity({ x: velocityX, y: velocityY });\r\n      }\r\n    } else {\r\n      // No new target, keep going but don't destroy\r\n      return;\r\n    }\r\n  } else {\r\n    // No piercing or reached piercing limit, destroy projectile\r\n    //this.parent.destroy();\r\n  }\r\n}\r\n\r\napplySplashDamage(centerEnemy) {\r\n  // Get nearby enemies within splash radius\r\n  const nearbyEnemies = this.game.spatialGrid.getNearbyEntities(\r\n    this.parent.gridPosition.x,\r\n    this.parent.gridPosition.y,\r\n    this.stats.splashRadius,\r\n    \"enemy\"\r\n  );\r\n  \r\n  const gridSize = this.game.config.configs.game.gridSize;\r\n  const splashRadiusSq = this.stats.splashRadius * this.stats.splashRadius * gridSize * gridSize;\r\n  \r\n  for (const enemy of nearbyEnemies) {\r\n    // Skip the center enemy (already damaged) and dead enemies\r\n    if (enemy === centerEnemy || enemy.isDead || this.piercedEnemies.includes(enemy)) continue;\r\n    \r\n    let enemyHealth = enemy.getComponent(\"health\");\r\n    let enemyEnergyShield = enemy.getComponent(\"energyshield\");\r\n    let enemyStats = enemy.getComponent(\"stats\");\r\n    let enemyStatClone = { ...enemyStats.stats };\r\n    enemyStatClone.energyShield = enemyEnergyShield.energyShield;\r\n\r\n    const dx = enemy.position.x - this.parent.position.x;\r\n    const dy = enemy.position.y - this.parent.position.y;\r\n    const distSq = dx * dx + dy * dy;\r\n\r\n    if (distSq <= splashRadiusSq) {\r\n      let damageResult = engine.getFunction(\"calculateDamage\")(this.stats, enemyStatClone);\r\n      if (!damageResult.wasEvaded) {\r\n        enemyHealth.hp -= damageResult.damageDealt;\r\n        enemyEnergyShield.absorbDamage(damageResult.damageAbsorbed);\r\n        this.game.spawn(enemy.position.x, enemy.position.y, \"hitEffect\", {\r\n          damageType: this.stats.damageType,\r\n          lifeSpan: 0.3\r\n        });\r\n        if (this.ownerStats.slowAmount) {\r\n          enemyStats.addEffect(\r\n            this.game.config.effects.slow,\r\n            this.game.effects.slow,\r\n            this.ownerStats.slowAmount\r\n          );\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nupdate() {\r\n  if(this.target) this.targetCurrentPosition = {...this.target.position };\r\n  \r\n  // Update lifespan and destroy if expired\r\n  this.currentLifespan += this.game.deltaTime;\r\n  if (this.currentLifespan >= this.maxLifespan) {\r\n    this.parent.destroy();\r\n    return;\r\n  }\r\n\r\n  // Remove if target is gone (only if no targetPosition)\r\n  if (!this.targetPosition && (!this.target || this.target.destroyed)) {\r\n    if(this.targetCurrentPosition) {\r\n      this.targetPosition = this.targetCurrentPosition;\r\n      \r\n      // Recalculate velocity toward the last known position\r\n      const currentPosition = {\r\n        x: this.parent.position.x,\r\n        y: this.parent.position.y\r\n      };\r\n      \r\n      const dx = this.targetPosition.x - currentPosition.x;\r\n      const dy = this.targetPosition.y - currentPosition.y;\r\n      const dist = Math.sqrt(dx * dx + dy * dy);\r\n      \r\n      if (dist > 0) {        \r\n        const velocityX = (dx / dist) * this.speed;\r\n        const velocityY = (dy / dist) * this.speed;\r\n        this.planckBody.setVelocity({ x: velocityX, y: velocityY });\r\n      }\r\n    } else {\r\n      this.parent.destroy(); \r\n      return;\r\n    }\r\n  }\r\n    \r\n\r\n\r\n  // Particle spawning logic\r\n  const currentPos = this.planckBody.body.getPosition();\r\n  const currentVel = this.planckBody.body.getLinearVelocity();\r\n  const speed = Math.sqrt(currentVel.x * currentVel.x + currentVel.y * currentVel.y);\r\n  \r\n  // Only spawn particles if the projectile is moving\r\n  if (speed > 0 && this.def.particle) {\r\n    this.distanceTraveled += speed * this.game.deltaTime;\r\n    \r\n    if (this.distanceTraveled > this.distanceToSpawnParticle) {\r\n      this.game.spawn(currentPos.x, currentPos.y, \"particle\", { \r\n        objectType: \"particles\", \r\n        spawnType: this.def.particle\r\n      });\r\n      this.distanceTraveled = 0;\r\n      this.distanceToSpawnParticle = 24 + Math.random() * 3;\r\n    }\r\n  }\r\n}\r\n\r\n// Helper method to find a new target for piercing\r\nfindNewTarget(nearbyEnemies) {\r\n  const gridSize = this.game.config.configs.game.gridSize;\r\n  const rangeSq = this.ownerStats.range * this.ownerStats.range * gridSize * gridSize;\r\n  for (let enemy of nearbyEnemies) {\r\n    if (!enemy.destroyed && !this.piercedEnemies.includes(enemy)) {\r\n      const dx = enemy.position.x - this.parent.position.x;\r\n      const dy = enemy.position.y - this.parent.position.y;\r\n      const distSq = dx * dx + dy * dy;\r\n      if (distSq < rangeSq) {\r\n        return enemy;\r\n      }\r\n    }\r\n  }\r\n  return null;\r\n}\r\n}"
      },
      "Projectile": {
        "fileName": "Projectile",
        "script": "class Projectile extends engine.Component {\r\n    \r\n    constructor(game, parent, params) {\r\n        super(game, parent, params);\r\n    }\r\n    \r\n    \r\ninit({ spawnType, owner, target, targetPosition, stats }) {\r\n  this.type = spawnType;\r\n  this.def = this.game.config.projectiles[this.type];\r\n  this.owner = owner;\r\n  this.target = target;\r\n  this.targetPosition = targetPosition;\r\n  this.stats = stats;\r\n  this.piercedEnemies = [];\r\n  this.ownerStats = this.owner.getComponent(\"stats\").stats;\r\n  this.distanceTraveled = 0;\r\n  this.distanceToSpawnParticle = 24;\r\n\r\n  // Add lifespan for projectile (e.g., 5 seconds)\r\n  this.maxLifespan = this.stats.lifespan || 5; // Default to 5 seconds, adjust as needed\r\n  this.currentLifespan = 0;  \r\n  if(this.stats.attackSound){\r\n    this.game.audioManager.playSound('attackSounds', this.stats.attackSound);\r\n  }\r\n}\r\n\r\nupdate() {\r\n  let hitSoundPlayed = false;\r\n  if(this.target) this.targetCurrentPosition = {...this.target.position };\r\n  // Update lifespan and destroy if expired\r\n  this.currentLifespan += this.game.deltaTime; // Assuming deltaTime is in seconds\r\n  if (this.currentLifespan >= this.maxLifespan) {\r\n    this.parent.destroy();\r\n    return;\r\n  }\r\n\r\n  // Remove if target is gone (only if no targetPosition)\r\n  if (!this.targetPosition && (!this.target || this.target.destroyed)) {\r\n    if(this.targetCurrentPosition) {\r\n    \tthis.targetPosition = this.targetCurrentPosition;\r\n    } else {\r\n     \tthis.parent.destroy(); \r\n    \treturn;\r\n    }\r\n  }\r\n\r\n  // Determine movement target\r\n  const targetPos = this.targetPosition ? this.targetPosition : this.target.position;\r\n  const dx = targetPos.x - this.parent.position.x;\r\n  const dy = targetPos.y - this.parent.position.y;\r\n  const distSq = dx * dx + dy * dy;\r\n  const dist = Math.sqrt(distSq);\r\n  const speed = this.stats.speed;\r\n\r\n  // Hit detection\r\n  const hitRadiusSq = 15 * 15; // Same as your original hit detection radius\r\n  let hitDetected = false;\r\n\r\n  if (this.targetPosition) {\r\n    // Check nearby enemies for hit detection when using targetPosition\r\n    const nearbyEnemies = this.game.spatialGrid.getNearbyEntities(\r\n      this.parent.gridPosition.x,\r\n      this.parent.gridPosition.y,\r\n      this.stats.splashRadius || 15, // Use splashRadius or default to 15,\r\n      \"enemy\"\r\n    );\r\n\r\n    for (const enemy of nearbyEnemies) {\r\n      if (enemy.isDead || this.piercedEnemies.includes(enemy)) continue;\r\n\r\n      const dxEnemy = enemy.position.x - this.parent.position.x;\r\n      const dyEnemy = enemy.position.y - this.parent.position.y;\r\n      const enemyDistSq = dxEnemy * dxEnemy + dyEnemy * dyEnemy;\r\n\r\n      if (enemyDistSq <= hitRadiusSq) {\r\n        // Hit detected\r\n        if(this.stats.hitSound && !hitDetected && !hitSoundPlayed){\r\n          this.game.audioManager.playSound('hitSounds', this.stats.hitSound);\r\n          hitSoundPlayed = true;\r\n        }\r\n        hitDetected = true;\r\n        let enemyHealth = enemy.getComponent(\"health\");\r\n        let enemyEnergyShield = enemy.getComponent(\"energyshield\");\r\n        let enemyStats = enemy.getComponent(\"stats\");\r\n        let enemyStatClone = { ...enemyStats.stats };\r\n        enemyStatClone.energyShield = enemyEnergyShield.energyShield;\r\n\r\n        // Apply damage\r\n        let damageResult = engine.getFunction(\"calculateDamage\")(this.stats, enemyStatClone);\r\n        if (!damageResult.wasEvaded) {\r\n          enemyHealth.hp -= damageResult.damageDealt;\r\n          enemyEnergyShield.absorbDamage(damageResult.damageAbsorbed);\r\n          this.game.spawn(enemy.position.x, enemy.position.y, \"hitEffect\", {\r\n            damageType: this.stats.damageType,\r\n            lifeSpan: 0.3\r\n          });\r\n          if (this.ownerStats.slowAmount) {\r\n            enemyStats.addEffect(\r\n              this.game.config.effects.slow,\r\n              this.game.effects.slow,\r\n              this.ownerStats.slowAmount\r\n            );\r\n          }\r\n        }\r\n\r\n        // Piercing logic\r\n        if (this.stats.piercing > 0 && this.piercedEnemies.length < this.stats.piercing) {\r\n          this.piercedEnemies.push(enemy);\r\n          let newTarget = this.findNewTarget(nearbyEnemies);\r\n          if (newTarget) {\r\n            this.target = newTarget;\r\n            this.targetPosition = null; // Switch to target-based tracking\r\n            return;\r\n          }\r\n        }\r\n\r\n        // Splash damage if applicable\r\n        if (this.stats.splashRadius > 0) {\r\n          this.applySplashDamage(nearbyEnemies);\r\n          this.game.spawn(this.parent.position.x, this.parent.position.y, \"explosion\", {\r\n            radius: this.stats.splashRadius\r\n          });\r\n        }\r\n\r\n        // Destroy projectile if no piercing or piercing limit reached\r\n        if (this.stats.piercing <= 0 || this.piercedEnemies.length >= this.stats.piercing) {\r\n          this.parent.destroy();\r\n          return;\r\n        }\r\n      }\r\n    }\r\n  } else if (distSq < hitRadiusSq) {\r\n    // Original target-based hit detection\r\n    let targetHealth = this.target.getComponent(\"health\");\r\n    let targetEnergyShield = this.target.getComponent(\"energyshield\");\r\n    let targetStats = this.target.getComponent(\"stats\");\r\n    let targetStatClone = { ...targetStats.stats };\r\n    targetStatClone.energyShield = targetEnergyShield.energyShield;\r\n\r\n    // Apply damage and effects (unchanged from your original code)\r\n    let damageResult = engine.getFunction(\"calculateDamage\")(this.stats, targetStatClone);\r\n    if (!damageResult.wasEvaded) {\r\n      if(this.stats.hitSound && !hitSoundPlayed){\r\n        this.game.audioManager.playSound('hitSounds', this.stats.hitSound);\r\n        hitSoundPlayed = true;\r\n      }\r\n      targetHealth.hp -= damageResult.damageDealt;\r\n      targetEnergyShield.absorbDamage(damageResult.damageAbsorbed);\r\n      this.game.spawn(this.target.position.x, this.target.position.y, \"hitEffect\", {\r\n        damageType: this.stats.damageType,\r\n        lifeSpan: 0.3\r\n      });\r\n      if (this.ownerStats.slowAmount) {\r\n        targetStats.addEffect(\r\n          this.game.config.effects.slow,\r\n          this.game.effects.slow,\r\n          this.ownerStats.slowAmount\r\n        );\r\n      }\r\n    }\r\n\r\n    // Summon skeleton, leech, thief logic (unchanged)\r\n    if (\r\n      this.ownerStats.summonChance > 0 &&\r\n      targetHealth.hp <= 0 &&\r\n      Math.random() < this.ownerStats.summonChance - 1\r\n    ) {\r\n      this.game.spawn(this.target.position.x, this.target.position.y, \"summonedTower\", {\r\n        objectType: \"towers\",\r\n        spawnType: this.ownerStats.summonType,\r\n        owner: this.owner\r\n      });\r\n    }\r\n    if (this.ownerStats.leech > 0) {\r\n      const healing = this.stats.damage * this.ownerStats.leech * this.game.state.stats.healingMultiplier;\r\n      this.game.state.bloodCoreHP = Math.min(\r\n        this.game.state.stats.maxBloodCoreHP,\r\n        this.game.state.bloodCoreHP + healing\r\n      );\r\n    }\r\n    if (this.ownerStats.thief && this.ownerStats.thief != 0) {\r\n      const stealAmt = this.stats.damage * this.ownerStats.thief * this.game.state.stats.bloodShardMultiplier;\r\n      this.game.state.bloodShards += stealAmt;\r\n    }\r\n\r\n    // Piercing logic\r\n    if (this.stats.piercing > 0 && this.piercedEnemies.length < this.stats.piercing) {\r\n      this.piercedEnemies.push(this.target);\r\n      const newTarget = this.findNewTarget(\r\n        this.game.spatialGrid.getNearbyEntities(\r\n          this.parent.gridPosition.x,\r\n          this.parent.gridPosition.y,\r\n          this.ownerStats.range\r\n        )\r\n      );\r\n      if (newTarget) {\r\n        this.target = newTarget;\r\n        return;\r\n      }\r\n    }\r\n\r\n    this.parent.destroy();\r\n    return;\r\n  }\r\n\r\n  // Move projectile\r\n  this.parent.position.x += (dx / dist) * speed;\r\n  this.parent.position.y += (dy / dist) * speed;\r\n\r\n  // Continue moving past targetPosition by updating it if reached\r\n  if (this.targetPosition && distSq < speed * speed) {\r\n    // If close to targetPosition, extend it in the same direction\r\n    const directionX = dx / dist;\r\n    const directionY = dy / dist;\r\n    this.targetPosition.x += directionX * speed * 10; // Extend further (adjust multiplier)\r\n    this.targetPosition.y += directionY * speed * 10;\r\n  }\r\n\r\n  // Particle spawning logic (unchanged)\r\n  const tDx = this.parent.lastPosition.x - this.parent.position.x;\r\n  const tDy = this.parent.lastPosition.y - this.parent.position.y;\r\n  const tDistSq = tDx * tDx + tDy * tDy;\r\n  const tDist = Math.sqrt(tDistSq);\r\n\r\n  this.distanceTraveled += tDist;\r\n  if (this.def.particle && this.distanceTraveled > this.distanceToSpawnParticle) {\r\n    this.game.spawn(this.parent.position.x, this.parent.position.y, \"particle\", { objectType: \"particles\", spawnType: this.def.particle});\r\n    this.distanceTraveled = 0;\r\n    this.distanceToSpawnParticle += Math.random() * 3;\r\n  }\r\n}\r\n\r\n// Helper method to find a new target for piercing\r\nfindNewTarget(nearbyEnemies) {\r\n  const gridSize = this.game.config.configs.game.gridSize;\r\n  const rangeSq = this.ownerStats.range * this.ownerStats.range * gridSize * gridSize;\r\n  for (let enemy of nearbyEnemies) {\r\n    if (!enemy.destroyed && !this.piercedEnemies.includes(enemy)) {\r\n      const dx = enemy.position.x - this.parent.position.x;\r\n      const dy = enemy.position.y - this.parent.position.y;\r\n      const distSq = dx * dx + dy * dy;\r\n      if (distSq < rangeSq) {\r\n        return enemy;\r\n      }\r\n    }\r\n  }\r\n  return null;\r\n}\r\n\r\n// Helper method to apply splash damage\r\napplySplashDamage(nearbyEnemies) {\r\n  const gridSize = this.game.config.configs.game.gridSize;\r\n  const splashRadiusSq = this.stats.splashRadius * this.stats.splashRadius * gridSize * gridSize;\r\n  for (const enemy of nearbyEnemies) {\r\n    if (enemy.isDead || this.piercedEnemies.includes(enemy)) continue;\r\n    let enemyHealth = enemy.getComponent(\"health\");\r\n    let enemyEnergyShield = enemy.getComponent(\"energyshield\");\r\n    let enemyStats = enemy.getComponent(\"stats\");\r\n    let enemyStatClone = { ...enemyStats.stats };\r\n    enemyStatClone.energyShield = enemyEnergyShield.energyShield;\r\n\r\n    const dx = enemy.position.x - this.parent.position.x;\r\n    const dy = enemy.position.y - this.parent.position.y;\r\n    const distSq = dx * dx + dy * dy;\r\n\r\n    if (distSq <= splashRadiusSq) {\r\n      let damageResult = engine.getFunction(\"calculateDamage\")(this.stats, enemyStatClone);\r\n      if (!damageResult.wasEvaded) {\r\n        enemyHealth.hp -= damageResult.damageDealt;\r\n        enemyEnergyShield.absorbDamage(damageResult.damageAbsorbed);\r\n        this.game.spawn(enemy.position.x, enemy.position.y, \"hitEffect\", {\r\n          damageType: this.stats.damageType,\r\n          lifeSpan: 0.3\r\n        });\r\n        if (this.ownerStats.slowAmount) {\r\n          enemyStats.addEffect(\r\n            this.game.config.effects.slow,\r\n            this.game.effects.slow,\r\n            this.ownerStats.slowAmount\r\n          );\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n}"
      },
      "Effect": {
        "fileName": "Effect",
        "script": "class Effect extends engine.Component {\r\n    \r\n    constructor(game, parent, params) {\r\n        super(game, parent, params);\r\n    }\r\n    \r\n    \r\n    init( {config, applyFn, amount }) {\r\n        this.id = config.id;\r\n        this.title = config.title;\r\n        this.desc = config.desc;\r\n        this.lifeTime = config.lifeTime;\r\n        this.applyFn = applyFn;\r\n        this.amount = amount;    \r\n    }\r\n\r\n    update() {\r\n        this.lifeTime--;\r\n        if( this.lifeTime <= 0) this.parent.removeComponent(this);\r\n        return true;        \r\n    }\r\n\r\n    apply(s, add, mul) {\r\n        this.applyFn(s, add, mul, this.amount);\r\n    }\r\n}"
      },
      "GameLoader": {
        "title": "Game Loader",
        "fileName": "GameLoader",
        "script": "class GameLoader extends engine.Component {\r\n    \r\n    constructor(game, parent, params) {\r\n        super(game, parent, params);\r\n    }\r\n\r\n    init() {}\r\n    \r\n    async load({config}){\r\n        this.config = config;        \r\n        this.config.configs.game.canvasWidth = window.outerWidth;\r\n        this.config.configs.game.canvasHeight = window.outerHeight;\r\n        this.state = new (this.game.libraryClasses.GameState)(this.config);  \r\n        this.game.state = this.state;\r\n        this.game.palette = this.config.palettes && this.config.configs.game.palette ? this.config.palettes[this.config.configs.game.palette] : null;\r\n        this.isometric = this.config.configs.game.isIsometric;\r\n        this.game.state.tileMapData = this.config.levels[this.game.state.level].tileMap;\r\n        this.game.state.isometric = this.config.configs.game.isIsometric;\r\n        if (this.game.state.modifierSet && this.config.modifierSets) {\r\n            this.game.state.stats = this.config.modifierSets[this.game.state.modifierSet];\r\n            this.game.state.defaultStats = { ...this.game.state.stats };\r\n        }   \r\n\r\n\r\n        this.setupCanvas(this.config.configs.game.canvasWidth, this.config.configs.game.canvasHeight);\r\n        await this.loadAssets();\r\n\r\n        this.game.translator = new (this.game.libraryClasses.CoordinateTranslator)(this.config.configs.game, this.config.levels[this.state.level].tileMap.terrainMap.length, this.isometric);\r\n        this.game.spatialGrid = new (this.game.libraryClasses.SpatialGrid)(this.config.levels[this.state.level].tileMap.terrainMap.length, this.config.configs.game.gridSize);\r\n        const terrainImages = this.game.imageManager.getImages(\"levels\", this.state.level);\r\n\r\n        // Use ModuleManager's script environment\r\n        this.game.terrainTileMapper = new (this.game.libraryClasses.TileMap)(this, {}, {CanvasUtility: this.game.libraryClasses.CanvasUtility});\r\n        this.game.terrainTileMapper.init(this.terrainCanvasBuffer, this.config.configs.game.gridSize, terrainImages, this.isometric);\r\n\r\n        this.game.gameEntity = this.game.createEntityFromConfig(0, 0, 'game', { gameConfig: this.config.configs.game, canvas: this.canvas, canvasBuffer: this.canvasBuffer, terrainCanvasBuffer: this.terrainCanvasBuffer, worldObjects: this.config.worldObjects, imageManager: this.game.imageManager, levelName: this.game.state.level, level: this.config.levels[this.game.state.level], palette: this.game.palette });\r\n        this.game.imageManager.dispose();    \r\n        this.game.audioManager = this.game.gameEntity.getComponent('AudioManager');  \r\n    }\r\n\r\n    getProject() {\r\n        return this.game.gameEntity;\r\n    }\r\n    setupCanvas(canvasWidth, canvasHeight) {\r\n        this.canvas = document.getElementById(\"gameCanvas\");\r\n        if(this.game.config.configs.game.is3D){\r\n            this.finalCtx = this.canvas.getContext(\"webgl2\");\r\n        } else {\r\n            this.finalCtx = this.canvas.getContext(\"2d\");\r\n        }\r\n        this.canvasBuffer = document.createElement(\"canvas\");\r\n        this.ctx = this.canvasBuffer.getContext(\"2d\");\r\n        this.canvasBuffer.setAttribute('width', canvasWidth);\r\n        this.canvasBuffer.setAttribute('height', canvasHeight);\r\n        this.canvas.setAttribute('width', canvasWidth);\r\n        this.canvas.setAttribute('height', canvasHeight);  \r\n        \r\n        this.terrainCanvasBuffer = document.createElement('canvas');\r\n        this.terrainCanvasBuffer.width = this.config.configs.game.gridSize * this.config.levels[this.state.level].tileMap.terrainMap[0].length;\r\n        this.terrainCanvasBuffer.height = this.config.configs.game.gridSize * this.config.levels[this.state.level].tileMap.terrainMap.length;\r\n\r\n        this.game.canvas = this.canvas;\r\n        this.game.finalCtx = this.finalCtx;\r\n        this.game.canvasBuffer = this.canvasBuffer;\r\n        this.game.ctx = this.ctx;\r\n        this.game.terrainCanvasBuffer = this.terrainCanvasBuffer;\r\n    }\r\n    async loadAssets() {\r\n        this.game.imageManager = new (this.game.libraryClasses.ImageManager)(this, { imageSize: this.config.configs.game.imageSize, palette: this.game.palette, textures:  this.game.config.textures}, {ShapeFactory: this.game.libraryClasses.ShapeFactory});    \r\n        // Load all images\r\n        for(let objectType in this.config) {\r\n            await this.game.imageManager.loadImages(objectType, this.config[objectType]);\r\n        }  \r\n        this.game.modelManager = new (this.game.libraryClasses.ModelManager)(this,{ShapeFactory: this.game.libraryClasses.ShapeFactory, palette: this.game.palette, textures: this.game.config.textures});    \r\n        for(let objectType in this.config) {\r\n            await this.game.modelManager.loadModels(objectType, this.config[objectType]);\r\n        }  \r\n \r\n    }\r\n}"
      },
      "ThreeJsWorld": {
        "title": "ThreeJsWorld",
        "fileName": "ThreeJsWorld",
        "script": "class ThreeJsWorld extends engine.Component {\n    init({\n        containerSelector = '#gameContainer',\n        width = window.innerWidth,\n        height = window.innerHeight,\n        useControls = true}) {\n        if (!this.game.config.configs.game.is3D) {\n            return;\n        }\n        this.level = this.game.config.levels[this.game.state.level];\n        this.world = this.game.config.worlds[this.level.world];\n        this.lightingSettings = this.game.config.lightings[this.world.lighting];\n        this.shadowSettings = this.game.config.shadows[this.world.shadow];\n        this.fogSettings = this.game.config.fogs[this.world.fog]; \n        this.heightMapSettings = this.game.config.heightMaps[this.world.heightMap];      \n        this.cameraSettings = this.game.config.cameras[this.world.camera];\n\n        this.heightStep = this.heightMapSettings.heightStep;\n        this.showStats = false;\n        this.clock = new THREE.Clock();\n        this.onWindowResizeHandler = this.onWindowResize.bind(this);\n        this.game.heightMapConfig = this.heightMapSettings;\n        this.terrainSize = 768;\n        this.extensionSize = this.world.extensionSize;\n        this.extendedSize = this.terrainSize + 2 * this.world.extensionSize;\n        this.heightMapResolution = this.extendedSize / this.heightMapSettings.resolutionDivisor;\n        this.container = document.querySelector(containerSelector) || document.body;\n        this.renderer = new THREE.WebGLRenderer({ antialias: true, canvas: this.game.canvas, alpha: true });\n        \n        this.renderer.setSize(width, height);        \n        this.renderer.shadowMap.enabled = this.shadowSettings.enabled;\n        this.renderer.shadowMap.type = THREE.PCFSoftShadowMap;\n        this.uniforms = {};\n        this.scene = new THREE.Scene();\n        this.scene.background = new THREE.Color(this.world.backgroundColor);\n\n        if (this.fogSettings.enabled) {\n            this.scene.fog = new THREE.FogExp2(this.fogSettings.color, this.fogSettings.density);\n        }\n\n        this.camera = new THREE.PerspectiveCamera(\n            this.cameraSettings.fov,\n            width / height,\n            this.cameraSettings.near,\n            this.cameraSettings.far\n        );\n        let cameraPos = JSON.parse(this.cameraSettings.position);\n\n        this.camera.position.set(\n            cameraPos.x,\n            cameraPos.y,\n            cameraPos.z\n        );\n        let lookAt = JSON.parse(this.cameraSettings.lookAt);\n        this.camera.lookAt(\n            lookAt.x,\n            lookAt.y,\n            lookAt.z\n        );\n\n        if (useControls) {\n            this.controls = new THREE.OrbitControls(this.camera, this.renderer.domElement);\n            this.controls.target.set(\n                lookAt.x,\n                lookAt.y,\n                lookAt.z\n            );\n            this.controls.maxPolarAngle = Math.PI / 2.05;\n            this.controls.minPolarAngle = 0.1;\n            this.controls.enableDamping = true;\n            this.controls.dampingFactor = 0.05;\n            this.controls.update();\n        }\n\n        this.ambientLight = new THREE.AmbientLight(\n            this.lightingSettings.ambientColor,\n            this.lightingSettings.ambientIntensity\n        );\n        this.scene.add(this.ambientLight);\n\n        this.directionalLight = new THREE.DirectionalLight(\n            this.lightingSettings.directionalColor,\n            this.lightingSettings.directionalIntensity\n        );\n        this.directionalLight.position.set(this.extendedSize, this.extendedSize, this.extendedSize);\n        this.directionalLight.castShadow = this.shadowSettings.enabled;\n\n        if (this.shadowSettings.enabled) {\n            this.directionalLight.shadow.mapSize.width = this.shadowSettings.mapSize;\n            this.directionalLight.shadow.mapSize.height = this.shadowSettings.mapSize;\n            this.directionalLight.shadow.camera.near = 0.5;\n            this.directionalLight.shadow.camera.far = 20000;\n            this.directionalLight.shadow.bias = this.shadowSettings.bias;\n            this.directionalLight.shadow.normalBias = this.shadowSettings.normalBias;\n            this.directionalLight.shadow.radius = this.shadowSettings.radius;\n\n            const d = this.extendedSize * 0.75;\n            this.directionalLight.shadow.camera.left = -d;\n            this.directionalLight.shadow.camera.right = d;\n            this.directionalLight.shadow.camera.top = d;\n            this.directionalLight.shadow.camera.bottom = -d;\n\n            this.directionalLight.target.position.set(-this.extendedSize, -this.extendedSize, -this.extendedSize);\n            this.directionalLight.target.updateMatrixWorld();\n            this.directionalLight.shadow.camera.updateProjectionMatrix();\n        }\n\n        this.scene.add(this.directionalLight);\n        this.scene.add(this.directionalLight.target);\n\n        this.hemisphereLight = new THREE.HemisphereLight(\n            this.lightingSettings.skyColor,\n            this.lightingSettings.groundColor,\n            this.lightingSettings.hemisphereIntensity\n        );\n        this.scene.add(this.hemisphereLight);\n        this.tileMap = this.game.config.levels[this.game.state.level].tileMap;\n        this.setupGround();\n        this.generateLiquidSurfaceMesh(0);\n        this.generateLiquidSurfaceMesh(1);\n        if (this.showStats) {\n            this.stats = new Stats();\n            this.container.appendChild(this.stats.dom);\n        }\n\n        window.addEventListener('resize', this.onWindowResizeHandler);\n\n        this.game.scene = this.scene;\n        this.game.camera = this.camera;\n        this.game.renderer = this.renderer;\n        this.game.ground = this.ground;\n        this.drawn = false;\n        this.timer = 0;        \n    }\n\n    setupGround() {\n        this.groundCanvas = document.createElement('canvas');\n        this.groundCanvas.width = this.extendedSize;\n        this.groundCanvas.height = this.extendedSize;\n        this.groundCtx = this.groundCanvas.getContext('2d');\n\n        let bgColor = this.tileMap.terrainTypes[this.tileMap.extensionTerrainType].color;\n        let colorToUse = bgColor.paletteColor ? this.game.palette[bgColor.paletteColor] : bgColor;\n        this.groundCtx.fillStyle = colorToUse;\n        this.groundCtx.fillRect(0, 0, this.extendedSize, this.extendedSize);\n\n        this.groundTexture = new THREE.CanvasTexture(this.groundCanvas);\n        this.groundTexture.wrapS = THREE.ClampToEdgeWrapping;\n        this.groundTexture.wrapT = THREE.ClampToEdgeWrapping;\n        this.groundTexture.minFilter = THREE.NearestFilter;\n        this.groundTexture.magFilter = THREE.NearestFilter;\n\n        if (this.heightMapSettings) {\n            this.createHeightMapTerrain();\n        } else {\n            const groundGeometry = new THREE.PlaneGeometry(this.extendedSize, this.extendedSize);\n            this.groundMaterial = this.getGroundMaterial();\n            this.ground = new THREE.Mesh(groundGeometry, this.groundMaterial);\n            this.ground.rotation.x = -Math.PI / 2;\n            this.ground.position.set(this.terrainSize / 2, 0, this.terrainSize / 2);\n            this.ground.receiveShadow = true;\n            this.ground.castShadow = true;\n            this.scene.add(this.ground);\n        }\n    }\n\n    createHeightMapTerrain() {\n        this.heightMapData = new Float32Array(this.extendedSize * this.extendedSize);\n        this.terrainTypes = this.tileMap.terrainTypes || [];\n\n        const segments = this.heightMapResolution;\n        const groundGeometry = new THREE.PlaneGeometry(\n            this.extendedSize,\n            this.extendedSize,\n            segments,\n            segments\n        );\n\n        this.groundVertices = groundGeometry.attributes.position;\n\n        this.groundMaterial = this.getGroundMaterial();\n\n        this.ground = new THREE.Mesh(groundGeometry, this.groundMaterial);\n        this.ground.rotation.x = -Math.PI / 2;\n        this.ground.position.set(this.terrainSize / 2, 0, this.terrainSize / 2);\n        this.ground.receiveShadow = true;\n        this.ground.castShadow = true;\n        this.scene.add(this.ground);\n    }\n    findClosestTerrainType(r, g, b, terrainTypeColors) {\n        let minDistance = Infinity;\n        let bestTypeIndex = null;\n        let toleranceSquared = 36;\n        for (const [colorKey, typeIndex] of Object.entries(terrainTypeColors)) {\n            const [cr, cg, cb] = colorKey.split(',').map(Number);\n            const distance = ((r - cr) ** 2 + (g - cg) ** 2 + (b - cb) ** 2);\n            if (distance < minDistance && distance < toleranceSquared) { // Adjust tolerance as needed\n                minDistance = distance;\n                bestTypeIndex = typeIndex;\n            }\n        }\n        return bestTypeIndex;\n    }\n    updateHeightMap() {\n        if (!this.heightMapSettings.enabled || !this.game.terrainCanvasBuffer) return;\n\n        try {\n            const terrainCanvas = this.game.terrainCanvasBuffer;\n            const ctx = terrainCanvas.getContext('2d', { alpha: false, willReadFrequently: true });\n            ctx.imageSmoothingEnabled = false;\n            const terrainData = ctx.getImageData(0, 0, terrainCanvas.width, terrainCanvas.height).data;\n\n            const terrainTypeColors = this.createTerrainTypeColorMap();\n\n            this.heightMapData = new Float32Array(this.extendedSize * this.extendedSize);\n\n            const extensionTerrainType = this.tileMap.extensionTerrainType;\n            const extensionHeight = extensionTerrainType * this.heightStep;\n\n            for (let z = 0; z < this.extendedSize; z++) {\n                for (let x = 0; x < this.extendedSize; x++) {\n                    this.heightMapData[z * this.extendedSize + x] = extensionHeight;\n                }\n            }\n\n            for (let z = 0; z < this.terrainSize; z++) {\n                for (let x = 0; x < this.terrainSize; x++) {\n                    const pixelIndex = (z * terrainCanvas.width + x) * 4;\n                    const r = terrainData[pixelIndex];\n                    const g = terrainData[pixelIndex + 1];\n                    const b = terrainData[pixelIndex + 2];\n            \n                    const typeIndex = this.findClosestTerrainType(r,g,b,terrainTypeColors) ?? extensionHeight;\n                    let height = typeIndex !== undefined ? typeIndex * this.heightStep : extensionHeight;\n\n                    // Check neighboring pixels for lower terrain types\n                    let neighborCheckDist = this.heightMapSettings.resolutionDivisor - 1;\n                    const neighbors = [\n                        { x: x-neighborCheckDist, z: z },   // left\n                        { x: x+neighborCheckDist, z: z },   // right\n                        { x: x, z: z-neighborCheckDist },   // top\n                        { x: x, z: z+neighborCheckDist + 1 },   // bottom\n                        { x: x-neighborCheckDist, z: z-neighborCheckDist }, // top-left\n                        { x: x+neighborCheckDist, z: z-neighborCheckDist }, // top-right\n                        { x: x-neighborCheckDist, z: z+neighborCheckDist }, // bottom-left\n                        { x: x+neighborCheckDist, z: z+neighborCheckDist }  // bottom-right\n                    ];\n                    let lowestNeighborType = Infinity;\n                    for (const neighbor of neighbors) {\n                        if (neighbor.x >= 0 && neighbor.x < this.terrainSize && \n                            neighbor.z >= 0 && neighbor.z < this.terrainSize) {\n                            \n                            const neighborIndex = (neighbor.z * terrainCanvas.width + neighbor.x) * 4;\n                            const nr = terrainData[neighborIndex];\n                            const ng = terrainData[neighborIndex + 1];\n                            const nb = terrainData[neighborIndex + 2];\n                            const neighborKey = `${nr},${ng},${nb}`;\n                            \n                            const neighborTypeIndex = terrainTypeColors[neighborKey];\n                            if (neighborTypeIndex !== undefined && neighborTypeIndex < typeIndex && neighborTypeIndex < lowestNeighborType) {\n                                // If neighbor is lower terrain, use its height\n                                lowestNeighborType = neighborTypeIndex;\n                            }\n                        }\n                    }\n                    if (lowestNeighborType < typeIndex) {\n                        height = lowestNeighborType * this.heightStep;\n                    }\n            \n                    const extX = x + this.extensionSize;\n                    const extZ = z + this.extensionSize;\n                    this.heightMapData[extZ * this.extendedSize + extX] = height;\n                }\n            }\n\n            this.applyHeightMapToGeometry();\n\n        } catch (e) {\n            console.warn('Failed to update height map:', e);\n        }\n    }\n\n    createTerrainTypeColorMap() {\n        const colorMap = {};\n        const terrainTypes = this.terrainTypes;\n\n        for (let i = 0; i < terrainTypes.length; i++) {\n            const terrainType = terrainTypes[i];\n            let color = terrainType.color || {};\n\n            if (color.paletteColor && this.game.palette) {\n                const hexColor = this.game.palette[color.paletteColor];\n                if (hexColor) {\n                    const r = parseInt(hexColor.slice(1, 3), 16);\n                    const g = parseInt(hexColor.slice(3, 5), 16);\n                    const b = parseInt(hexColor.slice(5, 7), 16);\n                    colorMap[`${r},${g},${b}`] = i;\n                }\n            } else {\n                const hexColor = color;\n                if (hexColor) {\n                    const r = parseInt(hexColor.slice(1, 3), 16);\n                    const g = parseInt(hexColor.slice(3, 5), 16);\n                    const b = parseInt(hexColor.slice(5, 7), 16);\n                    colorMap[`${r},${g},${b}`] = i;\n                }\n            }\n        }\n\n        return colorMap;\n    }\n\n    applyHeightMapToGeometry() {\n        if (!this.ground || !this.groundVertices) return;\n\n        const positions = this.groundVertices.array;\n        const geometry = this.ground.geometry;\n        const segments = this.heightMapResolution;\n        const verticesPerRow = segments + 1;\n\n        for (let z = 0; z < verticesPerRow; z++) {\n            for (let x = 0; x < verticesPerRow; x++) {\n                const vertexIndex = (z * verticesPerRow + x);\n                const idx = vertexIndex * 3;\n\n                const nx = x / segments;\n                const nz = z / segments;\n\n                const terrainX = Math.floor(nx * (this.extendedSize - 1));\n                const terrainZ = Math.floor(nz * (this.extendedSize - 1));\n\n                const heightIndex = terrainZ * this.extendedSize + terrainX;\n                const height = this.heightMapData[heightIndex] || 0;\n\n                // const finalHeight = this.heightMapSettings.smoothing ?\n                //     this.smoothHeight(terrainX, terrainZ) : height;\n\n                positions[idx + 2] = height;\n            }\n        }\n\n        this.groundVertices.needsUpdate = true;\n        geometry.computeVertexNormals();\n    }\n\n    getGroundMaterial() {\n        return new THREE.MeshStandardMaterial({\n            map: this.groundTexture,\n            side: THREE.DoubleSide,\n            metalness: 0.0,\n            roughness: 0.8\n        });\n    }\n\n    onWindowResize() {\n        const width = this.container.clientWidth || window.innerWidth;\n        const height = this.container.clientHeight || window.innerHeight;\n\n        this.camera.aspect = width / height;\n        this.camera.updateProjectionMatrix();\n        this.renderer.setSize(width, height);\n                // Ensure canvas display size matches resolution\n        this.game.canvas.style.width = `${width}px`;\n        this.game.canvas.style.height = `${height}px`;\n    }\n\n    update() {\n        if (!this.game.config.configs.game.is3D) {\n            return;\n        }   \n    \n        if (this.controls) {\n            this.controls.update();\n        }\n        if (!isNaN(this.game.deltaTime)) {\n            this.timer += this.game.deltaTime;\n        }\n        if (this.stats) {\n            this.stats.update();\n        }\n        if (!this.drawn && this.groundTexture && this.game.mapRenderer && this.game.mapRenderer.isMapCached) {\n            this.groundCtx.drawImage(this.game.terrainCanvasBuffer, this.extensionSize, this.extensionSize);\n            this.groundTexture.needsUpdate = true;\n\n            if (this.heightMapSettings.enabled) {\n                this.updateHeightMap();\n            }\n\n            this.addGrassToTerrain();\n            this.drawn = true;\n        }\n        for(const key in this.uniforms) {\n            this.uniforms[key].time = { value: this.timer };            \n        }\n        this.renderer.render(this.scene, this.camera);\n    }\n\n    addGrassToTerrain() {\n        const bladeWidth = 12;\n        const bladeHeight = 18;\n        const grassGeometry = this.createCurvedBladeGeometry(bladeWidth, bladeHeight);\n        grassGeometry.translate(0, bladeHeight / 2, 0);\n        const grassCount = 500000;\n\n        const gridSize = this.game.config.configs.game.gridSize;\n        const phases = new Float32Array(grassCount);\n        for (let i = 0; i < grassCount; i++) {\n            phases[i] = Math.random() * Math.PI * 2;\n        }\n        grassGeometry.setAttribute('instancePhase', new THREE.InstancedBufferAttribute(phases, 1));\n\n        const grassTexture = this.createGrassTexture();\n        const grassShader = this.game.config.shaders[this.level.grassShader];\n        this.uniforms['grass'] = JSON.parse(grassShader.uniforms);\n        \n        this.uniforms['grass'].windDirection = { value: new THREE.Vector2(this.uniforms['grass'].windDirection.value[0], this.uniforms['grass'].windDirection.value[1]).normalize()};\n        this.uniforms['grass'].map = { value: grassTexture };\n        this.uniforms['grass'].fogColor = { value: new THREE.Color(this.fogSettings.color) };\n        this.uniforms['grass'].fogDensity = this.fogSettings.enabled ? { value: this.fogSettings.density } : 0;\n        const lightDirection = new THREE.Vector3();\n        lightDirection.subVectors(this.directionalLight.position, this.directionalLight.target.position);\n        lightDirection.normalize();\n\n        this.uniforms['grass'].directionalLightColor = { value: new THREE.Color(this.lightingSettings.directionalColor) };\n        this.uniforms['grass'].directionalLightIntensity = { value: this.lightingSettings.directionalIntensity };\n        this.uniforms['grass'].directionalLightDirection = { value: lightDirection };\n        this.uniforms['grass'].ambientLightColor = { value: new THREE.Color(this.lightingSettings.ambientColor) };\n        this.uniforms['grass'].ambientLightIntensity = { value: this.lightingSettings.ambientIntensity };\n        this.uniforms['grass'].skyColor =  { value: new THREE.Color(this.lightingSettings.skyColor) }; // HemisphereLight sky color\n        this.uniforms['grass'].groundColor = { value: new THREE.Color(this.lightingSettings.groundColor) }; // HemisphereLight ground color\n        this.uniforms['grass'].hemisphereIntensity = { value: this.lightingSettings.hemisphereIntensity };\n\n        const uniforms = this.uniforms['grass'];\n        this.grassMaterial = new THREE.ShaderMaterial({\n            vertexShader: grassShader.vertexScript,\n            fragmentShader: grassShader.fragmentScript,\n            uniforms: uniforms,\n            transparent: true\n        });\n\n        this.grassShader = this.grassMaterial;\n        \n        grassGeometry.computeVertexNormals(); \n        const grass = new THREE.InstancedMesh(grassGeometry, this.grassMaterial, grassCount);\n        grass.castShadow = true;\n        grass.receiveShadow = false;\n\n        const dummy = new THREE.Object3D();\n        const grassArea = this.extendedSize;  \n        const ctx = this.groundCanvas.getContext('2d');\n        const terrainData = ctx.getImageData(0, 0, this.groundCanvas.width, this.groundCanvas.height).data;\n\n        // Create a density map for grass placement\n        // Create a density map for grass placement\n        const densityMap = new Float32Array(this.extendedSize * this.extendedSize);\n        for (let z = 0; z < this.extendedSize; z++) {\n            for (let x = 0; x < this.extendedSize; x++) {\n                // Check current pixel for green dominance\n                const pixelIndex = (z * this.groundCanvas.width + x) * 4;\n                const isGreenDominant = (pixel) => {\n                    const r = terrainData[pixel];\n                    const g = terrainData[pixel + 1];\n                    const b = terrainData[pixel + 2];\n                    return g > r && g > b;\n                };\n\n                // Only set density if current pixel and all neighbors are green\n                if (isGreenDominant(pixelIndex)) {\n                    // Check 8 neighboring pixels\n                    let checkDist = Math.ceil(gridSize / 10);\n                    const neighbors = [\n                        [-checkDist, -checkDist], [0, -checkDist], [checkDist, -checkDist],\n                        [-checkDist,  0],                           [checkDist,  0],\n                        [-checkDist,  checkDist], [0,  checkDist], [checkDist,  checkDist]\n                    ];\n\n                    let allNeighborsGreen = true;\n                    for (const [dx, dz] of neighbors) {\n                        const nx = x + dx;\n                        const nz = z + dz;\n                        \n                        // Skip if neighbor is outside bounds\n                        if (nx < 0 || nx >= this.extendedSize || nz < 0 || nz >= this.extendedSize) {\n                            allNeighborsGreen = false;\n                            break;\n                        }\n\n                        const neighborIndex = (nz * this.groundCanvas.width + nx) * 4;\n                        if (!isGreenDominant(neighborIndex)) {\n                            allNeighborsGreen = false;\n                            break;\n                        }\n                    }\n\n                    densityMap[z * this.extendedSize + x] = allNeighborsGreen ? 1 : 0;\n                } else {\n                    densityMap[z * this.extendedSize + x] = 0;\n                }\n            }\n        }\n\n        // Place grass based on density\n        let placed = 0;\n        for (let i = 0; i < grassCount * 2 && placed < grassCount; i++) {\n            const x = Math.floor(Math.random() * grassArea);\n            const z = Math.floor(Math.random() * grassArea);\n            if (densityMap[z * this.extendedSize + x] > 0) {\n                const rotationY = Math.random() * Math.PI * 2;\n                const scale = 0.7 + Math.random() * 0.5;\n                let height = this.heightMapSettings.enabled\n                    ? this.heightMapData[Math.min(z, this.extendedSize - 1) * this.extendedSize + Math.min(x, this.extendedSize - 1)] || 0\n                    : 0;\n                dummy.position.set(x - grassArea / 2 + this.terrainSize / 2, height - bladeHeight, z - grassArea / 2 + this.terrainSize / 2);\n                dummy.rotation.set(0, rotationY, 0);\n                dummy.scale.set(scale, scale, scale);\n                dummy.updateMatrix();\n                grass.setMatrixAt(placed++, dummy.matrix);\n            }\n        }\n\n        grass.instanceMatrix.needsUpdate = true;\n        this.scene.add(grass);\n        this.grass = grass;\n    }\n\n    onDestroy() {\n        window.removeEventListener('resize', this.onWindowResizeHandler);\n        this.renderer.dispose();\n        if (this.stats?.dom?.parentElement) {\n            this.stats.dom.parentElement.removeChild(this.stats.dom);\n        }\n        if (this.renderer.domElement?.parentElement) {\n            this.renderer.domElement.parentElement.removeChild(this.renderer.domElement);\n        }\n        if (this.grass) {\n            this.grass.geometry.dispose();\n            this.grass.material.dispose();\n        }\n        this.ground.geometry?.dispose();\n        this.groundMaterial?.dispose();\n        this.groundTexture?.dispose();\n        this.groundCanvas = null;\n        this.game.scene = null;\n        this.game.camera = null;\n        this.game.renderer = null;\n    }\n\n    createCurvedBladeGeometry(width = 0.1, height = 1) {\n        const shape = new THREE.Shape();\n        shape.moveTo(0, 0);\n        shape.quadraticCurveTo(width * 0.5, height * 0.5, 0, height);\n    \n        const shapeGeom = new THREE.ShapeGeometry(shape, 12);\n        const positions = shapeGeom.attributes.position.array;\n        const uvs = shapeGeom.attributes.uv.array;\n        const vertexCount = positions.length / 3;\n    \n        const newUVs = new Float32Array(uvs.length);\n        const newNormals = new Float32Array(positions.length);\n    \n        for (let i = 0; i < vertexCount; i++) {\n            const posIndex = i * 3;\n            const uvIndex = i * 2;\n            const x = positions[posIndex];\n            const y = positions[posIndex + 1];\n            const normalizedY = y / height;\n    \n            newUVs[uvIndex] = uvs[uvIndex];\n            newUVs[uvIndex + 1] = normalizedY;\n    \n            // Compute normal: approximate outward direction along curve\n            const t = y / height; // Parameter along curve\n            const curveX = width * 0.5 * (1 - t); // Quadratic curve approximation\n            const tangent = new THREE.Vector2(curveX - x, y - (y - height * 0.5)).normalize();\n            const normal = new THREE.Vector2(-tangent.y, tangent.x); // Perpendicular to tangent\n            newNormals[posIndex] = normal.x;\n            newNormals[posIndex + 1] = 0;\n            newNormals[posIndex + 2] = normal.y;\n        }\n    \n        shapeGeom.setAttribute('uv', new THREE.BufferAttribute(newUVs, 2));\n        shapeGeom.setAttribute('normal', new THREE.BufferAttribute(newNormals, 3));\n        return shapeGeom;\n    }\n    createGrassTexture() {\n        const canvas = document.createElement('canvas');\n        canvas.width = 4;\n        canvas.height = 32;\n        const ctx = canvas.getContext('2d');\n\n        const gradient = ctx.createLinearGradient(0, canvas.height, 0, 0);\n        gradient.addColorStop(0.0, this.game.palette[\"greenMColor\"]);\n        gradient.addColorStop(0.8, this.game.palette[\"greenMColor\"]);\n        gradient.addColorStop(1.0, this.game.palette[\"redLColor\"]);\n\n        ctx.fillStyle = gradient;\n        ctx.fillRect(0, 0, canvas.width, canvas.height);\n\n        const texture = new THREE.CanvasTexture(canvas);\n        texture.wrapS = THREE.RepeatWrapping;\n        texture.wrapT = THREE.ClampToEdgeWrapping;\n        texture.magFilter = THREE.NearestFilter;\n        texture.minFilter = THREE.NearestFilter;\n        return texture;\n    }\n\n    generateLiquidSurfaceMesh(terrainType) {\n        const terrainMap = this.tileMap.terrainMap;\n        const gridSize = this.game.config.configs.game.gridSize;\n        const rows = terrainMap.length;\n        const cols = terrainMap[0].length;\n        \n        // Arrays to store vertices, indices, and UVs for the BufferGeometry\n        const vertices = [];\n        const indices = [];\n        const uvs = [];\n        \n        // Amount to extend the perimeter (e.g., 10% of gridSize)\n        const extensionAmount = gridSize * 0.25; // Adjust as needed        \n  \n        // Helper function to check if a tile is a water tile\n        const isWaterTile = (x, z) => {\n            if (x < 0 || x >= cols || z < 0 || z >= rows) return false;\n            return terrainMap[z][x] === terrainType;\n        };\n        \n        // Step 1: Generate a grid of vertices, but only for positions needed by water tiles\n        const usedPositions = new Set();\n        for (let z = 0; z < rows; z++) {\n            for (let x = 0; x < cols; x++) {\n                if (terrainMap[z][x] === terrainType) {\n                    usedPositions.add(`${x},${z}`);     // Bottom-left\n                    usedPositions.add(`${x + 1},${z}`); // Bottom-right\n                    usedPositions.add(`${x + 1},${z + 1}`); // Bottom-right in your view (+z is south)\n                    usedPositions.add(`${x},${z + 1}`); // Top-left\n                }\n            }\n        }\n        \n        // Step 2: Create vertices for all used positions and store their original positions\n        const positionToVertexIndex = new Map();\n        const originalPositions = []; // Store original (x, z) for each vertex\n        let vertexIndex = 0;\n        for (const pos of usedPositions) {\n            const [x, z] = pos.split(',').map(Number);\n            positionToVertexIndex.set(pos, vertexIndex++);\n            vertices.push(x * gridSize, 0.1, z * gridSize);\n            originalPositions.push([x, z]); // Store original grid position\n            uvs.push(x, z); // UVs based on grid position\n        }\n        \n        // Step 3: Generate indices for water tiles, connecting them into a single mesh\n        for (let z = 0; z < rows; z++) {\n            for (let x = 0; x < cols; x++) {\n                if (terrainMap[z][x] === terrainType) {\n                    const bl = positionToVertexIndex.get(`${x},${z}`);\n                    const br = positionToVertexIndex.get(`${x + 1},${z}`);\n                    const tr = positionToVertexIndex.get(`${x + 1},${z + 1}`); // Bottom-right in your view\n                    const tl = positionToVertexIndex.get(`${x},${z + 1}`);\n        \n                    indices.push(bl, br, tl);\n                    indices.push(br, tr, tl);\n                }\n            }\n        }\n        \n        // Step 4: Identify perimeter vertices and their extension directions\n        const perimeterExtensions = new Map(); // Map vertexIndex to { extendLeft, extendRight, extendUp, extendDown }\n        for (let z = 0; z < rows; z++) {\n            for (let x = 0; x < cols; x++) {\n                if (terrainMap[z][x] === terrainType) {\n                    const isLeftEdge = !isWaterTile(x - 1, z);\n                    const isRightEdge = !isWaterTile(x + 1, z);\n                    const isBottomEdge = !isWaterTile(x, z - 1); // North\n                    const isTopEdge = !isWaterTile(x, z + 1);    // South\n        \n                    // Bottom-left vertex (x, z)\n                    if (isLeftEdge || isBottomEdge) {\n                        const vIdx = positionToVertexIndex.get(`${x},${z}`);\n                        if (!perimeterExtensions.has(vIdx)) perimeterExtensions.set(vIdx, { extendLeft: false, extendRight: false, extendUp: false, extendDown: false });\n                        const ext = perimeterExtensions.get(vIdx);\n                        if (isLeftEdge) ext.extendLeft = true;\n                        if (isBottomEdge) ext.extendUp = true; // North\n                    }\n        \n                    // Bottom-right vertex (x + 1, z)\n                    if (isRightEdge || isBottomEdge) {\n                        const vIdx = positionToVertexIndex.get(`${x + 1},${z}`);\n                        if (!perimeterExtensions.has(vIdx)) perimeterExtensions.set(vIdx, { extendLeft: false, extendRight: false, extendUp: false, extendDown: false });\n                        const ext = perimeterExtensions.get(vIdx);\n                        if (isRightEdge) ext.extendRight = true;\n                        if (isBottomEdge) ext.extendUp = true; // North\n                    }\n        \n                    // Top-right vertex (x + 1, z + 1) - Bottom-right in your view\n                    if (isRightEdge || isTopEdge) {\n                        const vIdx = positionToVertexIndex.get(`${x + 1},${z + 1}`);\n                        if (!perimeterExtensions.has(vIdx)) perimeterExtensions.set(vIdx, { extendLeft: false, extendRight: false, extendUp: false, extendDown: false });\n                        const ext = perimeterExtensions.get(vIdx);\n                        if (isRightEdge) ext.extendRight = true;\n                        if (isTopEdge) ext.extendDown = true; // South\n                    }\n        \n                    // Top-left vertex (x, z + 1)\n                    if (isLeftEdge || isTopEdge) {\n                        const vIdx = positionToVertexIndex.get(`${x},${z + 1}`);\n                        if (!perimeterExtensions.has(vIdx)) perimeterExtensions.set(vIdx, { extendLeft: false, extendRight: false, extendUp: false, extendDown: false });\n                        const ext = perimeterExtensions.get(vIdx);\n                        if (isLeftEdge) ext.extendLeft = true;\n                        if (isTopEdge) ext.extendDown = true; // South\n                    }\n                }\n            }\n        }\n        \n        // Step 5: Apply perimeter extensions\n        perimeterExtensions.forEach((ext, vertexIndex) => {\n            const idx = vertexIndex * 3;\n            const [origX, origZ] = originalPositions[vertexIndex];\n        \n            // Log the bottom-right corner for debugging\n            if (ext.extendRight && ext.extendDown) {\n                console.log(`Bottom-right corner at (${origX}, ${origZ}): Before extension - x: ${vertices[idx]}, z: ${vertices[idx + 2]}`);\n            }\n        \n            if (ext.extendLeft) vertices[idx] -= extensionAmount; // Extend left\n            if (ext.extendRight) vertices[idx] += extensionAmount; // Extend right\n            if (ext.extendUp) vertices[idx + 2] -= extensionAmount; // Extend north (decrease z)\n            if (ext.extendDown) vertices[idx + 2] += extensionAmount; // Extend south (increase z)\n        \n            if (ext.extendRight && ext.extendDown) {\n                console.log(`Bottom-right corner at (${origX}, ${origZ}): After extension - x: ${vertices[idx]}, z: ${vertices[idx + 2]}`);\n            }\n        });\n        \n        // Step 6: Create the BufferGeometry\n        const geometry = new THREE.BufferGeometry();\n        geometry.setAttribute('position', new THREE.Float32BufferAttribute(vertices, 3));\n        geometry.setAttribute('uv', new THREE.Float32BufferAttribute(uvs, 2));\n        geometry.setIndex(indices);\n        geometry.computeVertexNormals(); // For lighting\n        // Parse the hex color to RGB\n        const parseHexColor = (hex) => {\n            const r = parseInt(hex.slice(1, 3), 16) / 255;\n            const g = parseInt(hex.slice(3, 5), 16) / 255;\n            const b = parseInt(hex.slice(5, 7), 16) / 255;\n            return { r, g, b };\n        };\n        const waterShader = this.game.config.shaders[this.level.waterShader];\n        // Use the hex color in a ShaderMaterial\n        this.uniforms[terrainType] = JSON.parse(waterShader.uniforms);\n        let vectorizeProps = JSON.parse(waterShader.vectors);\n        vectorizeProps.forEach((prop => {\n            if (this.uniforms[terrainType][prop]) {\n                if( prop.toLowerCase().endsWith(\"color\")){\n                    const colorToUse = this.tileMap.terrainTypes[terrainType].color;\n                    const { r, g, b } = parseHexColor(colorToUse);\n                    this.uniforms[terrainType][prop].value = new THREE.Vector3(r, g, b);\n                } else {\n                    let arr = this.uniforms[terrainType][prop].value;\n                    this.uniforms[terrainType][prop].value = new THREE.Vector3(arr[0], arr[1], arr[2]);\n                }\n            }\n        }));\n        this.uniforms[terrainType].fogColor = { value: new THREE.Color(this.fogSettings.color) };\n        this.uniforms[terrainType].fogDensity = this.fogSettings.enabled ? { value: this.fogSettings.density } : 0;\n        // Reference the uniforms\n        const uniforms = this.uniforms[terrainType];\n        \n        // Create the shader material\n        const material = new THREE.ShaderMaterial({\n            uniforms: uniforms,\n            vertexShader: waterShader.vertexScript,\n            fragmentShader: waterShader.fragmentScript,\n            side: THREE.DoubleSide,\n            transparent: true\n        });\n\n        // Replace the MeshBasicMaterial with this ShaderMaterial in the mesh creation\n        const waterMesh = new THREE.Mesh(geometry, material);        \n        waterMesh.position.y = (terrainType + 2) * this.heightMapSettings.heightStep;\n        this.scene.add(waterMesh); // Assuming `this.scene` is your THREE.js scene\n    }\n}"
      },
      "SpacialGridEntity": {
        "fileName": "SpacialGridEntity",
        "script": "class SpacialGridEntity extends engine.Component {\r\n    \r\n    constructor(game, parent, params) {\r\n        super(game, parent, params);\r\n    }\r\n    \r\n    \r\n   update() {\r\n        this.game.spatialGrid.insert(this.parent);\r\n    }\r\n    destroy() {\r\n        this.game.spatialGrid.remove(this.parent);\r\n    }\r\n}"
      },
      "UpgradeManager": {
        "fileName": "UpgradeManager",
        "script": "class UpgradeManager extends engine.Component {\r\n    \r\n    constructor(game, parent, params) {\r\n        super(game, parent, params);\r\n    }\r\n    \r\n    \r\n\r\n init() {\r\nthis.game.state.activeUpgrades = {};\r\n}\r\n    update() {\r\n       this.applyActiveUpgrades();\r\n        // Level Up check\r\n        if (this.game.state.essence >= this.game.state.essenceToNextLevel && !this.game.state.isLevelingUp) {\r\n            this.showUpgradeMenu();\r\n        }\r\n    }\r\n\r\n    applyActiveUpgrades() {\r\n        engine.getFunction(\"calculateStats\")(this.game.state.stats, this.game.state.activeUpgrades['global']);    \r\n    }\r\n\r\n    \r\n    // Upgrade system\r\n    showUpgradeMenu() {\r\n        if (this.game.state.isLevelingUp) return; // Prevent re-triggering\r\n        \r\n        this.game.state.isLevelingUp = true;\r\n        this.game.state.isPaused = true;\r\n        \r\n        this.game.uiManager.upgradeMenu.style.display = 'block';\r\n        this.game.uiManager.overlay.style.display = 'block';\r\n        this.game.uiManager.upgradeOptionsDiv.innerHTML = '';\r\n        \r\n        // Filter upgrades based on conditions\r\n        const availableUpgrades = this.game.upgrades.filter(upgrade => upgrade.canApply(this.game.state));\r\n        \r\n        // Choose 3 random upgrades\r\n        const options = [];\r\n        while (options.length < 3 && availableUpgrades.length > 0) {\r\n            const index = Math.floor(Math.random() * availableUpgrades.length);\r\n            options.push(availableUpgrades[index]);\r\n            availableUpgrades.splice(index, 1);\r\n        }\r\n        \r\n        // Create upgrade options\r\n        options.forEach(upgrade => {\r\n            const div = document.createElement('div');\r\n            div.className = 'upgrade-option';\r\n            div.innerHTML = `\r\n                <div class=\"upgrade-icon\">${upgrade.icon}</div>\r\n                <div class=\"upgrade-desc\">\r\n                    <div class=\"upgrade-title\">${upgrade.title}</div>\r\n                    ${upgrade.desc}\r\n                </div>\r\n            `;\r\n            div.onclick = () => this.selectUpgrade(upgrade);\r\n            this.game.uiManager.upgradeOptionsDiv.appendChild(div);\r\n        });\r\n    }\r\n\r\n    selectUpgrade(upgrade) {       \r\n        // Add to active upgrades list if not already\r\n        if (!this.game.state.activeUpgrades[upgrade.appliesTo]) {\r\n            this.game.state.activeUpgrades[upgrade.appliesTo] = [upgrade];\r\n        } else {\r\n            this.game.state.activeUpgrades[upgrade.appliesTo].push(upgrade);\r\n        }\r\n\r\n        this.applyActiveUpgrades();\r\n        if(upgrade.onAcquire) {\r\n            upgrade.onAcquire(this.game.state);\r\n        }\r\n        \r\n        upgradeMenu.style.display = 'none';\r\n        overlay.style.display = 'none';\r\n        \r\n        this.game.state.essence -= this.game.state.essenceToNextLevel;\r\n        this.game.state.level++;\r\n        this.game.state.essenceToNextLevel = Math.floor(this.game.state.essenceToNextLevel * 1.4);        \r\n        \r\n        this.game.state.isLevelingUp = false;\r\n        this.game.state.isPaused = false;\r\n    }\r\n}"
      },
      "Leveler": {
        "fileName": "Leveler",
        "script": "class Leveler extends engine.Component {\r\n    \r\n    constructor(game, parent, params) {\r\n        super(game, parent, params);\r\n    }\r\n    \r\n    \r\n init( {level = 1}) {\r\n        this.level = level;\r\n    }\r\n}"
      },
      "MapManager": {
        "fileName": "MapManager",
        "script": "class MapManager extends engine.Component {\r\n    \r\n    constructor(game, parent, params) {\r\n        super(game, parent, params);\r\n    }\r\n    \r\n    \r\ninit({level}) {\r\n  this.nodeClass = class Node {\r\n    constructor(x, y, tileType, parent = null) {\r\n        this.x = x;\r\n        this.y = y;\r\n        this.tileType = tileType;\r\n        this.parent = parent;\r\n        \r\n        this.g = 0; // Cost from start to current node\r\n        this.h = 0; // Heuristic (estimated cost from current to goal)\r\n        this.f = 0; // Total cost (g + h)\r\n    }\r\n\r\n    equals(other) {\r\n        return this.x === other.x && this.y === other.y;\r\n    }\r\n\r\n    // Unique key for node based on coordinates\r\n    key() {\r\n        return `${this.x},${this.y}`;\r\n    }\r\n};\r\n  this.tileMap = level.tileMap;\r\n   \r\n   const {tileMap, paths} = this.generateMap();\r\n   this.game.state.tileMap = tileMap;\r\n   this.game.state.paths = paths;\r\n}\r\n\r\n    generateMap() {\r\n        // Extract values from the data object\r\n        const { size, terrainTypes, terrainMap } = this.tileMap;\r\n        \r\n        let paths = [];\r\n        let starts = [];\r\n        let endPoint = {x: 0, y: 0};\r\n\r\n        // Find START and END tile types by their IDs\r\n        const startTypeId = terrainTypes.findIndex(t => t.type === \"start\");\r\n        const endTypeId = terrainTypes.findIndex(t => t.type === \"end\");\r\n        // Create the tile map using the provided terrainMap\r\n        const tileMap = terrainMap.map((row, y) => \r\n            row.map((terrainId, x) => {\r\n                // Find the terrain object to get color information\r\n                const terrain = terrainTypes[terrainId]; \r\n                // Check for start/end points using IDs\r\n                if(terrainId === startTypeId) {\r\n                    starts.push({x: x, y: y});\r\n                } else if(terrainId === endTypeId) {\r\n                    endPoint = {x: x, y: y};\r\n                }\r\n                \r\n                return { \r\n                    type: terrain ? terrain.type : 'unknown',\r\n                    typeId: terrainId,\r\n                    color: terrain ? terrain.color : '#8bc34a', // Default to grass color if not found\r\n                    buildable: terrain ? terrain.buildable : false\r\n                };\r\n            })\r\n        );        \r\n        \r\n        starts.forEach((startPoint) => {\r\n            paths.push(this.findPath(startPoint, endPoint, terrainMap));\r\n        });\r\n\r\n        return { tileMap, paths };\r\n    }\r\n\r\n    findPath(startPoint, endPoint, tileMap) {\r\n        return this.aStar(startPoint, endPoint, tileMap);\r\n    }\r\n    \r\n    /**\r\n     * A* pathfinding algorithm\r\n     * @param {Object} start - Starting position {x, y}\r\n     * @param {Object} end - Ending position {x, y}\r\n     * @param {Array} tileMap - 2D array representing the map\r\n     * @returns {Array} - Array of positions forming the path, or empty array if no path found\r\n     */\r\n    aStar(start, end, tileMap) {\r\n       \r\n        const rows = tileMap.length;\r\n        const cols = tileMap[0].length;\r\n        \r\n        // Validate inputs\r\n        if (start.x < 0 || start.x >= cols || start.y < 0 || start.y >= rows) {\r\n            throw new Error('Start position is outside the map bounds');\r\n        }\r\n        if (end.x < 0 || end.x >= cols || end.y < 0 || end.y >= rows) {\r\n            throw new Error('End position is outside the map bounds');\r\n        }\r\n        \r\n        // Create start and end nodes\r\n        const startNode = new this.nodeClass(start.x, start.y, tileMap[start.y][start.x]);\r\n        const endNode = new this.nodeClass(end.x, end.y, tileMap[end.y][end.x]);\r\n        \r\n        // Initialize open and closed lists\r\n        const openList = [];\r\n        const closedList = new Set();\r\n        const openSet = new Set(); // For faster lookups\r\n        \r\n        // Add start node to open list\r\n        openList.push(startNode);\r\n        openSet.add(startNode.key());\r\n        \r\n        // Define movement directions (4-directional: up, right, down, left)\r\n        const directions = [\r\n            {x: 0, y: -1}, // Up\r\n            {x: 1, y: 0},  // Right\r\n            {x: 0, y: 1},  // Down\r\n            {x: -1, y: 0}  // Left\r\n            \r\n            // {x: 1, y: 1}, // Up\r\n            // {x: 1, y: -1},  // Right\r\n            // {x: -1, y: 1},  // Down\r\n            // {x: -1, y: -1}  // Left\r\n        ];\r\n        \r\n        // Main loop\r\n        while (openList.length > 0) {\r\n            // Sort by f value and take the lowest\r\n            openList.sort((a, b) => a.f - b.f);\r\n            const currentNode = openList.shift();\r\n            openSet.delete(currentNode.key());\r\n            \r\n            // Add current node to closed list\r\n            closedList.add(currentNode.key());\r\n            \r\n            // Check if we've reached the end\r\n            if (currentNode.equals(endNode)) {\r\n                // Reconstruct the path\r\n                return this.reconstructPath(currentNode);\r\n            }\r\n            \r\n            // Generate neighbors\r\n            for (const dir of directions) {\r\n                const neighborX = currentNode.x + dir.x;\r\n                const neighborY = currentNode.y + dir.y;\r\n                \r\n                // Check if neighbor is inside the map\r\n                if (neighborX < 0 || neighborX >= cols || neighborY < 0 || neighborY >= rows) {\r\n                    continue;\r\n                }\r\n                \r\n                const tileType = tileMap[neighborY][neighborX];\r\n                const neighbor = new this.nodeClass(neighborX, neighborY, tileType, currentNode);\r\n                const neighborKey = neighbor.key();\r\n                \r\n                // Skip if neighbor is in closed list\r\n                if (closedList.has(neighborKey)) {\r\n                    continue;\r\n                }\r\n                \r\n                // Calculate g score for this neighbor\r\n                // Path tiles will have a much lower cost than other tile types\r\n                let movementCost = this.calculateMovementCost(tileType);\r\n                const tentativeG = currentNode.g + movementCost;\r\n                \r\n                // Check if this is a better path to neighbor\r\n                if (!openSet.has(neighborKey) || tentativeG < neighbor.g) {\r\n                    // Update neighbor values\r\n                    neighbor.g = tentativeG;\r\n                    neighbor.h = this.calculateHeuristic(neighbor, endNode);\r\n                    neighbor.f = neighbor.g + neighbor.h;\r\n                    \r\n                    // Add neighbor to open list if not there already\r\n                    if (!openSet.has(neighborKey)) {\r\n                        openList.push(neighbor);\r\n                        openSet.add(neighborKey);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        \r\n        // No path found\r\n        return [];\r\n    }\r\n    \r\n    /**\r\n     * Calculate movement cost based on tile type\r\n     * Path tiles are heavily favored\r\n     * @param {number} tileTypeId - ID of the tile type\r\n     * @returns {number} - Movement cost\r\n     */\r\n    calculateMovementCost(tileTypeId) {\r\n        // Find path and end type IDs\r\n        const { terrainTypes } = this.tileMap;\r\n        const pathTypeId = terrainTypes.findIndex(t => t.type === \"path\");\r\n        const endTypeId = terrainTypes.findIndex(t => t.type === \"end\");\r\n        \r\n        // Heavily favor \"path\" and \"end\" type tiles\r\n        if (tileTypeId === pathTypeId || tileTypeId === endTypeId) {\r\n            return 1;\r\n        } else {\r\n            // Make non-path tiles much less desirable\r\n            return 100000;\r\n        }\r\n    }\r\n    \r\n    /**\r\n     * Calculate heuristic (Manhattan distance)\r\n     * @param {Node} nodeA \r\n     * @param {Node} nodeB \r\n     * @returns {number} - Heuristic value\r\n     */\r\n    calculateHeuristic(nodeA, nodeB) {\r\n        return Math.abs(nodeA.x - nodeB.x) + Math.abs(nodeA.y - nodeB.y);\r\n    }\r\n    \r\n    /**\r\n     * Reconstruct the path from the end node to the start\r\n     * @param {Node} endNode - The end node\r\n     * @returns {Array} - Array of positions {x, y} from start to end\r\n     */\r\n    reconstructPath(endNode) {\r\n        const path = [];\r\n        let currentNode = endNode;\r\n        \r\n        while (currentNode !== null) {\r\n            path.unshift({\r\n                x: currentNode.x,\r\n                y: currentNode.y,\r\n                tileType: currentNode.tileType\r\n            });\r\n            currentNode = currentNode.parent;\r\n        }\r\n        \r\n        return path;\r\n    }\r\n}"
      },
      "MultishotProjectile": {
        "fileName": "MultishotProjectile",
        "script": "class MultishotProjectile extends engine.Component {\r\n    \r\n    constructor(game, parent, params) {\r\n        super(game, parent, params);\r\n    }\r\n    \r\n    \r\ninit({ spawnType, stats, target, owner }) {\r\n  this.type = spawnType;\r\n  this.stats = stats;\r\n  this.target = target;\r\n  const ownerStats = owner.getComponent('stats').stats;\r\n  const spreadCount = ownerStats.projectileCount || 3; // Total projectiles (e.g., 3: center + 2 sides)\r\n    const spreadAngleDegrees = ownerStats.projectileAngle || 45; // Default to 45 degrees\r\n  const spreadAngle = spreadAngleDegrees * (Math.PI / 180); // Convert degrees to radians\r\n\r\n \r\n  // Calculate the base direction to the target\r\n  const dx = target.position.x - this.parent.position.x;\r\n  const dy = target.position.y - this.parent.position.y;\r\n  const baseAngle = Math.atan2(dy, dx); // Angle from parent to target in radians\r\n  const distance = Math.sqrt(dx * dx + dy * dy);\r\n\r\n  // Total spread angle (e.g., for 3 projectiles: -spreadAngle, 0, +spreadAngle)\r\n  const totalSpread = spreadAngle * (spreadCount - 1); // Max angle covered by all projectiles\r\n\r\n  // Spawn projectiles in a symmetrical fan\r\n  for (let i = 0; i < spreadCount; i++) {\r\n    // Calculate the angle offset from the center\r\n    const offsetIndex = i - Math.floor(spreadCount / 2); // Center at 0 (e.g., -1, 0, 1 for 3)\r\n    const currentAngle = baseAngle + (offsetIndex * spreadAngle);\r\n\r\n    // Calculate the new target position based on the angle\r\n    const deltaX = Math.cos(currentAngle) * distance;\r\n    const deltaY = Math.sin(currentAngle) * distance;\r\n\r\n    this.game.spawn(\r\n      this.parent.position.x,\r\n      this.parent.position.y,\r\n      \"projectile\",\r\n      {\r\n        spawnType: ownerStats.projectile,\r\n        objectType: \"projectiles\",\r\n        owner: owner,\r\n        stats: stats,\r\n        target: target,\r\n        targetPosition: {\r\n          x: this.parent.position.x + deltaX, // Start from parent, extend to new position\r\n          y: this.parent.position.y + deltaY\r\n        }\r\n      }\r\n    );\r\n  }\r\n\r\n  this.parent.destroy();\r\n}\r\n}"
      },
      "Animator": {
        "fileName": "Animator",
        "script": "class Animator extends engine.Component {\r\n    \r\n    constructor(game, parent, params) {\r\n        super(game, parent, params);\r\n        \r\n    }\r\n    \r\n    \r\n    init({ objectType, spawnType}) {\r\n\r\n        this.animations = this.game.imageManager.getImages(objectType, spawnType); // { \"idle\": [...], \"walk\": [...] }\r\n        this.currentAnimation = \"idle\";\r\n        if(this.animations.walk) this.currentAnimation = \"walk\";\r\n        this.currentFrame = 0;\r\n        this.frameDuration = .166; // 10 frames per animation frame (~0.166s at 60 FPS)\r\n        this.frameTimer = 0;\r\n\r\n        this.baseSpeed = this.parent.getComponent(\"stats\")?.stats.speed || 1;\r\n    }\r\n\r\n    update() {\r\n        \r\n        this.frameTimer += this.game.deltaTime;\r\n        let currentSpeedPercent = this.parent.getComponent(\"stats\")?.stats.speed / this.baseSpeed || 1;\r\n\r\n        if (this.frameTimer >= this.frameDuration / currentSpeedPercent) {\r\n            this.frameTimer = 0;\r\n            const animFrames = this.animations[this.currentAnimation];\r\n            this.currentFrame = (this.currentFrame + 1) % animFrames.length;\r\n        }\r\n        // Sync direction with Renderer (if separate)\r\n        const renderer = this.parent.getComponent(\"Renderer\");\r\n        if (renderer) {\r\n            renderer.images = this.animations[this.currentAnimation][this.currentFrame];\r\n        }\r\n    }\r\n\r\n    setAnimation(animationType) {\r\n        if (this.animations[animationType] && this.currentAnimation !== animationType) {\r\n            this.currentAnimation = animationType;\r\n            this.currentFrame = 0;\r\n            this.frameTimer = 0;\r\n        }\r\n    }\r\n    \r\n}"
      },
      "Attacker": {
        "fileName": "Attacker",
        "script": "class Attacker extends engine.Component {\r\n    \r\n    constructor(game, parent, params) {\r\n        super(game, parent, params);\r\n    }\r\n    \r\n    \r\n init() {        \r\n        this.stats = this.getComponent('stats').stats;    \r\n        this.level = 1;\r\n        this.target = null;\r\n        this.projectiles = [];  \r\n        this.cooldown = 0;\r\n    }\r\n\r\n    update() {\r\n        if (this.cooldown > 0) this.cooldown -= this.game.deltaTime;\r\n\r\n        // Validate current target\r\n        if (this.target) {\r\n            const distance = Math.hypot(\r\n                this.target.position.x - this.parent.position.x,\r\n                this.target.position.y - this.parent.position.y\r\n            );\r\n            if (distance > this.stats.range || this.target.getComponent('health').hp <= 0) {\r\n                this.target = null;\r\n            }\r\n        }\r\n\r\n        // Find target if none\r\n        if (!this.target) {\r\n            this.findTarget();\r\n        }\r\n\r\n        // Attack if ready and has target\r\n        if (this.cooldown <= 0 && this.target) {\r\n            this.attack();\r\n        }\r\n\r\n        if (this.cooldown <= 0 && this.stats.mineAmt > 0) {\r\n            this.gather();\r\n        }\r\n        return true;\r\n    }\r\n    \r\n    findTarget() {\r\n        this.target = null;\r\n        let furthestEnemy = null;\r\n        let furthestDistance = -1;\r\n        const nearbyEntities = this.game.spatialGrid.getNearbyEntities(\r\n            this.parent.gridPosition.x, \r\n            this.parent.gridPosition.y, \r\n            this.stats.range,\r\n            \"enemy\"\r\n        );\r\n        for (let enemy of nearbyEntities) {\r\n            let enemyHP = enemy.getComponent(\"health\").hp;\r\n            let followPath = enemy.getComponent('followPath');\r\n            if (enemyHP <= 0) continue;          \r\n\r\n            let distanceToEnd = this.game.state.paths[followPath.pathIndex].length - followPath.indexInPath;\r\n            if (distanceToEnd > furthestDistance) {\r\n                furthestDistance = followPath.indexInPath;\r\n                furthestEnemy = enemy;\r\n            }  \r\n        }\r\n        \r\n        this.target = furthestEnemy;\r\n    }\r\n\r\n    gather() {\r\n        this.game.state.bloodShards += this.stats.mineAmt;\r\n        this.cooldown = this.stats.attackSpeed;\r\n    }\r\n\r\n    attack() {\r\n        if (!this.target) return; \r\n        this.launchProjectile();\r\n        this.cooldown = this.stats.attackSpeed;\r\n    }\r\n    \r\n    launchProjectile() {\r\n        this.stats = this.getComponent('stats').stats;    \r\n        let projectileType = this.stats.projectile;\r\n        let projectileDef = this.game.config.projectiles[projectileType];\r\n        \r\n\r\n        let projStats = { ...projectileDef };\r\n        delete projStats.render;\r\n        projStats.baseDamage = this.stats.damage || 1; \r\n        projStats.speed = this.stats.speed || 5;     \r\n        projStats.piercing = this.stats.piercing || 0;\r\n        projStats.splashRadius = this.stats.splashRadius || 0;\r\n        projStats.critChance = this.stats.critChance || 0.05;\r\n        projStats.critMultiplier = this.stats.critMultiplier || 2;\r\n    \r\n       \tif(projectileDef.customRenderer == \"lightning\") {\r\n         \tthis.game.spawn(this.parent.position.x, this.parent.position.y, 'lightningProjectile', { objectType: \"projectiles\", spawnType: projectileType, target: this.target, owner: this.parent, stats: projStats });\r\n        } else if(projectileDef.isBallistic) {\r\n         \tthis.game.spawn(this.parent.position.x, this.parent.position.y, 'ballisticProjectile', { objectType: \"projectiles\", spawnType: projectileType, target: this.target, owner: this.parent, stats: projStats });\r\n        } else if( this.stats.projectileCount > 0 ) {\r\n          this.game.spawn(this.parent.position.x, this.parent.position.y, 'multiShotProjectile', { objectType: \"projectiles\", spawnType: projectileType, target: this.target, owner: this.parent, stats: projStats });\r\n        } else {\r\n          let projectile = this.game.spawn(this.parent.position.x, this.parent.position.y, 'projectile', { objectType: \"projectiles\", spawnType: projectileType, target: this.target, owner: this.parent, stats: projStats });\r\n        }\r\n    }\r\n}"
      },
      "FollowPath": {
        "fileName": "FollowPath",
        "script": "class FollowPath extends engine.Component {\r\n    \r\n    constructor(game, parent, params) {\r\n        super(game, parent, params);\r\n    }\r\n    \r\n    init({ pathIndex = 0 }) {\r\n        this.gridSize = this.game.config.configs.game.gridSize;\r\n        this.pathIndex = pathIndex;\r\n        this.indexInPath = 0;\r\n        // Store grid coordinates\r\n        this.x = this.game.state.paths[this.pathIndex][this.indexInPath].x;\r\n        this.y = this.game.state.paths[this.pathIndex][this.indexInPath].y;\r\n        // Convert to pixel position\r\n        this.parent.position = { \r\n            x: this.x * this.gridSize + this.gridSize / 2, \r\n            y: this.y * this.gridSize + this.gridSize / 2 \r\n        };\r\n        this.progress = 0; // Progress between grid points (0 to 1)\r\n        \r\n        // Convert pixel-based speed to grid-based speed\r\n        this.stats = this.getComponent('stats').stats;\r\n        this.gridSpeed = this.stats.speed / this.gridSize;\r\n    }\r\n\r\n    update() {\r\n        this.stats = this.getComponent('stats').stats;\r\n        this.gridSize = this.game.config.configs.game.gridSize;\r\n\r\n        if (this.indexInPath < this.game.state.paths[this.pathIndex].length - 1) {\r\n            const target = this.game.state.paths[this.pathIndex][this.indexInPath + 1];\r\n            \r\n            // Use converted grid-based speed\r\n            this.progress += this.gridSpeed * this.game.deltaTime * 100;\r\n            \r\n            if (this.progress >= 1) {\r\n                this.indexInPath++;\r\n                this.progress = 0;\r\n                this.x = target.x;\r\n                this.y = target.y;\r\n            } else {\r\n                // Interpolate between current and target grid positions\r\n                this.x = this.game.state.paths[this.pathIndex][this.indexInPath].x * (1 - this.progress) + \r\n                        target.x * this.progress;\r\n                this.y = this.game.state.paths[this.pathIndex][this.indexInPath].y * (1 - this.progress) + \r\n                        target.y * this.progress;\r\n            }\r\n            \r\n            // Convert grid coordinates to pixel coordinates\r\n            this.parent.position.x = this.x * this.gridSize + this.gridSize / 2;\r\n            this.parent.position.y = this.y * this.gridSize + this.gridSize / 2;\r\n            this.parent.position.z = this.game.gameEntity.getComponent('game').getTerrainHeight(this.parent.gridPosition);\r\n        } else {\r\n            this.game.state.bloodCoreHP -= this.stats.value;\r\n            this.parent.destroy();\r\n            return false;\r\n        }\r\n    }\r\n}"
      }
    },
    "entities": {
      "ballisticProjectile": {
        "title": "Ballistic Projectile",
        "components": [
          "Stats",
          "ArrayTracker",
          "BallisticProjectile",
          "Animator"
        ],
        "renderers": [
          "ModelRenderer",
          "Renderer"
        ]
      },
      "game": {
        "title": "Game",
        "components": [
          "MapManager",
          "WaveManager",
          "UpgradeManager",
          "AudioManager",
          "ThreeJsWorld",
          "Game"
        ],
        "renderers": [
          "MapRenderer",
          "UiManager"
        ]
      },
      "hitEffect": {
        "title": "Hit Effect",
        "components": [
          "HitEffectParticle",
          "LifeSpan"
        ],
        "renderers": [
          "HitEffectRenderer"
        ]
      },
      "multiShotProjectile": {
        "title": "Multi-Shot Projectile",
        "components": [
          "Stats",
          "MultishotProjectile"
        ],
        "renderers": []
      },
      "particle": {
        "title": "Particle",
        "components": [
          "Stats",
          "LifeSpan",
          "Animator"
        ],
        "renderers": [
          "ModelRenderer",
          "Renderer"
        ]
      },
      "projectile": {
        "title": "Projectile",
        "components": [
          "Stats",
          "ArrayTracker",
          "Projectile",
          "Animator"
        ],
        "renderers": [
          "ModelRenderer",
          "Renderer"
        ]
      },
      "staticObject": {
        "title": "Static Object",
        "components": [
          "ArrayTracker",
          "Animator"
        ],
        "renderers": [
          "ModelRenderer",
          "Renderer"
        ]
      },
      "explosion": {
        "title": "Explosion",
        "components": [],
        "renderers": [
          "Explosion"
        ]
      },
      "lightningProjectile": {
        "title": "Lightning Projectile",
        "components": [
          "Stats",
          "ArrayTracker",
          "ChainProjectile"
        ],
        "renderers": [
          "LightningRenderer"
        ]
      },
      "previewTower": {
        "title": "Preview Tower",
        "components": [
          "Stats",
          "Animator"
        ],
        "renderers": [
          "ModelRenderer",
          "RangeIndicator",
          "Renderer"
        ]
      },
      "summonedTower": {
        "title": "Summoned Tower",
        "components": [
          "Stats",
          "ArrayTracker",
          "Attacker",
          "LifeSpan",
          "Animator"
        ],
        "renderers": [
          "ModelRenderer",
          "RangeIndicator",
          "Renderer"
        ]
      },
      "GameLoader": {
        "title": "Game Loader",
        "components": [
          "GameLoader"
        ],
        "renderers": []
      },
      "enemy": {
        "title": "Enemy",
        "components": [
          "Stats",
          "EssenceBounty",
          "FollowPath",
          "SpacialGridEntity",
          "ArrayTracker",
          "Animator"
        ],
        "renderers": [
          "ModelRenderer",
          "Health",
          "EnergyShield",
          "Renderer"
        ]
      },
      "tower": {
        "title": "Tower",
        "components": [
          "Stats",
          "ArrayTracker",
          "Leveler",
          "Buildable",
          "PopulationBurden",
          "Attacker",
          "Animator"
        ],
        "renderers": [
          "ModelRenderer",
          "RangeIndicator",
          "Renderer"
        ]
      }
    },
    "functions": {
      "calculateDamage": {
        "fileName": "calculateDamage",
        "script": "function calculateDamage(attack, target) {\r\n    // Set default values if not provided\r\n    \r\n    attack.speed = attack.speed || 5;     \r\n    attack.piercing = attack.piercing || 0,\r\n    attack.splashRadius = attack.splashRadius || 0;\r\n    attack.critChance = attack.critChance || .05;\r\n    attack.critMultiplier = attack.critMultiplier || 2;\r\n    attack.penetration = {\r\n      \"fire\": attack.firePenetration || 0,\r\n      \"electric\": attack.electricPenetration || 0,\r\n      \"cold\": attack.coldPenetration || 0,\r\n      \"physical\": attack.physicalPenetration || 0,\r\n      \"toxic\": attack.toxicPenetration || 0,\r\n    }\r\n    target.resistances = {\r\n      \"fire\": target.fireResistance || 0,\r\n      \"electric\": target.electricResistance || 0,\r\n      \"cold\": target.coldResistance || 0,\r\n      \"physical\": target.physicalResistance || 0,\r\n      \"toxic\": target.toxicResistance || 0,\r\n    }\r\n    \r\n    // Initialize result object\r\n    const result = {\r\n      damageBlocked: 0,\r\n      damageAbsorbed: 0,\r\n      damageDealt: 0,\r\n      energyShieldRemaining: target.energyShield || 0,\r\n      wasEvaded: false,\r\n      wasCritical: Math.random() <= attack.critChance,\r\n      hitDetails: {}\r\n    };\r\n    \r\n    // Check for evasion\r\n    if (target.evasion && target.evasion > 0) {\r\n      const evasionRoll = Math.random() * 100;\r\n      if (evasionRoll < target.evasion) {\r\n        result.wasEvaded = true;\r\n        result.hitDetails.evasion = \"Attack evaded\";\r\n        return result;\r\n      }\r\n    }\r\n    \r\n    // Calculate initial damage\r\n    let damage = attack.baseDamage;\r\n    \r\n    // Apply critical hit\r\n    if (result.wasCritical) {\r\n      damage *= attack.critMultiplier;\r\n      result.hitDetails.critical = `Critical hit (${attack.critMultiplier}x damage)`;\r\n    }\r\n    \r\n    // Apply resistances based on damage type\r\n  \r\n    if(attack.damageType != \"physical\") {\r\n      const resistance = target.resistances[attack.damageType] || 0;\r\n      const penetration = attack.penetration[attack.damageType] || 0;\r\n      const finalResist = resistance - penetration;\r\n      let resistanceMultiplier = 1 - (finalResist / 100);\r\n      damage *= resistanceMultiplier;\r\n  \r\n      \r\n      if (finalResist !== 0) {\r\n        if (finalResist > 0) {\r\n          result.hitDetails.resistance = `${attack.damageType} resisted (${finalResist}%)`;\r\n        } else {\r\n          result.hitDetails.resistance = `${attack.damageType} vulnerability (${-finalResist}%)`;\r\n        }\r\n      }  \r\n    }\r\n    \r\n    // Apply armor (only affects physical damage)\r\n    if (attack.damageType === \"physical\" && target.armor > 0) {\r\n      let effectiveArmor = target.armor;\r\n      if (attack.penetration.physical > 0 ) {\r\n        // Piercing ignores 75% of armor\r\n        effectiveArmor = target.armor * (1 - attack.penetration.physical);\r\n      }\r\n      // Armor formula: damage reduction percentage = armor / (armor + 100)\r\n      const armorReduction = effectiveArmor / (effectiveArmor + 100);\r\n      const blockedDamage = damage * armorReduction;\r\n      \r\n      damage -= blockedDamage;\r\n      result.damageBlocked = blockedDamage;\r\n      result.hitDetails.armor = `Armor blocked ${blockedDamage.toFixed(1)} damage`;\r\n    }\r\n    \r\n    // Round damage to 1 decimal place for cleaner numbers\r\n    damage = Math.round(damage * 10) / 10;\r\n    \r\n    // Apply shield absorption\r\n    if (target.energyShield > 0) {\r\n      if (damage <= target.energyShield) {\r\n        // Shield absorbs all damage\r\n        result.damageAbsorbed = damage;\r\n        result.energyShieldRemaining = target.energyShield - damage;\r\n        result.hitDetails.energyShield = `Shield absorbed all damage, ${result.energyShieldRemaining.toFixed(1)} shield remaining`;\r\n        damage = 0;\r\n      } else {\r\n        // Shield is depleted, remaining damage goes through\r\n        result.damageAbsorbed = target.energyShield;\r\n        result.damageDealt = damage - target.energyShield;\r\n        result.energyShieldRemaining = 0;\r\n        result.hitDetails.energyShield = `Shield depleted, ${result.damageDealt.toFixed(1)} damage dealt to health`;\r\n        damage -= target.energyShield;\r\n      }\r\n    } else {\r\n      // No shield, all damage goes to health\r\n      result.damageDealt = damage;\r\n    }\r\n    \r\n    // Make sure we don't return negative damage\r\n    result.damageDealt = Math.max(0, result.damageDealt);\r\n    \r\n    return result;\r\n  }\r\n"
      },
      "calculateStats": {
        "fileName": "calculateStats",
        "script": "function calculateStats(stats, calcArray) {\r\n\r\n    if( calcArray && calcArray.length > 0 ) {\r\n        let additiveStats = {};\r\n        let multiplicitiveStats = {};\r\n        for(let key in stats) {\r\n            additiveStats[key] = [];\r\n            multiplicitiveStats[key] = [];\r\n        }\r\n        for(let effect of calcArray) {\r\n            effect.apply(stats, additiveStats, multiplicitiveStats);\r\n        }\r\n        let addedEffects = {};\r\n        for(let key in additiveStats){\r\n            for(let val of additiveStats[key]){ \r\n                if(addedEffects[key]){\r\n                    addedEffects[key] += val - 1;\r\n                } else {\r\n                    addedEffects[key] = val - 1;\r\n                }\r\n            }\r\n        }\r\n\r\n        for(let key in addedEffects) {\r\n            if( stats[key] ) {\r\n                stats[key] *= ( 1 + addedEffects[key] );\r\n            }\r\n        }\r\n\r\n        let multipliedUpgrades = {};        \r\n        for(let key in multiplicitiveStats){\r\n            for(let val of multiplicitiveStats[key]){ \r\n                if(stats[key]){\r\n                    stats[key] *= val;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}"
      }
    },
    "interfaces": {
      "aiPromptPanel": {
        "title": "AI Prompt Panel",
        "modals": [
          "aiPromptPanel"
        ],
        "fileName": "aiPromptPanel"
      },
      "scriptEditor": {
        "title": "Script Editor",
        "fileName": "scriptEditor",
        "css": "\r\n#script-editor-container .grid-background {\r\n    width: calc(100% - 450px);\r\n}\r\n/* Override global scrollbar suppression for CodeMirror */\r\n#script-editor-container .CodeMirror {\r\n    overflow-y: auto !important; /* Enable vertical scrolling */\r\n    -ms-overflow-style: auto !important; /* IE and Edge */\r\n    scrollbar-width: auto !important; /* Firefox */\r\n}\r\n\r\n/* Container and layout */\r\n#script-editor-container {\r\n    position: relative;\r\n    height: auto; /* Allow dynamic resizing */\r\n}\r\n\r\n#script-editor-container .grid-background {\r\n    width: calc(100% - 360px); /* Adjust for sidebar width */\r\n    flex: 1;\r\n    position: relative;\r\n    overflow: hidden; /* Contain children */\r\n}\r\n\r\n#script-editor-container .grid-background > div {\r\n    position: relative;\r\n    height: 100%;\r\n}\r\n#script-editor-sidebar {\r\n    width: 360px;\r\n    padding: 10px;\r\n}",
        "html": "            <div id=\"script-editor-container\" class=\"main-content-container\">\r\n                <div id=\"script-editor-sidebar\" class=\"content-sidebar\">                    \r\n                    <h3>Script Editor</h3>\r\n                    <button id=\"save-script-btn\">Save Script</button>\r\n                </div>\r\n                <div class=\"grid-background\">\r\n                    <div>\r\n                        <textarea id=\"script-editor\" class=\"script-editor\" placeholder=\"Enter your script here...\"></textarea>                    \r\n                        <div class=\"handle\"></div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n"
      },
      "main": {
        "title": "Main Interface",
        "modals": [],
        "fileName": "main",
        "css": ":root {\r\n\t/* Solid hex colors */\r\n\t--primary-dark: #0f2418;\r\n\t/* Deep forest green */\r\n\t--primary-bg: #1a3526;\r\n\t/* Dark moss green */\r\n\t--secondary-bg: #224031;\r\n\t/* Muted pine green */\r\n\t--accent-color: #4a7c59;\r\n\t/* Fresh green (main accent) - matches grass */\r\n\t--bright-accent: #5a9e6f;\r\n\t/* Lighter, vibrant green */\r\n\t--highlight-color: #6abe54;\r\n\t/* Soft green highlight - matches necroOrb */\r\n\t--shadow-color: #3a443c;\r\n\t/* Darker green for shadows */\r\n\t--text-color: #f7f7f0;\r\n\t/* Off-white for readability - matches our palette */\r\n\t--gold-color: #e3d163;\r\n\t/* Warm gold - matches goldMine inner */\r\n\t--essence-color: #7047a3;\r\n\t/* Purple for essence - matches necromancer color */\r\n\t--health-color: #4a7c59;\r\n\t/* Forest green - matches grass */\r\n\t/* Opacity variables for use with solid colors */\r\n\t--semi-transparent: 0.6;\r\n\t--high-transparent: 0.8;\r\n\t--very-high-transparent: 0.95;\r\n\t--low-transparent: 0.3;\r\n\t--overlay-transparent: 0.75;\r\n\t--hover-transparent: 0.9;\r\n\t--full-transparent: 0.98;\r\n\t--near-full-transparent: 0.99;\r\n}\r\n\r\n* {\r\n\tmargin: 0;\r\n\tpadding: 0;\r\n\tbox-sizing: border-box;\r\n}\r\n\r\nbody {\r\n\tmargin: 0;\r\n\tpadding: 0;\r\n\tbackground-color: var(--primary-dark);\r\n\tbackground-image: radial-gradient(circle at center, var(--primary-bg) 0%, var(--primary-dark) 100%);\r\n\tcolor: var(--text-color);\r\n\tfont-family: 'Crimson Pro', serif;\r\n\toverflow: hidden;\r\n\tline-height: 1.6;\r\n}\r\n\r\n#gameContainer {\r\n    position: relative;\r\n    width: 100vw;\r\n    height: 100vh;\r\n}\r\n\r\ncanvas { \r\n    background-color: var(--secondary-bg);\r\n    transition: transform 0.3s ease;\r\n    width: 100vw;\r\n    height: 100vh;\r\n    position: absolute;\r\n    left: 0;\r\n    top: 0;\r\n    right: 0;\r\n    bottom: 0;\r\n    margin: 0;\r\n    z-index: 0;\r\n}\r\n\r\n/* ========== Tower Menu Container ========== */\r\n#towerMenu {\r\n    position: absolute;\r\n    bottom: 30px;\r\n    border-radius: 14px;\r\n    padding: .5em;\r\n    max-width: 90%;\r\n    width: 820px;\r\n    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.4);\r\n    border: 1px solid var(--accent-color);\r\n\tbackground-color: var(--primary-dark);\r\n    display: grid;\r\n    grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));\r\n    gap: 5px;\r\n    z-index: 100;\r\n\tleft: 0;\r\n\tright: 0;\r\n\tmargin: 0 auto;\r\n\toverflow-x: auto;\r\n\toverflow-y: hidden;\r\n\tpadding: 10px;\r\n\tscrollbar-width: thin;\r\n\tscrollbar-color: var(--accent-color) transparent;\r\n}\r\n\r\n/* ========== Tower Options ========== */\r\n.tower-option {\r\n\tbackground-color: var(--secondary-bg);\r\n\tborder-radius: 8px;\r\n\tborder: 1px solid var(--accent-color);\r\n\tcolor: var(--text-color);\r\n\tcursor: pointer;\r\n\tpadding: .1em .5em;\r\n}\r\n.tower-option:hover {\r\n\tbackground-color: var(--primary-bg);\r\n\ttransition: background-color 0.3s ease;\r\n}\t\r\n\r\n#statsContainer {\r\n\twidth: 800px;\r\n\tmax-width: 90%;\r\n\tpadding: 12px;\r\n\tbackground: var(--primary-dark);\r\n\tborder-radius: 10px;\r\n\tborder: 1px solid var(--accent-color);\r\n\tborder-opacity: var(--low-transparent);\r\n\t/* Note: This won't work directly; see below */\r\n\tbackdrop-filter: blur(5px);\r\n\tposition: absolute;\r\n\tz-index: 1;\r\n\tmargin: 1em auto;\r\n\tleft: 0;\r\n\tright: 0;\r\n}\r\n\r\n#stats {\r\n\tdisplay: flex;\r\n\tjustify-content: space-around;\r\n\tgap: 20px;\r\n\tflex-wrap: wrap;\r\n}\r\n\r\n.stat {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tgap: 8px;\r\n\tfont-size: 1.1rem;\r\n}\r\n\r\n.stat-icon {\r\n\twidth: 24px;\r\n\theight: 24px;\r\n\tborder-radius: 50%;\r\n\tbox-shadow: 0 0 8px #000;\r\n\tdisplay: flex;\r\n\tjustify-content: center;\r\n\talign-items: center;\r\n}\r\n\r\n#upgradeMenu {\r\n\tposition: absolute;\r\n\ttop: 50%;\r\n\tleft: 50%;\r\n\ttransform: translate(-50%, -50%);\r\n\tbackground: linear-gradient(to bottom, var(--secondary-bg), var(--primary-dark));\r\n\topacity: var(--very-high-transparent);\r\n\tcolor: var(--text-color);\r\n\tpadding: 25px;\r\n\tborder-radius: 12px;\r\n\tborder: 2px solid var(--accent-color);\r\n\tdisplay: none;\r\n\tz-index: 10;\r\n\twidth: 450px;\r\n\tbox-shadow: 0 0 40px var(--shadow-color);\r\n\tbackdrop-filter: blur(10px);\r\n}\r\n\r\n#upgradeMenu h2 {\r\n\ttext-align: center;\r\n\tcolor: var(--highlight-color);\r\n\tmargin-top: 0;\r\n\tborder-bottom: 1px solid var(--accent-color);\r\n\tpadding-bottom: 15px;\r\n\tfont-family: 'Cinzel', serif;\r\n\tletter-spacing: 1px;\r\n\tfont-weight: 700;\r\n}\r\n\r\n.upgrade-option {\r\n\tmargin: 18px 0;\r\n\tpadding: 18px;\r\n\tbackground: linear-gradient(to right, var(--secondary-bg), var(--primary-bg));\r\n\topacity: var(--high-transparent);\r\n\tcursor: pointer;\r\n\tborder-radius: 8px;\r\n\ttransition: all 0.3s;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tborder: 1px solid var(--accent-color);\r\n\tborder-opacity: var(--low-transparent);\r\n\t/* Note: This won't work directly; see below */\r\n\tbox-shadow: 0 4px 8px #000;\r\n}\r\n\r\n.upgrade-option:hover {\r\n\tbackground: linear-gradient(to right, var(--accent-color), var(--bright-accent));\r\n\topacity: var(--hover-transparent);\r\n\ttransform: translateX(8px);\r\n\tbox-shadow: 0 6px 12px #000;\r\n}\r\n\r\n.upgrade-icon {\r\n\twidth: 48px;\r\n\theight: 48px;\r\n\tmargin-right: 18px;\r\n\tbackground: linear-gradient(135deg, var(--accent-color), var(--secondary-bg));\r\n\tborder-radius: 8px;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n\tfont-size: 22px;\r\n\tbox-shadow: 0 3px 6px #000;\r\n}\r\n\r\n.upgrade-desc {\r\n\tflex-grow: 1;\r\n}\r\n\r\n.upgrade-title {\r\n\tfont-weight: bold;\r\n\tmargin-bottom: 6px;\r\n\tcolor: var(--highlight-color);\r\n\tfont-size: 1.2rem;\r\n\tfont-family: 'Cinzel', serif;\r\n}\r\n\r\n#overlay {\r\n\tposition: absolute;\r\n\ttop: 0;\r\n\tleft: 0;\r\n\twidth: 100%;\r\n\theight: 100%;\r\n\tbackground: #000;\r\n\topacity: var(--overlay-transparent);\r\n\tdisplay: none;\r\n\tz-index: 5;\r\n\tbackdrop-filter: blur(3px);\r\n}\r\n\r\n#waveInfo {\r\n\tposition: absolute;\r\n\ttop: 15px;\r\n\tleft: 50%;\r\n\ttransform: translateX(-50%);\r\n\tbackground: linear-gradient(to right, var(--secondary-bg), var(--primary-bg));\r\n\topacity: var(--high-transparent);\r\n\tpadding: 8px 20px;\r\n\tborder-radius: 20px;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tgap: 15px;\r\n\tbox-shadow: 0 4px 12px #000;\r\n\tborder: 1px solid var(--accent-color);\r\n\tborder-opacity: var(--low-transparent);\r\n\t/* Note: This won't work directly; see below */\r\n\tbackdrop-filter: blur(5px);\r\n}\r\n\r\n#waveDisplay {\r\n\tfont-weight: bold;\r\n\tcolor: var(--highlight-color);\r\n}\r\n\r\n.progress-bar {\r\n\twidth: 220px;\r\n\theight: 12px;\r\n\tbackground: var(--primary-dark);\r\n\tborder-radius: 6px;\r\n\toverflow: hidden;\r\n\tbox-shadow: inset 0 1px 3px #000;\r\n\tborder: 1px solid var(--accent-color);\r\n\tborder-opacity: var(--low-transparent);\r\n\t/* Note: This won't work directly; see below */\r\n}\r\n\r\n.progress-fill {\r\n\theight: 100%;\r\n\tbackground: linear-gradient(to right, var(--accent-color), var(--highlight-color));\r\n\twidth: 0%;\r\n\tbox-shadow: 0 0 8px var(--shadow-color);\r\n\ttransition: width 0.3s ease;\r\n}\r\n\r\n#startGameBtn {\r\n\tpadding: 12px 35px;\r\n\tbackground: linear-gradient(to bottom, var(--bright-accent), var(--accent-color));\r\n\tcolor: white;\r\n\tborder: none;\r\n\tborder-radius: 30px;\r\n\tcursor: pointer;\r\n\tfont-family: 'Cinzel', serif;\r\n\tfont-weight: 500;\r\n\tfont-size: 1.2rem;\r\n\ttransition: all 0.3s;\r\n\tbox-shadow: 0 6px 12px #000;\r\n\ttext-shadow: 0 1px 2px #000;\r\n\tposition: absolute;\r\n\ttop: 50%;\r\n\tleft: 50%;\r\n\ttransform: translate(-50%, -50%);\r\n\tz-index: 20;\r\n}\r\n\r\n#startGameBtn:hover {\r\n\tbackground: linear-gradient(to bottom, var(--highlight-color), var(--bright-accent));\r\n\ttransform: translate(-50%, -50%) scale(1.05);\r\n\tbox-shadow: 0 8px 16px #000;\r\n}\r\n\r\n#startGameBtn:active {\r\n\ttransform: translate(-50%, -50%) scale(1);\r\n\tbox-shadow: 0 4px 8px #000;\r\n}\r\n\r\n#tooltip {\r\n\tposition: absolute;\r\n\tbackground: linear-gradient(to bottom, var(--primary-dark), var(--primary-dark));\r\n\topacity: var(--very-high-transparent);\r\n\tcolor: var(--text-color);\r\n\tpadding: 12px 15px;\r\n\tborder-radius: 8px;\r\n\tdisplay: none;\r\n\tz-index: 100;\r\n\tborder: 1px solid var(--accent-color);\r\n\tpointer-events: none;\r\n\tmax-width: 280px;\r\n\tbox-shadow: 0 0 20px var(--shadow-color);\r\n\tfont-size: 0.95rem;\r\n\tbackdrop-filter: blur(5px);\r\n}\r\n\r\n#gameOverMenu,\r\n#victoryMenu {\r\n\tposition: absolute;\r\n\ttop: 50%;\r\n\tleft: 50%;\r\n\ttransform: translate(-50%, -50%);\r\n\tbackground: linear-gradient(to bottom, var(--secondary-bg), var(--primary-dark));\r\n\topacity: var(--full-transparent);\r\n\tcolor: white;\r\n\tpadding: 40px;\r\n\ttext-align: center;\r\n\tborder-radius: 15px;\r\n\tborder: 3px solid var(--accent-color);\r\n\tz-index: 20;\r\n\tdisplay: none;\r\n\tbox-shadow: 0 0 60px var(--shadow-color);\r\n\tbackdrop-filter: blur(10px);\r\n\tmin-width: 350px;\r\n}\r\n\r\n#gameOverMenu h2,\r\n#victoryMenu h2 {\r\n\tcolor: var(--highlight-color);\r\n\tfont-size: 32px;\r\n\tmargin-bottom: 20px;\r\n\tfont-family: 'Cinzel', serif;\r\n\ttext-shadow: 0 2px 4px #000;\r\n}\r\n\r\n#gameOverMenu p,\r\n#victoryMenu p {\r\n\tfont-size: 18px;\r\n\tmargin-bottom: 25px;\r\n\tline-height: 1.6;\r\n}\r\n\r\n.menu-button {\r\n\tmargin-top: 25px;\r\n\tpadding: 12px 25px;\r\n\tbackground: linear-gradient(to bottom, var(--bright-accent), var(--accent-color));\r\n\tborder: none;\r\n\tcolor: white;\r\n\tcursor: pointer;\r\n\tborder-radius: 8px;\r\n\ttransition: all 0.3s;\r\n\tfont-family: 'Cinzel', serif;\r\n\tfont-size: 16px;\r\n\tletter-spacing: 1px;\r\n\tbox-shadow: 0 4px 8px #000;\r\n\ttext-shadow: 0 1px 2px #000;\r\n}\r\n\r\n.menu-button:hover {\r\n\tbackground: linear-gradient(to bottom, var(--highlight-color), var(--bright-accent));\r\n\ttransform: scale(1.05) translateY(-3px);\r\n\tbox-shadow: 0 6px 15px #000;\r\n}\r\n\r\n.menu-button:active {\r\n\ttransform: scale(1) translateY(0);\r\n\tbox-shadow: 0 3px 6px #000;\r\n}\r\n\r\n/* Stat icons with custom styling */\r\n#shardsDisplay {\r\n\tcolor: var(--gold-color);\r\n\tfont-weight: 600;\r\n}\r\n\r\n#essenceDisplay,\r\n#essenceNeededDisplay {\r\n\tcolor: var(--essence-color);\r\n\tfont-weight: 600;\r\n}\r\n\r\n#populationDisplay,\r\n#maxPopulationDisplay {\r\n\tcolor: var(--essence-color);\r\n\tfont-weight: 600;\r\n}\r\n\r\n#hpDisplay {\r\n\tcolor: var(--health-color);\r\n\tfont-weight: 600;\r\n}\r\n\r\n#waveDisplay {\r\n\tdisplay: inline-block;\r\n}\r\n\r\n\r\n/* Mobile-first adjustments (applies below 768px) */\r\n@media screen and (max-width: 768px) {\r\n    /* Base layout adjustments */\r\n    #gameContainer {\r\n        overflow: hidden;\r\n    }\r\n    #towerMenu {\r\n        position: fixed;\r\n\t\tbottom: 0;\r\n        left: 0;\r\n        right: 0;\r\n        width: 95vw;\r\n\t\tmax-height: 20vh;\r\n\t\toverflow-y:auto;\r\n        max-width: unset;\r\n        margin: 0 auto;\r\n        grid-template-columns: repeat(2, 1fr);\r\n    }\r\n\r\n    .tower-option {\r\n        min-width: unset;\r\n        font-size: 0.95rem;\r\n    }\r\n\r\n    /* Add a close button for mobile */\r\n    #menuCloseButton {\r\n        display: block;\r\n        position: absolute;\r\n        top: 8px;\r\n        right: 8px;\r\n        background: var(--accent-color);\r\n        border: none;\r\n        color: var(--text-color);\r\n        width: 32px;\r\n        height: 32px;\r\n        border-radius: 50%;\r\n        cursor: pointer;\r\n        z-index: 100;\r\n    }\r\n\r\n    /* Adjust stats container position */\r\n    #statsContainer {\r\n        top: 10px;\r\n        width: 95%;\r\n        padding: 8px;\r\n    }\r\n    #stats {\r\n        gap: 8px;\r\n    }\r\n\r\n    .stat {\r\n        font-size: 0.9rem;\r\n        gap: 4px;\r\n    }\r\n\r\n    /* Upgrade menu adjustments */\r\n    #upgradeMenu {\r\n        width: 90%;\r\n        padding: 15px;\r\n    }\r\n\r\n    .upgrade-option {\r\n        margin: 12px 0;\r\n        padding: 12px;\r\n        flex-direction: column;\r\n        align-items: flex-start;\r\n    }\r\n\r\n    .upgrade-icon {\r\n        width: 36px;\r\n        height: 36px;\r\n        margin-right: 12px;\r\n        font-size: 18px;\r\n    }\r\n\r\n    .upgrade-title {\r\n        font-size: 1rem;\r\n    }\r\n\r\n    /* Wave info adjustments */\r\n    #waveInfo {\r\n        top: 80px;\r\n        width: 90%;\r\n        padding: 6px 15px;\r\n    }\r\n\r\n    .progress-bar {\r\n        width: 150px;\r\n    }\r\n\r\n    /* Game over/victory menus */\r\n    #gameOverMenu, #victoryMenu {\r\n        width: 90%;\r\n        padding: 20px;\r\n    }\r\n\r\n    #gameOverMenu h2, #victoryMenu h2 {\r\n        font-size: 1.5rem;\r\n    }\r\n\r\n    /* Tooltip adjustments */\r\n    #tooltip {\r\n        max-width: 200px;\r\n        font-size: 0.85rem;\r\n        padding: 8px 10px;\r\n    }\r\n\r\n    /* Button sizes */\r\n    #startGameBtn {\r\n        padding: 10px 25px;\r\n        font-size: 1rem;\r\n    }\r\n\r\n    .menu-button {\r\n        padding: 10px 20px;\r\n        font-size: 0.9rem;\r\n    }\r\n}\r\n\r\n/* Additional adjustments for very small screens */\r\n@media screen and (max-width: 480px) {\r\n\r\n\r\n    #stats {\r\n        justify-content: center;\r\n    }\r\n\r\n    .stat {\r\n        font-size: 0.8rem;\r\n    }\r\n\r\n    .progress-bar {\r\n        width: 120px;\r\n        height: 10px;\r\n    }\r\n\r\n    #waveDisplay {\r\n        font-size: 0.9rem;\r\n    }\r\n\r\n    .upgrade-option {\r\n        padding: 10px;\r\n        margin: 8px 0;\r\n    }\r\n\r\n    .upgrade-title {\r\n        font-size: 0.9rem;\r\n    }\r\n}\r\n\r\n/* Orientation-specific adjustments */\r\n@media screen and (max-height: 500px) and (orientation: landscape) {\r\n\r\n    #statsContainer {\r\n        top: 5px;\r\n        padding: 5px;\r\n    }\r\n\r\n  \r\n}\r\n@media screen and (max-width: 480px) {\r\n\r\n\r\n    #menuCloseButton {\r\n        top: 4px;\r\n        right: 4px;\r\n        width: 28px;\r\n        height: 28px;\r\n    }\r\n}",
        "html": "<div id=\"gameContainer\">\r\n    <div id=\"waveInfo\">\r\n        <span>Wave: <span id=\"waveDisplay\">1</span></span>             \r\n        <div class=\"progress-bar\">\r\n            <div class=\"progress-fill\" id=\"waveProgress\"></div>\r\n        </div>\r\n    </div>\r\n    <div id=\"statsContainer\">\r\n        <div id=\"stats\">\r\n            <div class=\"stat\">\r\n                <div class=\"stat-icon\" style=\"background-color: var(--gold-color);\"></div>\r\n                <span>Gold: <span id=\"shardsDisplay\">50</span></span>                 \r\n            </div>\r\n            <div class=\"stat\">\r\n                <div class=\"stat-icon\" style=\"background-color: var(--essence-color);\"></div>\r\n                <span>Essence: <span id=\"essenceDisplay\">0</span>/<span id=\"essenceNeededDisplay\">100</span></span>                 \r\n            </div>\r\n            <div class=\"stat\">\r\n                <div class=\"stat-icon\" style=\"background-color: var(--essence-color);\"></div>\r\n                <span>Population: <span id=\"populationDisplay\">0</span>/<span id=\"maxPopulationDisplay\">5</span></span>                 \r\n            </div>\r\n            <div class=\"stat\">\r\n                <div class=\"stat-icon\" style=\"background-color: var(--health-color);\"></div>\r\n                <span>Core: <span id=\"hpDisplay\">100</span></span>                 \r\n            </div>\r\n        </div>\r\n    </div>\r\n    <canvas id=\"gameCanvas\" width=\"1536\" height=\"768\"></canvas>\r\n    <div id=\"towerMenu\">\r\n        <div class=\"tower-option\" data-type=\"sentry\">Photon Sentry (25)</div>\r\n        <div class=\"tower-option\" data-type=\"fusionCore\">Fusion Core (50)</div>\r\n        <div class=\"tower-option\" data-type=\"barracks\">Barracks (100)</div>\r\n        <div class=\"tower-option\" data-type=\"fabricator\">Fabricator (200)</div>\r\n        <div class=\"tower-option\" data-type=\"teslaCoil\">Tesla Coil (70)</div>\r\n        <div class=\"tower-option\" data-type=\"missileLauncher\">Missile Launcher (90)</div>\r\n        <div class=\"tower-option\" data-type=\"chrono\">Chrono Defibrilator (100)</div>\r\n        <div class=\"tower-option\" data-type=\"guardTower\">Guard Tower (70)</div>\r\n    </div>\r\n    <button id=\"startGameBtn\">Start Game</button>    \r\n</div>\r\n<div id=\"overlay\"></div>\r\n<div id=\"upgradeMenu\">\r\n    <h2>Level Up! Choose an Upgrade:</h2>\r\n    <div id=\"upgradeOptions\"></div>\r\n</div>\r\n<div id=\"tooltip\" style=\"display: none;\"></div>\r\n<div id=\"gameOverMenu\">\r\n    <h2>Home Destroyed!</h2>\r\n    <p>You survived <span id=\"gameOverWave\">0</span> waves</p>\r\n    <button class=\"menu-button\">Try Again</button>     \r\n</div>\r\n<div id=\"victoryMenu\">\r\n    <h2>Victory!</h2>\r\n    <p>You've successfully defended your Home through all waves!</p>\r\n    <button class=\"menu-button\">Play Again</button>     \r\n</div>"
      },
      "audioEditor": {
        "title": "Audio Editor",
        "fileName": "audioEditor",
        "css": "#audio-editor-container {\r\n    padding: 20px;\r\n    margin: 0 auto;\r\n    border-radius: 8px;\r\n    flex-direction: column;\r\n}\r\n\r\n#audio-editor-container .main-flex-container {\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    gap: 20px;\r\n}\r\n\r\n#audio-editor-container #status-container {\r\n    width: 100%;\r\n    padding: 10px;\r\n    text-align: center;\r\n}\r\n\r\n#audio-editor-container #status-message {\r\n    color: #333;\r\n    font-weight: bold;\r\n}\r\n\r\n#audio-editor-container .parameters-container {\r\n    flex: 1;\r\n    min-width: 300px;\r\n    padding: 15px;\r\n    margin: 10px 0;\r\n    border-radius: 8px;\r\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n#audio-editor-container .control-buttons {\r\n    margin-bottom: 10px;\r\n    display: flex;\r\n    gap: 10px;\r\n    flex-wrap: wrap;\r\n}\r\n\r\n#audio-editor-container .parameter-group {\r\n    display: grid;\r\n    gap: 10px;\r\n    margin-top: 15px;\r\n}\r\n\r\n#audio-editor-container .parameter-group label {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 10px;\r\n    font-size: 0.9em;\r\n}\r\n\r\n#audio-editor-container .value-display {\r\n    min-width: 60px;\r\n    text-align: right;\r\n    font-family: monospace;\r\n}\r\n\r\n#audio-editor-container input[type=\"range\"] {\r\n    flex-grow: 1;\r\n}\r\n\r\n\r\n@media (max-width: 600px) {\r\n    #audio-editor-container .parameters-container {\r\n        min-width: 100%;\r\n    }\r\n    \r\n    #audio-editor-container .control-buttons {\r\n        flex-direction: column;\r\n    }\r\n    \r\n    #audio-editor-container .parameter-group label {\r\n        flex-direction: column;\r\n        align-items: flex-start;\r\n    }\r\n}",
        "html": "<div id=\"audio-editor-container\">       \r\n     <div id=\"status-container\">\r\n        <span id=\"status-message\">Ready</span>\r\n    </div>\r\n\r\n    <div class=\"main-flex-container\">\r\n        <!-- Status Message Area -->\r\n\r\n        <!-- Basic Parameters -->\r\n        <div class=\"parameters-container\">\r\n            <!-- Playback Controls -->\r\n            <div class=\"control-buttons\">\r\n                <button id=\"playBtn\" class=\"primary-button\">Play</button>\r\n                <button id=\"exportBtn\">Save</button>\r\n                <button id=\"randomSoundBtn\"> Randomize Sound</button>\r\n            </div>\r\n            <h3>Basic Parameters</h3>\r\n            <div class=\"parameter-group\">\r\n                <label>\r\n                    Waveform:\r\n                    <select id=\"waveform\">\r\n                        <option value=\"sine\">Sine</option>\r\n                        <option value=\"square\">Square</option>\r\n                        <option value=\"sawtooth\">Sawtooth</option>\r\n                        <option value=\"triangle\">Triangle</option>\r\n                        <option value=\"noise\">Noise</option>\r\n                    </select>\r\n                </label>\r\n                <label>\r\n                    Frequency:\r\n                    <input type=\"range\" id=\"frequency\" min=\"20\" max=\"2000\" value=\"440\" step=\"1\">\r\n                    <span class=\"value-display\">440 Hz</span>\r\n                </label>\r\n                <label>\r\n                    Duration:\r\n                    <input type=\"range\" id=\"duration\" min=\"0.1\" max=\"5\" value=\"1\" step=\"0.1\">\r\n                    <span class=\"value-display\">1.00 s</span>\r\n                </label>\r\n                <label>\r\n                    Volume:\r\n                    <input type=\"range\" id=\"volume\" min=\"0\" max=\"1\" value=\"0.7\" step=\"0.01\">\r\n                    <span class=\"value-display\">70%</span>\r\n                </label>\r\n            </div>\r\n        </div>\r\n        <div class=\"parameters-container\">\r\n            <h3>Noise Generator</h3>\r\n            <div class=\"parameter-group\">\r\n                <label >\r\n                    Noise Type:\r\n                    <select id=\"noiseType\">\r\n                        <option value=\"white\">White</option>\r\n                        <option value=\"pink\">Pink</option>\r\n                        <option value=\"brown\">Brown</option>\r\n                    </select>\r\n                </label>\r\n                <label>\r\n                    Noise Amount:\r\n                    <input type=\"range\" id=\"noiseAmount\" min=\"0\" max=\"1\" value=\"0\" step=\"0.01\">\r\n                    <span class=\"value-display\">0%</span>\r\n                </label>\r\n                <label >\r\n                    Noise Filter:\r\n                    <select id=\"noiseFilterType\">\r\n                        <option value=\"none\">None</option>\r\n                        <option value=\"lowpass\">Low Pass</option>\r\n                        <option value=\"highpass\">High Pass</option>\r\n                        <option value=\"bandpass\">Band Pass</option>\r\n                    </select>\r\n                </label>\r\n                <label>\r\n                    Noise Filter Freq:\r\n                    <input type=\"range\" id=\"noiseFilterFreq\" min=\"20\" max=\"20000\" value=\"2000\" step=\"1\">\r\n                    <span class=\"value-display\">2000 Hz</span>\r\n                </label>\r\n            </div>\r\n            <!-- ADSR Envelope -->\r\n            <div class=\"parameters-container\">\r\n                <h3>Envelope (ADSR)</h3>\r\n                <div class=\"parameter-group\">\r\n                    <label>\r\n                        Attack:\r\n                        <input type=\"range\" id=\"attack\" min=\"0.001\" max=\"2\" value=\"0.01\" step=\"0.001\">\r\n                        <span class=\"value-display\">0.010 s</span>\r\n                    </label>\r\n                    <label>\r\n                        Decay:\r\n                        <input type=\"range\" id=\"decay\" min=\"0\" max=\"2\" value=\"0.1\" step=\"0.001\">\r\n                        <span class=\"value-display\">0.10 s</span>\r\n                    </label>\r\n                    <label>\r\n                        Sustain:\r\n                        <input type=\"range\" id=\"sustain\" min=\"0\" max=\"1\" value=\"0.7\" step=\"0.01\">\r\n                        <span class=\"value-display\">70%</span>\r\n                    </label>\r\n                    <label>\r\n                        Release:\r\n                        <input type=\"range\" id=\"release\" min=\"0.001\" max=\"5\" value=\"0.3\" step=\"0.001\">\r\n                        <span class=\"value-display\">0.30 s</span>\r\n                    </label>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- Pitch Envelope -->\r\n        <div class=\"parameters-container\">\r\n            <h3>Pitch Envelope</h3>\r\n            <div class=\"parameter-group\">\r\n                <label>\r\n                    Start:\r\n                    <input type=\"range\" id=\"pitchEnvStart\" min=\"0.1\" max=\"4\" value=\"1\" step=\"0.01\">\r\n                    <span class=\"value-display\">1.00x</span>\r\n                </label>\r\n                <label>\r\n                    End:\r\n                    <input type=\"range\" id=\"pitchEnvEnd\" min=\"0.1\" max=\"4\" value=\"1\" step=\"0.01\">\r\n                    <span class=\"value-display\">1.00x</span>\r\n                </label>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- Effects -->\r\n        <div class=\"parameters-container\">\r\n            <h3>Effects</h3>\r\n            <div class=\"parameter-group\">\r\n                <label>\r\n                    Filter Type:\r\n                    <select id=\"filterType\">\r\n                        <option value=\"lowpass\">Low Pass</option>\r\n                        <option value=\"highpass\">High Pass</option>\r\n                        <option value=\"bandpass\">Band Pass</option>\r\n                        <option value=\"notch\">Notch</option>\r\n                    </select>\r\n                </label>\r\n                <label>\r\n                    Filter Frequency:\r\n                    <input type=\"range\" id=\"filterFreq\" min=\"20\" max=\"20000\" value=\"1000\" step=\"1\">\r\n                    <span class=\"value-display\">1000 Hz</span>\r\n                </label>\r\n                <label>\r\n                    Filter Q:\r\n                    <input type=\"range\" id=\"filterQ\" min=\"0.1\" max=\"20\" value=\"1\" step=\"0.1\">\r\n                    <span class=\"value-display\">Q: 1.0</span>\r\n                </label>\r\n                <label>\r\n                    Distortion:\r\n                    <input type=\"range\" id=\"distortion\" min=\"0\" max=\"100\" value=\"0\" step=\"1\">\r\n                    <span class=\"value-display\">0%</span>\r\n                </label>\r\n                <label>\r\n                    Delay Time:\r\n                    <input type=\"range\" id=\"delayTime\" min=\"0\" max=\"2\" value=\"0.3\" step=\"0.01\">\r\n                    <span class=\"value-display\">0.30 s</span>\r\n                </label>\r\n                <label>\r\n                    Delay Feedback:\r\n                    <input type=\"range\" id=\"delayFeedback\" min=\"0\" max=\"0.9\" value=\"0\" step=\"0.01\">\r\n                    <span class=\"value-display\">0%</span>\r\n                </label>\r\n                <label>\r\n                    Reverb:\r\n                    <input type=\"range\" id=\"reverbAmount\" min=\"0\" max=\"1\" value=\"0\" step=\"0.01\">\r\n                    <span class=\"value-display\">0%</span>\r\n                </label>\r\n                <label>\r\n                    Bitcrusher:\r\n                    <input type=\"range\" id=\"bitcrusher\" min=\"0\" max=\"1\" value=\"0\" step=\"0.01\">\r\n                    <span class=\"value-display\">0%</span>\r\n                </label>\r\n                <label>\r\n                    Panning:\r\n                    <input type=\"range\" id=\"panning\" min=\"-1\" max=\"1\" value=\"0\" step=\"0.01\">\r\n                    <span class=\"value-display\">Center</span>\r\n                </label>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n"
      },
      "TextureEditor": {
        "title": "Texture Editor",
        "fileName": "TextureEditor",
        "css": "#texture-editor-wrapper {\n    display: flex;\n    gap: 20px;\n    padding: 10px;\n    border-radius: 5px;\n}\n\n.texture-editor-tools {\n    width: 200px;\n    flex-shrink: 0;\n}\n\n.texture-editor-canvas-container {\n    flex-grow: 1;\n    position: relative;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    border-radius: 5px;\n}\n\n#texture-canvas {\n    background-color: transparent;\n    box-shadow: 0 0 10px rgba(0,0,0,0.1);\n    image-rendering: pixelated;\n    border: 1px solid #000;\n}\n\n#noTextureMessage {\n    position: absolute;\n    color: #666;\n}\n\n.tool-section {\n    margin-bottom: 15px;\n    padding-bottom: 15px;\n}\n\n.tool-section h3 {\n    margin-top: 0;\n    margin-bottom: 10px;\n    font-size: 14px;\n}\n\n.tool-btn {\n    margin-right: 5px;\n    margin-bottom: 5px;\n    padding: 5px 10px;\n    cursor: pointer;\n}\n\n.tool-btn.active {\n    background-color: #007bff;\n    color: white;\n}\n\n.color-palette {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 5px;\n    margin-bottom: 10px;\n}\n\n.color-btn {\n    width: 25px;\n    height: 25px;\n    border: 1px solid #ccc;\n    border-radius: 3px;\n    cursor: pointer;\n}\n\n.color-btn.active {\n    border: 2px solid #000;\n}\n\n.custom-color {\n    display: flex;\n    align-items: center;\n    gap: 10px;\n}\n\n#custom-color-picker {\n    width: 30px;\n    height: 30px;\n    padding: 0;\n    border: none;\n    cursor: pointer;\n}",
        "html": "<div id=\"texture-editor-container\" class=\"texture-editor-wrapper\"> \n    <div class=\"texture-editor-tools\">\n        <div class=\"tool-section\">\n            <h3>Tools</h3>\n            <button id=\"brush-tool\" class=\"tool-btn active\">Brush</button>\n            <button id=\"eraser-tool\" class=\"tool-btn\">Eraser</button>\n            <button id=\"fill-tool\" class=\"tool-btn\">Fill</button>\n            <button id=\"eyedropper-tool\" class=\"tool-btn\">Eyedropper</button>\n        </div>\n        \n        <div class=\"tool-section\">\n            <h3>Brush Size</h3>\n            <input type=\"range\" id=\"brush-size\" min=\"1\" max=\"10\" value=\"1\">\n            <span id=\"brush-size-display\">1px</span>\n        </div>\n        \n        <div class=\"tool-section\">\n            <h3>Colors</h3>\n            <div id=\"color-palette\" class=\"color-palette\"></div>\n            <div class=\"custom-color\">\n                <input type=\"color\" id=\"custom-color-picker\" value=\"#000000\">\n                <label for=\"custom-color-picker\">Custom Color</label>\n            </div>\n            <div class=\"transparency-controls\">\n                <label for=\"transparency-slider\">Opacity: </label>\n                <input type=\"range\" id=\"transparency-slider\" min=\"0\" max=\"255\">\n                <span id=\"transparency-display\">100%</span>\n            </div>\n        </div>\n        \n        <div class=\"tool-section\">\n            <h3>Actions</h3>\n            <button id=\"new-btn\">New</button>\n            <button id=\"undo-btn\" disabled>Undo</button>\n            <button id=\"redo-btn\" disabled>Redo</button>\n            <button id=\"clear-btn\">Clear</button>\n            <button class=\"export-btn\">Save</button>\n        </div>\n        \n        <div class=\"tool-section\">\n            <h3>Import</h3>\n            <input type=\"file\" accept=\"image/*\">\n        </div>\n    </div>\n    \n    <div class=\"texture-editor-canvas-container\">\n        <canvas id=\"texture-canvas\"></canvas>\n        <div id=\"noTextureMessage\">No texture loaded</div>\n    </div>\n</div>\n"
      },
      "graphicsEditor": {
        "title": "Graphics Editor",
        "modals": [
          "rotateShapes",
          "moveAllShapes",
          "generateIsometric"
        ],
        "fileName": "graphicsEditor",
        "css": "\r\n#graphics-editor-container #grid-display {\r\n    position: absolute;\r\n    top: 10px;\r\n    left: 10px;\r\n    padding: 5px 10px;\r\n    border-radius: 0;\r\n    font-family: 'Courier New', monospace;\r\n}\r\n#graphics-editor-container .btn {\r\n    padding: 0;\r\n}\r\n\r\n#graphics-editor-container .btn-add {\r\n  background-color: rgba(16, 185, 129, 0.3);\r\n  border: 1px solid #10b981;\r\n  color: #f4e1d2;\r\n}\r\n#graphics-editor-container .btn-add:hover {\r\n  background-color: rgba(16, 185, 129, 0.5);\r\n  box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);\r\n}\r\n#graphics-editor-container #graphics-rightbar {\r\n    width: 360px;\r\n    display: flex;\r\n    flex-direction: column;\r\n}\r\n\r\n#graphics-editor-container #canvas-container {\r\n    flex: 1;\r\n    position: relative;\r\n}\r\n\r\n#graphics-editor-container #graphics-editor-canvas {\r\n    width: 100%;\r\n    height: 100%;\r\n    cursor: grab;\r\n    outline: none;\r\n}\r\n\r\n#graphics-editor-container .toolbar {\r\n    display: flex;\r\n    flex-direction: column;\r\n    padding: 10px 5px;\r\n    gap: 5px;  \r\n    align-items: normal;\r\n}\r\n#graphics-editor-container .toolbar > div {\r\n    display: flex;\r\n    gap: 7px;\r\n    justify-content: space-between;\r\n}\r\n#graphics-editor-container .toolbar > div > div {\r\n    display: flex;\r\n    gap: 5px;\r\n}\r\n\r\n#graphics-editor-container #shape-list {\r\n    flex: 1;\r\n    overflow-y: auto;\r\n    padding: 15px;\r\n}\r\n\r\n#graphics-editor-container .shape-item {\r\n    padding: 12px;\r\n    margin-bottom: 8px;\r\n    border-radius: 0;\r\n    cursor: pointer;\r\n    transition: all 0.2s ease;\r\n}\r\n\r\n#graphics-editor-container #inspector {\r\n    padding: 15px;\r\n}\r\n\r\n#graphics-editor-container .scene-info {\r\n    padding: 10px 15px;\r\n    position: absolute;\r\n    bottom: 15px;\r\n    left: 15px;\r\n    border-radius: 0;\r\n    font-size: 13px;\r\n}\r\n#graphics-editor-container #move-modal button, #rotate-modal button, #isometric-modal button {\r\n    width: 48%;\r\n}\r\n\r\n\r\n#graphics-editor-container .ref-container {\r\n    display: flex;\r\n    gap: 10px;\r\n}\r\n\r\n#graphics-editor-container .ref-select {\r\n    flex: 1;\r\n    min-width: 150px;\r\n}\r\n\r\n#graphics-editor-container .ref-values {\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    gap: 5px;\r\n    margin-bottom: 5px;\r\n}\r\n\r\n#graphics-editor-container .ref-value-item {\r\n    border-radius: 4px;\r\n    padding: 3px 6px;\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 5px;\r\n}\r\n\r\n#graphics-editor-container .remove-ref-btn {\r\n    padding: 0 3px;\r\n    font-size: 14px;\r\n}\r\n\r\n#graphics-editor-container #rotate-group-modal .modal-content {\r\n    width: 400px;\r\n    padding: 20px;\r\n}\r\n\r\n#graphics-editor-container #rotate-group-modal .form-row {\r\n    display: flex;\r\n    align-items: center;\r\n    margin-bottom: 15px;\r\n}\r\n\r\n#graphics-editor-container #rotate-group-modal label {\r\n    width: 100px;\r\n    display: inline-block;\r\n}\r\n\r\n#graphics-editor-container #rotate-group-modal input[type=\"range\"] {\r\n    flex-grow: 1;\r\n    margin: 0 10px;\r\n}\r\n\r\n#graphics-editor-container #rotate-group-modal .button-row {\r\n    display: flex;\r\n    justify-content: flex-end;\r\n    margin-top: 20px;\r\n}\r\n\r\n#graphics-editor-container #rotate-group-modal button {\r\n    margin-left: 10px;\r\n    padding: 6px 12px;\r\n    cursor: pointer;\r\n}\r\n\r\n/* Base styling for shape list */\r\n#graphics-editor-container #shape-list {\r\n    padding: 10px;\r\n    user-select: none; /* Prevent text selection during drag */\r\n  }\r\n  \r\n  /* Common styles for items */\r\n  #graphics-editor-container  .shape-item, .group-item {\r\n    padding: 8px;\r\n    margin: 5px 0;\r\n    border-radius: 4px;\r\n    cursor: grab;\r\n    border: 1px solid transparent;\r\n    transition: border-color 0.2s;\r\n  }\r\n  \r\n  /* Shapes styling */\r\n  #graphics-editor-container  .shape-item {\r\n    border-left: 1px solid #555;\r\n  }\r\n  \r\n  #graphics-editor-container  .shape-item:active {\r\n    cursor: grabbing;\r\n  }\r\n  \r\n  /* Group styling */\r\n  #graphics-editor-container  .group-item {\r\n    border-left: 4px solid #007bff; /* Visual distinction for groups */\r\n    font-weight: 500;\r\n  }\r\n  \r\n  /* Selected states - use border instead of background */\r\n  #graphics-editor-container  .shape-item.selected, \r\n  #graphics-editor-container  .group-item.selected {\r\n    border-color: #4080ff;\r\n  }\r\n  \r\n  /* Drag-over states */\r\n  #graphics-editor-container .group-item.drag-over,\r\n  #graphics-editor-container  #shape-list.drag-over {\r\n    border-color: #40a040;\r\n    box-shadow: 0 0 3px rgba(0, 100, 0, 0.5);\r\n  }\r\n  \r\n  /* Animation for when dragging */\r\n  #graphics-editor-container .shape-item.dragging {\r\n    opacity: 0.7;\r\n  }\r\n  \r\n  /* Group shapes container */\r\n  #graphics-editor-container .group-shapes {\r\n    margin-left: 15px;\r\n    padding: 5px;\r\n    border-left: 2px dashed #666;\r\n  }\r\n  \r\n  /* Ungrouped shapes section */\r\n  #graphics-editor-container #shape-list .ungrouped-shapes {\r\n    margin-top: 10px;\r\n    padding: 10px;\r\n    border: 1px dashed #666;\r\n  }\r\n\r\n  #graphics-editor-container .transform-buttons {\r\n    display: flex;\r\n    gap: 10px;\r\n    margin-bottom: 10px;\r\n}\r\n\r\n#graphics-editor-container .transform-buttons button {\r\n    flex: 1;\r\n    padding: 8px;\r\n    background: #444;\r\n    border: 1px solid #666;\r\n    color: white;\r\n    cursor: pointer;\r\n}\r\n\r\n#graphics-editor-container .transform-buttons button.active {\r\n    background: #0066cc;\r\n    border-color: #0088ff;\r\n}",
        "html": "<div id=\"graphics-editor-container\" class=\"main-content-container\">\r\n   <div id=\"graphics-sidebar\" class=\"content-sidebar\">\r\n      <div id=\"toolbar\" class=\"toolbar\">\r\n         <div>    \r\n            <div>\r\n               <button id=\"add-animation\" class=\"btn btn-add\" title=\"Add Animation\">+A</button>                        \r\n               <button id=\"delete-animation\" class=\"btn btn-danger\" title=\"Delete Animation\">-A</button>                        \r\n            </div>                   \r\n            <div>\r\n               <button id=\"add-frame\" class=\"btn btn-add\" title=\"Add Frame\">+F</button>                        \r\n               <button id=\"delete-frame\" class=\"btn btn-danger\" title=\"Delete Frame\">-F</button>                        \r\n            </div>\r\n            <div>\r\n               <button id=\"create-group\" class=\"btn btn-add\" title=\"Create Group\">+G</button>\r\n               <button id=\"delete-group\" class=\"btn btn-danger\" title=\"Delete Group\">-G</button>\r\n            </div>\r\n            <div>                    \r\n               <button id=\"add-shape\" class=\"btn btn-add\" title=\"Add Shape\">+S</button>                        \r\n               <button id=\"delete-shape\" class=\"btn btn-danger\" title=\"Delete Shape\">-S</button>           \r\n            </div>\r\n         </div>  \r\n         <div>\r\n            <div>\r\n               <button id=\"preview-animation\" class=\"btn btn-primary\" title=\"Preview Animation\"></button> \r\n               <button id=\"generate-isometric\" class=\"btn btn-primary\" title=\"Generate Isometric Sprites\">Iso</button>                    \r\n            </div>\r\n         </div>\r\n      </div>\r\n      <div id=\"frame-list\"></div>\r\n      <div id=\"group-list\"></div>\r\n      <div id=\"shape-list\"></div>\r\n   </div>\r\n   <div id=\"canvas-container\" class=\"grid-background\">\r\n      <canvas id=\"graphics-editor-canvas\"></canvas>\r\n      <div class=\"scene-info\">\r\n         <div>Shapes: <span id=\"shape-count\">0</span></div>\r\n         <div>Selected: <span id=\"selected-shape\">None</span></div>\r\n         <div><small>Controls: Left-click to select, Drag to rotate, Right-drag to pan, Scroll to zoom</small></div>\r\n      </div>\r\n   </div>\r\n   <div id=\"graphics-rightbar\">\r\n      <div id=\"inspector\"></div>\r\n      <div id=\"json-editor\" style=\"display: none\">                        \r\n        <textarea id=\"json-content\" placeholder=\"Edit JSON here...\"></textarea>                    \r\n\t\t\t</div>\r\n   </div>\r\n</div>\r\n"
      },
      "terrainEditor": {
        "title": "Terrain Editor",
        "modals": [
          "addTerrainType",
          "generateIsoSprites"
        ],
        "fileName": "terrainEditor",
        "css": "#level-editor-container :root {\r\n\t--primary: #6366f1;\r\n\t--primary-dark: #4f46e5;\r\n\t--secondary: #10b981;\r\n\t--dark: #1e293b;\r\n\t--darker: #0f172a;\r\n\t--light: #e2e8f0;\r\n\t--accent: #8b5cf6;\r\n\t--danger: #ef4444;\r\n\t--text: #f8fafc;\r\n\t--text-muted: #94a3b8;\r\n\t--border-radius: 8px;\r\n\t--shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);\r\n  }\r\n\r\n  #level-editor-container * {\r\n\tmargin: 0;\r\n\tpadding: 0;\r\n\tbox-sizing: border-box;\r\n\tfont-family: 'Inter', system-ui, -apple-system, sans-serif;\r\n  }\r\n\r\n  #level-editor-container {\r\n\tbackground-color: var(--darker);\r\n\tcolor: var(--text);\r\n  }\r\n\r\n  #level-editor-container button {\r\n\tcursor: pointer;\r\n\tborder: none;\r\n\tborder-radius: var(--border-radius);\r\n\tpadding: 8px 12px;\r\n\tfont-weight: 500;\r\n\ttransition: all 0.2s ease;\r\n  }\r\n\r\n  #level-editor-container button:hover {\r\n\topacity: 0.9;\r\n\ttransform: translateY(-1px);\r\n  }\r\n\r\n  #level-editor-container button:active {\r\n\ttransform: translateY(0);\r\n  }\r\n\r\n  #level-editor-container input {\r\n\tbackground-color: var(--dark);\r\n\tborder: 1px solid #334155;\r\n\tcolor: var(--text);\r\n\tborder-radius: var(--border-radius);\r\n\tpadding: 8px 12px;\r\n\toutline: none;\r\n  }\r\n\r\n  #level-editor-container input:focus {\r\n\tborder-color: var(--primary);\r\n\tbox-shadow: 0 0 0 2px rgba(99, 102, 241, 0.2);\r\n  }\r\n\r\n  #level-editor-container input[type=\"number\"] {\r\n\twidth: 80px;\r\n  }\r\n\r\n  #level-editor-container input[type=\"color\"] {\r\n\twidth: 40px;\r\n\theight: 40px;\r\n\tpadding: 2px;\r\n\tcursor: pointer;\r\n  }\r\n\r\n  #level-editor-container {\r\n\tdisplay: flex;\r\n\tgap: 24px;\r\n\theight: 90vh;\r\n\toverflow: hidden;\r\n\tbackground-color: var(--darker);\r\n\tcolor: var(--text);\r\n\tposition: relative;\r\n  }\r\n\r\n  #level-editor-container .content-sidebar {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\twidth: 320px;\r\n\tbackground-color: var(--dark);\r\n\tborder-radius: var(--border-radius);\r\n\tbox-shadow: var(--shadow);\r\n\toverflow: hidden;\r\n  }\r\n\r\n  #level-editor-container .toolbar {\r\n\tdisplay: flex;\r\n\tpadding: 16px;\r\n\tbackground-color: rgba(255, 255, 255, 0.03);\r\n\tborder-bottom: 1px solid rgba(255, 255, 255, 0.1);\r\n  }\r\n\r\n  #level-editor-container .toolbar button {\r\n\tbackground-color: transparent;\r\n\tcolor: var(--text-muted);\r\n\tfont-weight: 600;\r\n\tpadding: 8px 16px;\r\n\tborder-radius: var(--border-radius);\r\n  }\r\n\r\n  #level-editor-container .toolbar button.active {\r\n\tbackground-color: var(--primary);\r\n\tcolor: white;\r\n  }\r\n\r\n  #level-editor-container .tools {\r\n\tpadding: 20px;\r\n\tflex-grow: 1;\r\n\toverflow-y: auto;\r\n  }\r\n\r\n  #level-editor-container .form-row {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: space-between;\r\n\tmargin-bottom: 16px;\r\n  }\r\n\r\n  #level-editor-container .form-row label {\r\n\tcolor: var(--text-muted);\r\n\tfont-size: 14px;\r\n\tflex: 1;\r\n  }\r\n\r\n  #level-editor-container h3 {\r\n\tcolor: var(--light);\r\n\tfont-size: 18px;\r\n\tmargin-bottom: 24px;\r\n\tfont-weight: 600;\r\n\tborder-bottom: 1px solid rgba(255, 255, 255, 0.1);\r\n\tpadding-bottom: 12px;\r\n  }\r\n\r\n  #level-editor-container h4 {\r\n\tcolor: var(--text-muted);\r\n\tfont-size: 16px;\r\n\tmargin: 24px 0 16px;\r\n\tfont-weight: 600;\r\n  }\r\n\r\n  #level-editor-container .grid-container {\r\n\tflex-grow: 1;\r\n\tposition: relative;\r\n\tbackground-color: var(--dark);\r\n\tborder-radius: var(--border-radius);\r\n\toverflow: hidden;\r\n\tbox-shadow: var(--shadow);\r\n  }\r\n\r\n  #level-editor-container .grid-background {\r\n\tbackground-image: \r\n\t  linear-gradient(rgba(255, 255, 255, 0.05) 1px, transparent 1px),\r\n\t  linear-gradient(90deg, rgba(255, 255, 255, 0.05) 1px, transparent 1px);\r\n\tbackground-size: 20px 20px;\r\n  }\r\n\r\n  #level-editor-container #grid {\r\n\tdisplay: block;\r\n\timage-rendering: pixelated;\r\n  }\r\n\r\n  #level-editor-container .translation-controls {\r\n\tposition: absolute;\r\n\tright: 20px;\r\n\tbottom: 20px;\r\n\tdisplay: grid;\r\n\tgrid-template-columns: repeat(3, 40px);\r\n\tgrid-template-rows: repeat(3, 40px);\r\n\tgap: 4px;\r\n\tz-index: 10;\r\n  }\r\n\r\n  #level-editor-container .translation-controls button {\r\n\twidth: 40px;\r\n\theight: 40px;\r\n\tbackground-color: rgba(15, 23, 42, 0.8);\r\n\tcolor: var(--light);\r\n\tborder: 1px solid rgba(255, 255, 255, 0.1);\r\n\tfont-size: 18px;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n  }\r\n\r\n  #level-editor-container #translate-up {\r\n\tgrid-column: 2;\r\n\tgrid-row: 1;\r\n  }\r\n\r\n  #level-editor-container #translate-left {\r\n\tgrid-column: 1;\r\n\tgrid-row: 2;\r\n  }\r\n\r\n  #level-editor-container #translate-right {\r\n\tgrid-column: 3;\r\n\tgrid-row: 2;\r\n  }\r\n\r\n  #level-editor-container #translate-down {\r\n\tgrid-column: 2;\r\n\tgrid-row: 3;\r\n  }\r\n\r\n  /* Terrain item styling */\r\n  #level-editor-container .terrain-types-container {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\tgap: 12px;\r\n\tmargin-top: 16px;\r\n  }\r\n\r\n  #level-editor-container .terrain-item {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tgap: 12px;\r\n\tpadding: 12px;\r\n\tborder-radius: var(--border-radius);\r\n\tbackground-color: rgba(255, 255, 255, 0.03);\r\n\tborder: 1px solid rgba(255, 255, 255, 0.1);\r\n\tcursor: move;\r\n\tuser-select: none;\r\n\ttransition: all 0.2s ease;\r\n  }\r\n\r\n  #level-editor-container .terrain-item:hover {\r\n\tbackground-color: rgba(255, 255, 255, 0.05);\r\n\ttransform: translateY(-2px);\r\n  }\r\n\r\n  #level-editor-container .color-option {\r\n\twidth: 36px;\r\n\theight: 36px;\r\n\tborder-radius: var(--border-radius);\r\n\tcursor: pointer;\r\n\tborder: 2px solid transparent;\r\n\tflex-shrink: 0;\r\n  }\r\n\r\n  #level-editor-container .color-option.active {\r\n\tborder-color: var(--primary);\r\n\tbox-shadow: 0 0 0 2px rgba(99, 102, 241, 0.3);\r\n  }\r\n\r\n  #level-editor-container  .terrain-label {\r\n\tflex-grow: 1;\r\n\tfont-weight: 500;\r\n  }\r\n\r\n  #level-editor-container .terrain-buttons {\r\n\tdisplay: flex;\r\n\tgap: 8px;\r\n  }\r\n\r\n  #level-editor-container .terrain-buttons button {\r\n\twidth: 30px;\r\n\theight: 30px;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n\tpadding: 0;\r\n\tbackground-color: transparent;\r\n\tcolor: var(--text-muted);\r\n\tborder: 1px solid rgba(255, 255, 255, 0.1);\r\n  }\r\n\r\n  #level-editor-container  .terrain-buttons button:hover {\r\n\tbackground-color: rgba(255, 255, 255, 0.05);\r\n\tcolor: var(--text);\r\n  }\r\n\r\n  #level-editor-container .status-bar {\r\n\tposition: absolute;\r\n\tbottom: 0;\r\n\tleft: 0;\r\n\tright: 0;\r\n\theight: 28px;\r\n\tbackground-color: rgba(15, 23, 42, 0.9);\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tpadding: 0 16px;\r\n\tfont-size: 13px;\r\n\tcolor: var(--text-muted);\r\n\tborder-top: 1px solid rgba(255, 255, 255, 0.1);\r\n  }\r\n\r\n  /* Add a terrainsPanel container */\r\n  #level-editor-container  #terrainsPanel {\r\n\tmargin-top: 24px;\r\n\tborder-top: 1px solid rgba(255, 255, 255, 0.1);\r\n\tpadding-top: 16px;\r\n  }\r\n\r\n\r\n\r\n  /* Environment Panel Styles */\r\n  #level-editor-container #environmentPanel {\r\n\toverflow-y: auto;\r\n\tmax-height: calc(100vh - 200px);\r\n  }\r\n  \r\n  #level-editor-container .environment-objects-container {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\tgap: 10px;\r\n  }\r\n  \r\n  #level-editor-container .environment-objects-container h3 {\r\n\tmargin-top: 0;\r\n\tmargin-bottom: 12px;\r\n\tcolor: #e5e7eb;\r\n\tfont-size: 16px;\r\n\tborder-bottom: 1px solid #374151;\r\n\tpadding-bottom: 8px;\r\n  }\r\n  \r\n  #level-editor-container .environment-type {\r\n\tbackground-color: #1f2937;\r\n\tborder-radius: 6px;\r\n\toverflow: hidden;\r\n\tmargin-bottom: 8px;\r\n\tbox-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);\r\n\ttransition: box-shadow 0.2s ease;\r\n  }\r\n  \r\n  #level-editor-container .environment-type:hover {\r\n\tbox-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);\r\n  }\r\n  \r\n  #level-editor-container .environment-type-header {\r\n\tpadding: 10px 12px;\r\n\tfont-weight: 500;\r\n\tcursor: pointer;\r\n\tdisplay: flex;\r\n\tjustify-content: space-between;\r\n\talign-items: center;\r\n\tbackground-color: #2d3748;\r\n\tcolor: #e5e7eb;\r\n\tposition: relative;\r\n\ttext-transform: capitalize;\r\n  }\r\n  \r\n  #level-editor-container .environment-type-header::after {\r\n\tcontent: '';\r\n\tfont-size: 10px;\r\n\ttransition: transform 0.2s ease;\r\n  }\r\n  \r\n  #level-editor-container .environment-type-header.open::after {\r\n\ttransform: rotate(180deg);\r\n  }\r\n  \r\n  #level-editor-container .environment-items {\r\n\tpadding: 10px;\r\n\tdisplay: flex;\r\n\tflex-wrap: wrap;\r\n\tgap: 3px;\r\n\tbackground-color: #1f2937;\r\n  }\r\n  \r\n  #level-editor-container .environment-item {\r\n\twidth: 128px;\r\n\theight: 128px;\r\n\tborder: 2px solid #4b5563;\r\n\tborder-radius: 4px;\r\n\tcursor: pointer;\r\n\tpadding: 2px;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n\tbackground-color: #374151;\r\n\ttransition: all 0.2s ease;\r\n\tposition: relative;\r\n  }\r\n  \r\n  #level-editor-container .environment-item:hover {\r\n\tborder-color: #9ca3af;\r\n\ttransform: translateY(-2px);\r\n  }\r\n  \r\n  #level-editor-container .environment-item.active {\r\n\tborder-color: #3b82f6;\r\n\tbox-shadow: 0 0 0 2px rgba(59, 130, 246, 0.3);\r\n  }\r\n  \r\n  #level-editor-container .environment-item canvas {\r\n\tmax-width: 100%;\r\n\tmax-height: 100%;\r\n\tobject-fit: contain;\r\n  }\r\n  \r\n  /* Tooltip for environment items */\r\n  #level-editor-container .environment-item::before {\r\n\tcontent: attr(data-name);\r\n\tposition: absolute;\r\n\tbottom: calc(100% + 5px);\r\n\tleft: 50%;\r\n\ttransform: translateX(-50%);\r\n\tbackground-color: #111827;\r\n\tcolor: white;\r\n\ttext-align: center;\r\n\tborder-radius: 4px;\r\n\tpadding: 4px 8px;\r\n\tfont-size: 12px;\r\n\twhite-space: nowrap;\r\n\tvisibility: hidden;\r\n\topacity: 0;\r\n\ttransition: all 0.2s ease;\r\n\tz-index: 10;\r\n\tpointer-events: none;\r\n\tbox-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\r\n  }\r\n  \r\n  #level-editor-container .environment-item:hover::before {\r\n\tvisibility: visible;\r\n\topacity: 1;\r\n  }\r\n  \r\n  /* Indicator for placement mode */\r\n  #level-editor-container .placement-mode-indicator {\r\n\tposition: absolute;\r\n\ttop: 10px;\r\n\tleft: 50%;\r\n\ttransform: translateX(-50%);\r\n\tbackground-color: rgba(17, 24, 39, 0.8);\r\n\tcolor: white;\r\n\tpadding: 5px 10px;\r\n\tborder-radius: 4px;\r\n\tfont-size: 14px;\r\n\tpointer-events: none;\r\n\ttransition: opacity 0.3s ease;\r\n\tbox-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\r\n\tz-index: 100;\r\n  }\r\n  \r\n  /* Improved toolbar buttons */\r\n  #level-editor-container .toolbar .btn {\r\n\tpadding: 8px 16px;\r\n\tborder: none;\r\n\tbackground-color: #374151;\r\n\tcolor: #e5e7eb;\r\n\tcursor: pointer;\r\n\tborder-radius: 4px;\r\n\tfont-weight: 500;\r\n\ttransition: all 0.2s ease;\r\n  }\r\n  \r\n  #level-editor-container .toolbar .btn:hover {\r\n\tbackground-color: #4b5563;\r\n  }\r\n  \r\n  #level-editor-container .toolbar .btn.active {\r\n\tbackground-color: #3b82f6;\r\n\tcolor: white;\r\n  }\r\n  \r\n  /* Better spacing for the tools panels */\r\n  #level-editor-container .tools > div {\r\n\tmargin-bottom: 20px;\r\n  }\r\n  \r\n  /* Environment object count badge */\r\n  #level-editor-container .environment-type-header .object-count-container {\r\n\tflex: 1;\r\n\tmargin-left: 8px;\r\n  }\r\n  #level-editor-container .environment-type-header .object-count {\r\n\tbackground-color: #4b5563;\r\n\tcolor: white;\r\n\tpadding: 2px 6px;\r\n\tborder-radius: 10px;\r\n\tfont-size: 12px;\r\n  }\r\n  \r\n  /* Empty state for environment types */\r\n  #level-editor-container .environment-items.empty {\r\n\tpadding: 20px;\r\n\ttext-align: center;\r\n\tcolor: #9ca3af;\r\n\tfont-style: italic;\r\n  }\r\n  \r\n  /* Styles for delete mode */\r\n  #level-editor-container .delete-mode-active .grid-container {\r\n\tcursor: url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"red\" stroke-width=\"2\"><path d=\"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2\"/><path d=\"M10 11v6M14 11v6\"/></svg>'), auto;\r\n  }\r\n  \r\n  /* Object control panel */\r\n  #level-editor-container .object-controls {\r\n\tdisplay: flex;\r\n\tjustify-content: space-between;\r\n\tpadding: 10px;\r\n\tbackground-color: #1f2937;\r\n\tborder-radius: 6px;\r\n\tmargin-bottom: 10px;\r\n\tgap: 8px;\r\n  }\r\n  \r\n  #level-editor-container .object-controls button {\r\n\tbackground-color: #374151;\r\n\tcolor: #e5e7eb;\r\n\tborder: none;\r\n\tpadding: 6px 12px;\r\n\tborder-radius: 4px;\r\n\tcursor: pointer;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tgap: 5px;\r\n\ttransition: background-color 0.2s;\r\n  }\r\n  \r\n  #level-editor-container .object-controls button:hover {\r\n\tbackground-color: #4b5563;\r\n  }\r\n  \r\n  #level-editor-container .object-controls button.delete-mode {\r\n\tbackground-color: #ef4444;\r\n\tcolor: white;\r\n  }\r\n  \r\n  #level-editor-container .object-controls button.delete-mode:hover {\r\n\tbackground-color: #dc2626;\r\n  }\r\n  \r\n  \r\n #object-preview-canvas {\r\n\ttransition: transform 0.05s ease-out;\r\n\twill-change: transform;\r\n\timage-rendering: pixelated;\r\n\tposition: absolute;\r\n\tpointer-events: none; \r\n\tz-index: 9999;\r\n\topacity: 0.7; \r\n}\r\n  /* Responsive adjustments */\r\n  @media (max-width: 768px) {\r\n\t#level-editor-container .environment-items {\r\n\t  justify-content: center;\r\n\t}\r\n\t\r\n\t#level-editor-container .environment-item {\r\n\t  width: 56px;\r\n\t  height: 56px;\r\n\t}\r\n  }",
        "html": "<div id=\"level-editor-container\" class=\"main-content-container\">\r\n   <div class=\"content-sidebar\">\r\n     <div class=\"toolbar\">\r\n       <button id=\"terrainsBtn\" class=\"btn active\">Tiles</button>\r\n       <button id=\"environmentBtn\" class=\"btn\">Env</button>\r\n     </div>\r\n     <div class=\"tools\">\r\n       <div>\r\n         <h3>Map Settings</h3>\r\n         <div class=\"form-row\">\r\n           <label for=\"terrainMapSize\">Map Size:</label>\r\n           <input type=\"number\" id=\"terrainMapSize\" value=\"48\" step=\"1\" min=\"1\">\r\n         </div>\r\n         <div class=\"form-row\">\r\n            <label for=\"extensionTerrainType\">Surrounding Terrain Type:</label>\r\n            <select id=\"extensionTerrainType\" class=\"extensionTerrainType\"></select>\r\n          </div>\r\n       </div>\r\n       <div id=\"environmentPanel\" style=\"display:none\">\r\n\r\n       </div>\r\n       <div id=\"terrainsPanel\">\r\n         <div class=\"terrain-types-container\">\r\n           <div class=\"terrain-item\">\r\n             <div class=\"color-option active\" style=\"background-color: #10b981;\"></div>\r\n             <div class=\"terrain-label\">Grass</div>\r\n             <div class=\"terrain-buttons\">\r\n               <button title=\"Edit\"></button>\r\n               <button title=\"Delete\"></button>\r\n             </div>\r\n           </div>\r\n           <div class=\"terrain-item\">\r\n             <div class=\"color-option\" style=\"background-color: #3b82f6;\"></div>\r\n             <div class=\"terrain-label\">Water</div>\r\n             <div class=\"terrain-buttons\">\r\n               <button title=\"Edit\"></button>\r\n               <button title=\"Delete\"></button>\r\n             </div>\r\n           </div>\r\n           <div class=\"terrain-item\">\r\n             <div class=\"color-option\" style=\"background-color: #a3a3a3;\"></div>\r\n             <div class=\"terrain-label\">Stone</div>\r\n             <div class=\"terrain-buttons\">\r\n               <button title=\"Edit\"></button>\r\n               <button title=\"Delete\"></button>\r\n             </div>\r\n           </div>\r\n         </div>\r\n       </div>\r\n     </div>\r\n   </div>\r\n   \r\n   <div class=\"grid-container grid-background\">\r\n     <canvas id=\"grid\"></canvas>\r\n     \r\n     <div class=\"translation-controls\">\r\n       <button id=\"translate-up\"><span></span></button>\r\n       <button id=\"translate-left\"><span></span></button>\r\n       <button id=\"translate-right\"><span></span></button>\r\n       <button id=\"translate-down\"><span></span></button>\r\n     </div>\r\n     \r\n     <div class=\"status-bar\">\r\n       Cursor: x: 0, y: 0 | Zoom: 100% | Selected: Grass\r\n     </div>\r\n   </div>\r\n </div>"
      }
    },
    "libraries": {
      "codemirror.min.js": {
        "title": "CodeMirror.min.js",
        "href-disabled": "https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/codemirror.min.js",
        "className": "CodeMirror",
        "fileName": "codemirror.min.js"
      },
      "GLTFLoader": {
        "title": "GLTF Loader",
        "href": "https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js",
        "className": "GLTFLoader",
        "fileName": "GLTFLoader"
      },
      "three.OrbitControls": {
        "title": "THREE.OrbitControls",
        "href": "https://cdn.jsdelivr.net/npm/three-orbitcontrols@2.110.3/OrbitControls.min.js",
        "isModule": true,
        "fileName": "three.OrbitControls"
      },
      "CodeMirror.js.min.js": {
        "title": "CodeMirror.js.min.js",
        "href-disabled": "https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/mode/javascript/javascript.min.js",
        "className": "CodeMirror.js",
        "fileName": "CodeMirror.js.min.js"
      },
      "threejs": {
        "title": "THREE",
        "href": "https://cdn.jsdelivr.net/npm/three@0.128.0/build/three.min.js",
        "className": "THREE",
        "requireName": "three",
        "fileName": "threejs",
        "isModule": true
      },
      "jszip.min.js": {
        "title": "jszip.min.js",
        "href-disabled": "https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js",
        "fileName": "jszip.min.js"
      },
      "GE_GroupManager": {
        "title": "GE_GroupManager",
        "fileName": "GE_GroupManager",
        "script": "class GE_GroupManager {\r\n    constructor(gameEditor, graphicsEditor) {\r\n        this.gameEditor = gameEditor;\r\n        this.graphicsEditor = graphicsEditor;\r\n        this.DEFAULT_GROUP = {\r\n            shapes: [],\r\n            position: { x: 0, y: 0, z: 0 },\r\n            rotation: { x: 0, y: 0, z: 0 },\r\n            scale: { x: 1.0, y: 1.0, z: 1.0 }\r\n        };\r\n    }\r\n\r\n    init() {\r\n        document.getElementById('create-group').addEventListener('click', this.createGroup.bind(this));\r\n        document.getElementById('delete-group').addEventListener('click', this.deleteGroup.bind(this));\r\n        \r\n       \r\n        // Update the group list initially\r\n        this.updateGroupList();\r\n        \r\n        // Initialize drag-and-drop\r\n        this.initDragAndDrop();\r\n    }\r\n\r\n    // Initialize drag and drop functionality\r\n    initDragAndDrop() {\r\n        // Make group items drop targets\r\n        const groupList = document.getElementById('group-list');\r\n        groupList.addEventListener('dragover', this.handleDragOver.bind(this));\r\n        groupList.addEventListener('drop', this.handleDrop.bind(this));\r\n    }\r\n    \r\n    handleDragOver(e) {\r\n        e.preventDefault(); // Allow drop\r\n        e.dataTransfer.dropEffect = 'move';\r\n        \r\n        // Highlight the group being dragged over\r\n        const groupItem = this.findGroupItemFromEvent(e);\r\n        if (groupItem) {\r\n            // Remove highlight from all groups\r\n            document.querySelectorAll('.group-item').forEach(item => {\r\n                item.classList.remove('drag-over');\r\n            });\r\n            \r\n            // Add highlight to target group\r\n            groupItem.classList.add('drag-over');\r\n        }\r\n    }\r\n    \r\n    handleDrop(e) {\r\n        e.preventDefault();\r\n        \r\n        // Remove all drag-over highlights\r\n        document.querySelectorAll('.group-item').forEach(item => {\r\n            item.classList.remove('drag-over');\r\n        });\r\n        \r\n        // Find the target group\r\n        const groupItem = this.findGroupItemFromEvent(e);\r\n        if (!groupItem) return;\r\n        \r\n        const targetGroup = groupItem.dataset.group;\r\n        \r\n        // Get the shape data from dataTransfer\r\n        const data = e.dataTransfer.getData('text/plain');\r\n        if (!data) return;\r\n        \r\n        try {\r\n            const dragData = JSON.parse(data);\r\n            const { shapeIndex, sourceGroup } = dragData;\r\n            \r\n            // Don't move if source and target are the same\r\n            if (sourceGroup === targetGroup) return;\r\n            \r\n            // Move the shape to the target group\r\n            this.moveToGroup(parseInt(shapeIndex), sourceGroup, targetGroup);\r\n        } catch (err) {\r\n            console.error('Error processing drop:', err);\r\n        }\r\n    }\r\n    \r\n    findGroupItemFromEvent(e) {\r\n        let target = e.target;\r\n        // Traverse up to find the group-item\r\n        while (target && !target.classList.contains('group-item')) {\r\n            target = target.parentElement;\r\n            if (!target || target === document.body) return null;\r\n        }\r\n        return target;\r\n    }\r\n\r\n    // Create a new group at the frame level\r\n    createGroup() {\r\n        if(!this.graphicsEditor.state.editingModel) {            \r\n            return;\r\n        }\r\n        const groupName = prompt(\"Enter group name:\", \"group_\" + Date.now());\r\n\r\n        const currentFrame = this.graphicsEditor.state.currentFrame;\r\n        \r\n        // Ensure we have current frame data\r\n        if (!this.graphicsEditor.getCurrentFrame()) {\r\n            this.graphicsEditor.getCurrentAnimation()[currentFrame] = {};\r\n        }\r\n        \r\n        // Switch selection to the new group\r\n        this.graphicsEditor.state.currentGroup = groupName;\r\n        // Initialize group if it doesn't exist\r\n        if (!this.graphicsEditor.getCurrentGroup()) {\r\n            // Using JSON parse/stringify for deep copying\r\n            this.graphicsEditor.getCurrentFrame()[groupName] = JSON.parse(JSON.stringify(this.DEFAULT_GROUP));\r\n        }\r\n        \r\n        \r\n        // Refresh UI\r\n        this.graphicsEditor.uiManager.updateList();\r\n        this.graphicsEditor.refreshShapes(true);\r\n    }\r\n\r\n    // Move an object from one group to another\r\n    moveToGroup(shapeIndex, fromGroupName, toGroupName) {\r\n        if(!this.graphicsEditor.state.editingModel) {            \r\n            return;\r\n        }\r\n        const currentFrameData = this.graphicsEditor.getCurrentFrame();\r\n        \r\n        // Find the shape in the source group\r\n        const sourceGroup = currentFrameData[fromGroupName];\r\n        if (!sourceGroup) {\r\n            console.warn(`Source group ${fromGroupName} not found`);\r\n            return;\r\n        }\r\n        \r\n        // Find the shape\r\n        const shapeToMove = sourceGroup.shapes[shapeIndex];\r\n        if (!shapeToMove) {\r\n            console.warn(`Shape at index ${shapeIndex} not found in ${fromGroupName}`);\r\n            return;\r\n        }\r\n        \r\n        // Remove from source group\r\n        sourceGroup.shapes.splice(shapeIndex, 1);\r\n        \r\n        // Ensure target group exists\r\n        if (!currentFrameData[toGroupName]) {\r\n            currentFrameData[toGroupName] = this.DEFAULT_GROUP;\r\n        }\r\n        \r\n        // Add to target group\r\n        currentFrameData[toGroupName].shapes.push(shapeToMove);\r\n        \r\n        // Clear selection\r\n        this.graphicsEditor.state.selectedShapeIndex = -1;\r\n        \r\n        // Update UI\r\n        this.graphicsEditor.refreshShapes(true);\r\n    }\r\n\r\n    getGroupData(groupName){\r\n        let groupData = this.graphicsEditor.getCurrentFrame()[groupName];\r\n        if(!groupData){\r\n            return this.graphicsEditor.state.renderData.model[groupName];\r\n        }\r\n        return groupData;\r\n    }\r\n    // Select a group to work with\r\n    selectGroup(groupName) {\r\n        if (!groupName) return;\r\n        \r\n        // Update the selected group name\r\n        this.graphicsEditor.state.currentGroup = groupName;\r\n        this.graphicsEditor.state.selectedShapeIndex = -1;\r\n        let groupData = this.graphicsEditor.getMergedGroup(groupName);\r\n        this.graphicsEditor.uiManager.updateList();\r\n        this.graphicsEditor.shapeManager.highlightSelectedShape();\r\n        if(groupData){\r\n            // Update the UI to show shapes in this group\r\n            this.graphicsEditor.uiManager.createGroupInspector(groupData);\r\n            this.graphicsEditor.gizmoManager.transformSelectedObject(this.getGroupObject(groupName));\r\n            \r\n        }\r\n        // Update the selected class on group items\r\n        this.updateSelectedGroupClass(groupName);\r\n    }\r\n    updateSelectedGroupClass(groupName) {\r\n        // Remove selected class from all group items\r\n        const groupItems = document.querySelectorAll('.group-item');\r\n        groupItems.forEach(item => {\r\n            item.classList.remove('selected');\r\n        });\r\n        \r\n        // Add selected class to the newly selected group\r\n        const selectedGroupItem = Array.from(groupItems).find(\r\n            item => item.dataset.group === groupName\r\n        );\r\n        \r\n        if (selectedGroupItem) {\r\n            selectedGroupItem.classList.add('selected');\r\n        }\r\n    }\r\n    // Remove a group and place its contents back in the shapes group\r\n    deleteGroup() {\r\n        if(!this.graphicsEditor.state.editingModel) {            \r\n            return;\r\n        }\r\n        const currentFrameData = this.graphicsEditor.getCurrentFrame();\r\n        const currentGroup = this.graphicsEditor.getCurrentGroup();\r\n        // Get shapes from the selected group\r\n        const groupShapes = currentGroup.shapes;\r\n        if (groupShapes.length > 0) {\r\n            alert('Group must be empty to delete.');\r\n            return;\r\n        }\r\n                        \r\n        // Remove the group\r\n        delete currentFrameData[this.graphicsEditor.state.currentGroup];\r\n        \r\n        // Reset selection to shapes group\r\n        this.graphicsEditor.state.currentGroup = Object.keys(currentFrameData)[0];\r\n        this.graphicsEditor.state.selectedShapeIndex = -1;\r\n        \r\n        // Update UI\r\n        this.updateGroupList();\r\n        this.graphicsEditor.refreshShapes(true);\r\n    }\r\n    getGroupObject(groupName) {\r\n        let foundGroup = null;\r\n        this.graphicsEditor.rootGroup.traverse(obj => {\r\n            if (obj.isGroup && obj.name === groupName && obj.userData.isGroup) {\r\n                foundGroup = obj;\r\n            }\r\n        });\r\n        return foundGroup;\r\n    }\r\n\r\n\r\n    applyGroupTransform(groupName, position, rotation, scale) {\r\n        // Get the current frame data\r\n        const frameData = this.graphicsEditor.getCurrentFrame();\r\n        \r\n        // Ensure the group exists in the frame data\r\n        if (!frameData[groupName]) {\r\n            console.warn(`Group ${groupName} not found in frame data`);\r\n            return;\r\n        }\r\n \r\n        // Save transformations to the group data\r\n        frameData[groupName].position = {\r\n            x: position.x,\r\n            y: position.y,\r\n            z: position.z\r\n        };\r\n        frameData[groupName].rotation = {\r\n            x: rotation.x,\r\n            y: rotation.y,\r\n            z: rotation.z\r\n        };\r\n        frameData[groupName].scale = {\r\n            x: scale.x,\r\n            y: scale.y,\r\n            z: scale.z\r\n        };\r\n    \r\n        // Refresh the scene to see changes\r\n        this.graphicsEditor.refreshShapes(true);\r\n    }\r\n    // Update the group list in the UI\r\n    updateGroupList() {\r\n        const list = document.getElementById('group-list');\r\n        if (!list) {\r\n            console.warn(\"Group list element not found\");\r\n            return;\r\n        }\r\n        \r\n        list.innerHTML = '';\r\n        \r\n        for (const group of Object.keys(this.graphicsEditor.state.renderData.model)) {\r\n            const groupItem = document.createElement('div');\r\n            groupItem.classList.add('group-item');\r\n            if (group === this.graphicsEditor.state.currentGroup) {\r\n                groupItem.classList.add('selected');\r\n            }\r\n            \r\n            groupItem.textContent = group;\r\n            groupItem.addEventListener('click', () => this.selectGroup(group));\r\n            \r\n            // Make it a valid drop target for drag and drop\r\n            groupItem.dataset.group = group;\r\n            \r\n            list.appendChild(groupItem);\r\n        }\r\n    }\r\n}"
      },
      "GameState": {
        "fileName": "GameState",
        "script": "class GameState {\r\n    constructor(gameConfig = {}) {\r\n        let state = gameConfig.configs.state;\r\n     \r\n        // Clear all existing properties\r\n        for (let prop in this) {\r\n            if (Object.prototype.hasOwnProperty.call(this, prop)) {\r\n                delete this[prop];\r\n            }\r\n        }\r\n\r\n        // Set only the properties from params\r\n        for (let key in state) {\r\n            if (Object.prototype.hasOwnProperty.call(state, key)) {\r\n                this[key] = state[key];\r\n            }\r\n        }\r\n        this.entities = [];\r\n        // If stats is present, create defaultStats as a copy\r\n  \r\n    }\r\n\r\n    addEntity(entity) {\r\n        this.entities.push(entity);\r\n    }\r\n    removeEntity(entity) {\r\n    \r\n        let index = this.entities.indexOf(entity);\r\n        if( index >= 0 ) {\r\n            this.entities.splice(index, 1);\r\n        }\r\n    }\r\n}"
      },
      "ImageManager": {
        "fileName": "ImageManager",
        "script": "\r\nclass ImageManager {\r\n    constructor(app, {imageSize, palette, textures}, {ShapeFactory}) {\r\n        this.app = app;\r\n        this.images = {};\r\n        this.imageSize = imageSize || 128;\r\n        // Create a single reusable renderer\r\n        this.renderer = new THREE.WebGLRenderer({ antialias: false, alpha: true });\r\n        this.renderer.setSize(this.imageSize, this.imageSize);\r\n        this.renderer.shadowMap.enabled = true;\r\n        this.renderer.shadowMap.type = THREE.PCFSoftShadowMap;\r\n        \r\n        this.renderTarget = new THREE.WebGLRenderTarget(this.imageSize, this.imageSize);\r\n        this.renderTarget.texture.flipY = true;\r\n        \r\n        // Create reusable scene\r\n        this.scene = new THREE.Scene();\r\n        \r\n        // Create reusable cameras for different views\r\n        const cameraDistance = 64;\r\n        const frustumSize = cameraDistance + 16;\r\n        const aspect = 1;\r\n\r\n        this.shapeFactory = new ShapeFactory(palette, textures);\r\n        // Create 8 cameras for isometric views at 45-degree intervals\r\n        this.cameras = [];\r\n        for (let i = 0; i < 8; i++) {\r\n            this.cameras.push(new THREE.OrthographicCamera(-frustumSize * aspect, frustumSize * aspect, frustumSize, -frustumSize, 0.1, 1000));\r\n        }\r\n        \r\n        // Position cameras in a circle around the y-axis at isometric angle\r\n        // Standard isometric angle is about 35.264 degrees (arctan(1/sqrt(2)))\r\n        const isoAngle = Math.atan(1 / Math.sqrt(2));\r\n        const horizDistance = cameraDistance * Math.cos(isoAngle);\r\n        const vertDistance = cameraDistance * Math.sin(isoAngle);\r\n        \r\n        for (let i = 0; i < 8; i++) {\r\n            const angle = (i * Math.PI / 4); // 45-degree increments\r\n            const x = horizDistance * Math.sin(angle);\r\n            const z = horizDistance * Math.cos(angle);\r\n            \r\n            this.cameras[i].position.set(x, vertDistance, z);\r\n            this.cameras[i].lookAt(0, 0, 0);\r\n        }\r\n        \r\n        // Create reusable lights\r\n        this.ambientLight = new THREE.AmbientLight(0xffaaff, .25);\r\n        \r\n        // Create a light group that will rotate with each camera view\r\n        this.lightGroup = new THREE.Group();\r\n        \r\n        // Main directional light\r\n        this.directionalLight = new THREE.DirectionalLight(0xffffaa, .7);\r\n        this.directionalLight.position.set(75, 96, 75);\r\n        this.directionalLight.castShadow = true;\r\n        this.directionalLight.shadow.mapSize.width = 1024;\r\n        this.directionalLight.shadow.mapSize.height = 1024;\r\n        this.directionalLight.shadow.camera.near = 0.5;\r\n        this.directionalLight.shadow.camera.far = 500;\r\n        this.directionalLight.shadow.bias = -0.0005;\r\n        this.directionalLight.shadow.normalBias = 0.02;\r\n        this.directionalLight.shadow.radius = 1;\r\n        this.lightGroup.add(this.directionalLight);\r\n        \r\n        // Fill light\r\n        this.fillLight = new THREE.DirectionalLight(0xffaaff, .5);\r\n        this.fillLight.position.set(-20, 30, -20);\r\n        this.lightGroup.add(this.fillLight);\r\n        \r\n        // Create ground plane\r\n        const groundGeometry = new THREE.PlaneGeometry(200, 200);\r\n        const groundMaterial = new THREE.ShadowMaterial({ opacity: 0.3 });\r\n        this.ground = new THREE.Mesh(groundGeometry, groundMaterial);\r\n        this.ground.rotation.x = -Math.PI / 2;\r\n        this.ground.position.y = 0;\r\n        this.ground.receiveShadow = true;\r\n    }\r\n\r\n    clear() {\r\n        images = {};\r\n    }\r\n\r\n    dispose() {\r\n        // Proper cleanup when the manager is no longer needed\r\n        if (this.renderer) {\r\n            this.renderer.dispose();\r\n            this.renderer = null;\r\n        }\r\n        if (this.renderTarget) {\r\n            this.renderTarget.dispose();\r\n            this.renderTarget = null;\r\n        }\r\n        if (this.ground && this.ground.geometry) {\r\n            this.ground.geometry.dispose();\r\n            this.ground.material.dispose();\r\n        }\r\n        // Dispose of other reusable resources\r\n        this.cameras = [];\r\n        this.scene = null;\r\n        this.lightGroup = null;\r\n        this.ambientLight = null;\r\n    }\r\n\r\n    async loadImages(prefix, config, checkCache = true, cacheResult = true) {\r\n\r\n        if (!prefix || !config || typeof config !== 'object') {\r\n            throw new Error('Invalid prefix or config provided to loadImages');\r\n        }\r\n        if( checkCache ) {\r\n            const cachedImages = await this.checkCache(prefix);\r\n            if (cachedImages) {\r\n                this.images = { ...this.images, ...cachedImages };\r\n                return;\r\n            }\r\n        }\r\n    \r\n        for (const [type, cfg] of Object.entries(config)) {\r\n            if (cfg.render && cfg.render.animations) {\r\n                this.images[`${prefix}_${type}`] = await this.createAnimatedPlaceholder(cfg);\r\n            } else if (cfg.tileMap && cfg.tileMap.terrainTypes) {\r\n                this.images[`${prefix}_${type}`] = await this.createTerrainImages(cfg);\r\n            }\r\n        }\r\n        if(cacheResult) {\r\n            await this.cacheImages(prefix);\r\n        }\r\n    }\r\n    \r\n    async checkCache(prefix) {\r\n        try {\r\n            const response = await fetch(`cache/${prefix}.json`);\r\n            if (response.ok) {\r\n                const cacheData = await response.json();\r\n                // Convert base64 cached images back to canvases\r\n                return await this.convertBase64ToCanvases(cacheData.images);\r\n            }\r\n            return null;\r\n        } catch (error) {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    async convertBase64ToCanvases(cachedImages) {\r\n        const convertedImages = {};\r\n        \r\n        for (const [key, value] of Object.entries(cachedImages)) {\r\n            if (Array.isArray(value)) {\r\n                // Handle terrain tiles\r\n                convertedImages[key] = await Promise.all(value.map(async (terrain) => {\r\n                    const sprites = await Promise.all(terrain.sprites.map(async (base64) => {\r\n                        const canvas = document.createElement('canvas');\r\n                        canvas.width = canvas.height = 24; // Match tileWidth from createTerrainImages\r\n                        const ctx = canvas.getContext('2d');\r\n                        const img = new Image();\r\n                        \r\n                        await new Promise((resolve, reject) => {\r\n                            img.onload = () => {\r\n                                ctx.drawImage(img, 0, 0);\r\n                                resolve();\r\n                            };\r\n                            img.onerror = reject;\r\n                            img.src = base64;\r\n                        });\r\n                        \r\n                        return canvas;\r\n                    }));\r\n                    \r\n                    return {\r\n                        type: terrain.type,\r\n                        sprites\r\n                    };\r\n                }));\r\n            } else if (typeof value === 'object') {\r\n                // Handle animations\r\n                const animations = {};\r\n                for (const [animType, frames] of Object.entries(value)) {\r\n                    animations[animType] = await Promise.all(frames.map(async (frameSet) => {\r\n                        return Promise.all(frameSet.map(async (base64) => {\r\n                            const canvas = document.createElement('canvas');\r\n                            canvas.width = canvas.height = this.imageSize;\r\n                            const ctx = canvas.getContext('2d');\r\n                            const img = new Image();\r\n                            \r\n                            await new Promise((resolve, reject) => {\r\n                                img.onload = () => {\r\n                                    ctx.drawImage(img, 0, 0);\r\n                                    resolve();\r\n                                };\r\n                                img.onerror = reject;\r\n                                img.src = base64;\r\n                            });\r\n                            \r\n                            return canvas;\r\n                        }));\r\n                    }));\r\n                }\r\n                convertedImages[key] = animations;\r\n            }\r\n        }\r\n        \r\n        return convertedImages;\r\n    }\r\n    async cacheImages(prefix) {\r\n        const base64Images = {};\r\n        \r\n        for (const [key, value] of Object.entries(this.images)) {\r\n            if (key.startsWith(prefix)) {\r\n                if (Array.isArray(value) && value[0]?.type && value[0]?.sprites) {\r\n                    // Handle terrain tiles\r\n                    base64Images[key] = value.map(terrain => ({\r\n                        type: terrain.type,\r\n                        sprites: terrain.sprites.map(canvas => canvas.toDataURL('image/png'))\r\n                    }));\r\n                } else if (typeof value === 'object' && value !== null) {\r\n                    // Handle animations\r\n                    const animationData = {};\r\n                    for (const [animType, frames] of Object.entries(value)) {\r\n                        animationData[animType] = frames.map(frameSet => \r\n                            frameSet.map(canvas => canvas.toDataURL('image/png'))\r\n                        );\r\n                    }\r\n                    base64Images[key] = animationData;\r\n                }\r\n            }\r\n        }\r\n\r\n        try {\r\n            await fetch('/api/cache', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                },\r\n                body: JSON.stringify({\r\n                    prefix,\r\n                    images: base64Images\r\n                })\r\n            });\r\n        } catch (error) {\r\n            console.error('Error caching images:', error);\r\n        }\r\n    }\r\n    // In the ImageManager class\r\n    async createTerrainImages(config) {\r\n        let terrainTiles = [];\r\n        const tileWidth = 24;\r\n\r\n        // Create a map of terrain type to its image data first\r\n        const terrainMap = {};\r\n        \r\n        await Promise.all(config.tileMap.terrainTypes.map(async (terrainType, terrainIndex) => {\r\n            const pixelData = terrainType.image;\r\n            if (pixelData && pixelData.length > 0) {\r\n                let sprites = new Array(8);\r\n                \r\n                await Promise.all(pixelData.map(async (imagePixelData, spriteIdx) => {\r\n                    const img = new Image();\r\n                    const canvas = document.createElement('canvas');\r\n                    canvas.width = canvas.height = tileWidth;\r\n                    const ctx = canvas.getContext('2d');\r\n\r\n                    if (!imagePixelData.startsWith('data:image/')) {\r\n                        imagePixelData = 'data:image/png;base64,' + imagePixelData;\r\n                    }\r\n                    img.src = imagePixelData;\r\n\r\n                    await new Promise((resolve, reject) => {\r\n                        img.onload = () => {\r\n                            ctx.drawImage(img, 0, 0);\r\n                            sprites[spriteIdx] = canvas;\r\n                            resolve();\r\n                        };\r\n                        img.onerror = () => {\r\n                            console.error(`Failed to load image for ${terrainType.type} at index ${spriteIdx}`);\r\n                            sprites[spriteIdx] = canvas; // Store empty canvas on error\r\n                            resolve(); // Don't reject, just move on\r\n                        };\r\n                    });\r\n                }));\r\n\r\n                // Store by index and type for more reliable lookup\r\n                terrainTiles[terrainIndex] = { \r\n                    type: terrainType.type,\r\n                    sprites: sprites \r\n                };\r\n            } else {\r\n                // Create a solid color placeholder for types without images\r\n                const sprites = new Array(8).fill().map(() => {\r\n                    const canvas = document.createElement('canvas');\r\n                    canvas.width = canvas.height = tileWidth;\r\n                    const ctx = canvas.getContext('2d');\r\n                    ctx.fillStyle = terrainType.color || '#cccccc';\r\n                    ctx.fillRect(0, 0, tileWidth, tileWidth);\r\n                    return canvas;\r\n                });\r\n                \r\n                terrainTiles[terrainIndex] = {\r\n                    type: terrainType.type,\r\n                    sprites: sprites\r\n                };\r\n            }\r\n        }));\r\n\r\n        // Make sure there are no gaps in the array\r\n        return terrainTiles.filter(Boolean);\r\n    }\r\n    async createAnimatedPlaceholder(config) {\r\n        const animations = {};\r\n        \r\n        if(config.shadows === false) {\r\n            this.ground.receiveShadow = false;\r\n        } else {\r\n            this.ground.receiveShadow = true;\r\n        }\r\n        for (const [animType, frames] of Object.entries(config.render.animations)) {\r\n            animations[animType] = [];\r\n            let i = 0;\r\n            for (const frame of frames) {\r\n                const frameImages = await this.captureObjectImagesFromJSON(config.render.model, frame);\r\n                const canvases = frameImages.map(img => {\r\n                    const canvas = document.createElement('canvas');\r\n                    canvas.width = canvas.height = this.imageSize;\r\n                    const ctx = canvas.getContext('2d');\r\n                    ctx.drawImage(img, 0, 0);\r\n                    return canvas;\r\n                });                \r\n                animations[animType].push(canvases); // Array of 8 canvases per frame\r\n            }\r\n        }\r\n        return animations; // { \"idle\": [[canvas0, canvas1, canvas2, canvas3, ...], ...], \"walk\": [...] }\r\n    }\r\n\r\n    getImages(prefix, type) {\r\n        return this.images[`${prefix}_${type}`]; // Returns animation object\r\n    }\r\n    async captureObjectImagesFromJSON(model, frameData) {\r\n        const size = this.imageSize;\r\n        // Clear the scene\r\n        while (this.scene.children.length > 0) {\r\n            const object = this.scene.children[0];\r\n            this.scene.remove(object);\r\n        }\r\n        \r\n        // Add reusable elements to scene\r\n        this.scene.add(this.ground);\r\n        this.scene.add(this.ambientLight);\r\n        this.scene.add(this.lightGroup);\r\n        \r\n        // Create objects from the JSON data\r\n        const objectGroup = await this.createObjectsFromJSON(model, frameData, this.scene);\r\n\r\n        \r\n        const images = [];\r\n        \r\n        // For each camera view, rotate the light group to match camera orientation\r\n        for (let i = 0; i < this.cameras.length; i++) {\r\n            const camera = this.cameras[i];\r\n            \r\n            // Reset light group rotation\r\n            this.lightGroup.rotation.set(0, 0, 0);\r\n            \r\n            // Rotate light group to match camera position\r\n            // Calculate angle based on camera index (8 positions at 45-degree intervals)\r\n            // Rotate 45 degrees CLOCKWISE (subtract /4 instead of adding)\r\n            const angle = (i * Math.PI / 4); \r\n            this.lightGroup.rotation.y = angle;\r\n            \r\n            // Before rendering with each camera, update shadow camera frustum\r\n            const d = 100;\r\n            this.directionalLight.shadow.camera.left = -d;\r\n            this.directionalLight.shadow.camera.right = d;\r\n            this.directionalLight.shadow.camera.top = d;\r\n            this.directionalLight.shadow.camera.bottom = -d;\r\n            // After rotating lightGroup in the camera loop\r\n            this.directionalLight.shadow.camera.updateProjectionMatrix();\r\n            this.directionalLight.shadow.camera.updateMatrixWorld();\r\n            this.directionalLight.target.position.set(0, 0, 0);\r\n            this.directionalLight.target.updateMatrixWorld();\r\n            // Render and capture the image\r\n            this.renderer.setRenderTarget(this.renderTarget);\r\n            this.renderer.render(this.scene, camera);\r\n            const buffer = new Uint8Array(size * size * 4);\r\n            this.renderer.readRenderTargetPixels(this.renderTarget, 0, 0, size, size, buffer);\r\n            \r\n            // Flip the buffer (y-axis)\r\n            const flippedBuffer = new Uint8Array(size * size * 4);\r\n            for (let y = 0; y < size; y++) {\r\n                const srcRowStart = y * size * 4;\r\n                const destRowStart = (size - 1 - y) * size * 4;\r\n                flippedBuffer.set(buffer.subarray(srcRowStart, srcRowStart + size * 4), destRowStart);\r\n            }\r\n            \r\n            const imageData = new ImageData(new Uint8ClampedArray(flippedBuffer), size, size);\r\n            const imageBitmap = await createImageBitmap(imageData);\r\n            images.push(imageBitmap);\r\n        }\r\n        if( this.renderer) this.renderer.setRenderTarget(null);\r\n        \r\n        // Cleanup object geometries and materials\r\n        this.shapeFactory.disposeObject(objectGroup);\r\n        \r\n        // Remove object group from scene\r\n        if( this.scene ) this.scene.remove(objectGroup);\r\n        \r\n        return images;\r\n    }\r\n\r\n    /**\r\n     * Creates 3D objects from shape data.\r\n     * @param {Object} frameData - The JSON object containing frame definitions.\r\n     * @returns {THREE.Group} - A group containing all 3D objects.\r\n     */\r\n  \r\n    async createObjectsFromJSON(model, frameData, scene) {\r\n        const rootGroup = new THREE.Group();\r\n        \r\n        for(const groupName in model) {\r\n            const group = await this.shapeFactory.createMergedGroupFromJSON(model, frameData, groupName);\r\n            if(group){\r\n                group.traverse((child) => {\r\n                    if (child.isMesh) {\r\n                        child.castShadow = true; // or set this selectively for objects that should cast shadows\r\n                        child.receiveShadow = true; // for objects that should receive shadows\r\n                    }\r\n                });\r\n                rootGroup.add(group);\r\n            }\r\n        }\r\n\r\n        scene.add(rootGroup);\r\n    \r\n        return rootGroup;\r\n    }\r\n   \r\n}\r\n"
      },
      "ModelManager": {
        "title": "ModelManager",
        "fileName": "ModelManager",
        "script": "class ModelManager {\n    constructor(app, { ShapeFactory, palette, textures }) {\n        this.app = app;\n        this.models = {};\n        this.shapeFactory = new ShapeFactory(palette, textures);\n    }\n\n    clear() {\n        this.models = {};\n    }\n\n    dispose() {\n        // Cleanup when manager is no longer needed\n        for (const [key, model] of Object.entries(this.models)) {\n            this.disposeModel(model);\n        }\n        this.models = {};\n    }\n    \n    disposeModel(model) {\n        if (!model) return;\n        \n        // Handle animation objects\n        if (model.animations) {\n            for (const [animType, frames] of Object.entries(model.animations)) {\n                for (const frame of frames) {\n                    if (frame.group) {\n                        this.shapeFactory.disposeObject(frame.group);\n                        frame.group = null;\n                    }\n                }\n            }\n        }\n    }\n\n    async loadModels(prefix, config) {\n        if (!prefix || !config || typeof config !== 'object') {\n            throw new Error('Invalid prefix or config provided to loadModels');\n        }\n    \n        for (const [type, cfg] of Object.entries(config)) {\n            if (cfg.render && cfg.render.model) {\n                this.models[`${prefix}_${type}`] = await this.createModel(cfg.render.model);\n            }\n        }        \n       \n    }\n\n\n    async createModel(modelData) {\n        const modelGroup = await this.createObjectsFromJSON(modelData, {});\n            \n        if (modelGroup) {\n            // Apply shadows to all meshes\n            modelGroup.traverse((child) => {\n                if (child.isMesh) {\n                    child.castShadow = true;\n                    child.receiveShadow = true;\n                }\n            });\n            \n        }\n            \n        \n        \n        return modelGroup;\n    }\n\n    getModel(prefix, type) {\n        return this.models[`${prefix}_${type}`];\n    }\n\n    async createObjectsFromJSON(model, frameData) {\n        const rootGroup = new THREE.Group();\n        \n        for (const groupName in model) {\n            const group = await this.shapeFactory.createMergedGroupFromJSON(model, frameData, groupName);\n            if (group) {\n                rootGroup.add(group);\n            }\n        }\n    \n        return rootGroup;\n    }\n}"
      },
      "aiPromptPanel": {
        "fileName": "aiPromptPanel",
        "script": "class AIPromptPanel {\r\n    constructor(gameEditor) {\r\n        this.gameEditor = gameEditor;\r\n      console.log(this.gameEditor);\r\n        const aiConfig = this.gameEditor.getCollections().configs.ai;\r\n        this.elements = {\r\n            launchBtn: null,\r\n            aiPromptModal: null,\r\n            promptTextarea: null,\r\n            sendBtn: null,\r\n            closeBtn: null,\r\n            previewArea: null,\r\n            applyBtn: null\r\n        };\r\n        this.init(aiConfig);\r\n    }\r\n\r\n    init(aiConfig) {\r\n       this.setupHooks();\r\n        // Create the AI Prompt Modal\r\n        const modal = document.getElementById('modal-aiPromptPanel');\r\n\r\n        this.config = aiConfig;\r\n        // Cache elements\r\n        this.elements = {\r\n            aiPromptModal: modal,\r\n            promptTextarea: modal.querySelector('#ai-prompt-textarea'),\r\n            prePromptTextarea: modal.querySelector('#ai-pre-prompt-textarea'),\r\n            sendBtn: modal.querySelector('#send-ai-prompt-btn'),\r\n            closeBtn: modal.querySelector('#close-ai-prompt-modal'),\r\n            previewArea: modal.querySelector('#ai-response-preview'),\r\n            applyBtn: modal.querySelector('#apply-ai-response-btn')\r\n        };\r\n\r\n        // Setup event listeners\r\n        this.setupEventListeners();\r\n    }\r\n\r\n    setupEventListeners() {\r\n        this.elements.sendBtn.addEventListener('click', () => this.sendPromptToAI());\r\n        this.elements.closeBtn.addEventListener('click', () => {\r\n            this.elements.aiPromptModal.classList.remove('show');\r\n        });\r\n        this.elements.applyBtn.addEventListener('click', () => {\r\n            this.applyAIResponse();\r\n        });\r\n    }\r\n\r\n    setupHooks() {\r\n        \r\n        document.body.addEventListener('renderEditor', () => {\r\n            if(this.elements.launchBtn) this.elements.launchBtn.remove();\r\n            this.elements.launchBtn = document.createElement('button');\r\n            this.elements.launchBtn.innerHTML = \"AI Prompt\";\r\n            this.elements.launchBtn.id = 'ai-prompt-modal';\r\n            this.gameEditor.elements.editor.querySelector(\".actions>div\")?.appendChild(this.elements.launchBtn);\r\n            this.elements.launchBtn.addEventListener('click', () => {\r\n                this.showModal();\r\n            });\r\n        });\r\n    }\r\n\r\n    generateContextPrompt(object) {\r\n        const type = this.gameEditor.model.getSingularType(this.gameEditor.model.state.selectedType);\r\n\t\tlet defaultPrompt = this.config.defaultPrompt.trim().replace(/\\$\\{type\\}/g, type);\r\n        let outputObj = {...object};\r\n        const { selectedObject } = this.gameEditor.model.state;\r\n        outputObj.id = selectedObject;\r\n        \r\n        return `${defaultPrompt}\\n\\nContext Object: \\n\\n${JSON.stringify(outputObj, null, 2)}`;\r\n\t\t\r\n    }\r\n\r\n    async sendPromptToAI() {\r\n        const prompt = `${this.elements.prePromptTextarea.value} \\n\\n ${this.elements.promptTextarea.value}`;\r\n\r\n        try {\r\n            this.elements.previewArea.value = \"Generating ...\"; // Use .value for textarea\r\n\r\n            const { aiEndPoint, aiModel, apiKey, headers, requestBody } = this.prepareAIConfig(prompt);\r\n            console.log('Request config:', { aiEndPoint, aiModel, apiKey, headers, requestBody });\r\n\r\n            const response = await fetch(aiEndPoint, {\r\n                method: 'POST',\r\n                headers,\r\n                body: JSON.stringify(requestBody)\r\n            });\r\n\r\n            if (!response.ok) {\r\n                throw new Error(`AI generation failed: ${response.statusText}`);\r\n            }\r\n\r\n            const responseData = await response.json();\r\n            console.log('Raw API response:', responseData);\r\n\r\n            const aiOutput = this.extractAIOutput(responseData);\r\n            const cleanedOutput = this.cleanOutput(aiOutput);\r\n            console.log('Cleaned output:', cleanedOutput);\r\n\r\n            const parsedResponse = this.parseJSONResponse(cleanedOutput);\r\n            this.elements.previewArea.value = JSON.stringify(parsedResponse, null, 2); // Use .value\r\n            this.elements.applyBtn.style.display = 'block';\r\n        } catch (error) {\r\n            console.error('AI Generation Error:', error);\r\n            this.elements.previewArea.value = `Error: ${error.message}`; // Use .value\r\n            this.elements.applyBtn.style.display = 'none';\r\n        }\r\n    }\r\n\r\n    prepareAIConfig(prompt) {\r\n        let updated = false;\r\n\r\n        let aiEndPoint = this.config.aiEndPoint || \"http://127.0.0.1:11434/api/generate\";\r\n        let aiModel = this.config.aiModel || \"deepseek-r1:32b\";\r\n        const apiKey = this.config.aiApiKey || \"\";\r\n\r\n        if (!this.config.aiEndPoint) {\r\n            this.config.aiEndPoint = aiEndPoint;\r\n            updated = true;\r\n        }\r\n        if (!this.config.aiModel) {\r\n            this.config.aiModel = aiModel;\r\n            updated = true;\r\n        }\r\n        if (updated) {\r\n            this.gameEditor.renderObjectList();\r\n            this.gameEditor.saveToLocalStorage();\r\n        }\r\n\r\n        const headers = { 'Content-Type': 'application/json' };\r\n        let requestBody = { \r\n            prompt, \r\n            model: aiModel, \r\n            jsonOnly: true, \r\n            stream: false \r\n        };\r\n\r\n        if (apiKey) {\r\n            headers.Authorization = `Bearer ${apiKey}`;\r\n            requestBody = {\r\n                model: aiModel,\r\n                messages: [\r\n                    { role: 'system', content: 'You are a helpful assistant that generates valid JSON objects based on user prompts.' },\r\n                    { role: 'user', content: prompt }\r\n                ],\r\n                temperature: 0.7,\r\n                max_tokens: 500\r\n            };\r\n        }\r\n\r\n        return { aiEndPoint, aiModel, apiKey, headers, requestBody };\r\n    }\r\n\r\n    extractAIOutput(responseData) {\r\n        return responseData.response || responseData.result || responseData;\r\n    }\r\n\r\n cleanOutput(aiOutput) {\r\n        const outputString = typeof aiOutput === 'string' ? aiOutput : JSON.stringify(aiOutput);\r\n        return outputString\r\n            .replace(/```json\\s*/g, '') // Remove ```json and optional whitespace/newlines\r\n            .replace(/```\\s*/g, '')     // Remove ``` and optional whitespace/newlines\r\n            .replace(/<think\\s*>[\\s\\S]*?<\\/think\\s*>/gi, '') // Remove <think> tags\r\n            .replace(/<think[\\s\\S]*?\\/>/gi, '') // Remove self-closing <think> tags\r\n            .trim(); // Remove leading/trailing whitespace\r\n    }\r\n\r\n    parseJSONResponse(cleanedOutput) {\r\n        try {\r\n            return JSON.parse(cleanedOutput);\r\n        } catch (parseError) {\r\n            throw new Error('Invalid JSON response from AI:\\n' + cleanedOutput);\r\n        }\r\n    }\r\n\r\n    applyAIResponse() {\r\n        try {\r\n            const responseText = this.elements.previewArea.value; // Use .value for textarea\r\n            const parsedResponse = JSON.parse(responseText);\r\n\r\n            if (!parsedResponse.id) {\r\n                alert(\"Must include id in new object.\");\r\n                return;\r\n            }\r\n\r\n            const { selectedType } = this.gameEditor.model.state;\r\n            this.gameEditor.model.getCollections()[selectedType][parsedResponse.id] = parsedResponse;\r\n\r\n            this.gameEditor.renderObjectList();\r\n            this.gameEditor.selectObject(parsedResponse.id); // Use new id instead of old selectedObject\r\n\r\n            this.elements.aiPromptModal.classList.remove('show');\r\n        } catch (error) {\r\n            console.error('Error applying AI response:', error);\r\n            alert('Failed to apply AI response. Please check the JSON format.');\r\n        }\r\n    }\r\n\r\n    showModal() {\r\n        const currentObject = this.gameEditor.getCurrentObject();\r\n        this.elements.prePromptTextarea.value = this.generateContextPrompt(currentObject); // Use .value\r\n        this.elements.previewArea.value = ''; // Use .value\r\n        this.elements.applyBtn.style.display = 'none';\r\n        this.elements.aiPromptModal.classList.add('show');\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"
      },
      "CanvasUtility": {
        "fileName": "CanvasUtility",
        "script": "class CanvasUtility {\r\n    constructor() {\r\n        this.canvas = document.createElement('canvas');\r\n        this.ctx = this.canvas.getContext('2d', { willReadFrequently: true });\r\n\t\tthis.ctx.globalCompositeOperation = 'destination-over';// Set the composite operation to preserve transparency\r\n        \r\n\t\tthis.tempCanvas = document.createElement('canvas');\r\n        this.tempCtx = this.tempCanvas.getContext('2d', { willReadFrequently: true });\r\n\t\tthis.tempCtx.globalCompositeOperation = 'destination-over';// Set the composite operation to preserve transparency\r\n    }\r\n\r\n    setSize(width, height) {\r\n        this.canvas.width = width;\r\n        this.canvas.height = height;\r\n    }\r\n    paintTexture(imageData) {\r\n        this.setSize(imageData.width, imageData.height);\r\n        this.ctx.putImageData(imageData, 0, 0);\r\n        return this.ctx.getImageData(0, 0, this.canvas.width, this.canvas.height);\r\n    }\r\n\trotateTexture(imageData, angle) {\r\n        // Set the canvas size to accommodate the rotated image\r\n        // Note: If the rotation results in a change in width/height, adjust these values accordingly\r\n        this.setSize(imageData.width, imageData.height);\r\n\r\n        // Draw the original imageData to the canvas\r\n        this.ctx.putImageData(imageData, 0, 0);\r\n\r\n        // Apply the rotation\r\n        this.ctx.translate(this.canvas.width / 2, this.canvas.height / 2);\r\n        this.ctx.rotate(angle);\r\n        this.ctx.translate(-this.canvas.width / 2, -this.canvas.height / 2);\r\n\r\n        // Create a temporary canvas to hold the current state\r\n        this.tempCanvas.width = this.canvas.width;\r\n        this.tempCanvas.height = this.canvas.height;\r\n        this.tempCtx.drawImage(this.canvas, 0, 0);\r\n\r\n        // Clear the main canvas and draw the rotated image\r\n        this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n        this.ctx.drawImage(this.tempCanvas, 0, 0);\r\n\r\n        // Capture the rotated image data\r\n        let rotatedData = this.ctx.getImageData(0, 0, this.canvas.width, this.canvas.height);\r\n \r\n\r\n        return rotatedData;\r\n    }\r\n\tflipTextureVertical(imageData) {\r\n        this.setSize(imageData.width, imageData.height);\r\n\r\n        // Draw the original image data to the canvas\r\n        this.ctx.putImageData(imageData, 0, 0);\r\n\r\n        // Use an off-screen canvas to perform the flip\r\n        this.tempCanvas.width = imageData.width;\r\n        this.tempCanvas.height = imageData.height;\r\n  \r\n        // Apply the flip on the off-screen canvas\r\n        this.tempCtx.translate(0, this.tempCanvas.height);\r\n\t\tthis.tempCtx.scale(1, -1);\r\n\t\tthis.tempCtx.drawImage(this.canvas, 0, 0);\r\n\r\n        // Extract the flipped image data\r\n        return this.tempCtx.getImageData(0, 0, this.tempCanvas.width, this.tempCanvas.height);\r\n    }\r\n\r\n    flipTextureHorizontal(imageData) {\r\n        this.setSize(imageData.width, imageData.height);\r\n\r\n        // Draw the original image data to the canvas\r\n        this.ctx.putImageData(imageData, 0, 0);\r\n\r\n        // Use an off-screen canvas to perform the flip\r\n        this.tempCanvas.width = imageData.width;\r\n        this.tempCanvas.height = imageData.height;\r\n        // Apply the flip on the off-screen canvas\r\n\t\tthis.tempCtx.translate(this.tempCanvas.width, 0);\r\n\t\tthis.tempCtx.scale(-1, 1);\r\n\t\tthis.tempCtx.drawImage(this.canvas, 0, 0);\r\n\r\n        // Extract the flipped image data\r\n        return this.tempCtx.getImageData(0, 0, this.tempCanvas.width, this.tempCanvas.height);\r\n    }\r\n\tdrawImage(image) {\r\n        this.setSize(image.width, image.height);\r\n        this.ctx.drawImage(image, 0, 0);\r\n        return this.ctx.getImageData(0, 0, this.canvas.width, this.canvas.height);\r\n    }\r\n\r\n\trotateImage(image, angle) {\r\n\t\tthis.setSize(image.width, image.height);\r\n\t\t// Set up the rotation\r\n\t\tthis.ctx.translate(this.canvas.width / 2, this.canvas.height / 2);\r\n\t\tthis.ctx.rotate(angle);\r\n\t\tthis.ctx.translate(-this.canvas.width / 2, -this.canvas.height / 2);\r\n\t\tthis.ctx.fillStyle = 'rgba(0, 0, 0, 0)'; // Fully transparent\r\n\t\tthis.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);\r\n\t\r\n\t\t// Draw the image\r\n\t\tthis.ctx.drawImage(image, 0, 0);\r\n\t\treturn this.ctx.getImageData(0, 0, this.canvas.width, this.canvas.height);\r\n\t}\r\n\r\n    flipImageVertical(image) {\r\n        this.setSize(image.width, image.height);\r\n        this.ctx.translate(0, this.canvas.height);\r\n        this.ctx.scale(1, -1);\r\n        this.ctx.drawImage(image, 0, 0);\r\n        return this.ctx.getImageData(0, 0, this.canvas.width, this.canvas.height);\r\n    }\r\n\r\n    flipCanvasVertical() {\r\n        this.ctx.translate(0, this.canvas.height);\r\n        this.ctx.scale(1, -1);\r\n        return this.ctx.getImageData(0, 0, this.canvas.width, this.canvas.height);\r\n    }\r\n\r\n    flipImageHorizontal(image) {\r\n        this.setSize(image.width, image.height);\r\n        this.ctx.translate(this.canvas.width, 0);\r\n        this.ctx.scale(-1, 1);\r\n        this.ctx.drawImage(image, 0, 0);\r\n        return this.ctx.getImageData(0, 0, this.canvas.width, this.canvas.height);\r\n    }\r\n}"
      },
      "GE_SceneRenderer": {
        "title": "GE_SceneRenderer",
        "fileName": "GE_SceneRenderer",
        "script": "class GE_SceneRenderer {\r\n    constructor(gameEditor, graphicsEditor) {\r\n        this.gameEditor = gameEditor;\r\n        this.graphicsEditor = graphicsEditor;\r\n        this.scene = null;\r\n        this.camera = null;\r\n        this.renderer = null;\r\n        this.controls = null;\r\n    }    \r\n\r\n    init() {        \r\n        this.initThreeJS();\r\n        this.initEventListeners();\r\n    }\r\n    initEventListeners() {\r\n        document.body.addEventListener('renderGraphicsObject', this.handleRenderObject.bind(this));\r\n        document.body.addEventListener('resizedEditor', () => { \r\n            console.log('resized');\r\n            this.graphicsEditor.canvas.width = this.gameEditor.getCollections().configs.game.canvasWidth;\r\n            this.graphicsEditor.canvas.height = this.gameEditor.getCollections().configs.game.canvasHeight;\r\n            this.graphicsEditor.canvas.setAttribute('style','');\r\n            this.handleResize();  \r\n            this.graphicsEditor.refreshShapes(false); \r\n        });\r\n        document.getElementById('iso-generate').addEventListener('click', this.generateIsometricSprites.bind(this));\r\n    }\r\n    initThreeJS() {\r\n        // Scene setup\r\n        this.scene = new window.THREE.Scene();\r\n        \r\n        // Add the root group to the scene\r\n        this.scene.add(this.graphicsEditor.rootGroup);\r\n\r\n        // Camera setup\r\n        this.camera = new window.THREE.PerspectiveCamera(\r\n            75, \r\n            this.graphicsEditor.canvas.clientWidth / this.graphicsEditor.canvas.clientHeight, \r\n            0.1, \r\n            1000\r\n        );\r\n        this.camera.position.set(100, 100, 100);\r\n        this.camera.lookAt(0, 0, 0);\r\n\r\n        // Renderer setup\r\n        this.renderer = new window.THREE.WebGLRenderer({ \r\n            canvas: this.graphicsEditor.canvas, \r\n            antialias: false, \r\n            alpha: true \r\n        });\r\n        this.renderer.setSize(this.graphicsEditor.canvas.clientWidth, this.graphicsEditor.canvas.clientHeight);\r\n\r\n        // Add helpers\r\n        const gridHelper = new window.THREE.GridHelper(100, 100);\r\n        this.scene.add(gridHelper);\r\n\r\n        const axesHelper = new window.THREE.AxesHelper(5);\r\n        this.scene.add(axesHelper);\r\n\r\n        // Orbit controls\r\n        this.controls = new window.THREE.OrbitControls(this.camera, this.renderer.domElement);\r\n        this.controls.enableDamping = true;\r\n        this.controls.dampingFactor = 0.25;\r\n\r\n        // Resize handling\r\n        window.addEventListener('resize', this.handleResize.bind(this));\r\n    }\r\n    \r\n    handleResize() {\r\n        this.camera.aspect = this.graphicsEditor.canvas.clientWidth / this.graphicsEditor.canvas.clientHeight;\r\n        this.camera.updateProjectionMatrix();\r\n        this.renderer.setSize(this.graphicsEditor.canvas.clientWidth, this.graphicsEditor.canvas.clientHeight);\r\n    }\r\n    \r\n    handleRenderObject(event) {\r\n        this.graphicsEditor.canvas.width = this.gameEditor.getCollections().configs.game.canvasWidth;\r\n        this.graphicsEditor.canvas.height = this.gameEditor.getCollections().configs.game.canvasHeight;\r\n        this.graphicsEditor.canvas.setAttribute('style','');\r\n        this.graphicsEditor.setPreviewAnimationState(false);\r\n        this.graphicsEditor.state.renderData = event.detail.data;\r\n        document.getElementById('json-content').value = JSON.stringify(this.graphicsEditor.state.renderData, null, 2);\r\n        \r\n        // Safely get first animation name\r\n        let model = this.graphicsEditor.state.renderData.model;        \r\n        if(!model) {\r\n            this.graphicsEditor.state.renderData.model = JSON.parse(JSON.stringify(this.graphicsEditor.state.renderData.animations['idle'][0])); // Deep copy\r\n            model = this.graphicsEditor.state.renderData.model;\r\n        }\r\n        this.graphicsEditor.state.currentAnimation = \"\";\r\n        this.graphicsEditor.state.editingModel = true;\r\n        // Safely get first frame's shapes\r\n        const firstGroup = Object.keys(model)[0];\r\n        const shapes = model[firstGroup].shapes || [];\r\n        this.graphicsEditor.state.currentGroup = firstGroup;\r\n        this.handleResize();\r\n        this.graphicsEditor.refreshShapes(false);\r\n        requestAnimationFrame(() => {\r\n            this.graphicsEditor.state.selectedShapeIndex = -1;\r\n            this.graphicsEditor.shapeManager.selectShape(shapes.length > 0 ? 0 : -1);\r\n        });\r\n    }\r\n\r\n\r\n    animate() {\r\n        requestAnimationFrame(this.animate.bind(this));\r\n        this.controls.update();\r\n        this.renderer.render(this.scene, this.camera);\r\n    }\r\n\r\n    async createObjectsFromJSON(frameData, scene) {\r\n        for(const groupName in frameData) {\r\n            const group = await this.graphicsEditor.shapeFactory.createGroupFromJSON(groupName, frameData[groupName]);\r\n            scene.add(group);\r\n        }\r\n    }\r\n\r\n    \r\n    async generateIsometricSprites() {\r\n        const frustumSize = parseFloat(document.getElementById('iso-frustum').value) || 48;\r\n        const cameraDistance = parseFloat(document.getElementById('iso-distance').value) || 100;\r\n        const size = parseFloat(document.getElementById('iso-size').value) || 64;\r\n        const aspect = 1;\r\n        const tempRenderer = new window.THREE.WebGLRenderer({ antialias: false, alpha: true });\r\n        tempRenderer.setSize(size, size);\r\n        document.getElementById('modal-generateIsoSprites').classList.remove('show');\r\n    \r\n        const renderTarget = new window.THREE.WebGLRenderTarget(size, size);\r\n        const cameras = [\r\n            new window.THREE.OrthographicCamera(-frustumSize * aspect, frustumSize * aspect, frustumSize, -frustumSize, 0.1, 1000),\r\n            new window.THREE.OrthographicCamera(-frustumSize * aspect, frustumSize * aspect, frustumSize, -frustumSize, 0.1, 1000),\r\n            new window.THREE.OrthographicCamera(-frustumSize * aspect, frustumSize * aspect, frustumSize, -frustumSize, 0.1, 1000),\r\n            new window.THREE.OrthographicCamera(-frustumSize * aspect, frustumSize * aspect, frustumSize, -frustumSize, 0.1, 1000),\r\n            new window.THREE.OrthographicCamera(-frustumSize * aspect, frustumSize * aspect, frustumSize, -frustumSize, 0.1, 1000),\r\n            new window.THREE.OrthographicCamera(-frustumSize * aspect, frustumSize * aspect, frustumSize, -frustumSize, 0.1, 1000),\r\n            new window.THREE.OrthographicCamera(-frustumSize * aspect, frustumSize * aspect, frustumSize, -frustumSize, 0.1, 1000),\r\n            new window.THREE.OrthographicCamera(-frustumSize * aspect, frustumSize * aspect, frustumSize, -frustumSize, 0.1, 1000)\r\n        ];\r\n    \r\n        // Position cameras at 8 angles (45 increments)\r\n        cameras[0].position.set(cameraDistance, cameraDistance, cameraDistance);           // NE up\r\n        cameras[1].position.set(0, cameraDistance, cameraDistance);                       // N up\r\n        cameras[2].position.set(-cameraDistance, cameraDistance, cameraDistance);         // NW up\r\n        cameras[3].position.set(-cameraDistance, cameraDistance, 0);                      // W up\r\n        cameras[4].position.set(-cameraDistance, cameraDistance, -cameraDistance);        // SW up\r\n        cameras[5].position.set(0, cameraDistance, -cameraDistance);                      // S up\r\n        cameras[6].position.set(cameraDistance, cameraDistance, -cameraDistance);         // SE up\r\n        cameras[7].position.set(cameraDistance, cameraDistance, 0);                       // E up\r\n        \r\n        cameras.forEach(camera => camera.lookAt(0, 0, 0));\r\n    \r\n        const sprites = {};     \r\n       \r\n        for (const animType in this.graphicsEditor.state.renderData.animations) {\r\n            sprites[animType] = [];\r\n            for (let frameIndex = 0; frameIndex < this.graphicsEditor.state.renderData.animations[animType].length; frameIndex++) {\r\n                const frame = this.graphicsEditor.state.renderData.animations[animType][frameIndex];\r\n                const scene = new window.THREE.Scene();\r\n                \r\n                // Add lights\r\n                const ambientLight = new window.THREE.AmbientLight(0xffffff, 0.8);\r\n                scene.add(ambientLight);\r\n                const directionalLight = new window.THREE.DirectionalLight(0xffffff, 1.0);\r\n                directionalLight.position.set(5, 10, 7.5);\r\n                scene.add(directionalLight);\r\n\r\n                await this.createObjectsFromJSON(frame, scene);\r\n    \r\n                const frameSprites = [];\r\n                for (const camera of cameras) {\r\n                    tempRenderer.setRenderTarget(renderTarget);\r\n                    tempRenderer.render(scene, camera);\r\n                    const buffer = new Uint8Array(size * size * 4);\r\n                    tempRenderer.readRenderTargetPixels(renderTarget, 0, 0, size, size, buffer);\r\n                    const flippedBuffer = new Uint8Array(size * size * 4);\r\n                    for (let y = 0; y < size; y++) {\r\n                        const srcRowStart = y * size * 4;\r\n                        const destRowStart = (size - 1 - y) * size * 4;\r\n                        flippedBuffer.set(buffer.subarray(srcRowStart, srcRowStart + size * 4), destRowStart);\r\n                    }\r\n                    const canvas = document.createElement('canvas');\r\n                    canvas.width = size;\r\n                    canvas.height = size;\r\n                    const ctx = canvas.getContext('2d');\r\n                    const imageData = ctx.createImageData(size, size);\r\n                    imageData.data.set(flippedBuffer);\r\n                    ctx.putImageData(imageData, 0, 0);\r\n                    frameSprites.push(canvas.toDataURL());\r\n                }\r\n                sprites[animType].push(frameSprites);\r\n            }\r\n        }\r\n        tempRenderer.setRenderTarget(null);\r\n        tempRenderer.dispose();\r\n        renderTarget.dispose();\r\n        this.graphicsEditor.displayIsometricSprites(sprites);\r\n    }\r\n}"
      },
      "SpatialGrid": {
        "fileName": "SpatialGrid",
        "script": " \r\n    class SpatialGrid {\r\n        constructor(worldSize, cellSize) {\r\n            this.cellSize = cellSize;\r\n            this.cols = worldSize;\r\n            this.rows = worldSize;\r\n            this.grid = new Array(this.cols * this.rows).fill().map(() => []);\r\n            \r\n            // Track which cell each entity is in\r\n            this.entityCells = new Map(); // Map of entity -> cell index\r\n        }\r\n        \r\n        getIndex(x, y) {\r\n            return y * this.cols + x;\r\n        }\r\n\r\n        insert(entity) {\r\n            const newIndex = this.getIndex(entity.gridPosition.x, entity.gridPosition.y);\r\n            const oldIndex = this.entityCells.get(entity);\r\n            \r\n            // If entity moved to a new cell\r\n            if (oldIndex !== newIndex) {\r\n                // Remove from old cell if it exists\r\n                if (oldIndex !== undefined) {\r\n                    const oldCell = this.grid[oldIndex];\r\n                    const entityIndex = oldCell.indexOf(entity);\r\n                    if (entityIndex !== -1) {\r\n                        oldCell.splice(entityIndex, 1);\r\n                    }\r\n                }\r\n                \r\n                // Add to new cell\r\n                if (newIndex >= 0 && newIndex < this.grid.length) {\r\n                    this.grid[newIndex].push(entity);\r\n                    this.entityCells.set(entity, newIndex);\r\n                }\r\n            }\r\n        }\r\n        \r\n        remove(entity) {\r\n            const index = this.entityCells.get(entity);\r\n            if (index !== undefined) {\r\n                const cell = this.grid[index];\r\n                const entityIndex = cell.indexOf(entity);\r\n                if (entityIndex !== -1) {\r\n                    cell.splice(entityIndex, 1);\r\n                }\r\n                this.entityCells.delete(entity);\r\n            }\r\n        }\r\n        getNearbyEntities(x, y, radius, type=\"\") {\r\n            const nearby = [];\r\n            // Get cells that could contain entities within radius\r\n            const startX = Math.max(0, Math.floor((x - radius)));\r\n            const endX = Math.min(this.cols - 1, Math.floor((x + radius)));\r\n            const startY = Math.max(0, Math.floor((y - radius)));\r\n            const endY = Math.min(this.rows - 1, Math.floor((y + radius)));\r\n       \r\n            // Collect potential candidates from relevant cells\r\n            for (let row = startY; row <= endY; row++) {\r\n                for (let col = startX; col <= endX; col++) {\r\n                    const index = row * this.cols + col;\r\n                    if (index >= 0 && index < this.grid.length) {\r\n                        for (let entity of this.grid[index]) {\r\n                            const dx = (entity.gridPosition.x) - (x + .5);\r\n                            const dy = (entity.gridPosition.y) - (y + .5);\r\n                            const distSquared = dx * dx + dy * dy;\r\n                            \r\n                            if (distSquared <= radius * radius) {\r\n                                if(type) {\r\n                                    if( entity.type == type ) {\r\n                                        nearby.push(entity);\r\n                                    }\r\n                                } else {\r\n                                    nearby.push(entity);\r\n                                }\r\n                            }                            \r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            \r\n            return nearby;\r\n        }\r\n        clear() {\r\n            this.grid = this.grid.map(() => []);\r\n            this.entityCells.clear();\r\n        }\r\n        \r\n        // Optional: Only clear but maintain all entity positions\r\n        // Useful for when reusing the same grid across updates\r\n        resetKeepingEntities() {\r\n            const allEntities = [];\r\n            this.entityCells.forEach((_, entity) => {\r\n                allEntities.push(entity);\r\n            });\r\n            \r\n            this.clear();\r\n            \r\n            allEntities.forEach(entity => {\r\n                this.insert(entity);\r\n            });\r\n        }\r\n    }\r\n"
      },
      "GE_RotationUtils": {
        "title": "GE_RotationUtils",
        "fileName": "GE_RotationUtils",
        "script": "// RotationUtils.js\r\nclass GE_RotationUtils {\r\n    /**\r\n     * Convert degrees to radians\r\n     * @param {number} degrees - Angle in degrees\r\n     * @return {number} Angle in radians\r\n     */\r\n    static degToRad(degrees) {\r\n        return degrees * Math.PI / 180;\r\n    }\r\n    \r\n    /**\r\n     * Convert radians to degrees\r\n     * @param {number} radians - Angle in radians\r\n     * @return {number} Angle in degrees (rounded)\r\n     */\r\n    static radToDeg(radians) {\r\n        return Math.round(radians * 180 / Math.PI);\r\n    }\r\n    \r\n    /**\r\n     * Apply rotation to a position vector around a center point\r\n     * @param {Object} position - Position with x, y, z properties\r\n     * @param {Object} center - Center point with x, y, z properties\r\n     * @param {Object} rotation - Rotation with x, y, z properties in radians\r\n     * @return {Object} New position after rotation\r\n     */\r\n    static rotatePosition(position, center, rotation) {\r\n        const pos = new window.THREE.Vector3(\r\n            position.x || 0,\r\n            position.y || 0,\r\n            position.z || 0\r\n        );\r\n        \r\n        const centerVec = new window.THREE.Vector3(\r\n            center.x || 0,\r\n            center.y || 0,\r\n            center.z || 0\r\n        );\r\n        \r\n        // Create rotation matrix\r\n        const rotMatrix = new window.THREE.Matrix4();\r\n        rotMatrix.makeRotationFromEuler(new window.THREE.Euler(\r\n            rotation.x || 0,\r\n            rotation.y || 0,\r\n            rotation.z || 0\r\n        ));\r\n        \r\n        // Apply rotation\r\n        pos.sub(centerVec);\r\n        pos.applyMatrix4(rotMatrix);\r\n        pos.add(centerVec);\r\n        \r\n        return { x: pos.x, y: pos.y, z: pos.z };\r\n    }\r\n    \r\n    /**\r\n     * Combine two rotations (in Euler angles)\r\n     * @param {Object} rotation1 - First rotation with x, y, z in degrees\r\n     * @param {Object} rotation2 - Second rotation with x, y, z in degrees\r\n     * @return {Object} Combined rotation in degrees\r\n     */\r\n    static combineRotations(rotation1, rotation2) {\r\n        // Convert to radians\r\n        const rot1 = {\r\n            x: this.degToRad(rotation1.x || 0),\r\n            y: this.degToRad(rotation1.y || 0),\r\n            z: this.degToRad(rotation1.z || 0)\r\n        };\r\n        \r\n        const rot2 = {\r\n            x: this.degToRad(rotation2.x || 0),\r\n            y: this.degToRad(rotation2.y || 0),\r\n            z: this.degToRad(rotation2.z || 0)\r\n        };\r\n        \r\n        // Convert to quaternions and multiply\r\n        const quat1 = new window.THREE.Quaternion().setFromEuler(\r\n            new window.THREE.Euler(rot1.x, rot1.y, rot1.z)\r\n        );\r\n        \r\n        const quat2 = new window.THREE.Quaternion().setFromEuler(\r\n            new window.THREE.Euler(rot2.x, rot2.y, rot2.z)\r\n        );\r\n        \r\n        quat1.multiply(quat2);\r\n        \r\n        // Convert back to euler angles\r\n        const euler = new window.THREE.Euler().setFromQuaternion(quat1);\r\n        \r\n        // Return in degrees\r\n        return {\r\n            x: this.radToDeg(euler.x),\r\n            y: this.radToDeg(euler.y),\r\n            z: this.radToDeg(euler.z)\r\n        };\r\n    }\r\n}"
      },
      "TileMap": {
        "fileName": "TileMap",
        "script": "\r\n  \r\n  \r\nclass TileMap {\r\n\r\n  constructor(app, config, { CanvasUtility }) {\r\n   \tthis.app = app;\r\n    this.config = config;\r\n    this.engineClasses = {\r\n \t\t\t\"CanvasUtility\": CanvasUtility\r\n    } \r\n  }\r\n\tinit(canvas, tileSize, layerSpriteSheets, isometric) {\r\n\t\tthis.isometric = isometric;\r\n\t\tthis.canvas = canvas;\r\n\t\tthis.tileSize = tileSize;\r\n\t\tthis.numColumns = 0;\r\n\t\tthis.layerSpriteSheets = layerSpriteSheets;\r\n\t\tthis.tileMap = [];\r\n\t\tthis.layerTextures = [];\r\n\t\tthis.canvasUtility = new (this.engineClasses.CanvasUtility)();\r\n\t\tthis.TileAnalysis = class {\r\n\t\t\tconstructor() {\r\n\t\t\t  this.heightIndex = 0;\r\n\t\t\t  this.neighborLowerCount = 0;\r\n\t\t\t  this.cornerLowerCount = 0;\r\n\t\t\t  this.topLess = false;\r\n\t\t\t  this.leftLess = false;\r\n\t\t\t  this.rightLess = false;\r\n\t\t\t  this.botLess = false;\r\n\t\t\t  this.cornerTopLeftLess = false;\r\n\t\t\t  this.cornerTopRightLess = false;\r\n\t\t\t  this.cornerBottomLeftLess = false;\r\n\t\t\t  this.cornerBottomRightLess = false;\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tthis.TileTransforms = {\r\n\t\t\tNone: 0,\r\n\t\t\tClockWise90: 1,\r\n\t\t\tCounterClockWise90: 2,\r\n\t\t\tRotate180: 3,\r\n\t\t\tFlipHorizontal: 4,\r\n\t\t\tFlipVertical: 5,\r\n\t\t};\r\n\t\t\r\n\t\tthis.TileAtom = {\r\n\t\t\tFull: 0,\r\n\t\t\tOneCorner: 1,\r\n\t\t\tTwoCorner: 2,\r\n\t\t\tThreeCorner: 3,\r\n\t\t\tFullVariation: 4,\r\n\t\t\tOneCornerBot: 5,\r\n\t\t\tTwoCornerBot: 6,\r\n\t\t\tThreeCornerBot: 7\r\n\t\t};\r\n\t\t\r\n\t\tthis.TileMolecule = {\r\n\t\t\tFull: 0,\r\n\t\t\tCorner: 1,\r\n\t\t\tEdge: 2,\r\n\t\t\tTunnel: 3,\r\n\t\t\tTwoSides: 4,\r\n\t\t\tPenninsula: 5,\r\n\t\t\tIsland: 6,\r\n\t\t};\r\n\t\t\r\n\t\tthis.TileCliffMolecules = {\r\n\t\t\tFull: 0,\r\n\t\t\tCornerTL: 1,\r\n\t\t\tCornerTR: 2,\r\n\t\t\tCornerBL: 3,\r\n\t\t\tCornerBR: 4,\r\n\t\t\tEdgeT: 5,\r\n\t\t\tEdgeL: 6,\r\n\t\t\tEdgeR: 7,\r\n\t\t\tEdgeB: 8,\r\n\t\t\tTunnelH: 9,\r\n\t\t\tTunnelV: 10,\r\n\t\t\tTwoSidesTL: 11,\r\n\t\t\tTwoSidesTR: 12,\r\n\t\t\tTwoSidesBL: 13,\r\n\t\t\tTwoSidesBR: 14,    \r\n\t\t\tPenninsulaT: 15,\r\n\t\t\tPenninsulaL: 16,\r\n\t\t\tPenninsulaR: 17,\r\n\t\t\tPenninsulaB: 18,\r\n\t\t\tIsland: 19,\r\n\t\t};\r\n\t}\r\n\r\n    draw(map){\r\n\t\tthis.tileMap = map;\r\n\t\tthis.numColumns = this.tileMap.length;\r\n\t\t// Load all textures\r\n\r\n\t\tif(this.layerTextures.length == 0) {\r\n\t\r\n\t\t\tthis.layerSpriteSheets.forEach((layerSprites, index) => {      \r\n\t\t\t\tconst moleculeData = this.buildBaseMolecules(layerSprites.sprites);\r\n\t\t\t\tthis.layerTextures[index] = moleculeData;\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tlet analyzedMap = this.analyzeMap(this.tileMap);\r\n\t\tthis.drawMap(analyzedMap);\r\n        if(this.isometric){\r\n            this.drawIsometric();\r\n        }\r\n\r\n    }\r\n\r\n    drawIsometric() {\r\n        let ctx = this.canvas.getContext('2d');\r\n        // Save the original state\r\n        ctx.save();\r\n        \r\n        // Create an off-screen canvas to hold original drawing\r\n        const offscreen = document.createElement('canvas');\r\n        offscreen.width = this.canvas.width;\r\n        offscreen.height = this.canvas.height;\r\n        const offCtx = offscreen.getContext('2d');\r\n        offCtx.drawImage(this.canvas, 0, 0);\r\n        \r\n        // Clear the main canvas\r\n        ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n        \r\n        // Move to center for rotation\r\n        ctx.translate(this.canvas.width / 2, this.canvas.height / 2);\r\n        \r\n        // Apply isometric transformation\r\n        const scale = .56;    // Adjust overall size\r\n        const isoAngle = Math.atan(1 / 2); //  26.565 (classic isometric angle)\r\n        const cosA = Math.cos(isoAngle);   //  0.8944\r\n        const sinA = Math.sin(isoAngle);   //  0.4472\r\n        \r\n        ctx.transform(\r\n            cosA * scale,    // scaleX\r\n            sinA * scale,    // skewY\r\n            -cosA * scale,   // skewX\r\n            sinA * scale,    // scaleY\r\n            0,               // translateX\r\n            0                // translateY\r\n        );\r\n        \r\n        // Draw the transformed image centered\r\n        ctx.drawImage(offscreen, -this.canvas.width / 2, -this.canvas.height / 2);\r\n        \r\n        // Restore original state\r\n        ctx.restore();\r\n    }\r\n\r\n    drawTexture(texture, x, y) {\r\n\t\tctx.drawImage(texture, x, y, this.tileSize / 2, this.tileSize / 2); // Assuming each atom is 256x256\r\n    }\r\n\r\n    // Function to generate a molecule texture for various molecule ty\r\n\tbuildBaseMolecules(sprites) {\r\n\t\t// Define texture objects\r\n\t\tconst fullTexture = document.createElement(\"canvas\");\r\n\r\n\t\tconst oneCornerTexture = document.createElement(\"canvas\");\r\n\t\tconst twoCornerTexture = document.createElement(\"canvas\");\r\n\t\tconst threeCornerTexture = document.createElement(\"canvas\");\r\n\r\n\t\tconst oneCornerBotTexture = document.createElement(\"canvas\");\r\n\t\tconst twoCornerBotTexture = document.createElement(\"canvas\");\r\n\t\tconst threeCornerBotTexture = document.createElement(\"canvas\");\r\n\r\n\t\tfullTexture.setAttribute('willReadFrequently', true); \r\n\r\n\t\toneCornerTexture.setAttribute('willReadFrequently', true); \r\n\t\ttwoCornerTexture.setAttribute('willReadFrequently', true); \r\n\t\tthreeCornerTexture.setAttribute('willReadFrequently', true); \r\n\r\n\t\toneCornerBotTexture.setAttribute('willReadFrequently', true); \r\n\t\ttwoCornerBotTexture.setAttribute('willReadFrequently', true); \r\n\t\tthreeCornerBotTexture.setAttribute('willReadFrequently', true); \r\n\r\n\t\t// Set the texture sizes\r\n\t\tconst spriteResolution = this.tileSize / 2;\r\n\t\tconst finalTileBaseResolution = spriteResolution * 2;\r\n\r\n\t\tfullTexture.width = spriteResolution;\r\n\t\tfullTexture.height = spriteResolution;\r\n\r\n\t\toneCornerTexture.width = spriteResolution;\r\n\t\toneCornerTexture.height = spriteResolution;\r\n\r\n\t\ttwoCornerTexture.width = spriteResolution;\r\n\t\ttwoCornerTexture.height = spriteResolution;\r\n\r\n\t\tthreeCornerTexture.width = spriteResolution;\r\n\t\tthreeCornerTexture.height = spriteResolution;\t\r\n\r\n\t\toneCornerBotTexture.width = spriteResolution;\r\n\t\toneCornerBotTexture.height = spriteResolution;\t\r\n\r\n\t\ttwoCornerBotTexture.width = spriteResolution;\r\n\t\ttwoCornerBotTexture.height = spriteResolution;\t\r\n\r\n\t\tthreeCornerBotTexture.width = spriteResolution;\r\n\t\tthreeCornerBotTexture.height = spriteResolution;\t\r\n\t\t\r\n\t\t// Get sprite textures\r\n\t\tconst fullSprite = sprites[this.TileAtom.Full];\r\n\r\n\t\tconst oneCornerSprite = sprites[this.TileAtom.OneCorner];\r\n\t\tconst twoCornerSprite = sprites[this.TileAtom.TwoCorner];\r\n\t\tconst threeCornerSprite = sprites[this.TileAtom.ThreeCorner];\r\n\r\n\t\tconst oneCornerBotSprite = sprites[this.TileAtom.OneCornerBot];\r\n\t\tconst twoCornerBotSprite = sprites[this.TileAtom.TwoCornerBot];\r\n\t\tconst threeCornerBotSprite = sprites[this.TileAtom.ThreeCornerBot];\r\n\r\n\t\t// Create CanvasRenderingContext2D objects for each texture\r\n\t\tconst fullCtx = fullTexture.getContext(\"2d\");\r\n\r\n\t\tconst oneCornerCtx = oneCornerTexture.getContext(\"2d\", { willReadFrequently: true });\r\n\t\tconst twoCornerCtx = twoCornerTexture.getContext(\"2d\", { willReadFrequently: true });\r\n\t\tconst threeCornerCtx = threeCornerTexture.getContext(\"2d\", { willReadFrequently: true });\r\n\r\n\t\tconst oneCornerBotCtx = oneCornerBotTexture.getContext(\"2d\", { willReadFrequently: true });\r\n\t\tconst twoCornerBotCtx = twoCornerBotTexture.getContext(\"2d\", { willReadFrequently: true });\r\n\t\tconst threeCornerBotCtx = threeCornerBotTexture.getContext(\"2d\", { willReadFrequently: true });\r\n\t\t\r\n\t\t// Copy pixels from sprites to texture canvases\r\n\t\tfullCtx.drawImage(fullSprite,0,0);\r\n\r\n\t\toneCornerCtx.drawImage(oneCornerSprite,0,0);\r\n\t\ttwoCornerCtx.drawImage(twoCornerSprite,0,0);\r\n\t\tthreeCornerCtx.drawImage(threeCornerSprite,0,0);\r\n\r\n\t\toneCornerBotCtx.drawImage(oneCornerBotSprite,0,0);\r\n\t\ttwoCornerBotCtx.drawImage(twoCornerBotSprite,0,0);\r\n\t\tthreeCornerBotCtx.drawImage(threeCornerBotSprite,0,0);\r\n\r\n\t\t// Get pixel data from the canvases\r\n\t\tconst fullImageData = fullCtx.getImageData(0, 0, spriteResolution, spriteResolution);\r\n\t\tconst oneCornerTopRightImageData = oneCornerCtx.getImageData(0, 0, spriteResolution, spriteResolution);\r\n\t\tconst oneCornerTopLeftImageData = this.flipTextureHorizontal(oneCornerCtx.getImageData(0, 0, spriteResolution, spriteResolution));\t\r\n\r\n\t\tconst oneCornerBotRightImageData = oneCornerBotCtx.getImageData(0, 0, spriteResolution, spriteResolution);\r\n\t\tconst oneCornerBotLeftImageData = this.flipTextureHorizontal(oneCornerBotCtx.getImageData(0, 0, spriteResolution, spriteResolution));\t\r\n\t\t\r\n\t\tconst twoCornerTopImageData = twoCornerCtx.getImageData(0, 0, spriteResolution, spriteResolution);\r\n\t\tconst twoCornerLeftImageData = this.rotateTexture(twoCornerCtx.getImageData(0, 0, spriteResolution, spriteResolution), -Math.PI / 2);\r\n\t\tconst twoCornerRightImageData = this.rotateTexture(twoCornerCtx.getImageData(0, 0, spriteResolution, spriteResolution), Math.PI / 2);\r\n\t\tconst twoCornerBottomImageData = twoCornerBotCtx.getImageData(0, 0, spriteResolution, spriteResolution);\r\n\t\t\r\n\t\tconst threeCornerTopRightImageData = threeCornerCtx.getImageData(0, 0, spriteResolution, spriteResolution);\r\n\t\tconst threeCornerTopLeftImageData = this.flipTextureHorizontal(threeCornerCtx.getImageData(0, 0, spriteResolution, spriteResolution));\t\t\r\n\t\tconst threeCornerBottomRightImageData = threeCornerBotCtx.getImageData(0, 0, spriteResolution, spriteResolution);\r\n\t\tconst threeCornerBottomLeftImageData = this.flipTextureHorizontal(threeCornerBotCtx.getImageData(0, 0, spriteResolution, spriteResolution));\r\n\t\t\t\t\r\n\t\t\t\r\n\t\t// Define molecule objects\r\n\t\tconst moleculeCanvas = document.createElement(\"canvas\");\r\n\r\n\t\tmoleculeCanvas.width = finalTileBaseResolution;\r\n\t\tmoleculeCanvas.height = finalTileBaseResolution;\r\n\t\t\r\n\t\tconst moleculeCtx = moleculeCanvas.getContext('2d', { willReadFrequently: true });\r\n\r\n\t\tconst cornerCanvas = document.createElement(\"canvas\");\r\n\r\n\t\tcornerCanvas.width = finalTileBaseResolution / 2;\r\n\t\tcornerCanvas.height = finalTileBaseResolution / 2;\r\n\t\t\r\n\t\tconst cornerCtx = cornerCanvas.getContext('2d', { willReadFrequently: true });\r\n\r\n\t\tvar imageDataList = [\r\n\t\t\t//FULL\r\n\t\t\tthis.createMolecule(moleculeCtx, fullImageData, fullImageData, fullImageData, fullImageData),\r\n\r\n\t\t\t//CORNERS\r\n\t\t\toneCornerTopLeftImageData, \r\n\t\t\toneCornerTopRightImageData,\r\n\t\t\toneCornerBotLeftImageData,\r\n\t\t\toneCornerBotRightImageData,\r\n\t\t\t//EDGES\r\n\t\t\tthis.createMolecule(moleculeCtx, twoCornerTopImageData, twoCornerTopImageData, fullImageData, fullImageData),\r\n\t\t\tthis.createMolecule(moleculeCtx, twoCornerLeftImageData, fullImageData, twoCornerLeftImageData, fullImageData),\r\n\t\t\tthis.createMolecule(moleculeCtx, fullImageData, twoCornerRightImageData, fullImageData, twoCornerRightImageData),\r\n\t\t\tthis.createMolecule(moleculeCtx, fullImageData, fullImageData, twoCornerBottomImageData, twoCornerBottomImageData),\r\n\r\n\t\t\t//TUNNELS\r\n\t\t\tthis.createMolecule(moleculeCtx, twoCornerTopImageData, twoCornerTopImageData, twoCornerBottomImageData, twoCornerBottomImageData),\r\n\t\t\tthis.createMolecule(moleculeCtx, twoCornerLeftImageData, twoCornerRightImageData, twoCornerLeftImageData, twoCornerRightImageData),\r\n\r\n\t\t\t//TWO SIDES\r\n\t\t\tthis.createMolecule(moleculeCtx, threeCornerTopLeftImageData, twoCornerTopImageData, twoCornerLeftImageData, fullImageData),\r\n\t\t\tthis.createMolecule(moleculeCtx, twoCornerTopImageData, threeCornerTopRightImageData, fullImageData, twoCornerRightImageData),\r\n\t\t\tthis.createMolecule(moleculeCtx, twoCornerLeftImageData, fullImageData, threeCornerBottomLeftImageData, twoCornerBottomImageData),\r\n\t\t\tthis.createMolecule(moleculeCtx, fullImageData, twoCornerRightImageData, twoCornerBottomImageData, threeCornerBottomRightImageData),\r\n\r\n\t\t\t//PENNINSULAS\t\t\r\n\t\t\tthis.createMolecule(moleculeCtx, threeCornerTopLeftImageData, threeCornerTopRightImageData, twoCornerLeftImageData, twoCornerRightImageData),\r\n\t\t\tthis.createMolecule(moleculeCtx, threeCornerTopLeftImageData, twoCornerTopImageData, threeCornerBottomLeftImageData, twoCornerBottomImageData),\r\n\t\t\tthis.createMolecule(moleculeCtx, twoCornerTopImageData, threeCornerTopRightImageData, twoCornerBottomImageData, threeCornerBottomRightImageData),\r\n\t\t\tthis.createMolecule(moleculeCtx, twoCornerLeftImageData, twoCornerRightImageData, threeCornerBottomLeftImageData, threeCornerBottomRightImageData),\r\n\r\n\t\t\t//ISLAND\r\n\t\t\tthis.createMolecule(moleculeCtx, threeCornerTopLeftImageData, threeCornerTopRightImageData, threeCornerBottomLeftImageData, threeCornerBottomRightImageData),\r\n\t\t];\r\n\r\n\t\treturn imageDataList;\r\n\t}\r\n\r\n\tcreateMolecule(context, TLImageData, TRImageData, BLImageData, BRImageData) {\r\n\t\tlet size = context.canvas.width;\r\n\t\tlet spriteResolution = size / 2;\r\n\t\tcontext.fillStyle = 'black';\r\n\t\tcontext.fillRect(0, 0, size, size);\r\n\t\tcontext.putImageData(TLImageData, 0, 0);\r\n\t\tcontext.putImageData(TRImageData, spriteResolution, 0);\r\n\t\tcontext.putImageData(BLImageData, 0, spriteResolution);\r\n\t\tcontext.putImageData(BRImageData, spriteResolution, spriteResolution);\r\n\t\treturn context.getImageData(0, 0, size, size);\r\n\t}\r\n\r\n\textractSpritesFromSheet(spriteSheet, columns, rows) {\r\n\t\tlet sprites = [];\r\n\t\tlet spriteWidth = spriteSheet.width / columns;\r\n\t\tlet spriteHeight = spriteSheet.height / rows;\r\n\t\r\n\t\tfor (let y = 0; y < rows; y++) {\r\n\t\t\tfor (let x = 0; x < columns; x++) {\r\n\t\t\t\tlet canvas = document.createElement('canvas');\r\n\t\t\t\tcanvas.width = spriteWidth;\r\n\t\t\t\tcanvas.height = spriteHeight;\r\n\t\t\t\tlet context = canvas.getContext('2d');\r\n\t\t\t\tcontext.drawImage(spriteSheet, x * spriteWidth, y * spriteHeight, spriteWidth, spriteHeight, 0, 0, spriteWidth, spriteHeight);\r\n\t\t\t\tsprites.push(canvas);\r\n\t\t\t}\r\n\t\t}\r\n\t\r\n\t\treturn sprites;\r\n\t}\r\n\t\r\n\tgetSpriteRotations(imageDataList) {\r\n\t\tlet rotationDict = {};\r\n\r\n\t\tlet requiredTransforms = {};\r\n\r\n\t\trequiredTransforms[this.TileMolecule.Full] = [];\r\n\t\trequiredTransforms[this.TileMolecule.Corner] = [this.TileTransforms.FlipHorizontal, this.TileTransforms.FlipVertical, this.TileTransforms.Rotate180];\r\n\t\trequiredTransforms[this.TileMolecule.Edge] = [this.TileTransforms.ClockWise90, this.TileTransforms.CounterClockWise90, this.TileTransforms.Rotate180];\r\n\t\trequiredTransforms[this.TileMolecule.Tunnel] = [this.TileTransforms.CounterClockWise90];\r\n\t\trequiredTransforms[this.TileMolecule.TwoSides] = [this.TileTransforms.FlipHorizontal, this.TileTransforms.FlipVertical, this.TileTransforms.Rotate180];\r\n\t\trequiredTransforms[this.TileMolecule.Penninsula] = [this.TileTransforms.FlipVertical, this.TileTransforms.ClockWise90, this.TileTransforms.CounterClockWise90];\r\n\t\trequiredTransforms[this.TileMolecule.Island] = [];\r\n\r\n\t\tObject.keys(imageDataList).forEach(moleculeType => {\r\n\t\t\tlet rotations = {};\r\n\t\t\tlet colors = imageDataList[moleculeType];\r\n\t\t\trotations[this.TileTransforms.None] = colors;\r\n\r\n\t\t\tif (requiredTransforms[moleculeType].includes(this.TileTransforms.ClockWise90)) {\r\n\t\t\t\trotations[this.TileTransforms.ClockWise90] = this.rotateTexture(colors, Math.PI / 2);\r\n\t\t\t}\r\n\t\t\tif (requiredTransforms[moleculeType].includes(this.TileTransforms.CounterClockWise90)) {\r\n\t\t\t\trotations[this.TileTransforms.CounterClockWise90] = this.rotateTexture(colors, -Math.PI / 2);\r\n\t\t\t}\r\n\t\t\tif (requiredTransforms[moleculeType].includes(this.TileTransforms.Rotate180)) {\r\n\t\t\t\trotations[this.TileTransforms.Rotate180] = this.rotateTexture(colors, Math.PI);\r\n\t\t\t}\r\n\t\t\tif (requiredTransforms[moleculeType].includes(this.TileTransforms.FlipHorizontal)) {\r\n\t\t\t\trotations[this.TileTransforms.FlipHorizontal] = this.flipTextureHorizontal(colors);\r\n\t\t\t}\r\n\t\t\tif (requiredTransforms[moleculeType].includes(this.TileTransforms.FlipVertical)) {\r\n\t\t\t\trotations[this.TileTransforms.FlipVertical] = this.flipTextureVertical(colors);\r\n\t\t\t}\r\n\r\n\t\t\trotationDict[moleculeType] = rotations;\r\n\t\t});\r\n\r\n\t\treturn rotationDict;\r\n\t}\r\n\r\n\trotateTexture(imageData, angle) {\r\n\t\treturn this.canvasUtility.rotateTexture(imageData, angle);\r\n\t}\r\n\r\n\tflipTextureVertical(imageData) {\r\n\t\treturn this.canvasUtility.flipTextureVertical(imageData);\r\n\t}\r\n\r\n\tflipTextureHorizontal(imageData) {\r\n\t\treturn this.canvasUtility.flipTextureHorizontal(imageData);\r\n\t}\r\n\r\n\tanalyzeTile(x, y) {\r\n\t\tlet tileAnalysis = new this.TileAnalysis();\r\n\t\tlet row = y;\r\n\t\tlet col = x;\r\n\r\n\t\tif (row < 0 || row >= this.numColumns || col < 0 || col >= this.numColumns) {\r\n\t\t\treturn tileAnalysis; // Out of bounds\r\n\t\t}\r\n\r\n\t\ttileAnalysis.heightIndex = this.tileMap[row][col];\r\n\r\n\t\t// Helper function to check if a location is within bounds\r\n\t\tfunction isWithinBounds(r, c, n) {\r\n\t\t\treturn r >= 0 && r < n && c >= 0 && c < n;\r\n\t\t}\r\n\r\n\t\t// Helper function to check and update tile analysis\r\n\t\tvar checkAndUpdate = ((r, c, n, direction, propertyLess) => {\r\n\t\t\tif (isWithinBounds(r, c, n) ) {\r\n\t\t\t\ttileAnalysis[direction] = this.tileMap[r][c];\r\n\t\t\t\tif( this.tileMap[r][c] < tileAnalysis.heightIndex) {\r\n\t\t\t\t\ttileAnalysis[propertyLess] = true;\r\n\t\t\t\t\tif(['topLess', 'leftLess', 'rightLess', 'botLess'].indexOf(propertyLess) >= 0 ) {\r\n\t\t\t\t\t\ttileAnalysis.neighborLowerCount++;\r\n\t\t\t\t\t} else if(['cornerTopLeftLess', 'cornerTopRightLess', 'cornerBottomLeftLess', 'cornerBottomRightLess'].indexOf(propertyLess) >= 0) {\r\n\t\t\t\t\t\ttileAnalysis.cornerLowerCount++;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tcheckAndUpdate(row - 1, col, this.numColumns, 'topHeight', 'topLess');\r\n\t\tcheckAndUpdate(row, col - 1, this.numColumns, 'leftHeight', 'leftLess');\r\n\t\tcheckAndUpdate(row, col + 1, this.numColumns, 'rightHeight', 'rightLess');\r\n\t\tcheckAndUpdate(row + 1, col, this.numColumns, 'botHeight', 'botLess');\r\n\t\tcheckAndUpdate(row - 1, col - 1, this.numColumns, 'topLeftHeight', 'cornerTopLeftLess');\r\n\t\tcheckAndUpdate(row - 1, col + 1, this.numColumns, 'topRightHeight', 'cornerTopRightLess');\r\n\t\tcheckAndUpdate(row + 1, col - 1, this.numColumns, 'botLeftHeight', 'cornerBottomLeftLess');\r\n\t\tcheckAndUpdate(row + 1, col + 1, this.numColumns, 'botRightHeight', 'cornerBottomRightLess');\r\n\r\n\t\treturn tileAnalysis;\r\n\t}\r\n\r\n\t// Function to generate a random integer between min and max (inclusive)\r\n\tgetRandomInt(min, max) {\r\n\t\treturn Math.floor(Math.random() * (max - min + 1)) + min;\r\n\t}\r\n\r\n\t// Function to generate a random 10x10 map\r\n\tgenerateRandomMap(rows, columns) {\r\n\t\tlet map = [];\r\n\t\tfor (let i = 0; i < rows; i++) {\r\n\t\t\tlet row = [];\r\n\t\t\tfor (let j = 0; j < columns; j++) {\r\n\t\t\t\trow.push(getRandomInt(0, layers.length - 1)); // Random height between 0 and 10\r\n\t\t\t}\r\n\t\t\tmap.push(row);\r\n\t\t}\r\n\t\treturn map;\r\n\t}\r\n\r\n\tanalyzeMap() {\r\n\t\tlet analyzedTiles = [];\r\n\r\n\t\tfor (let i = 0; i < this.numColumns; i++) {\r\n\t\t\tfor (let j = 0; j < this.numColumns; j++) {\r\n\t\t\t\tanalyzedTiles.push(this.analyzeTile(j, i));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn analyzedTiles;\r\n\t}\r\n\r\n\tgetTransformedTexture(transformationDict, tileAnalysis, molecule){\r\n\t\tswitch(tileAnalysis.neighborLowerCount){\t\t\t\t\r\n\t\t\tcase 1:\r\n\t\t\t\tif(tileAnalysis.leftLess){                    \r\n\t\t\t\t\treturn transformationDict[molecule][this.TileTransforms.CounterClockWise90];\r\n\t\t\t\t} else if(tileAnalysis.rightLess){\r\n                    return transformationDict[molecule][this.TileTransforms.ClockWise90];\r\n\t\t\t\t} else if(tileAnalysis.botLess){\t\t\r\n\t\t\t\t\treturn transformationDict[molecule][this.TileTransforms.Rotate180];\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase 2:\r\n\t\t\t\tif(tileAnalysis.topLess && tileAnalysis.leftLess){\r\n\t\t\t\t\treturn transformationDict[molecule][this.TileTransforms.FlipHorizontal];\r\n\t\t\t\t} else if(tileAnalysis.botLess && tileAnalysis.leftLess){\t\t\r\n\t\t\t\t\treturn transformationDict[molecule][this.TileTransforms.Rotate180];\r\n\t\t\t\t} else if(tileAnalysis.botLess && tileAnalysis.rightLess){\t\t\r\n\t\t\t\t\treturn transformationDict[molecule][this.TileTransforms.FlipVertical];\r\n\t\t\t\t} else if(tileAnalysis.leftLess && tileAnalysis.rightLess){\r\n\t\t\t\t\treturn transformationDict[molecule][this.TileTransforms.CounterClockWise90];\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase 3:\r\n\t\t\t\tif(!tileAnalysis.topLess){\r\n\t\t\t\t\treturn transformationDict[molecule][this.TileTransforms.FlipVertical];\r\n\t\t\t\t} else if(!tileAnalysis.leftLess){\t\t\r\n\t\t\t\t\treturn transformationDict[molecule][this.TileTransforms.ClockWise90];\r\n\t\t\t\t} else if(!tileAnalysis.rightLess){\t\t\r\n\t\t\t\t\treturn transformationDict[molecule][this.TileTransforms.CounterClockWise90];\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase 4:\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t}\t\t\r\n        return transformationDict[molecule][this.TileTransforms.None];\r\n\t}\r\n\r\n\tgetMoleculeByTileAnalysis(tileAnalysis){\r\n\t\tvar molecule = this.TileCliffMolecules.Full;\t\t\t\t\t\t\t\t\r\n\t\tswitch(tileAnalysis.neighborLowerCount){\r\n\t\t\tcase 0: \r\n\t\t\t\tmolecule = this.TileCliffMolecules.Full;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 1:\r\n\t\t\t\tif(tileAnalysis.topLess) {\r\n\t\t\t\t\tmolecule = this.TileCliffMolecules.EdgeT;\r\n\t\t\t\t} else if(tileAnalysis.leftLess) {\r\n\t\t\t\t\tmolecule = this.TileCliffMolecules.EdgeL;\r\n\t\t\t\t} else if(tileAnalysis.rightLess) {\r\n\t\t\t\t\tmolecule = this.TileCliffMolecules.EdgeR;\r\n\t\t\t\t} else if(tileAnalysis.botLess) {\r\n\t\t\t\t\tmolecule = this.TileCliffMolecules.EdgeB;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase 2:\r\n\t\t\t\tif(tileAnalysis.topLess && tileAnalysis.botLess){\r\n\t\t\t\t\tmolecule = this.TileCliffMolecules.TunnelH;\r\n\t\t\t\t} else if(tileAnalysis.leftLess && tileAnalysis.rightLess){\r\n\t\t\t\t\tmolecule = this.TileCliffMolecules.TunnelV;\r\n\t\t\t\t} else if(tileAnalysis.topLess && tileAnalysis.leftLess){\r\n\t\t\t\t\tmolecule = this.TileCliffMolecules.TwoSidesTL;\r\n\t\t\t\t} else if(tileAnalysis.topLess && tileAnalysis.rightLess){\r\n\t\t\t\t\tmolecule = this.TileCliffMolecules.TwoSidesTR;\r\n\t\t\t\t} else if(tileAnalysis.botLess && tileAnalysis.leftLess){\r\n\t\t\t\t\tmolecule = this.TileCliffMolecules.TwoSidesBL;\r\n\t\t\t\t} else if(tileAnalysis.botLess && tileAnalysis.rightLess){\r\n\t\t\t\t\tmolecule = this.TileCliffMolecules.TwoSidesBR;\r\n\t\t\t\t} \r\n\t\t\t\tbreak;\r\n\t\t\tcase 3:\r\n\t\t\t\tif( !tileAnalysis.topLess ) {\r\n\t\t\t\t\tmolecule = this.TileCliffMolecules.PenninsulaB;\r\n\t\t\t\t} else if( !tileAnalysis.leftLess ) {\r\n\t\t\t\t\tmolecule = this.TileCliffMolecules.PenninsulaR;\r\n\t\t\t\t} else if( !tileAnalysis.rightLess ) {\r\n\t\t\t\t\tmolecule = this.TileCliffMolecules.PenninsulaL;\r\n\t\t\t\t} else if( !tileAnalysis.botLess ) {\r\n\t\t\t\t\tmolecule = this.TileCliffMolecules.PenninsulaT;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\t\t\t\t\t\t\t\t\r\n\t\t\tcase 4:\r\n\t\t\t\tmolecule = this.TileCliffMolecules.Island;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn molecule;\r\n\t}\r\n\r\n\tcolorImageData(imageData, tileAnalysis) {\r\n\t\t\r\n\t\tconst data = new Uint8ClampedArray(imageData.data);\r\n\t\tvar directions = ['topHeight', 'leftHeight', 'rightHeight', 'botHeight', 'topLeftHeight', 'topRightHeight', 'botLeftHeight', 'botRightHeight'];\r\n\t\tlet heightCounts = {};\r\n\t\tdirections.forEach((direction) => {\r\n\t\t\tlet height = tileAnalysis[direction];\r\n\t\t\tif (height !== tileAnalysis.heightIndex) {\r\n\t\t\t\tif (!heightCounts[height]) {\r\n\t\t\t\t\theightCounts[height] = 0;\r\n\t\t\t\t}\r\n\t\t\t\theightCounts[height]++;\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\tlet lowerNeighborHeight = Math.max(0, tileAnalysis.heightIndex - 1);\r\n\t\tlet maxCount = 0;\r\n\t\tObject.keys(heightCounts).forEach((height) => {\r\n\t\t\tif (heightCounts[height] > maxCount && height < tileAnalysis.heightIndex) {\r\n\t\t\t\tlowerNeighborHeight = parseInt(height);\r\n\t\t\t\tmaxCount = heightCounts[height];\r\n\t\t\t}\r\n\t\t});\r\n\t\tconst numPixels = this.tileSize * this.tileSize;\r\n\t\tif(lowerNeighborHeight < 0){\r\n\t\t\tconst blackData = new Uint8ClampedArray(numPixels * 4); // 4 values per pixel (RGBA)\r\n\t\t\tblackData.fill(0); // Fill with black (0, 0, 0, 255)\r\n\t\t\treturn new ImageData(blackData, this.tileSize, this.tileSize);\r\n\t\t}\r\n\t\tlet baseColors = this.layerTextures[tileAnalysis.heightIndex][this.TileMolecule.Full].data;\r\n\t\tlet neighborColors = this.layerTextures[lowerNeighborHeight][this.TileMolecule.Full].data;\r\n\r\n\t\t// Iterate over each pixel\r\n\t\tfor (let i = 0; i < numPixels; i++) {\r\n\t\t\tconst dataIndex = i * 4;\r\n\t\t\tlet pColor = { r: data[dataIndex], g: data[dataIndex + 1], b: data[dataIndex + 2], a: data[dataIndex + 3] };\r\n\t\t\tlet bColor = { r: baseColors[dataIndex], g: baseColors[dataIndex + 1], b: baseColors[dataIndex + 2], a: baseColors[dataIndex + 3] };\r\n\t\t\tlet tColor = { r: neighborColors[dataIndex], g: neighborColors[dataIndex + 1], b: neighborColors[dataIndex + 2], a: neighborColors[dataIndex + 3] };\r\n\t\r\n\t\t\tif (this.layerTextures.length > tileAnalysis.heightIndex) {\r\n\t\t\t\tif (baseColors.length > i) {\r\n\t\t\t\t\tbColor = { r: baseColors[dataIndex], g: baseColors[dataIndex + 1], b: baseColors[dataIndex + 2], a: baseColors[dataIndex + 3] };\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (lowerNeighborHeight >= 0) {\r\n\t\t\t\tif (neighborColors.length > i) {\r\n\t\t\t\t\ttColor = { r: neighborColors[dataIndex], g: neighborColors[dataIndex + 1], b: neighborColors[dataIndex + 2], a: neighborColors[dataIndex + 3] };\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet fColor = pColor;\r\n\t\t\tif (this.isEqualColor(fColor, { r: 0, g: 0, b: 0, a: 0 })) fColor = pColor;\r\n\t\t\tif (this.isEqualColor(fColor, { r: 0, g: 0, b: 0, a: 255 })) fColor = bColor;\r\n\r\n\t\t\tdata.set([fColor.r, fColor.g, fColor.b, fColor.a], dataIndex);\r\n\t\t}\r\n\t\treturn new ImageData(data, this.tileSize, this.tileSize);\r\n\t}\r\n\r\n\tisEqualColor(color1, color2) {\r\n\t\treturn color1.r === color2.r && color1.g === color2.g && color1.b === color2.b && color1.a === color2.a;\r\n\t}\r\n\r\n\taddCornerGraphics(imageData, tileAnalysis) {\r\n\t\tlet cornerSize = this.tileSize / 2;\r\n\t\tlet cornerTexture;\r\n\t\tlet heightIndex = tileAnalysis.heightIndex;\r\n\t\r\n\t\tif (tileAnalysis.cornerLowerCount > 0) {\r\n\t\t\tif (tileAnalysis.cornerTopLeftLess && (!tileAnalysis.topLess && !tileAnalysis.leftLess)) {\t\t\t\t\r\n\t\t\t\tcornerTexture = this.layerTextures[heightIndex][this.TileCliffMolecules.CornerTL];\r\n\t\t\t\timageData = this.colorCornerTextureRoutine(imageData, 0, 0, cornerTexture, tileAnalysis);\t\t\t\r\n\t\t\t}\r\n\t\t\t// Assuming tileAnalysis, textureDict, and other variables are already defined\r\n\t\t\tif (tileAnalysis.cornerTopRightLess && (!tileAnalysis.topLess && !tileAnalysis.rightLess)) {\t\t\t\t\r\n\t\t\t\tcornerTexture = this.layerTextures[heightIndex][this.TileCliffMolecules.CornerTR];\r\n\t\t\t\timageData = this.colorCornerTextureRoutine(imageData, cornerSize, 0, cornerTexture, tileAnalysis);\t\t\t\r\n\t\t\t}\r\n\r\n\t\t\tif (tileAnalysis.cornerBottomLeftLess && (!tileAnalysis.botLess && !tileAnalysis.leftLess)) {\t\t\t\t\r\n\t\t\t\tcornerTexture = this.layerTextures[heightIndex][this.TileCliffMolecules.CornerBL];\r\n\t\t\t\timageData = this.colorCornerTextureRoutine(imageData, 0, cornerSize, cornerTexture, tileAnalysis);\t\t\t\r\n\t\t\t}\r\n\r\n\t\t\tif (tileAnalysis.cornerBottomRightLess && (!tileAnalysis.botLess && !tileAnalysis.rightLess)) {\t\t\t\r\n\t\t\t\tcornerTexture = this.layerTextures[heightIndex][this.TileCliffMolecules.CornerBR];\r\n\t\t\t\timageData = this.colorCornerTextureRoutine(imageData, cornerSize, cornerSize, cornerTexture, tileAnalysis);\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn imageData;\r\n\t}\r\n\t\r\n\tcolorCornerTextureRoutine(outputImageData, x, y, cornerImageData, tileAnalysis) {\r\n\t\tlet cornerSize = this.tileSize / 2;\t\r\n\t\tlet baseHeightIndex = tileAnalysis.heightIndex;\r\n\t\tlet baseColors = this.layerTextures[baseHeightIndex][this.TileMolecule.Full];\r\n\t\tconst data = new Uint8ClampedArray(outputImageData.data);\r\n\t\tfor (let j = 0; j < cornerSize; j++) {\r\n\t\t\tfor (let i = 0; i < cornerSize; i++) {\r\n\t\t\t\t// Calculate the correct position in the output image data\r\n\t\t\t\tlet outputIndex = ((y + j) * this.tileSize + (x + i)) * 4;\r\n\t\r\n\t\t\t\tlet baseColor = this.getColorFromImageData(baseColors, outputIndex);\r\n\t\t\r\n\t\t\t\tlet sourceOriginX = i;\r\n\t\t\t\tlet sourceOriginY = j * cornerSize;\r\n\t\t\t\tlet sourcePixel = (sourceOriginY + sourceOriginX) * 4;\r\n\t\t\t\tlet pColor = this.getColorFromImageData(cornerImageData, sourcePixel);\r\n\t\t\t\tlet fColor = pColor;\r\n\t\t\t\tif (this.isEqualColor(fColor, { r: 0, g: 0, b: 0, a: 255 })) {\r\n\t\t\t\t\tfColor = baseColor;\t\t\t\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tdata[outputIndex] = fColor.r;\r\n\t\t\t\tdata[outputIndex + 1] = fColor.g;\r\n\t\t\t\tdata[outputIndex + 2] = fColor.b;\r\n\t\t\t\tdata[outputIndex + 3] = fColor.a;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn new ImageData(data, this.tileSize, this.tileSize);\r\n\t}\r\n\t\r\n\tgetColorFromImageData(imageData, index) {\r\n\t\treturn {\r\n\t\t\tr: imageData.data[index],\r\n\t\t\tg: imageData.data[index + 1],\r\n\t\t\tb: imageData.data[index + 2],\r\n\t\t\ta: imageData.data[index + 3]\r\n\t\t};\r\n\t}\t\r\n\t\r\n\taddVariationImage(imageData, tileAnalysis) {\r\n\t\tconst img = this.layerSpriteSheets[tileAnalysis.heightIndex];\r\n\t\r\n\t\tif (img && Math.random() < .25) {\r\n\t\t\tthis.canvasUtility.setSize(imageData.width, imageData.height);\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t// Paint the existing imageData onto the canvas\r\n\t\t\tthis.canvasUtility.paintTexture(imageData);\r\n\t\r\n\t\t\t// Assuming img is a loaded Image object and you want to draw it at (0,0)\r\n\t\t\t// Draw the img over the imageData\r\n\t\t\tthis.canvasUtility.ctx.drawImage(img, (imageData.width / 2) - img.width / 2,  (imageData.width / 2) - img.width / 2);\r\n\t\r\n\t\t\t// Get the updated imageData from the canvas\r\n\t\t\treturn this.canvasUtility.ctx.getImageData(0, 0, imageData.width, imageData.height);\r\n\t\t} else {\r\n\t\t\t// If img is not available, return the original imageData\r\n\t\t\treturn imageData;\r\n\t\t}\r\n\t}\r\n\t\r\n\tdrawMap(analyzedMap) {\r\n\t\tconst ctx = this.canvas.getContext('2d');\r\n\t\tconst layerCanvases = {};\r\n\t\r\n\t\tfor (let layerIndex = 0; layerIndex < this.layerTextures.length; layerIndex++) {\r\n\t\t\tconst offscreenCanvas = document.createElement('canvas');\r\n\t\t\toffscreenCanvas.width = this.canvas.width;\r\n\t\t\toffscreenCanvas.height = this.canvas.height;\r\n\t\t\tlayerCanvases[layerIndex] = offscreenCanvas;\r\n\t\t\tconst offscreenCtx = offscreenCanvas.getContext('2d');\r\n\t\r\n\t\t\tanalyzedMap.forEach((tileAnalysis, index) => {\r\n\t\t\t\tconst x = (index % this.numColumns) * this.tileSize;\r\n\t\t\t\tconst y = Math.floor(index / this.numColumns) * this.tileSize;\r\n\t\r\n\t\t\t\tlet imageData;\r\n\t\t\t\tlet _tileAnalysis = {...tileAnalysis };\r\n\t\t\t\tif (_tileAnalysis.heightIndex > layerIndex) {\r\n\t\t\t\t\t// Use base image data for higher layers\r\n\t\t\t\t\t_tileAnalysis.heightIndex = layerIndex;\r\n\t\t\t\t\tif(_tileAnalysis.topLess && _tileAnalysis.topHeight >= _tileAnalysis.heightIndex) {\r\n\t\t\t\t\t\t_tileAnalysis.topLess = false;\r\n\t\t\t\t\t\t_tileAnalysis.neighborLowerCount--;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(_tileAnalysis.leftLess && _tileAnalysis.leftHeight >= _tileAnalysis.heightIndex) {\r\n\t\t\t\t\t\t_tileAnalysis.leftLess = false;\r\n\t\t\t\t\t\t_tileAnalysis.neighborLowerCount--;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(_tileAnalysis.rightLess && _tileAnalysis.rightHeight >= _tileAnalysis.heightIndex){\r\n\t\t\t\t\t\t_tileAnalysis.rightLess = false;\r\n\t\t\t\t\t\t_tileAnalysis.neighborLowerCount--;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(_tileAnalysis.botLess && _tileAnalysis.botHeight >= _tileAnalysis.heightIndex) {\r\n\t\t\t\t\t\t_tileAnalysis.botLess = false;\r\n\t\t\t\t\t\t_tileAnalysis.neighborLowerCount--;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(_tileAnalysis.cornerTopLeftLess && _tileAnalysis.topLeftHeight >= _tileAnalysis.heightIndex) {\r\n\t\t\t\t\t\t_tileAnalysis.cornerTopLeftLess = false;\r\n\t\t\t\t\t\t_tileAnalysis.cornerLowerCount--;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(_tileAnalysis.cornerTopRightLess && _tileAnalysis.topRightHeight >= _tileAnalysis.heightIndex) {\r\n\t\t\t\t\t\t_tileAnalysis.cornerTopRightLess = false;\r\n\t\t\t\t\t\t_tileAnalysis.cornerLowerCount--;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(_tileAnalysis.cornerBottomLeftLess && _tileAnalysis.botLeftHeight >= _tileAnalysis.heightIndex) {\r\n\t\t\t\t\t\t_tileAnalysis.cornerBottomLeftLess = false;\r\n\t\t\t\t\t\t_tileAnalysis.cornerLowerCount--;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(_tileAnalysis.cornerBottomRightLess && _tileAnalysis.botRightHeight >= _tileAnalysis.heightIndex) {\r\n\t\t\t\t\t\t_tileAnalysis.cornerBottomRightLess = false;\r\n\t\t\t\t\t\t_tileAnalysis.cornerLowerCount--;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t} \r\n\t\t\t\tif (_tileAnalysis.heightIndex < layerIndex) {\r\n\t\t\t\t\t// Use base image data for higher layers\r\n\t\t\t\t\tlet numPixels = this.tileSize * this.tileSize;\r\n\t\t\t\t\tconst transparentData = new Uint8ClampedArray(numPixels * 4); // 4 values per pixel (RGBA)\r\n\t\t\t\t\t\r\n\t\t\t\t\tfor (let i = 0; i < numPixels * 4; i += 4) {\r\n\t\t\t\t\t\ttransparentData[i] = 0;     // Red (not important for transparency)\r\n\t\t\t\t\t\ttransparentData[i + 1] = 0; // Green (not important for transparency)\r\n\t\t\t\t\t\ttransparentData[i + 2] = 0; // Blue (not important for transparency)\r\n\t\t\t\t\t\ttransparentData[i + 3] = 0; // Alpha (0 for full transparency)\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\timageData = new ImageData(transparentData, this.tileSize, this.tileSize);\r\n\t\t\t\t\t\r\n\t\t\t\t } else {\r\n\t\t\t\t\timageData = new ImageData(new Uint8ClampedArray(4), 1, 1);\r\n\t\t\t\t\tif( _tileAnalysis.heightIndex >= 0 ) {\r\n\t\t\t\t\t\tlet molecule = this.getMoleculeByTileAnalysis(_tileAnalysis);\t\t\t\t\t\t\r\n\t\t\t\t\t\timageData = this.layerTextures[_tileAnalysis.heightIndex][molecule];//this.getTransformedTexture(this.layerTextures[_tileAnalysis.heightIndex], _tileAnalysis, molecule);\t\t\t\r\n\t\t\t\t\t\timageData = this.colorImageData(imageData, _tileAnalysis);\r\n\t\t\t\t\t\t//imageData = this.addVariationImage(imageData, _tileAnalysis);\r\n\t\t\t\t\t\timageData = this.addCornerGraphics(imageData, _tileAnalysis);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tlet numPixels = this.tileSize * this.tileSize;\r\n\t\t\t\t\t\tconst blackData = new Uint8ClampedArray(numPixels * 4); // 4 values per pixel (RGBA)\r\n\t\t\t\t\t\tblackData.fill(0); // Fill with black (0, 0, 0, 255)\r\n\t\t\t\t\t\timageData = new ImageData(blackData, this.tileSize, this.tileSize);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\toffscreenCtx.putImageData(imageData, x, y);\r\n\t\t\t});\r\n\t\t}\r\n\t\r\n\t\t// Drawing each layer canvas onto the main canvas\r\n\t\tObject.keys(layerCanvases).forEach(layerIndex => {\r\n\t\t\t//if( layerIndex == 0 || layerIndex == 1 || layerIndex == 2) {\r\n\t\t\tctx.drawImage(layerCanvases[layerIndex], 0, 0);\r\n\t\t//}\r\n\t\t});\r\n\t}\r\n  }"
      },
      "GraphicsEditor": {
        "fileName": "GraphicsEditor",
        "title": "GraphicsEditor",
        "script": "/**\n * @class GraphicsEditor\n * @description Manages 3D graphics editing functionality including shapes, animations, and UI\n */\nclass GraphicsEditor {\n    /**\n     * @param {Object} gameEditor - Main game editor instance\n     * @param {Object} config - Editor configuration\n     * @param {Object} managers - Required manager instances\n     * @param {Function} managers.ShapeFactory - Factory for creating shapes\n     * @param {Function} managers.GE_SceneRenderer - Handles scene rendering\n     * @param {Function} managers.GE_ShapeManager - Manages shape operations\n     * @param {Function} managers.GE_AnimationManager - Handles animations\n     * @param {Function} managers.GE_RotationUtils - Rotation utility functions\n     * @param {Function} managers.GE_UIManager - Manages UI interactions\n     * @param {Function} managers.GE_GroupManager - Handles shape grouping\n     * @param {Function} managers.GE_GizmoManager - Manages transformation gizmos\n     */\n    constructor(gameEditor, config, {ShapeFactory, GE_SceneRenderer, GE_ShapeManager, GE_AnimationManager, GE_RotationUtils, GE_UIManager, GE_GroupManager, GE_GizmoManager}) {\n        this.gameEditor = gameEditor;\n        this.config = config;\n        this.shapeFactory = new ShapeFactory(this.gameEditor.getPalette(), this.gameEditor.getCollections().textures);\n        this.canvas = document.getElementById('graphics-editor-canvas');\n        // Initialize sub-modules\n        this.sceneRenderer = new GE_SceneRenderer(gameEditor, this);\n        this.shapeManager = new GE_ShapeManager(gameEditor, this);\n        this.uiManager = new GE_UIManager(gameEditor, this);\n        this.animationManager = new GE_AnimationManager(gameEditor, this);\n        this.groupManager = new GE_GroupManager(gameEditor, this);\n        this.gizmoManager = new GE_GizmoManager(gameEditor, this);\n        this.rotationUtils = GE_RotationUtils;\n        // State management (simplified)\n        this.state = {\n            editingModel: true,\n            selectedShapeIndex: -1,\n            currentAnimation: \"\",\n            selectedGroup: \"main\",\n            currentFrame: 0,\n            renderData: { model: {}, animations: { idle: [{ main: { shapes: [], position: {x: 0, y: 0, z: 0}, rotation: {x:0,y:0,z:0}, scale: {x:1, y:1, z:1}} }] } }\n        };\n        \n        this.rootGroup = new window.THREE.Group(); // Main container for all shapes\n        this.rootGroup.name = \"rootGroup\";\n        this.init();\n    }\n    /**\n     * Initializes all manager components\n     * @private\n     */\n    init() {\n        this.sceneRenderer.init();\n        this.uiManager.init();\n        this.shapeManager.init();\n        this.animationManager.init();\n        this.groupManager.init();\n        this.gizmoManager.init();\n        this.sceneRenderer.animate();    \n    }\n\n    /**\n     * Displays isometric sprite previews\n     * @param {Array<Object>} sprites - Array of sprite data\n     */\n    displayIsometricSprites(sprites){\n        this.uiManager.displayIsometricSprites(sprites);\n    }\n\n    /**\n     * Renders all shapes in the scene\n     * @param {boolean} [fireSave=true] - Whether to trigger a save after rendering\n     * @returns {Promise<void>}\n     */\n    async renderShapes(fireSave = true) {\n        await this.clearScene();\n        await this.setupLights();\n        \n        if (!this.validateCurrentFrame()) {\n            return;\n        }\n        \n        await this.renderGroups();\n        await this.updateUI(fireSave);\n        await this.updateSelection();\n    }\n\n    /**\n     * Clears all objects from the scene\n     * @private\n     * @returns {Promise<void>}\n     */    \n    async clearScene() {\n        while (this.rootGroup.children.length > 0) {\n            const obj = this.rootGroup.children[0];\n            this.shapeFactory.disposeObject(obj);\n            this.shapeManager.originalMaterials.delete(obj);\n            this.rootGroup.remove(obj);\n        }\n    }\n\n    /**\n     * Sets up scene lighting\n     * @private\n     * @returns {Promise<void>}\n     */    \n    async setupLights() {\n        if (this.sceneRenderer.scene.getObjectByName('ambient-light')) {\n            return;\n        }\n    \n        const ambientLight = new window.THREE.AmbientLight(0xffffff, 0.6);\n        ambientLight.name = 'ambient-light';\n        this.sceneRenderer.scene.add(ambientLight);\n    \n        const directionalLight = new window.THREE.DirectionalLight(0xffffff, 0.8);\n        directionalLight.position.set(5, 10, 7.5);\n        directionalLight.name = 'dir-light';\n        this.sceneRenderer.scene.add(directionalLight);\n    }    \n\n    /**\n     * Validates the current animation frame\n     * @private\n     * @returns {boolean} - Whether the current frame is valid\n     */\n    validateCurrentFrame() {\n        if (!this.state.editingModel && !this.getCurrentFrame()) {\n            console.warn(\n                \"Animation or frame doesn't exist:\", \n                this.state.currentAnimation, \n                this.state.currentFrame\n            );\n            return false;\n        }\n        return true;\n    }\n    \n    /**\n     * Renders all shapes in the scene\n     * @param {boolean} [fireSave=true] - Whether to trigger a save after rendering\n     * @returns {Promise<void>}\n     */\n    async renderGroups() {\n        const model = this.state.renderData.model;\n        for (const groupName in model) {     \n            const mergedGroup = this.getMergedGroup(groupName);\n            if (mergedGroup) {\n                let threeGroup = await this.shapeFactory.createGroupFromJSON(groupName, mergedGroup); \n                threeGroup.name = groupName;\n                this.rootGroup.add(threeGroup);\n            }\n        }\n    }\n\n    /**\n     * Renders all shapes in the scene\n     * @param {boolean} [fireSave=true] - Whether to trigger a save after rendering\n     * @returns {Promise<void>}\n     */\n    async updateUI(fireSave) {\n        this.updateShapeCount();\n        await this.handleSave(fireSave);\n    }\n\n    /**\n     * Updates the shape count display in the UI\n     * @private\n     */\n    updateShapeCount() {\n        const model = this.state.renderData.model;\n        const totalShapes = Object.values(model).reduce((total, group) => {\n            return total + (Array.isArray(group.shapes) ? group.shapes.length : 0);\n        }, 0);\n        document.getElementById('shape-count').textContent = totalShapes;\n    }\n    \n    /**\n     * Handles saving the current state\n     * @param {boolean} fireSave - Whether to trigger a save event\n     * @returns {Promise<void>}\n     */\n    async handleSave(fireSave) {\n        if (fireSave) {\n            const saveEvent = new CustomEvent('saveGraphicsObject', {\n                detail: { \n                    data: this.state.renderData, \n                    propertyName: 'render' \n                },\n                bubbles: true,\n                cancelable: true\n            });\n            document.body.dispatchEvent(saveEvent);\n        } else {\n            const valueElement = this.gameEditor.elements.editor\n                .querySelector('#render-value');\n            if (valueElement) {\n                let renderDataCopy = JSON.parse(JSON.stringify(this.state.renderData));\n                Object.keys(renderDataCopy.animations).forEach(animationName => {\n                    const animation = renderDataCopy.animations[animationName];\n                    animation.forEach(frame => {\n                        Object.keys(frame).forEach(groupName => {\n                            const group = frame[groupName];\n                            if (group && group.shapes) {\n                                // Filter shapes with more than just ID\n                                group.shapes = group.shapes.filter(shape => \n                                    Object.keys(shape).length > 1\n                                );\n                                \n                                // Remove empty shapes array\n                                if (group.shapes.length === 0) {\n                                    delete group.shapes;\n                                }\n                \n                                // Remove empty group\n                                if (Object.keys(group).length === 0) {\n                                    delete frame[groupName];\n                                }\n                            }\n                        });               \n                    });\n                });\n                valueElement.value = JSON.stringify(renderDataCopy);\n            }\n        }\n    }\n\n    /**\n     * Updates the selection highlight and gizmo positions\n     * @returns {Promise<void>}\n     */\n    async updateSelection() {\n        this.shapeManager.highlightSelectedShape();\n        this.gizmoManager.updateGizmoPosition();\n    }\n\n    /**\n     * Gets the current animation data\n     * @returns {Object|null} Current animation or null if none exists\n     */\n    getCurrentAnimation() {\n     \n        return this.state.renderData.animations[this.state.currentAnimation] || null;\n    }\n\n    /**\n     * Gets the current frame data\n     * @returns {Object|null} Current frame data or model data if in editing mode\n     */\n    getCurrentFrame() {\n        if(this.state.editingModel){\n            return this.state.renderData.model;\n        } else {\n            let currentAnimation = this.getCurrentAnimation();\n            return currentAnimation ? currentAnimation[this.state.currentFrame] : null;\n        }\n    }\n\n    /**\n     * Gets the current group data\n     * @returns {Object|null} Current group data or null if none exists\n     */\n    getCurrentGroup() {\n        let currentFrame = this.getCurrentFrame();\n        return currentFrame ? currentFrame[this.state.currentGroup] : null;\n    }\n\n    /**\n     * Refreshes the shape list and renders the scene\n     * @param {boolean} param - Whether to trigger a save after refresh\n     */\n    refreshShapes(param) {\n        this.uiManager.updateList();\n        this.renderShapes(param);\n    }\n\n    /**\n     * Creates an inspector panel for the given shape\n     * @param {Object} shape - Shape to create inspector for\n     */\n    createInspector(shape) {\n        this.uiManager.createInspector(shape);\n    }\n\n    /**\n     * Sets the animation preview state\n     * @param {Object} state - New animation state\n     * @returns {Promise<void>}\n     */\n    setPreviewAnimationState(state) {\n        return this.animationManager.setPreviewAnimationState(state);\n    }\n\n    /**\n     * Selects a shape by index\n     * @param {number} index - Index of shape to select\n     * @returns {Promise<void>}\n     */\n    selectShape(index) {\n        return this.shapeManager.selectShape(index);\n    }\n\n    /**\n     * Gets a merged group by name\n     * @param {string} groupName - Name of group to get\n     * @returns {Object|null} Merged group data or null\n     */\n    getMergedGroup(groupName){\n        let model = this.state.renderData.model;\n        const modelGroup = model[groupName];\n        if(this.state.editingModel){\n            return modelGroup;\n        }\n        return this.shapeFactory.getMergedGroup(model, this.getCurrentAnimation()[this.state.currentFrame], groupName );\n    }\n\n    /**\n     * Gets the current frame's shape data\n     * @returns {Object|null} Shape data or null if not found\n     */\n    getFrameShape() {\n        // If we're in model editing mode, return merged shape\n        if (this.state.editingModel) {\n            return this.getMergedShape();\n        }\n    \n        // Return null if no shape is selected\n        if (this.state.selectedShapeIndex < 0) {\n            return null;\n        }\n    \n        // Get or create group data\n        let groupData = this.getCurrentGroup() || \n            JSON.parse(JSON.stringify(this.state.renderData.model[this.state.currentGroup]));\n    \n        if (!groupData?.shapes) {\n            return null;\n        }\n    \n        // Find existing shape or create new one\n        let shape = groupData.shapes.find(s => s.id === this.state.selectedShapeIndex);\n        if (shape) {\n            return shape;\n        }\n    \n        // Create new shape if not found\n        return this.createBlankFrameShape();\n    }\n\n    /**\n     * Creates a new blank frame shape\n     * @private\n     * @returns {Object|null} New shape or null if frame doesn't exist\n     */\n    createBlankFrameShape() {\n        const shape = { id: this.state.selectedShapeIndex };\n        const currentFrame = this.getCurrentFrame();\n        \n        if (!currentFrame) {\n            return null;\n        }\n    \n        // Add shape to current group or create new group\n        if (!currentFrame[this.state.currentGroup]) {\n            currentFrame[this.state.currentGroup] = { shapes: [] };\n        }\n        \n        currentFrame[this.state.currentGroup].shapes.push(shape);\n        return shape;\n    }\n    /**\n     * Gets the currently selected shape merged with its group\n     * @returns {Object|null} - Merged shape or null if not found\n     */\n    getMergedShape() {\n        if (this.state.selectedShapeIndex < 0) {\n            return null;\n        }\n    \n        const selectedGroup = this.getMergedGroup(this.state.currentGroup);\n        const shapes = selectedGroup?.shapes || [];\n        const shape = shapes[this.state.selectedShapeIndex];\n    \n        if (!shape) {\n            return null;\n        }\n    \n        if (this.state.editingModel) {\n            return shape;\n        }\n    \n        return this.mergeShapeWithCurrentGroup(shape);\n    }\n    /**\n     * Merges a shape with its current group\n     * @param {Object} shape - Shape to merge\n     * @returns {Object} - Merged shape\n     */\n    mergeShapeWithCurrentGroup(shape) {\n        // Set shape ID\n        shape.id = this.state.selectedShapeIndex;\n    \n        // Get or create current group data\n        const currentGroupData = this.getCurrentGroup() || { shapes: [] };\n        if (!Array.isArray(currentGroupData.shapes)) {\n            currentGroupData.shapes = [];\n        }\n    \n        // Update shape in current group\n        this.updateShapeInGroup(shape, currentGroupData);\n    \n        // Update animation data\n        this.updateAnimationData(currentGroupData);\n    \n        return shape;\n    }\n    /**\n     * Updates a shape within its group\n     * @param {Object} shape - Shape to update\n     * @param {Object} groupData - Group containing the shape\n     */\n    updateShapeInGroup(shape, groupData) {\n        const shapeIndex = groupData.shapes.findIndex(s => s.id === shape.id);\n        \n        if (shapeIndex >= 0) {\n            groupData.shapes[shapeIndex] = shape; // Replace existing\n        } else {\n            groupData.shapes.push(shape); // Add new\n        }\n    }\n    \n    /**\n     * Updates animation data for the current group\n     * @param {Object} groupData - Group data to update\n     */\n    updateAnimationData(groupData) {\n        const path = [\n            this.state.currentAnimation,\n            this.state.currentFrame,\n            this.state.currentGroup\n        ];\n    \n        // Update nested property safely\n        let current = this.state.renderData.animations;\n        path.forEach((key, index) => {\n            if (index === path.length - 1) {\n                current[key] = groupData;\n            } else {\n                current = current[key];\n            }\n        });\n    }\n    /**\n     * Gets the currently selected object from the scene\n     * @returns {THREE.Object3D} - Selected object or root group\n     */\n    getSelectedObject() {\n        const currentGroup = this.state.currentGroup;\n        \n        if (!currentGroup) {\n            return this.rootGroup;\n        }\n    \n        const foundGroup = this.findGroupByName(currentGroup);\n        if (!foundGroup) {\n            return this.rootGroup;\n        }\n    \n        const foundShape = this.findShapeInGroup(foundGroup);\n        return foundShape || foundGroup || this.rootGroup;\n    }\n        /**\n     * Finds a group by name in the scene\n     * @param {string} groupName - Name of the group to find\n     * @returns {THREE.Group|null} - Found group or null\n     */\n    findGroupByName(groupName) {\n        let found = null;\n        this.rootGroup.traverse(obj => {\n            if (obj.isGroup && obj.name === groupName && obj.userData.isGroup) {\n                found = obj;\n            }\n        });\n        return found;\n    }\n        /**\n     * Finds a shape within a group\n     * @param {THREE.Group} group - Group to search in\n     * @returns {THREE.Object3D|null} - Found shape or null\n     */\n    findShapeInGroup(group) {\n        let found = null;\n        group.traverse(obj => {\n            if (obj.userData.isShape && obj.userData.index === this.state.selectedShapeIndex) {\n                found = obj;\n            }\n        });\n        return found;\n    }\n}\n"
      },
      "GE_EventManager": {
        "title": "GE_EventManager",
        "fileName": "GE_EventManager",
        "script": "class GE_EventManager {\r\n    constructor(gameEditor, graphicsEditor) {\r\n        this.editor = gameEditor;\r\n        this.graphicsEditor = graphicsEditor;\r\n    }    \r\n    \r\n\r\n}"
      },
      "GE_GizmoManager": {
        "title": "GE_GizmoManager",
        "fileName": "GE_GizmoManager",
        "script": "class GE_GizmoManager {\r\n    constructor(gameEditor, graphicsEditor) {\r\n        this.gameEditor = gameEditor;\r\n        this.graphicsEditor = graphicsEditor;\r\n        this.gizmoMode = 'translate';\r\n        this.gizmoGroup = null;\r\n        this.isDragging = false;\r\n        this.selectedAxis = null;\r\n        this.mouse = new window.THREE.Vector2();\r\n        this.lastMouse = new window.THREE.Vector2();\r\n        this.raycaster = new window.THREE.Raycaster();\r\n        this.originalScale = new window.THREE.Vector3(1, 1, 1);\r\n        this.originalPosition = new window.THREE.Vector3(0, 0, 0);\r\n        this.originalRotation = new window.THREE.Vector3(0, 0, 0);\r\n    }\r\n\r\n    init() {\r\n\r\n        const canvas = this.graphicsEditor.sceneRenderer.renderer.domElement;\r\n        canvas.addEventListener('mousedown', this.onMouseDown.bind(this));\r\n        canvas.addEventListener('mousemove', this.onDrag.bind(this));\r\n        canvas.addEventListener('mouseup', this.onMouseUp.bind(this));\r\n\r\n    }\r\n\r\n    destroyGizmo() {\r\n        if (this.gizmoGroup) {\r\n            this.gizmoGroup.children.forEach(child => {\r\n                if (child.geometry) child.geometry.dispose();\r\n                if (child.material) child.material.dispose();\r\n            });\r\n            this.graphicsEditor.sceneRenderer.scene.remove(this.gizmoGroup);\r\n            this.gizmoGroup = null;\r\n        }\r\n    }\r\n\r\n    createGizmo() {\r\n        this.destroyGizmo();\r\n        this.gizmoGroup = new window.THREE.Group();\r\n        this.graphicsEditor.sceneRenderer.scene.add(this.gizmoGroup);\r\n    \r\n        let center = new window.THREE.Vector3();\r\n        let xOffset = 1, yOffset = 1, zOffset = 1;\r\n    \r\n        if (this.currentTransformTarget.children.length > 0) {\r\n            const boundingBox = new window.THREE.Box3().setFromObject(this.currentTransformTarget);\r\n            const size = new window.THREE.Vector3();\r\n            if (!boundingBox.isEmpty() && isFinite(boundingBox.min.x)) {\r\n                boundingBox.getSize(size);\r\n                boundingBox.getCenter(center);\r\n                xOffset = size.x / 2 + 1;\r\n                yOffset = size.y / 2 + 1;\r\n                zOffset = size.z / 2 + 1;\r\n            } else {\r\n                this.currentTransformTarget.getWorldPosition(center);\r\n                console.warn(\"Invalid bounding box; using group position.\");\r\n            }\r\n        } else {\r\n            const boundingBox = new window.THREE.Box3().setFromObject(this.currentTransformTarget);\r\n            const size = new window.THREE.Vector3();\r\n            if (!boundingBox.isEmpty() && isFinite(boundingBox.min.x)) {\r\n                boundingBox.getSize(size);\r\n                boundingBox.getCenter(center);\r\n                xOffset = size.x / 2 + 1;\r\n                yOffset = size.y / 2 + 1;\r\n                zOffset = size.z / 2 + 1;\r\n            } else {\r\n                this.currentTransformTarget.getWorldPosition(center);\r\n                console.warn(\"Invalid bounding box; using group position.\");\r\n            }\r\n        }\r\n    \r\n        this.gizmoGroup.position.copy(center);\r\n    \r\n        if (this.graphicsEditor.state.gizmoMode === \"translate\") {\r\n            const arrowLength = 5;\r\n            const arrowHeadLength = 2;\r\n            const arrowHeadWidth = 1;\r\n    \r\n            // X-axis (red)\r\n            const xCylinderGeometry = new window.THREE.CylinderGeometry(0.5, 0.5, arrowLength - arrowHeadLength, 8);\r\n            const xCylinderMaterial = new window.THREE.MeshBasicMaterial({ color: 0xff0000 });\r\n            const xCylinder = new window.THREE.Mesh(xCylinderGeometry, xCylinderMaterial);\r\n            xCylinder.rotation.z = Math.PI / 2;\r\n            xCylinder.position.x = xOffset + (arrowLength - arrowHeadLength) / 2;\r\n            xCylinder.name = \"translate-x\";\r\n            this.gizmoGroup.add(xCylinder);\r\n    \r\n            const xConeGeometry = new window.THREE.ConeGeometry(arrowHeadWidth, arrowHeadLength, 8);\r\n            const xConeMaterial = new window.THREE.MeshBasicMaterial({ color: 0xff0000 });\r\n            const xCone = new window.THREE.Mesh(xConeGeometry, xConeMaterial);\r\n            xCone.rotation.z = 3 * Math.PI / 2;\r\n            xCone.position.x = xOffset + arrowLength - arrowHeadLength / 2;\r\n            xCone.name = \"translate-x\";\r\n            this.gizmoGroup.add(xCone);\r\n    \r\n            // Y-axis (green)\r\n            const yCylinderGeometry = new window.THREE.CylinderGeometry(0.5, 0.5, arrowLength - arrowHeadLength, 8);\r\n            const yCylinderMaterial = new window.THREE.MeshBasicMaterial({ color: 0x00ff00 });\r\n            const yCylinder = new window.THREE.Mesh(yCylinderGeometry, yCylinderMaterial);\r\n            yCylinder.position.y = yOffset + (arrowLength - arrowHeadLength) / 2;\r\n            yCylinder.name = \"translate-y\";\r\n            this.gizmoGroup.add(yCylinder);\r\n    \r\n            const yConeGeometry = new window.THREE.ConeGeometry(arrowHeadWidth, arrowHeadLength, 8);\r\n            const yConeMaterial = new window.THREE.MeshBasicMaterial({ color: 0x00ff00 });\r\n            const yCone = new window.THREE.Mesh(yConeGeometry, yConeMaterial);\r\n            yCone.position.y = yOffset + arrowLength - arrowHeadLength / 2;\r\n            yCone.name = \"translate-y\";\r\n            this.gizmoGroup.add(yCone);\r\n    \r\n            // Z-axis (blue)\r\n            const zCylinderGeometry = new window.THREE.CylinderGeometry(0.5, 0.5, arrowLength - arrowHeadLength, 8);\r\n            const zCylinderMaterial = new window.THREE.MeshBasicMaterial({ color: 0x0000ff });\r\n            const zCylinder = new window.THREE.Mesh(zCylinderGeometry, zCylinderMaterial);\r\n            zCylinder.rotation.x = Math.PI / 2;\r\n            zCylinder.position.z = zOffset + (arrowLength - arrowHeadLength) / 2;\r\n            zCylinder.name = \"translate-z\";\r\n            this.gizmoGroup.add(zCylinder);\r\n    \r\n            const zConeGeometry = new window.THREE.ConeGeometry(arrowHeadWidth, arrowHeadLength, 8);\r\n            const zConeMaterial = new window.THREE.MeshBasicMaterial({ color: 0x0000ff });\r\n            const zCone = new window.THREE.Mesh(zConeGeometry, zConeMaterial);\r\n            zCone.rotation.x = Math.PI / 2;\r\n            zCone.position.z = zOffset + arrowLength - arrowHeadLength / 2;\r\n            zCone.name = \"translate-z\";\r\n            this.gizmoGroup.add(zCone);\r\n        } else if (this.graphicsEditor.state.gizmoMode === \"rotate\") {\r\n            const ringRadius = 4;\r\n            const ringTube = 0.5;\r\n    \r\n            // X-axis (red)\r\n            const xRingGeometry = new window.THREE.TorusGeometry(ringRadius, ringTube, 16, 100);\r\n            const xRingMaterial = new window.THREE.MeshBasicMaterial({ color: 0xff0000 });\r\n            const xRing = new window.THREE.Mesh(xRingGeometry, xRingMaterial);\r\n            xRing.rotation.y = Math.PI / 2;\r\n            xRing.position.x = xOffset;\r\n            xRing.name = \"rotate-x\";\r\n            this.gizmoGroup.add(xRing);\r\n    \r\n            // Y-axis (green)\r\n            const yRingGeometry = new window.THREE.TorusGeometry(ringRadius, ringTube, 16, 100);\r\n            const yRingMaterial = new window.THREE.MeshBasicMaterial({ color: 0x00ff00 });\r\n            const yRing = new window.THREE.Mesh(yRingGeometry, yRingMaterial);\r\n            yRing.rotation.x = Math.PI / 2;\r\n            yRing.position.y = yOffset;\r\n            yRing.name = \"rotate-y\";\r\n            this.gizmoGroup.add(yRing);\r\n    \r\n            // Z-axis (blue)\r\n            const zRingGeometry = new window.THREE.TorusGeometry(ringRadius, ringTube, 16, 100);\r\n            const zRingMaterial = new window.THREE.MeshBasicMaterial({ color: 0x0000ff });\r\n            const zRing = new window.THREE.Mesh(zRingGeometry, zRingMaterial);\r\n            zRing.position.z = zOffset;\r\n            zRing.name = \"rotate-z\";\r\n            this.gizmoGroup.add(zRing);\r\n        } else if (this.graphicsEditor.state.gizmoMode === \"scale\") {\r\n            const boxSize = 2;\r\n    \r\n            // X-axis (red)\r\n            const xBoxGeometry = new window.THREE.BoxGeometry(boxSize, boxSize, boxSize);\r\n            const xBoxMaterial = new window.THREE.MeshBasicMaterial({ color: 0xff0000 });\r\n            const xBox = new window.THREE.Mesh(xBoxGeometry, xBoxMaterial);\r\n            xBox.position.set(xOffset, 0, 0);\r\n            xBox.name = \"scale-x\";\r\n            this.gizmoGroup.add(xBox);\r\n    \r\n            // Y-axis (green)\r\n            const yBoxGeometry = new window.THREE.BoxGeometry(boxSize, boxSize, boxSize);\r\n            const yBoxMaterial = new window.THREE.MeshBasicMaterial({ color: 0x00ff00 });\r\n            const yBox = new window.THREE.Mesh(yBoxGeometry, yBoxMaterial);\r\n            yBox.position.set(0, yOffset, 0);\r\n            yBox.name = \"scale-y\";\r\n            this.gizmoGroup.add(yBox);\r\n    \r\n            // Z-axis (blue)\r\n            const zBoxGeometry = new window.THREE.BoxGeometry(boxSize, boxSize, boxSize);\r\n            const zBoxMaterial = new window.THREE.MeshBasicMaterial({ color: 0x0000ff });\r\n            const zBox = new window.THREE.Mesh(zBoxGeometry, zBoxMaterial);\r\n            zBox.position.set(0, 0, zOffset);\r\n            zBox.name = \"scale-z\";\r\n            this.gizmoGroup.add(zBox);\r\n        }\r\n    }   \r\n\r\n    setGizmoMode(mode) {\r\n        this.graphicsEditor.state.gizmoMode = mode;\r\n        this.createGizmo();\r\n    }\r\n\r\n    updateGizmoPosition() {\r\n        if (!this.currentTransformTarget || !this.gizmoGroup) return;\r\n                \r\n        let center = new window.THREE.Vector3();\r\n        let xOffset = 1, yOffset = 1, zOffset = 1;\r\n    \r\n        if (this.currentTransformTarget.children.length > 0) {\r\n            const boundingBox = new window.THREE.Box3().setFromObject(this.currentTransformTarget);\r\n            const size = new window.THREE.Vector3();\r\n            if (!boundingBox.isEmpty() && isFinite(boundingBox.min.x)) {\r\n                boundingBox.getSize(size);\r\n                boundingBox.getCenter(center);\r\n                xOffset = size.x / 2 + 1;\r\n                yOffset = size.y / 2 + 1;\r\n                zOffset = size.z / 2 + 1;\r\n            } else {\r\n                this.currentTransformTarget.getWorldPosition(center);\r\n                console.warn(\"Invalid bounding box; using group position.\");\r\n            }\r\n        } else {\r\n            const boundingBox = new window.THREE.Box3().setFromObject(this.currentTransformTarget);\r\n            const size = new window.THREE.Vector3();\r\n            if (!boundingBox.isEmpty() && isFinite(boundingBox.min.x)) {\r\n                boundingBox.getSize(size);\r\n                boundingBox.getCenter(center);\r\n                xOffset = size.x / 2 + 1;\r\n                yOffset = size.y / 2 + 1;\r\n                zOffset = size.z / 2 + 1;\r\n            } else {\r\n                this.currentTransformTarget.getWorldPosition(center);\r\n                console.warn(\"Invalid bounding box; using group position.\");\r\n            }\r\n        }\r\n    \r\n        this.gizmoGroup.position.copy(center);\r\n    \r\n        this.gizmoGroup.children.forEach(child => {\r\n            const name = child.name;\r\n            if (!name) return;\r\n    \r\n            child.position.set(0, 0, 0);\r\n    \r\n            if (name.startsWith(\"translate-\")) {\r\n                const arrowLength = 5;\r\n                const arrowHeadLength = 2;\r\n                if (name === \"translate-x\") {\r\n                    child.position.x = xOffset + (child.geometry.type === \"CylinderGeometry\" ? (arrowLength - arrowHeadLength) / 2 : arrowLength - arrowHeadLength / 2);\r\n                } else if (name === \"translate-y\") {\r\n                    child.position.y = yOffset + (child.geometry.type === \"CylinderGeometry\" ? (arrowLength - arrowHeadLength) / 2 : arrowLength - arrowHeadLength / 2);\r\n                } else if (name === \"translate-z\") {\r\n                    child.position.z = zOffset + (child.geometry.type === \"CylinderGeometry\" ? (arrowLength - arrowHeadLength) / 2 : arrowLength - arrowHeadLength / 2);\r\n                }\r\n            } else if (name.startsWith(\"rotate-\")) {\r\n                if (name === \"rotate-x\") child.position.x = xOffset;\r\n                else if (name === \"rotate-y\") child.position.y = yOffset;\r\n                else if (name === \"rotate-z\") child.position.z = zOffset;\r\n            } else if (name.startsWith(\"scale-\")) {\r\n                if (name === \"scale-x\") child.position.x = xOffset;\r\n                else if (name === \"scale-y\") child.position.y = yOffset;\r\n                else if (name === \"scale-z\") child.position.z = zOffset;\r\n            }\r\n        });\r\n    \r\n        // Ensure gizmoGroup is in scene (not rootGroup, as its a UI overlay)\r\n        if (!this.graphicsEditor.sceneRenderer.scene.children.includes(this.gizmoGroup)) {\r\n            this.graphicsEditor.sceneRenderer.scene.add(this.gizmoGroup);\r\n            console.warn(\"Gizmo was removed from scene; re-added.\");\r\n        }\r\n    }\r\n\r\n          \r\n    onMouseDown(event) {\r\n        if (!this.gizmoGroup) {\r\n            return;\r\n        }\r\n    \r\n        const canvas = this.graphicsEditor.sceneRenderer.renderer.domElement;\r\n        const rect = canvas.getBoundingClientRect();\r\n        this.mouse.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;\r\n        this.mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;\r\n    \r\n        this.raycaster.setFromCamera(this.mouse, this.graphicsEditor.sceneRenderer.camera);\r\n        const intersects = this.raycaster.intersectObjects(this.gizmoGroup.children, true);\r\n    \r\n        if (intersects.length > 0) {\r\n            const object = intersects[0].object;\r\n            this.selectedAxis = object.name.split('-')[1];\r\n            this.isDragging = true;\r\n            if (this.graphicsEditor.sceneRenderer.controls) {\r\n                this.graphicsEditor.sceneRenderer.controls.enabled = false;\r\n            }\r\n    \r\n            this.lastMouse.copy(this.mouse);\r\n        } else {\r\n            console.log(\"No intersection with gizmo\");\r\n        }\r\n    }\r\n\r\n    onMouseUp() {\r\n        this.isDragging = false;\r\n        this.selectedAxis = null;\r\n\r\n        if (this.graphicsEditor.sceneRenderer.controls) {\r\n            this.graphicsEditor.sceneRenderer.controls.enabled = true;\r\n        }\r\n    }\r\n    onDrag(event) {\r\n        if (!this.isDragging || !this.selectedAxis || !this.currentTransformTarget) return;\r\n        \r\n        const canvas = this.graphicsEditor.sceneRenderer.renderer.domElement;\r\n        const rect = canvas.getBoundingClientRect();\r\n        this.mouse.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;\r\n        this.mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;\r\n        const deltaMouse = this.mouse.clone().sub(this.lastMouse);\r\n        \r\n        const camera = this.graphicsEditor.sceneRenderer.camera;\r\n        const cameraPosition = camera.position.clone();\r\n        const objectPosition = this.currentTransformTarget.position.clone();\r\n        \r\n        const cameraRight = new window.THREE.Vector3(1, 0, 0).applyQuaternion(camera.quaternion);\r\n        const cameraUp = new window.THREE.Vector3(0, 1, 0).applyQuaternion(camera.quaternion);\r\n        const cameraForward = new window.THREE.Vector3(0, 0, -1).applyQuaternion(camera.quaternion);\r\n        const cameraToObject = objectPosition.clone().sub(cameraPosition);\r\n        \r\n        if (this.graphicsEditor.state.gizmoMode === \"translate\") {\r\n            const moveSpeed = 100;\r\n            \r\n            if (this.selectedAxis === \"x\") {\r\n                const worldX = new window.THREE.Vector3(1, 0, 0);\r\n                const dotProduct = worldX.dot(cameraRight);\r\n                const moveFactor = Math.sign(dotProduct) * deltaMouse.x * moveSpeed;\r\n                this.currentTransformTarget.position.x += moveFactor;\r\n            } else if (this.selectedAxis === \"y\") {\r\n                const worldY = new window.THREE.Vector3(0, 1, 0);\r\n                const dotProduct = worldY.dot(cameraUp);\r\n                const moveFactor = Math.sign(dotProduct) * deltaMouse.y * moveSpeed;\r\n                this.currentTransformTarget.position.y += moveFactor;\r\n            } else if (this.selectedAxis === \"z\") {\r\n                const worldZ = new window.THREE.Vector3(0, 0, 1);\r\n                const cameraRightXZ = new window.THREE.Vector3(cameraRight.x, 0, cameraRight.z).normalize();\r\n                const dotProduct = worldZ.dot(cameraRightXZ);\r\n                const moveFactor = Math.sign(dotProduct) * deltaMouse.x * moveSpeed;\r\n                this.currentTransformTarget.position.z += moveFactor;\r\n            }\r\n        } else if (this.graphicsEditor.state.gizmoMode === \"rotate\") {\r\n            const rotateSpeed = 2 * Math.PI;\r\n            \r\n            if (this.selectedAxis === \"x\") {\r\n                const worldX = new window.THREE.Vector3(1, 0, 0);\r\n                const dotProduct = worldX.dot(cameraRight);\r\n                const rotateFactor = -Math.sign(dotProduct) * deltaMouse.x * rotateSpeed;\r\n                this.currentTransformTarget.rotation.x += rotateFactor;\r\n            } else if (this.selectedAxis === \"y\") {\r\n                const worldY = new window.THREE.Vector3(0, 1, 0);\r\n                const dotProduct = worldY.dot(cameraUp);\r\n                const rotateFactor = Math.sign(dotProduct) * deltaMouse.x * rotateSpeed;\r\n                this.currentTransformTarget.rotation.y += rotateFactor;\r\n            } else if (this.selectedAxis === \"z\") {\r\n                const worldZ = new window.THREE.Vector3(0, 0, 1);\r\n                const dotProduct = cameraToObject.normalize().dot(worldZ);\r\n                const rotateFactor = Math.sign(dotProduct) * deltaMouse.x * rotateSpeed;\r\n                this.currentTransformTarget.rotation.z += rotateFactor;\r\n            }\r\n        } else if (this.graphicsEditor.state.gizmoMode === \"scale\") {\r\n            const scaleSpeed = 2;\r\n            let scaleFactor = 0;\r\n            \r\n            if (this.selectedAxis === \"x\") {\r\n                const worldX = new window.THREE.Vector3(1, 0, 0);\r\n                const dotProduct = worldX.dot(cameraRight);\r\n                scaleFactor = Math.sign(dotProduct) * deltaMouse.x * scaleSpeed;\r\n            } else if (this.selectedAxis === \"y\") {\r\n                const worldY = new window.THREE.Vector3(0, 1, 0);\r\n                const dotProduct = worldY.dot(cameraUp);\r\n                scaleFactor = Math.sign(dotProduct) * deltaMouse.y * scaleSpeed;\r\n            } else if (this.selectedAxis === \"z\") {\r\n                const worldZ = new window.THREE.Vector3(0, 0, 1);\r\n                const cameraRightXZ = new window.THREE.Vector3(cameraRight.x, 0, cameraRight.z).normalize();\r\n                const dotProduct = worldZ.dot(cameraRightXZ);\r\n                scaleFactor = Math.sign(dotProduct) * deltaMouse.x * scaleSpeed;\r\n            }\r\n            \r\n            if (this.selectedAxis === \"x\") {\r\n                this.currentTransformTarget.scale.x += scaleFactor;\r\n                if (this.currentTransformTarget.scale.x < 0.1) this.currentTransformTarget.scale.x = 0.1;\r\n            } else if (this.selectedAxis === \"y\") {\r\n                this.currentTransformTarget.scale.y += scaleFactor;\r\n                if (this.currentTransformTarget.scale.y < 0.1) this.currentTransformTarget.scale.y = 0.1;\r\n            } else if (this.selectedAxis === \"z\") {\r\n                this.currentTransformTarget.scale.z += scaleFactor;\r\n                if (this.currentTransformTarget.scale.z < 0.1) this.currentTransformTarget.scale.z = 0.1;\r\n            }\r\n        }\r\n        this.updateGizmoPosition();\r\n        this.lastMouse.copy(this.mouse);\r\n        this.updateInspectorValues();\r\n        this.applyCurrentTransform(); \r\n    }\r\n\r\n    updateInspectorValues() {\r\n        if (!this.currentTransformTarget) return;\r\n        \r\n        // Update all relevant input fields\r\n        const updateInput = (property, value) => {\r\n            const input = document.querySelector(`[data-property=\"${property}\"]`);\r\n            if (input) input.value = value;\r\n        };\r\n        \r\n        // Position\r\n        updateInput('x', this.currentTransformTarget.position.x);\r\n        updateInput('y', this.currentTransformTarget.position.y);\r\n        updateInput('z', this.currentTransformTarget.position.z);\r\n        \r\n        // Rotation (convert to degrees)\r\n        updateInput('rotationX', this.graphicsEditor.rotationUtils.radToDeg(this.currentTransformTarget.rotation.x));\r\n        updateInput('rotationY', this.graphicsEditor.rotationUtils.radToDeg(this.currentTransformTarget.rotation.y));\r\n        updateInput('rotationZ', this.graphicsEditor.rotationUtils.radToDeg(this.currentTransformTarget.rotation.z));\r\n        \r\n        // Scale\r\n        updateInput('scaleX', this.currentTransformTarget.scale.x);\r\n        updateInput('scaleY', this.currentTransformTarget.scale.y);\r\n        updateInput('scaleZ', this.currentTransformTarget.scale.z);\r\n    }\r\n \r\n    applyCurrentTransform() {\r\n        if (!this.currentTransformTarget) return;\r\n    \r\n        // For groups\r\n        if (this.currentTransformTarget.userData?.isGroup) {\r\n            const groupId = this.currentTransformTarget.name;\r\n            const groupData = this.graphicsEditor.groupManager.getGroupData(groupId);\r\n            \r\n            // Directly update group transform without full refresh\r\n            groupData.position = {\r\n                x: this.currentTransformTarget.position.x,\r\n                y: this.currentTransformTarget.position.y,\r\n                z: this.currentTransformTarget.position.z\r\n            };\r\n            groupData.rotation = {\r\n                x: this.currentTransformTarget.rotation.x,\r\n                y: this.currentTransformTarget.rotation.y,\r\n                z: this.currentTransformTarget.rotation.z\r\n            };\r\n            groupData.scale = {\r\n                x: this.currentTransformTarget.scale.x,\r\n                y: this.currentTransformTarget.scale.y,\r\n                z: this.currentTransformTarget.scale.z\r\n            };\r\n        }\r\n        // For individual shapes\r\n        else if (this.graphicsEditor.state.selectedShapeIndex >= 0) {\r\n            const shape = this.graphicsEditor.shapeManager.getShapeData(this.graphicsEditor.state.selectedShapeIndex);\r\n            if (shape) {\r\n                shape.x = this.currentTransformTarget.position.x;\r\n                shape.y = this.currentTransformTarget.position.y;\r\n                shape.z = this.currentTransformTarget.position.z;\r\n                \r\n                shape.rotationX = this.graphicsEditor.rotationUtils.radToDeg(this.currentTransformTarget.rotation.x);\r\n                shape.rotationY = this.graphicsEditor.rotationUtils.radToDeg(this.currentTransformTarget.rotation.y);\r\n                shape.rotationZ = this.graphicsEditor.rotationUtils.radToDeg(this.currentTransformTarget.rotation.z);\r\n                \r\n                shape.scaleX = this.currentTransformTarget.scale.x;\r\n                shape.scaleY = this.currentTransformTarget.scale.y;\r\n                shape.scaleZ = this.currentTransformTarget.scale.z;\r\n            }\r\n        }\r\n        this.graphicsEditor.renderShapes(false);\r\n        // Optional: Auto-save or trigger update\r\n    }\r\n\r\n\r\n    transformSelectedObject(targetObject) {\r\n        if(!targetObject){\r\n            targetObject = this.graphicsEditor.getSelectedObject();\r\n        }\r\n        console.log('transform', targetObject);\r\n        // Determine the target object - prioritize the passed target, then selected group, then rootGroup\r\n        let target;\r\n        if (targetObject) {\r\n            target = targetObject;\r\n        } else {\r\n            // Try to get the currently selected group\r\n            const currentGroup = this.graphicsEditor.state.currentGroup;\r\n            if (currentGroup) {\r\n                // Find the group in the scene\r\n                this.graphicsEditor.rootGroup.traverse(obj => {\r\n                    if (obj.isGroup && obj.name === currentGroup && obj.userData.isGroup) {\r\n                        target = obj;\r\n                    }\r\n                });\r\n            }\r\n            \r\n            // Fall back to rootGroup if no selected group found\r\n            if (!target) {\r\n                target = this.graphicsEditor.rootGroup;\r\n            }\r\n        }\r\n    \r\n        // If we still don't have a target, return\r\n        if (!target) return;\r\n    \r\n        this.currentTransformTarget = target;\r\n    \r\n        // If target is a group, ensure it's in rootGroup and populated\r\n        if (this.currentTransformTarget.userData?.isGroup) {\r\n            const groupId = this.currentTransformTarget.userData.groupId;\r\n            const group = this.graphicsEditor.groupManager.getGroupObject(groupId);\r\n            if (group) {\r\n                // Ensure group is in rootGroup\r\n                if (this.currentTransformTarget.parent !== this.graphicsEditor.rootGroup) {\r\n                    if (this.currentTransformTarget.parent) {\r\n                        this.currentTransformTarget.parent.remove(this.currentTransformTarget);\r\n                    }\r\n                    this.graphicsEditor.rootGroup.add(this.currentTransformTarget);\r\n                }    \r\n            }\r\n        }\r\n    \r\n        this.originalPosition.copy(this.currentTransformTarget.position);\r\n        this.originalRotation.copy(this.currentTransformTarget.rotation);\r\n        this.originalScale.copy(this.currentTransformTarget.scale);\r\n        \r\n        // Inject transform controls into inspector instead of creating separate UI\r\n        this.injectTransformControlsToInspector();\r\n        this.updateGizmoPosition();\r\n    }\r\n      \r\n    injectTransformControlsToInspector() {\r\n        const inspector = document.getElementById('inspector');\r\n        \r\n        // Create transform controls section\r\n        const transformSection = document.createElement('div');\r\n        transformSection.className = 'transform-controls-section';\r\n        transformSection.innerHTML = `\r\n            <h3>Transform ${this.currentTransformTarget.name || 'Current Frame'}</h3>\r\n            <div class=\"transform-buttons\">\r\n                <button id=\"translate-btn\" class=\"${this.gizmoMode === 'translate' ? 'active' : ''}\">Translate</button>\r\n                <button id=\"rotate-btn\" class=\"${this.gizmoMode === 'rotate' ? 'active' : ''}\">Rotate</button>\r\n                <button id=\"scale-btn\" class=\"${this.gizmoMode === 'scale' ? 'active' : ''}\">Scale</button>\r\n            </div>\r\n        `;\r\n        // Insert at the top of the inspector\r\n        if (inspector.firstChild) {\r\n            inspector.insertBefore(transformSection, inspector.firstChild);\r\n        } else {\r\n            inspector.appendChild(transformSection);\r\n        }      \r\n        // Add event listeners for transform mode buttons\r\n        document.getElementById('translate-btn').addEventListener('click', () => {\r\n            this.setGizmoMode('translate');\r\n            this.updateModeButtonsUI();\r\n        });\r\n        \r\n        document.getElementById('rotate-btn').addEventListener('click', () => {\r\n            this.setGizmoMode('rotate');\r\n            this.updateModeButtonsUI();\r\n        });\r\n        \r\n        document.getElementById('scale-btn').addEventListener('click', () => {\r\n            this.setGizmoMode('scale');\r\n            this.updateModeButtonsUI();\r\n        });\r\n        \r\n        this.updateInspectorValues();\r\n        this.setGizmoMode('translate');\r\n        this.updateModeButtonsUI();\r\n    }\r\n    \r\n    updateModeButtonsUI() {\r\n        const translateBtn = document.getElementById('translate-btn');\r\n        const rotateBtn = document.getElementById('rotate-btn');\r\n        const scaleBtn = document.getElementById('scale-btn');\r\n        \r\n        translateBtn.className = this.gizmoMode === 'translate' ? 'active' : '';\r\n        rotateBtn.className = this.gizmoMode === 'rotate' ? 'active' : '';\r\n        scaleBtn.className = this.gizmoMode === 'scale' ? 'active' : '';\r\n    }\r\n    \r\n}"
      },
      "ExportScripts": {
        "fileName": "ExportScripts",
        "script": "class ExportScripts {\r\n  constructor(app) {\r\n     this.app = app;\r\n  }\r\n  export(project) {\r\n      // Initialize JSZip\r\n      const zip = new (this.app.libraryClasses.JSZip)();\r\n\r\n      // Iterate over each script type (e.g., \"renderers\", \"components\")\r\n      Object.keys(project).forEach(scriptType => {\r\n          const scripts = project[scriptType];\r\n\r\n          // Create a folder for the script type\r\n          const folder = zip.folder(`scripts/${scriptType}`);\r\n\r\n          // Iterate over each script key (e.g., \"renderer\", \"component\")\r\n          Object.keys(scripts).forEach(scriptKey => {\r\n              const scriptData = scripts[scriptKey];\r\n              const scriptContent = scriptData.script || ''; // Fallback to empty string if no script\r\n\r\n              // Add the script file to the folder\r\n              folder.file(`${scriptKey}.js`, scriptContent);\r\n          });\r\n      });\r\n\r\n      // Generate the zip file and trigger download\r\n      zip.generateAsync({ type: 'blob' }).then(blob => {\r\n          // Create a temporary URL for the blob\r\n          const url = window.URL.createObjectURL(blob);\r\n\r\n          // Create a temporary link element to trigger download\r\n          const link = document.createElement('a');\r\n          link.href = url;\r\n          link.download = 'scripts.zip'; // Name of the downloaded file\r\n          document.body.appendChild(link);\r\n          link.click();\r\n\r\n          // Clean up\r\n          document.body.removeChild(link);\r\n          window.URL.revokeObjectURL(url);\r\n      }).catch(error => {\r\n          console.error('Error generating zip file:', error);\r\n      });\r\n  }\r\n}"
      },
      "scriptEditor": {
        "fileName": "scriptEditor",
        "script": "class ScriptEditor {\r\n    constructor(gameEditor, config) {\r\n      \r\n        this.gameEditor = gameEditor;\r\n        this.config = config;\r\n        let theme = \"\";\r\n        if( this.gameEditor.getCollections().configs.codeMirror ) {\r\n            theme = this.gameEditor.getCollections().themes[this.gameEditor.getCollections().configs.codeMirror.theme].css;\r\n            if( theme ) { \r\n              let styleTag = document.createElement('style');\r\n              styleTag.innerHTML = theme;\r\n              styleTag.setAttribute('id', 'codeMirrorTheme');\r\n              document.head.append(styleTag);\r\n            }\r\n        }\r\n        this.container = document.getElementById('script-editor-container'); \r\n        this.MIN_HEIGHT = 200;\r\n        this.isDragging = false;\r\n        this.start_y = 0;\r\n        this.start_h = 0;\r\n        this.DEFAULT_HEIGHT = () => document.body.clientHeight - 200;\r\n\t\t\t\tthis.savePropertyName = \"script\";\r\n        if (!this.container) {\r\n            console.error(\"ScriptEditor container not found\");\r\n            return;\r\n        }\r\n\r\n        const textArea = this.container.querySelector('#script-editor');\r\n        if (!textArea) {\r\n            console.error(\"Textarea #script-editor not found\");\r\n            return;\r\n        }\r\n\r\n        this.scriptEditor = CodeMirror.fromTextArea(textArea, {\r\n            mode: 'javascript',\r\n            lineNumbers: true,\r\n            tabSize: 2,\r\n            indentWithTabs: false,\r\n            extraKeys: { 'Ctrl-Space': 'autocomplete' },\r\n            hintOptions: { completeSingle: false }\r\n        });\r\n\r\n        this.scriptEditor.setSize(null, this.DEFAULT_HEIGHT());\r\n\r\n        this.setupEventListeners();\r\n        \r\n        \r\n    }\r\n   \r\n    setupEventListeners() {\r\n     \r\n        document.body.addEventListener('editScript', (event) => {\r\n            this.scriptValue = event.detail.data;\r\n            this.savePropertyName = event.detail.propertyName;\r\n            this.scriptEditor.setValue(this.scriptValue);\r\n            this.scriptEditor.setSize(null, this.DEFAULT_HEIGHT());\r\n            this.scriptEditor.refresh();\r\n            setTimeout(() => {\r\n                this.scriptEditor.refresh();\r\n            }, 100);\r\n        });\r\n        \r\n        const saveBtn = this.container.querySelector('#save-script-btn');\r\n        if (saveBtn) {\r\n            saveBtn.addEventListener('click', () => this.saveScript());\r\n        } else {\r\n            console.warn(\"Save button not found\");\r\n        }\r\n    }\r\n\r\n    saveScript() {\r\n\r\n        if (!this.gameEditor.getCurrentObject()) {\r\n            console.warn(\"No selected object to save script to\");\r\n            return;\r\n        }\r\n        const scriptText = this.scriptEditor.getValue();\r\n   \r\n        const myCustomEvent = new CustomEvent('saveScript', {\r\n            detail: { data: scriptText, propertyName: this.savePropertyName }, \r\n            bubbles: true, \r\n            cancelable: true \r\n        });\r\n\r\n      \r\n        document.body.dispatchEvent(myCustomEvent);\r\n    }\r\n\r\n    destroy() {\r\n        if (this.container && this.container.parentNode) {\r\n            this.container.parentNode.removeChild(this.container);\r\n        }\r\n    }\r\n}\r\n"
      },
      "GE_AnimationManager": {
        "title": "GE_AnimationManager",
        "fileName": "GE_AnimationManager",
        "script": "class GE_AnimationManager {\r\n    constructor(gameEditor, graphicsEditor) {\r\n        this.gameEditor = gameEditor;\r\n        this.graphicsEditor = graphicsEditor;\r\n\r\n        this.isPreviewingAnimation = false;\r\n    }    \r\n\r\n    init() {   \r\n        this.initEventListeners();\r\n    }\r\n    \r\n    initEventListeners() {\r\n        // Button event listeners\r\n        const buttonMappings = {\r\n            'preview-animation': this.togglePreview.bind(this),\r\n            'add-animation': this.addNewAnimation.bind(this),\r\n            'delete-animation': this.deleteAnimation.bind(this),\r\n            'add-frame': this.addFrame.bind(this),\r\n            'delete-frame': this.deleteFrame.bind(this)\r\n        };\r\n        Object.entries(buttonMappings).forEach(([id, handler]) => {\r\n            const button = document.getElementById(id);\r\n            if (button) button.addEventListener('click', handler);\r\n        });\r\n    }\r\n\r\n    setPreviewAnimationState(isPreviewing) {\r\n        this.isPreviewingAnimation = isPreviewing;\r\n        let btn = document.getElementById('preview-animation');\r\n        if (this.isPreviewingAnimation) {\r\n            btn.classList.add(\"active\");\r\n            this.graphicsEditor.gizmoManager.destroyGizmo();\r\n            this.graphicsEditor.shapeManager.destroyOutlines();\r\n        } else {\r\n            this.graphicsEditor.state.currentFrame = 0;\r\n            btn.classList.remove(\"active\");\r\n        }\r\n    }\r\n\r\n    async animatePreview() {\r\n        if (!this.isPreviewingAnimation) return;\r\n        this.graphicsEditor.state.currentFrame = (this.graphicsEditor.state.currentFrame + 1) % this.graphicsEditor.getCurrentAnimation().length;\r\n        await this.graphicsEditor.renderShapes(false);\r\n        setTimeout(this.animatePreview.bind(this), 166); // ~6 FPS, adjust as needed\r\n    }\r\n    \r\n    async togglePreview(e) {\r\n        this.isPreviewingAnimation = !this.isPreviewingAnimation;\r\n        await this.animatePreview();\r\n        this.setPreviewAnimationState(this.isPreviewingAnimation);            \r\n    }\r\n\r\n    \r\n\r\n\r\n    addNewAnimation() {\r\n        const animName = prompt(\"Enter animation name:\", `anim${Object.keys(this.graphicsEditor.state.renderData.animations).length + 1}`);\r\n        if (animName && !this.graphicsEditor.state.renderData.animations[animName]) {\r\n            this.graphicsEditor.state.renderData.animations[animName] = [ ...this.graphicsEditor.state.renderData.animations[\"idle\"] ];\r\n            this.graphicsEditor.state.currentAnimation = animName;\r\n            this.graphicsEditor.state.currentFrame = 0;        \r\n            this.graphicsEditor.refreshShapes(true);\r\n        }\r\n    }\r\n\r\n    deleteAnimation() {\r\n        if (this.graphicsEditor.state.currentAnimation !== \"idle\") {\r\n            delete this.graphicsEditor.getCurrentAnimation();\r\n            this.graphicsEditor.state.currentAnimation = \"idle\";\r\n            this.graphicsEditor.state.currentFrame = 0;\r\n            this.graphicsEditor.state.selectedShapeIndex = -1;\r\n            this.graphicsEditor.refreshShapes(true);\r\n        }\r\n    }\r\n\r\n    addFrame() {\r\n\r\n        let currentFrame = this.graphicsEditor.getCurrentFrame();\r\n        if(!currentFrame){\r\n            currentFrame = {};\r\n        }\r\n        const newFrame = { shapes: JSON.parse(JSON.stringify(currentFrame.shapes || [])) };\r\n        this.graphicsEditor.getCurrentAnimation().splice(this.graphicsEditor.state.currentFrame + 1, 0, newFrame);                    \r\n        this.graphicsEditor.state.currentFrame++;\r\n        this.graphicsEditor.refreshShapes(true);\r\n    \r\n    }\r\n\r\n    deleteFrame() {\r\n        let currentAnimation = this.graphicsEditor.getCurrentAnimation();\r\n        if (currentAnimation.length > 1) {\r\n            currentAnimation.splice(this.graphicsEditor.state.currentFrame, 1);\r\n            \r\n            this.graphicsEditor.state.currentFrame = Math.min(this.graphicsEditor.state.currentFrame, currentAnimation.length - 1);\r\n            this.graphicsEditor.refreshShapes(true);\r\n        }\r\n    }\r\n}"
      },
      "Entity": {
        "fileName": "Entity",
        "script": "class Entity {\r\n    constructor(game, x, y, type) {\r\n        this.game = game;\r\n        this.moduleManager = game.moduleManager;\r\n        this.position = { x: x, y: y, z: 0};\r\n        this.components = [];\r\n        this.renderers = [];\r\n        this.destroyed = false;        \r\n        this.id = ++game.entityId;\r\n        this.type = type;\r\n        this.gridPosition = { x: 0, y: 0};\r\n        this.drawPosition = { x: 0, y: 0};\r\n        this.lastPosition = {...this.position};\r\n        this.lastGridPosition = {...this.gridPosition};\r\n        this.lastDrawPosition = {...this.drawPosition};\r\n        if(this.game.gameEntity){\r\n            this.setGridPosition();\r\n            this.position.z = this.getCurrentTerrainHeight();\r\n        }\r\n    }\r\n\r\n    getCurrentTerrainHeight(){\r\n        return this.game.gameEntity.getComponent('game').getTerrainHeight(this.gridPosition);\r\n    }\r\n\r\n    getComponent(name) {\r\n        return this.components[name.toLowerCase()] || this.components[`${name.toLowerCase()}`];\r\n    }\r\n    addRenderer(RendererClassName, params) {\r\n        const RendererClass = this.moduleManager.getCompiledScript(RendererClassName, 'renderers');\r\n        const renderer = new RendererClass(this.game, this, params);\r\n        this.renderers[RendererClass.name.toLowerCase()] = renderer;\r\n        this.components[RendererClass.name.toLowerCase()] = renderer;\r\n        return renderer;\r\n    }\r\n    addComponent(ComponentClassName, params) {        \r\n        const ComponentClass = this.moduleManager.getCompiledScript(ComponentClassName, 'components');\r\n        const component = new ComponentClass(this.game, this, params);\r\n        this.components[ComponentClass.name.toLowerCase()] = component;\r\n        return component;\r\n    }\r\n    removeComponent(component) {\r\n        let index = this.components.indexOf(component);\r\n        if( index >= 0 ) {\r\n            this.components.splice(index, 1);\r\n        }\r\n    }\r\n    setGridPosition() {\r\n        if(this.game.translator){\r\n            let gridPosition = this.game.translator.pixelToGrid( this.position.x, this.position.y ); \r\n            this.gridPosition = this.game.translator.snapToGrid(gridPosition.x, gridPosition.y);   \r\n            return;\r\n        }\r\n        this.gridPosition = { x: 0, y: 0 };\r\n    }\r\n    updateLastPositions() {\r\n        this.lastPosition = {...this.position};\r\n        this.lastGridPosition = {...this.gridPosition};\r\n        this.lastDrawPosition = {...this.drawPosition};         \r\n    }\r\n    \r\n    getCurrentTile() {                     \r\n        if(this.game.state.tileMap.length > this.gridPosition.y && this.gridPosition.y > 0 && this.game.state.tileMap[Math.floor(this.gridPosition.y)] && this.game.state.tileMap[Math.floor(this.gridPosition.y)].length > this.gridPosition.x && this.gridPosition.x > 0){\r\n            return this.game.state.tileMap[Math.floor(this.gridPosition.y)][Math.floor(this.gridPosition.x)];\r\n        }\r\n        return { typeId: 0};\r\n    }\r\n    update() {    \r\n        this.setGridPosition();\r\n        for(let c in this.components) {\r\n            this.components[c].update();   \r\n            this.setGridPosition();\r\n            if(this.destroyed) break;\r\n        }                \r\n        return !this.destroyed;\r\n    }\r\n    postUpdate() {\r\n        for(let c in this.components) {\r\n            this.components[c].postUpdate();   \r\n            if(this.destroyed) break;\r\n        }     \r\n        this.updateLastPositions(); \r\n        return !this.destroyed;\r\n    }\r\n    draw() {\r\n        const isoPos = this.game.translator.pixelToIso(this.position.x, this.position.y);    \r\n        this.drawPosition = { x: isoPos.x, y: isoPos.y };\r\n\r\n        for(let r in this.renderers) {\r\n            this.renderers[r].draw();  \r\n        }\r\n\r\n    }\r\n    destroy() {\r\n        this.destroyed = true;\r\n        for(let c in this.components) {\r\n            this.components[c].destroy();   \r\n        }   \r\n        for(let r in this.renderers) {\r\n            this.renderers[r].destroy();   \r\n        }   \r\n    }\r\n}"
      },
      "Component": {
        "fileName": "Component",
        "script": "class Component {\r\n    constructor(game, parent, params) { \r\n        this.game = game;\r\n        this.parent = parent;\r\n        this.init(params);\r\n    }\r\n    init(params) {}\r\n    getComponent(type) {\r\n        return this.parent.getComponent(type);\r\n    }\r\n    update() {}\r\n    postUpdate() {}\r\n    destroy() {}\r\n}\r\n"
      },
      "GE_ShapeManager": {
        "title": "GE_ShapeManager",
        "fileName": "GE_ShapeManager",
        "script": "class GE_ShapeManager {\r\n    constructor(gameEditor, graphicsEditor) {\r\n        this.gameEditor = gameEditor;\r\n        this.graphicsEditor = graphicsEditor;\r\n        this.originalMaterials = new Map();\r\n        \r\n    }    \r\n\r\n    init() {   \r\n        this.initEventListeners();\r\n\r\n    }\r\n    initEventListeners() {\r\n        // Button event listeners\r\n        const buttonMappings = {\r\n            'add-shape': this.addSelectedShape.bind(this),\r\n            'delete-shape': this.deleteSelectedShape.bind(this)\r\n        };\r\n        Object.entries(buttonMappings).forEach(([id, handler]) => {\r\n            const button = document.getElementById(id);\r\n            if (button) button.addEventListener('click', handler);\r\n        });\r\n        \r\n        document.getElementById('move-cancel').addEventListener('click', () => {            \r\n            const inspector = document.getElementById('inspector');\r\n            inspector.innerHTML = ``;\r\n        });\r\n    }\r\n    getShapeData(shapeId){\r\n        let currentGroup = this.graphicsEditor.getCurrentGroup();\r\n        if(!currentGroup){\r\n            currentGroup = { shapes: [] };\r\n            let currentAnimation = this.graphicsEditor.getCurrentAnimation();\r\n            let currentFrame = currentAnimation[this.graphicsEditor.state.currentFrame];\r\n            if(!currentFrame){\r\n                currentFrame = {};\r\n            }\r\n            currentFrame[this.graphicsEditor.state.currentGroup] = currentGroup;\r\n            currentAnimation[this.graphicsEditor.state.currentFrame] = currentFrame;\r\n        }\r\n        currentGroup.shapes = currentGroup.shapes || [];\r\n        if(currentGroup.shapes.length == 0){\r\n            let shapeData = JSON.parse(JSON.stringify(this.graphicsEditor.state.renderData.model[this.graphicsEditor.state.currentGroup])).shapes[shapeId];\r\n            shapeData.id = shapeId;\r\n            currentGroup.shapes = [shapeData];\r\n            return shapeData;\r\n        }\r\n        let shapeData = (currentGroup.shapes).find(s => s.id == shapeId);\r\n        if(this.graphicsEditor.state.editingModel){\r\n            shapeData = currentGroup.shapes[shapeId];\r\n        }\r\n        return shapeData;\r\n    }\r\n    selectShape(index) {\r\n        if (this.graphicsEditor.animationManager.isPreviewingAnimation) {\r\n            this.graphicsEditor.setPreviewAnimationState(false);\r\n        }\r\n        \r\n        // Toggle selection if clicking the same shape\r\n        this.graphicsEditor.state.selectedShapeIndex = (this.graphicsEditor.state.selectedShapeIndex === index) ? -1 : index;\r\n\r\n        // Update shape list and highlighting\r\n        this.graphicsEditor.uiManager.updateList();\r\n        // Show inspector for selected shape\r\n        const shape = this.graphicsEditor.getMergedShape();\r\n        if (shape) {\r\n            this.highlightSelectedShape();\r\n            this.graphicsEditor.createInspector(shape);\r\n            this.graphicsEditor.gizmoManager.transformSelectedObject();\r\n        } else {\r\n            this.destroyOutlines();\r\n            this.graphicsEditor.gizmoManager.destroyGizmo();\r\n            this.graphicsEditor.groupManager.selectGroup(this.graphicsEditor.state.currentGroup);\r\n        }\r\n    }\r\n    destroyOutlines() {\r\n        // Remove existing outlines\r\n        this.graphicsEditor.sceneRenderer.scene.children.forEach(obj => {\r\n            if (obj.userData.isOutline) {\r\n                this.graphicsEditor.sceneRenderer.scene.remove(obj);\r\n                if (obj.geometry) obj.geometry.dispose();\r\n                if (obj.material) obj.material.dispose();\r\n            }\r\n        });\r\n    \r\n        // Reset any highlighted materials\r\n        this.originalMaterials.forEach((material, object) => {\r\n            object.material = material;\r\n        });\r\n        this.originalMaterials.clear();\r\n    }\r\n    highlightSelectedShape() {\r\n        this.destroyOutlines();\r\n\r\n    \r\n        // If no shape is selected or invalid selection, return\r\n        if (this.graphicsEditor.state.selectedShapeIndex < 0) {\r\n            return;\r\n        }\r\n    \r\n        // Get the selected group name from state\r\n        const currentGroup = this.graphicsEditor.state.currentGroup;\r\n        if (!currentGroup) {\r\n            console.warn(\"No group selected\");\r\n            return;\r\n        }\r\n    \r\n        // Find the THREE.Group with matching name under rootGroup\r\n        let selectedGroup = null;\r\n        this.graphicsEditor.rootGroup.traverse(obj => {\r\n            if (obj.isGroup && obj.name === currentGroup) {\r\n                selectedGroup = obj;\r\n            }\r\n        });\r\n    \r\n        if (!selectedGroup) {\r\n            console.warn(`No group found with name ${currentGroup}`);\r\n            return;\r\n        }\r\n    \r\n        const currentFrameData = this.graphicsEditor.getCurrentFrame();\r\n    \r\n        if (!currentFrameData) {\r\n            console.warn(\"No frame data found\");\r\n            return;\r\n        }\r\n    \r\n        const groupShapes = currentFrameData[currentGroup];\r\n    \r\n        if (!groupShapes || this.graphicsEditor.state.selectedShapeIndex >= groupShapes.length) {\r\n            console.warn(`Invalid shape index ${this.graphicsEditor.state.selectedShapeIndex} for group ${currentGroup}`);\r\n            return;\r\n        }\r\n    \r\n        // Find all meshes belonging to the selected shape within the group\r\n        const selectedMeshes = [];\r\n        selectedGroup.traverse(obj => {\r\n            if (obj.isMesh && (\r\n                // Direct shape object that matches the index\r\n                (obj.userData.isShape &&\r\n                 obj.userData.index === this.graphicsEditor.state.selectedShapeIndex) ||\r\n                // Parent is a shape object that matches the index\r\n                (obj.parent &&\r\n                 obj.parent.userData.isShape &&\r\n                 obj.parent.userData.index === this.graphicsEditor.state.selectedShapeIndex) ||\r\n                // GLTF child of selected shape that matches the index\r\n                (obj.userData.isGLTFChild &&\r\n                 obj.parent &&\r\n                 obj.parent.userData.index === this.graphicsEditor.state.selectedShapeIndex)\r\n            )) {\r\n                selectedMeshes.push(obj);\r\n            }\r\n        });\r\n    \r\n        // Handle highlighting for all relevant meshes\r\n        selectedMeshes.forEach(mesh => {\r\n            // Apply emissive highlight to original mesh\r\n            this.originalMaterials.set(mesh, mesh.material);\r\n            const highlightMaterial = mesh.material.clone();\r\n            highlightMaterial.emissive = new window.THREE.Color(0x555555);\r\n            highlightMaterial.emissiveIntensity = 0.5;\r\n            mesh.material = highlightMaterial;\r\n    \r\n            // Create the outline geometry\r\n            const outlineGeometry = mesh.geometry.clone();\r\n            const outlineMaterial = new window.THREE.MeshBasicMaterial({\r\n                color: 0xffff00,\r\n                side: window.THREE.BackSide\r\n            });\r\n    \r\n            // Create the outline mesh\r\n            const outline = new window.THREE.Mesh(outlineGeometry, outlineMaterial);\r\n            outline.userData.isOutline = true;\r\n            \r\n            // Create a new group to hold the outline\r\n            let outlineGroup = new window.THREE.Group();\r\n            outlineGroup.userData.isOutline = true;\r\n            \r\n            // Add the outline to the group\r\n            outlineGroup.add(outline);\r\n            \r\n            // Find all parent groups up to rootGroup and copy their transformations\r\n            let currentParent = mesh.parent;\r\n            let transformChain = [];\r\n            \r\n            while (currentParent && currentParent !== this.graphicsEditor.rootGroup) {\r\n                transformChain.unshift({\r\n                    position: currentParent.position.clone(),\r\n                    rotation: currentParent.rotation.clone(),\r\n                    scale: currentParent.scale.clone(),\r\n                    quaternion: currentParent.quaternion.clone()\r\n                });\r\n                currentParent = currentParent.parent;\r\n            }\r\n            \r\n            // Apply all parent transformations to our outline group\r\n            transformChain.forEach(transform => {\r\n                // Create a temporary group to apply each parent's transform\r\n                const tempGroup = new window.THREE.Group();\r\n                tempGroup.position.copy(transform.position);\r\n                tempGroup.rotation.copy(transform.rotation);\r\n                tempGroup.scale.copy(transform.scale);\r\n                \r\n                // Add our current group to this temp group\r\n                tempGroup.add(outlineGroup);\r\n                \r\n                // Move outlineGroup up one level\r\n                outlineGroup = tempGroup;\r\n                outlineGroup.userData.isOutline = true;\r\n            });\r\n            \r\n            // Add mesh's local transform\r\n            outline.position.copy(mesh.position);\r\n            outline.rotation.copy(mesh.rotation);\r\n            outline.scale.copy(mesh.scale);\r\n            \r\n            // Scale the outline slightly larger (in local space)\r\n            outline.scale.multiplyScalar(1.05);\r\n            \r\n            // Add the complete outline group to the scene\r\n            this.graphicsEditor.sceneRenderer.scene.add(outlineGroup);\r\n        });\r\n    }\r\n    addNewShape() {\r\n        if(!this.graphicsEditor.state.editingModel) {            \r\n            return;\r\n        }\r\n        const newShape = {\r\n            type: 'sphere',\r\n            size: 2,\r\n            color: '#ff0000',\r\n            x: 0,\r\n            y: 0,\r\n            z: 0,\r\n            rotationX: 0,\r\n            rotationY: 0,\r\n            rotationZ: 0\r\n        };\r\n        this.graphicsEditor.getCurrentGroup().shapes.push(newShape);\r\n        this.graphicsEditor.state.selectedShapeIndex = this.graphicsEditor.getCurrentGroup().shapes.length - 1;\r\n        this.graphicsEditor.refreshShapes(true); \r\n    }\r\n\r\n    addSelectedShape() {\r\n        if(!this.graphicsEditor.state.editingModel) {            \r\n            return;\r\n        }\r\n        if (this.graphicsEditor.state.selectedShapeIndex >= 0) {\r\n            const originalShape = this.graphicsEditor.state.editingModel ? \r\n                                    this.graphicsEditor.getCurrentGroup().shapes[this.graphicsEditor.state.selectedShapeIndex] : \r\n                                    this.graphicsEditor.getCurrentGroup().shapes.find(s => s.id == this.graphicsEditor.state.selectedShapeIndex);\r\n            const newShape = JSON.parse(JSON.stringify(originalShape));\r\n            this.graphicsEditor.getCurrentGroup().shapes.push(newShape);\r\n            this.graphicsEditor.state.selectedShapeIndex = this.graphicsEditor.getCurrentGroup().shapes.length - 1;\r\n            this.graphicsEditor.refreshShapes(true);\r\n        } else {\r\n            this.addNewShape();\r\n        }\r\n    }\r\n\r\n    deleteSelectedShape() {\r\n        if(!this.graphicsEditor.state.editingModel) {            \r\n            return;\r\n        }\r\n        if (this.graphicsEditor.state.selectedShapeIndex >= 0) {\r\n            this.graphicsEditor.getCurrentGroup().shapes.splice(this.graphicsEditor.state.selectedShapeIndex, 1);\r\n            if (this.graphicsEditor.getCurrentGroup().shapes.length > 0) {\r\n                this.graphicsEditor.state.selectedShapeIndex = Math.min(this.graphicsEditor.state.selectedShapeIndex, this.graphicsEditor.getCurrentGroup().shapes.length - 1);\r\n            } else {\r\n                this.graphicsEditor.state.selectedShapeIndex = -1;\r\n            }\r\n            this.graphicsEditor.refreshShapes(true);\r\n        }\r\n    }\r\n\r\n}"
      },
      "CoordinateTranslator": {
        "fileName": "CoordinateTranslator",
        "script": "class CoordinateTranslator {\r\n    constructor(config, mapSize, isometric = false) {\r\n        this.isometric = isometric;\r\n        this.tileWidth = config.gridSize;\r\n        this.tileHeight = config.gridSize * 0.5;\r\n        this.canvasWidth = config.canvasWidth;\r\n        this.canvasHeight = config.canvasHeight;\r\n        this.mapSize = mapSize;\r\n    }\r\n\r\n    // Pixel (top-down) to Grid\r\n    pixelToGrid(pixelX, pixelY) {\r\n        return {\r\n            x: pixelX / this.tileWidth,\r\n            y: pixelY / this.tileWidth\r\n        };\r\n    }\r\n\r\n    // Grid to Isometric (with vertical centering)\r\n    gridToIso(gridX, gridY) {\r\n        // If not isometric, return grid coordinates as-is\r\n        if (!this.isometric) {\r\n            return { x: gridX * this.tileWidth, y: gridY * this.tileWidth };\r\n        }\r\n\r\n        const isoX = (gridX - gridY) * (this.tileWidth / 2) + this.canvasWidth / 2;\r\n       \r\n        // Calculate the height the grid would occupy\r\n        const totalGridHeight = this.mapSize * this.tileHeight;\r\n       \r\n        // Center vertically by adding an offset\r\n        const verticalOffset = (this.canvasHeight - totalGridHeight) / 2;\r\n       \r\n        const isoY = (gridX + gridY) * (this.tileHeight / 2) + verticalOffset;\r\n       \r\n        return { x: isoX, y: isoY };\r\n    }\r\n\r\n    // Pixel (top-down) to Isometric\r\n    pixelToIso(pixelX, pixelY) {\r\n        if(!this.isometric){\r\n            return {\r\n                x: pixelX + ( this.canvasWidth - this.mapSize * this.tileWidth) / 2,\r\n                y: pixelY + ( this.canvasHeight - this.mapSize * this.tileWidth) / 2\r\n            }\r\n        }\r\n        const grid = this.pixelToGrid(pixelX, pixelY);\r\n        return this.gridToIso(grid.x, grid.y);\r\n    }\r\n\r\n    isoToGrid(isoX, isoY) {\r\n        // If not isometric, convert directly to grid\r\n        if (!this.isometric) {\r\n            return {\r\n                x: isoX / this.tileWidth,\r\n                y: isoY / this.tileWidth\r\n            };\r\n        }\r\n\r\n        const adjustedX = isoX - this.canvasWidth / 2;\r\n       \r\n        // Calculate the same vertical offset as in gridToIso\r\n        const totalGridHeight = this.mapSize * this.tileHeight;\r\n        const verticalOffset = (this.canvasHeight - totalGridHeight) / 2;\r\n       \r\n        // Subtract the offset before conversion\r\n        const adjustedY = isoY - verticalOffset;\r\n       \r\n        const gridX = (adjustedX / (this.tileWidth / 2) + adjustedY / (this.tileHeight / 2)) / 2;\r\n        const gridY = (adjustedY / (this.tileHeight / 2) - adjustedX / (this.tileWidth / 2)) / 2;\r\n       \r\n        return { x: gridX, y: gridY };\r\n    }\r\n\r\n    isoToPixel(isoX, isoY) {\r\n        const grid = this.isoToGrid(isoX, isoY);\r\n        return {\r\n            x: grid.x * this.tileWidth,\r\n            y: grid.y * this.tileWidth\r\n        };\r\n    }\r\n\r\n    // Snap grid coordinates to nearest integer\r\n    snapToGrid(gridX, gridY) {\r\n        return { x: Math.floor(gridX), y: Math.floor(gridY) };\r\n    }\r\n}"
      },
      "terrainMapEditor": {
        "fileName": "terrainMapEditor",
        "script": "class TerrainMapEditor {\r\n    constructor(gameEditor, config = {}, { TileMap, TerrainImageProcessor, CoordinateTranslator, ImageManager, ShapeFactory }) {\r\n        this.gameEditor = gameEditor;\r\n        this.engineClasses = { TileMap, TerrainImageProcessor, CoordinateTranslator, ImageManager, ShapeFactory };\r\n        this.defaultConfig = { gridSize: 48, imageSize: 128, canvasWidth: 1536, canvasHeight: 768 };\r\n        this.config = { ...this.defaultConfig, ...config };\r\n    \r\n        this.defaultMapSize = 16;\r\n        this.mapSize = this.defaultMapSize;\r\n        this.currentTerrainId = 3; // Default to grass (index 3)\r\n        this.isMouseDown = false;\r\n        this.objectData = {};\r\n        // Terrain map structure without explicit IDs\r\n        this.tileMap = {\r\n            size: 16,\r\n            terrainBGColor: \"#7aad7b\",\r\n            terrainTypes: [\r\n                { type: \"start\", color: \"#ffff00\", image: [] },\r\n                { type: \"end\", color: \"#ff0000\", image: [] },\r\n                { type: \"path\", color: \"#eeae9e\", image: [] },\r\n                { type: \"grass\", color: \"#7aad7b\", image: [] },\r\n                { type: \"water\", color: \"#64b5f6\", image: [] },\r\n                { type: \"rock\", color: \"#9e9e9e\", image: [] }\r\n            ],\r\n            terrainMap: []\r\n        };\r\n        this.environmentObjects = this.tileMap.environmentObjects || [];\r\n        this.selectedEnvironmentType = null;\r\n        this.selectedEnvironmentItem = null;\r\n        this.placementMode = 'terrain'; // can be 'terrain' or 'environment'\r\n        this.worldObjects = [];\r\n        this.terrainTypesContainer = null;\r\n        this.draggedItem = null;\r\n        this.dragOverItem = null; // Track the item being dragged over\r\n\r\n        // DOM elements\r\n        this.canvasEl = document.getElementById('grid');\r\n        this.canvasEl.width = this.config.canvasWidth;\r\n        this.canvasEl.height = this.config.canvasHeight;\r\n\r\n        // Preview elements for cursor\r\n        this.previewCanvas = null;\r\n        this.currentPreviewImage = null;\r\n\r\n        // Managers and renderers\r\n        let palette = this.gameEditor.getPalette();\r\n        this.imageManager = new this.engineClasses.ImageManager(this.gameEditor,  { imageSize: this.config.imageSize, palette: palette}, {ShapeFactory: ShapeFactory});\r\n        this.mapRenderer = null;\r\n        this.mapManager = null;\r\n\r\n        this.translator = new this.engineClasses.CoordinateTranslator(this.config, this.tileMap.size, this.gameEditor.getCollections().configs.game.isIsometric);\r\n        this.terrainCanvasBuffer = document.createElement('canvas');\r\n        this.terrainCanvasBuffer.width = this.tileMap.size * this.gameEditor.getCollections().configs.game.gridSize;\r\n        this.terrainCanvasBuffer.height =  this.tileMap.size * this.gameEditor.getCollections().configs.game.gridSize;\r\n        this.modalId = 'modal-addTerrainType';\r\n        // Bind methods to maintain correct context\r\n        this.init();\r\n    }\r\n\r\n    init() {\r\n        this.setupTerrainTypesUI();\r\n        this.setupTerrainImageProcessor();\r\n        this.setupEnvironmentPanel();\r\n        this.createPreviewCanvas();\r\n        this.setupEventListeners();\r\n        this.updateTerrainStyles();\r\n    }\r\n\r\n    setupEventListeners() {\r\n\r\n        document.getElementById('terrainColor').addEventListener('change', (el) => {                    \r\n            document.getElementById('terrainColorText').value = el.target.value;\r\n        });\r\n        document.getElementById('terrainTexture').addEventListener('change', (ev) => {\r\n            const textureName = ev.target.value;\r\n            if (textureName) {\r\n                this.tileMap.terrainTypes[this.currentTerrainId].texture = textureName;\r\n                this.terrainImageProcessor.processImage(this.gameEditor.getCollections().textures[textureName].image);\r\n            }\r\n        });\r\n        document.getElementById('terrainMapSize').addEventListener('change', (ev) => {    \r\n            const newGridSize = parseInt(ev.target.value);\r\n            const oldGridSize = this.tileMap.size;\r\n            \r\n            // Create a new map to hold the resized terrain\r\n            const newTerrainMap = [];\r\n            for (let i = 0; i < newGridSize; i++) {\r\n                newTerrainMap.push(new Array(newGridSize));\r\n            }\r\n            \r\n            // Calculate offsets for maintaining center\r\n            const oldOffset = Math.floor(oldGridSize / 2);\r\n            const newOffset = Math.floor(newGridSize / 2);\r\n            \r\n            // Fill the new map\r\n            for (let newI = 0; newI < newGridSize; newI++) {\r\n                for (let newJ = 0; newJ < newGridSize; newJ++) {\r\n                    const absI = newI - newOffset;\r\n                    const absJ = newJ - newOffset;\r\n                    \r\n                    const oldI = absI + oldOffset;\r\n                    const oldJ = absJ + oldOffset;\r\n                    \r\n                    if (oldI >= 0 && oldI < oldGridSize && oldJ >= 0 && oldJ < oldGridSize) {\r\n                        // Copy existing terrain\r\n                        newTerrainMap[newI][newJ] = this.tileMap.terrainMap[oldI][oldJ];\r\n                    } else {\r\n                        // Use nearest edge value for new areas\r\n                        const clampedI = Math.max(0, Math.min(oldGridSize - 1, oldI));\r\n                        const clampedJ = Math.max(0, Math.min(oldGridSize - 1, oldJ));\r\n                        newTerrainMap[newI][newJ] = this.tileMap.terrainMap[clampedI][clampedJ];\r\n                    }\r\n                }\r\n            }\r\n            \r\n            // Update tileMap with new terrain\r\n            this.tileMap.terrainMap = newTerrainMap;\r\n            this.tileMap.size = newGridSize;\r\n            this.translator = new this.engineClasses.CoordinateTranslator(this.config, newGridSize, this.gameEditor.getCollections().configs.game.isIsometric);\r\n            \r\n            this.updateTerrainStyles();\r\n            this.setupTerrainTypesUI();\r\n            this.initGridCanvas();\r\n            this.exportMap();\r\n        });\r\n        document.getElementById('extensionTerrainType').addEventListener('change', (ev) => {    \r\n            const newTerrainType = parseInt(ev.target.value);            \r\n            this.tileMap.extensionTerrainType = newTerrainType;\r\n            this.initGridCanvas();\r\n            this.exportMap();\r\n        });\r\n       \r\n        // Handle mouseup event (stop dragging)\r\n        document.addEventListener('mouseup', () => {\r\n            this.isMouseDown = false;\r\n        });\r\n\r\n        // Add mouse down event for canvas\r\n        this.canvasEl.addEventListener('mousedown', (e) => {\r\n            if (e.button === 0) { // Left click\r\n                if (this.deleteMode && this.tileMap.environmentObjects) {\r\n                    this.deleteEnvironmentObjectAt(e);\r\n                } else {\r\n                    this.isMouseDown = true;\r\n                    this.handleCanvasInteraction(e);\r\n                }\r\n            }\r\n        });\r\n        \r\n        // Add mouse move event for drawing while dragging\r\n        this.canvasEl.addEventListener('mousemove', (e) => {\r\n            this.updatePreviewPosition(e);\r\n            \r\n            if (this.isMouseDown) {\r\n                this.handleCanvasInteraction(e);\r\n            }\r\n        });\r\n\r\n        // Add translation event listeners\r\n        document.getElementById('translate-left').addEventListener('click', () => this.translateMap(-1, 0));\r\n        document.getElementById('translate-right').addEventListener('click', () => this.translateMap(1, 0));\r\n        document.getElementById('translate-up').addEventListener('click', () => this.translateMap(0, -1));\r\n        document.getElementById('translate-down').addEventListener('click', () => this.translateMap(0, 1));\r\n\r\n        // Handle editTileMap event\r\n        document.body.addEventListener('editTileMap', async (event) => {\r\n            this.config = event.detail.config;\r\n            this.tileMap = event.detail.data;\r\n            this.objectData = event.detail.objectData;\r\n            this.savePropertyName = event.detail.propertyName;\r\n            const world = this.objectData.world ? this.gameEditor.getCollections().worlds[this.objectData.world] : null;\r\n            this.worldObjects = {};\r\n            if(world){\r\n                const worldObjectNames = world.worldObjects || [];             \r\n                worldObjectNames.forEach((objectName) => {\r\n                    this.worldObjects[objectName] = this.gameEditor.getCollections().worldObjects[objectName];\r\n                });\r\n            }\r\n            this.canvasEl.width = this.config.canvasWidth;\r\n            this.canvasEl.height = this.config.canvasHeight;            \r\n            //this.gameEditor.setColorValue(document.getElementById('terrainBGColorContainer'), this.tileMap.terrainBGColor || \"#7aad7b\"); \r\n            if(this.tileMap.extensionTerrainType){\r\n                this.canvasEl.backgroundColor = this.tileMap.terrainTypes[this.tileMap.extensionTerrainType].color;\r\n            } else {\r\n                this.canvasEl.backgroundColor = this.tileMap.terrainTypes[4].color;\r\n                this.tileMap.extensionTerrainType = 4; // Default to grass if not set\r\n            }\r\n\r\n            if (!this.tileMap.environmentObjects) {\r\n                this.tileMap.environmentObjects = [];\r\n            }\r\n            const extensionTerrainTypeSelector = document.getElementById('extensionTerrainType');\r\n            // Strip id from terrainTypes if present, assume order is correct\r\n            this.tileMap.terrainTypes.forEach((terrain, index) => {\r\n                const newOption = document.createElement('option');\r\n                newOption.value = index;\r\n                newOption.textContent = terrain.type;\r\n                if (index === this.tileMap.extensionTerrainType) {\r\n                    newOption.selected = true;\r\n                }\r\n                extensionTerrainTypeSelector.appendChild(newOption);\r\n            });\r\n        \r\n            // No need to remap terrainMap; assume it already uses indices matching the order\r\n            // If terrainMap has invalid indices, clamp them to valid range\r\n            if (this.tileMap.terrainMap && this.tileMap.terrainMap.length > 0) {\r\n                const maxIndex = this.tileMap.terrainTypes.length - 1;\r\n                for (let y = 0; y < this.tileMap.terrainMap.length; y++) {\r\n                    for (let x = 0; x < this.tileMap.terrainMap[y].length; x++) {\r\n                        const currentValue = this.tileMap.terrainMap[y][x];\r\n                        if (currentValue > maxIndex || currentValue < 0) {\r\n                            this.tileMap.terrainMap[y][x] = 0; // Clamp invalid values to 0\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            \r\n            // Update grid size if it's different\r\n            if (this.tileMap.size && this.tileMap.size !== this.mapSize) {\r\n                this.mapSize = this.tileMap.size;\r\n                this.translator = new this.engineClasses.CoordinateTranslator(this.config, this.mapSize, this.gameEditor.getCollections().configs.game.isIsometric);\r\n            } else {\r\n                this.mapSize = this.defaultMapSize;\r\n                this.translator = new this.engineClasses.CoordinateTranslator(this.config, this.mapSize, this.gameEditor.getCollections().configs.game.isIsometric);\r\n            }\r\n            \r\n            document.getElementById('terrainMapSize').value = this.mapSize;\r\n            requestAnimationFrame(() => {\r\n                // Load terrain types if provided\r\n                this.updateTerrainStyles();\r\n                this.setupTerrainTypesUI();\r\n                this.initGridCanvas();\r\n            });\r\n        });\r\n\r\n        document.getElementById('terrainsBtn').addEventListener('click', () => {\r\n            document.getElementById('terrainsBtn').classList.add('active');\r\n            document.getElementById('environmentBtn').classList.remove('active');\r\n            \r\n            document.getElementById('terrainsPanel').style.display = 'block';\r\n            document.getElementById('environmentPanel').style.display = 'none';\r\n            this.placementMode = 'terrain';\r\n            this.previewCanvas.style.display = 'none';\r\n            // Update placement indicator\r\n            this.placementModeIndicator.textContent = 'Placement Mode: Terrain';\r\n            this.placementModeIndicator.style.opacity = '1';\r\n            \r\n            // Hide indicator after a delay\r\n            clearTimeout(this.indicatorTimeout);\r\n            this.indicatorTimeout = setTimeout(() => {\r\n                this.placementModeIndicator.style.opacity = '0';\r\n            }, 2000);\r\n        });\r\n        \r\n        document.getElementById('environmentBtn').addEventListener('click', () => {\r\n            document.getElementById('terrainsBtn').classList.remove('active');\r\n            document.getElementById('environmentBtn').classList.add('active');\r\n            document.getElementById('terrainsPanel').style.display = 'none';\r\n            document.getElementById('environmentPanel').style.display = 'block';\r\n            this.placementMode = 'environment';\r\n            \r\n            // Make sure environment panel is set up\r\n            this.setupEnvironmentPanel();\r\n            this.placementModeIndicator.textContent = 'Placement Mode: Environment';\r\n            this.placementModeIndicator.style.opacity = '1';\r\n            \r\n            // Hide indicator after a delay\r\n            clearTimeout(this.indicatorTimeout);\r\n            this.indicatorTimeout = setTimeout(() => {\r\n                this.placementModeIndicator.style.opacity = '0';\r\n            }, 2000);\r\n        });\r\n        this.canvasEl.addEventListener('contextmenu', (e) => {\r\n            e.preventDefault(); // Prevent default context menu\r\n            \r\n            if (this.placementMode === 'environment' && this.tileMap.environmentObjects) {\r\n                this.deleteEnvironmentObjectAt(e);\r\n            }\r\n        });\r\n    }\r\n\r\n    async initImageManager() {\r\n        let palette = this.gameEditor.getPalette();\r\n        this.imageManager = new this.engineClasses.ImageManager(this.gameEditor, { imageSize: this.config.imageSize, palette: palette}, {ShapeFactory: this.engineClasses.ShapeFactory});\r\n        await this.imageManager.loadImages(\"levels\", { level: { tileMap: this.tileMap } }, false, false);\r\n        if(this.worldObjects){\r\n            await this.imageManager.loadImages(\"environment\", this.worldObjects, false, false);\r\n        }\r\n        const terrainImages = this.imageManager.getImages(\"levels\", \"level\");\r\n\r\n        this.terrainTileMapper = this.gameEditor.editorModuleInstances.TileMap;\r\n        if(!this.terrainCanvasBuffer) {\r\n            this.terrainCanvasBuffer = document.createElement('canvas');\r\n        }\r\n        this.terrainCanvasBuffer.width = this.tileMap.size * this.gameEditor.getCollections().configs.game.gridSize;\r\n        this.terrainCanvasBuffer.height =  this.tileMap.size * this.gameEditor.getCollections().configs.game.gridSize;\r\n\r\n        this.terrainTileMapper.init(this.terrainCanvasBuffer, this.gameEditor.getCollections().configs.game.gridSize, terrainImages, this.gameEditor.getCollections().configs.game.isIsometric);\r\n        this.game = { state: {}, terrainTileMapper: this.terrainTileMapper, config: this.gameEditor.getCollections(), translator: this.translator };\r\n\r\n        this.mapRenderer = new (this.gameEditor.scriptContext.getRenderer(\"MapRenderer\"))(this.game, null,\r\n            { \r\n                gameConfig: this.config, \r\n                terrainCanvasBuffer: this.terrainCanvasBuffer, \r\n                canvasBuffer: this.canvasEl, \r\n                environment: this.worldObjects, \r\n                imageManager: this.imageManager, \r\n                levelName: 'level', \r\n                level: { tileMap: this.tileMap },\r\n                isEditor: true,\r\n                palette: palette\r\n            }\r\n        );\r\n    }\r\n    updatePreviewImage() {\r\n        if (!this.selectedEnvironmentType || this.selectedEnvironmentItem === null) {\r\n            this.currentPreviewImage = null;\r\n            return;\r\n        }\r\n        \r\n        const images = this.imageManager.getImages(\"environment\", this.selectedEnvironmentType);\r\n        if (!images || !images.idle || !images.idle[0] || !images.idle[0][this.selectedEnvironmentItem]) {\r\n            this.currentPreviewImage = null;\r\n            return;\r\n        }\r\n        \r\n        const image = images.idle[0][this.selectedEnvironmentItem];\r\n        this.currentPreviewImage = image;\r\n        \r\n        // Resize preview canvas if needed\r\n        const maxDimension = Math.max(image.width, image.height);\r\n        const scale = this.config.imageSize / maxDimension;\r\n        \r\n        this.previewCanvas.width = image.width * scale;\r\n        this.previewCanvas.height = image.height * scale;\r\n        \r\n        const ctx = this.previewCanvas.getContext('2d');\r\n        ctx.clearRect(0, 0, this.previewCanvas.width, this.previewCanvas.height);\r\n        ctx.drawImage(image, 0, 0, this.previewCanvas.width, this.previewCanvas.height);\r\n    }\r\n    updatePreviewPosition(e) {\r\n        if (this.placementMode !== 'environment' || \r\n            !this.selectedEnvironmentType || \r\n            this.selectedEnvironmentItem === null || \r\n            this.deleteMode || \r\n            !this.currentPreviewImage) {\r\n            this.previewCanvas.style.display = 'none';\r\n            return;\r\n        }\r\n        \r\n        // Get mouse position relative to canvas\r\n        const rect = this.canvasEl.getBoundingClientRect();\r\n        let mouseX = e.clientX - rect.left;\r\n        const mouseY = e.clientY - rect.top;\r\n        \r\n        if (!this.gameEditor.getCollections().configs.game.isIsometric) {\r\n            mouseX -= (this.canvasEl.width - this.mapSize * this.config.gridSize) / 2;\r\n        }\r\n        \r\n        // For isometric view, we need to convert cursor position to actual object position\r\n        let posX, posY;\r\n        if (this.gameEditor.getCollections().configs.game.isIsometric) {\r\n            const isoPos = { x: mouseX, y: mouseY };\r\n            const pixelPos = this.translator.isoToPixel(isoPos.x, isoPos.y);\r\n            \r\n            // Convert back to screen coordinates\r\n            const screenPos = this.translator.pixelToIso(pixelPos.x, pixelPos.y);\r\n            posX = screenPos.x + rect.left;\r\n            posY = screenPos.y + rect.top;\r\n        } else {\r\n            // For non-isometric, just use the mouse position\r\n            posX = e.clientX;\r\n            posY = e.clientY;\r\n        }\r\n        posX = e.clientX;\r\n        posY = e.clientY;\r\n        // Center the preview on the cursor\r\n        this.previewCanvas.style.transform = `translate(${posX - this.previewCanvas.width / 2}px, ${posY - this.previewCanvas.height / 2}px)`;\r\n        this.previewCanvas.style.display = 'block';\r\n    }\r\n    setupTerrainImageProcessor() {\r\n        this.terrainImageProcessor = new this.engineClasses.TerrainImageProcessor();\r\n        this.terrainImageProcessor.initialize(\r\n            document.getElementById('terrainImage'),\r\n            document.getElementById('terrain-image-display')\r\n        );\r\n    }\r\n\r\n    setupTerrainTypesUI() {\r\n        const terrainsPanel = document.getElementById('terrainsPanel');\r\n        const existingColorPicker = terrainsPanel.querySelector('.terrain-types-container');\r\n        if (existingColorPicker) {\r\n            terrainsPanel.removeChild(existingColorPicker);\r\n        }\r\n    \r\n        this.terrainTypesContainer = document.createElement('div');\r\n        this.terrainTypesContainer.className = 'terrain-types-container';\r\n        const addNewBtn = document.createElement('button');\r\n        addNewBtn.className = 'add-terrain-btn';\r\n        addNewBtn.innerHTML = '+ Add Layer';\r\n        addNewBtn.addEventListener('click', this.showAddTerrainForm.bind(this));\r\n        this.terrainTypesContainer.appendChild(addNewBtn);\r\n        this.tileMap.terrainTypes.forEach((terrain, index) => {\r\n            const terrainItem = document.createElement('div');\r\n            terrainItem.className = 'terrain-item';\r\n            terrainItem.draggable = true;\r\n            terrainItem.dataset.index = index;\r\n    \r\n            terrainItem.addEventListener('dragstart', this.handleDragStart.bind(this));\r\n            terrainItem.addEventListener('dragover', this.handleDragOver.bind(this));\r\n            terrainItem.addEventListener('drop', this.handleDrop.bind(this));\r\n            terrainItem.addEventListener('dragend', this.handleDragEnd.bind(this));\r\n            terrainItem.addEventListener('dragenter', this.handleDragEnter.bind(this));\r\n            terrainItem.addEventListener('dragleave', this.handleDragLeave.bind(this));\r\n    \r\n            const option = document.createElement('div');\r\n            option.className = 'color-option';\r\n            option.dataset.index = index;\r\n            option.dataset.type = terrain.type;\r\n            option.style.backgroundColor = terrain.color;\r\n    \r\n            if (index === this.currentTerrainId) {\r\n                option.classList.add('active');\r\n            }\r\n    \r\n            option.addEventListener('click', () => {\r\n                document.querySelectorAll('.color-option').forEach(opt => opt.classList.remove('active'));\r\n                option.classList.add('active');\r\n                this.currentTerrainId = parseInt(option.dataset.index);\r\n            });\r\n    \r\n            const label = document.createElement('div');\r\n            label.className = 'terrain-label';\r\n            label.textContent = terrain.type;\r\n    \r\n            const buttonContainer = document.createElement('div');\r\n            buttonContainer.className = 'terrain-buttons';\r\n    \r\n            const editBtn = document.createElement('button');\r\n            editBtn.className = 'edit-terrain-btn';\r\n            editBtn.innerHTML = '';\r\n            editBtn.title = 'Edit terrain';\r\n            editBtn.addEventListener('click', () => this.showTerrainEditForm(index));\r\n            buttonContainer.appendChild(editBtn);\r\n    \r\n            const deleteBtn = document.createElement('button');\r\n            deleteBtn.className = 'delete-terrain-btn';\r\n            deleteBtn.innerHTML = '';\r\n            deleteBtn.title = 'Delete terrain';\r\n            deleteBtn.addEventListener('click', () => this.deleteTerrain(index));\r\n            buttonContainer.appendChild(deleteBtn);\r\n    \r\n            terrainItem.appendChild(option);\r\n            terrainItem.appendChild(label);\r\n            terrainItem.appendChild(buttonContainer);\r\n    \r\n            this.terrainTypesContainer.appendChild(terrainItem);\r\n        });\r\n    \r\n\r\n    \r\n        terrainsPanel.appendChild(this.terrainTypesContainer);\r\n    \r\n        document.getElementById('saveTerrainBtn').addEventListener('click', this.saveTerrainType.bind(this));\r\n        document.getElementById('cancelTerrainBtn').addEventListener('click', this.hideTerrainForm.bind(this));\r\n    }\r\n    \r\n    createPreviewCanvas() {\r\n        if (this.previewCanvas) {\r\n            document.body.removeChild(this.previewCanvas);\r\n        }\r\n        \r\n        this.previewCanvas = document.createElement('canvas');\r\n        this.previewCanvas.id = 'object-preview-canvas';\r\n        this.previewCanvas.width = this.config.imageSize;\r\n        this.previewCanvas.height = this.config.imageSize;\r\n        this.previewCanvas.style.display = 'none'; // Hidden by default\r\n        \r\n        document.body.prepend(this.previewCanvas);\r\n\r\n    }\r\n\r\n    setupEnvironmentPanel() {\r\n        const environmentPanel = document.getElementById('environmentPanel');\r\n        if (!environmentPanel) {\r\n            // Create the panel if it doesn't exist\r\n            const panel = document.createElement('div');\r\n            panel.id = 'environmentPanel';\r\n            panel.style.display = 'none'; // Hidden by default\r\n            document.querySelector('.tools').appendChild(panel);\r\n        } else {\r\n            // Clear existing content\r\n            environmentPanel.innerHTML = '';\r\n        }\r\n    \r\n        // Create object controls\r\n        const controlsDiv = document.createElement('div');\r\n        controlsDiv.className = 'object-controls';\r\n        \r\n        const deleteButton = document.createElement('button');\r\n        deleteButton.className = 'delete-btn';\r\n        deleteButton.innerHTML = '<svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2\"/><path d=\"M10 11v6M14 11v6\"/></svg> Delete Mode';\r\n        deleteButton.addEventListener('click', () => {\r\n            deleteButton.classList.toggle('delete-mode');\r\n            document.body.classList.toggle('delete-mode-active');\r\n            this.deleteMode = deleteButton.classList.contains('delete-mode');\r\n            if (this.deleteMode) {\r\n                this.previewCanvas.style.display = 'none';\r\n            } else if (this.placementMode === 'environment' && \r\n                      this.selectedEnvironmentType && \r\n                      this.selectedEnvironmentItem !== null) {\r\n                this.updatePreviewImage();\r\n            }\r\n        });\r\n        \r\n        const clearButton = document.createElement('button');\r\n        clearButton.className = 'clear-all-btn';\r\n        clearButton.innerHTML = 'Clear All Objects';\r\n        clearButton.addEventListener('click', () => {\r\n            if (confirm('Are you sure you want to remove all environment objects?')) {\r\n                this.tileMap.environmentObjects = [];\r\n                this.updateCanvasWithData();\r\n                this.exportMap();\r\n                this.updateObjectCounts();\r\n            }\r\n        });\r\n        \r\n        controlsDiv.appendChild(deleteButton);\r\n        controlsDiv.appendChild(clearButton);\r\n        environmentPanel.appendChild(controlsDiv);\r\n        \r\n        // Create placement mode indicator (hidden by default)\r\n        const indicator = document.createElement('div');\r\n        indicator.className = 'placement-mode-indicator';\r\n        indicator.style.opacity = '0';\r\n        indicator.textContent = 'Placement Mode: Terrain';\r\n        document.querySelector('.grid-container').appendChild(indicator);\r\n        this.placementModeIndicator = indicator;\r\n    \r\n        // Create environment object selector\r\n        if (this.worldObjects) {\r\n            const container = document.createElement('div');\r\n            container.className = 'environment-objects-container';\r\n            \r\n            // Add header\r\n            const header = document.createElement('h3');\r\n            header.textContent = 'Environment Objects';\r\n            container.appendChild(header);\r\n            \r\n            // Create object type list\r\n            for (const type in this.worldObjects) {\r\n                const typeContainer = document.createElement('div');\r\n                typeContainer.className = 'environment-type';\r\n                \r\n                // Count objects of this type\r\n                const objectCount = (this.tileMap.environmentObjects || [])\r\n                    .filter(obj => obj.type === type).length;\r\n                \r\n                const typeHeader = document.createElement('div');\r\n                typeHeader.className = 'environment-type-header';\r\n                typeHeader.textContent = type;\r\n                \r\n                // Add count badge\r\n                const countBadgeContainer = document.createElement('span');\r\n                countBadgeContainer.className = 'object-count-container';\r\n                const countBadge = document.createElement('span');\r\n                countBadge.className = 'object-count';\r\n                countBadge.textContent = objectCount;\r\n                countBadgeContainer.appendChild(countBadge);\r\n                typeHeader.appendChild(countBadgeContainer);\r\n                \r\n                typeHeader.addEventListener('click', () => {\r\n                    const content = typeContainer.querySelector('.environment-items');\r\n                    const isOpen = content.style.display !== 'none';\r\n                    content.style.display = isOpen ? 'none' : 'flex';\r\n                    typeHeader.classList.toggle('open', !isOpen);\r\n                });\r\n                typeContainer.appendChild(typeHeader);\r\n                \r\n                const itemsContainer = document.createElement('div');\r\n                itemsContainer.className = 'environment-items';\r\n                itemsContainer.style.display = 'none';\r\n                \r\n                // Get images for this type\r\n                const images = this.imageManager.getImages(\"environment\", type);\r\n                if (images && images.idle && images.idle[0] && images.idle[0].length > 0) {\r\n                    images.idle[0].forEach((image, imageIndex) => {\r\n                        const item = document.createElement('div');\r\n                        item.className = 'environment-item';\r\n                        item.dataset.name = `${type} ${imageIndex + 1}`;\r\n                        \r\n                        const preview = document.createElement('canvas');\r\n                        preview.width = this.config.imageSize;\r\n                        preview.height = this.config.imageSize;\r\n                        const ctx = preview.getContext('2d');\r\n                        \r\n                        // Draw scaled down version of the image for preview with proper centering\r\n                        const scale = Math.min(this.config.imageSize / image.width, this.config.imageSize / image.height);\r\n                        ctx.drawImage(\r\n                            image, \r\n                            (this.config.imageSize - image.width * scale) / 2, \r\n                            (this.config.imageSize - image.height * scale) / 2, \r\n                            image.width * scale, \r\n                            image.height * scale\r\n                        );\r\n                        \r\n                        item.appendChild(preview);\r\n                        \r\n                        item.addEventListener('click', () => {\r\n                            // Deselect any previously selected items\r\n                            document.querySelectorAll('.environment-item').forEach(i => i.classList.remove('active'));\r\n                            \r\n                            // Select this item\r\n                            item.classList.add('active');\r\n                            this.selectedEnvironmentType = type;\r\n                            this.selectedEnvironmentItem = imageIndex;\r\n                            this.placementMode = 'environment';\r\n                              // Update preview image for cursor\r\n                            this.updatePreviewImage();\r\n                            // Update placement indicator\r\n                            this.placementModeIndicator.textContent = `Placing: ${type} ${imageIndex + 1}`;\r\n                            this.placementModeIndicator.style.opacity = '1';\r\n                            \r\n                            // Auto-disable delete mode when selecting an object\r\n                            if (this.deleteMode) {\r\n                                deleteButton.classList.remove('delete-mode');\r\n                                document.body.classList.remove('delete-mode-active');\r\n                                this.deleteMode = false;\r\n                            }\r\n                            \r\n                            // Hide indicator after a delay\r\n                            clearTimeout(this.indicatorTimeout);\r\n                            this.indicatorTimeout = setTimeout(() => {\r\n                                this.placementModeIndicator.style.opacity = '0';\r\n                            }, 2000);\r\n                        });\r\n                        \r\n                        itemsContainer.appendChild(item);\r\n                    });\r\n                } else {\r\n                    // Empty state\r\n                    itemsContainer.classList.add('empty');\r\n                    const emptyMsg = document.createElement('div');\r\n                    emptyMsg.textContent = 'No objects available for this type';\r\n                    itemsContainer.appendChild(emptyMsg);\r\n                }\r\n                \r\n                typeContainer.appendChild(itemsContainer);\r\n                container.appendChild(typeContainer);\r\n            }\r\n            \r\n            environmentPanel.appendChild(container);\r\n        } else {\r\n            const message = document.createElement('p');\r\n            message.textContent = 'No environment objects available.';\r\n            environmentPanel.appendChild(message);\r\n        }\r\n    }\r\n    deleteEnvironmentObjectAt(e) {\r\n        // Get mouse position and convert to game coordinates\r\n        const rect = this.canvasEl.getBoundingClientRect();\r\n        let mouseX = e.clientX - rect.left;\r\n        const mouseY = e.clientY - rect.top;\r\n        \r\n        if(!this.gameEditor.getCollections().configs.game.isIsometric) {\r\n            mouseX -= (this.canvasEl.width - this.mapSize * this.config.gridSize) / 2;\r\n        }\r\n        \r\n        const isoPos = { x: mouseX, y: mouseY };\r\n        const pixelPos = this.translator.isoToPixel(isoPos.x, isoPos.y);\r\n        \r\n        // Find and remove any environment object near the click position\r\n        const clickRadius = 30; // Radius for detecting objects to delete (in pixels)\r\n        let deletedObject = false;\r\n        \r\n        for (let i = this.tileMap.environmentObjects.length - 1; i >= 0; i--) {\r\n            const obj = this.tileMap.environmentObjects[i];\r\n            const dx = obj.x - pixelPos.x;\r\n            const dy = obj.y - pixelPos.y;\r\n            const distance = Math.sqrt(dx * dx + dy * dy);\r\n            \r\n            if (distance < clickRadius) {\r\n                // Remove this object\r\n                const deleted = this.tileMap.environmentObjects.splice(i, 1)[0];\r\n                deletedObject = true;\r\n                \r\n                // Show feedback\r\n                this.placementModeIndicator.textContent = `Deleted: ${deleted.type}`;\r\n                this.placementModeIndicator.style.opacity = '1';\r\n                \r\n                // Hide indicator after a delay\r\n                clearTimeout(this.indicatorTimeout);\r\n                this.indicatorTimeout = setTimeout(() => {\r\n                    this.placementModeIndicator.style.opacity = '0';\r\n                }, 1500);\r\n                \r\n                // Update the map rendering\r\n                this.updateCanvasWithData();\r\n                \r\n                // Update object counts\r\n                this.updateObjectCounts();\r\n                \r\n                // Export the updated map\r\n                this.exportMap();\r\n                break; // Only remove one object at a time\r\n            }\r\n        }\r\n        \r\n        // Show feedback if no object was found to delete\r\n        if (!deletedObject && this.deleteMode) {\r\n            this.placementModeIndicator.textContent = 'No object found at this location';\r\n            this.placementModeIndicator.style.opacity = '1';\r\n            \r\n            // Hide indicator after a delay\r\n            clearTimeout(this.indicatorTimeout);\r\n            this.indicatorTimeout = setTimeout(() => {\r\n                this.placementModeIndicator.style.opacity = '0';\r\n            }, 1500);\r\n        }\r\n    }\r\n    updateObjectCounts() {\r\n        if (!document.getElementById('environmentPanel')) return;\r\n        \r\n        // Update count badges\r\n        for (const type in this.worldObjects) {\r\n            const objectCount = (this.tileMap.environmentObjects || [])\r\n                .filter(obj => obj.type === type).length;\r\n            \r\n            // Find all headers first\r\n            const headers = document.querySelectorAll('.environment-type-header');\r\n            // Find the specific header containing the type name\r\n            for (const header of headers) {\r\n                if (header.textContent.includes(type)) {\r\n                    // Get the count badge within this header\r\n                    const countBadge = header.querySelector('.object-count');\r\n                    if (countBadge) {\r\n                        countBadge.textContent = objectCount;\r\n                    }\r\n                    break; // Found the right header, no need to continue\r\n                }\r\n            }\r\n        }\r\n    }\r\n    // Improved drag and drop handlers\r\n    handleDragStart(e) {\r\n        this.draggedItem = e.currentTarget;\r\n        e.dataTransfer.effectAllowed = 'move';\r\n        e.dataTransfer.setData('text/html', this.draggedItem.outerHTML);\r\n        this.draggedItem.classList.add('dragging');\r\n        this.draggedTerrainId = parseInt(this.draggedItem.dataset.index);\r\n    }\r\n    \r\n    async handleDrop(e) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        const dropTarget = e.currentTarget;\r\n        dropTarget.classList.remove('drag-over');\r\n    \r\n        if (this.draggedItem !== dropTarget && dropTarget.classList.contains('terrain-item')) {\r\n            const allItems = Array.from(this.terrainTypesContainer.querySelectorAll('.terrain-item'));\r\n            const draggedIndex = allItems.indexOf(this.draggedItem);\r\n            const dropIndex = allItems.indexOf(dropTarget);\r\n    \r\n            if (draggedIndex !== -1 && dropIndex !== -1) {\r\n                // Store a copy of the original terrain types for reference\r\n                const oldTerrainTypes = [...this.tileMap.terrainTypes];\r\n                \r\n                // Reorder terrain types\r\n                const draggedTerrain = this.tileMap.terrainTypes[draggedIndex];\r\n                this.tileMap.terrainTypes.splice(draggedIndex, 1);\r\n                this.tileMap.terrainTypes.splice(dropIndex, 0, draggedTerrain);\r\n    \r\n                // Create mapping between old and new indices\r\n                const indexMap = {};\r\n                oldTerrainTypes.forEach((terrain, oldIndex) => {\r\n                    const newIndex = this.tileMap.terrainTypes.findIndex(t => t.type === terrain.type);\r\n                    indexMap[oldIndex] = newIndex;\r\n                });\r\n    \r\n                // Update terrain map with new indices\r\n                if (this.tileMap.terrainMap && this.tileMap.terrainMap.length > 0) {\r\n                    const maxIndex = this.tileMap.terrainTypes.length - 1;\r\n                    for (let y = 0; y < this.tileMap.terrainMap.length; y++) {\r\n                        for (let x = 0; x < this.tileMap.terrainMap[y].length; x++) {\r\n                            const oldIndex = this.tileMap.terrainMap[y][x];\r\n                            const newIndex = indexMap[oldIndex] !== undefined ? indexMap[oldIndex] : 0;\r\n                            this.tileMap.terrainMap[y][x] = Math.min(newIndex, maxIndex);\r\n                        }\r\n                    }\r\n                }\r\n    \r\n                // Update UI order\r\n                if (draggedIndex < dropIndex) {\r\n                    dropTarget.parentNode.insertBefore(this.draggedItem, dropTarget.nextSibling);\r\n                } else {\r\n                    dropTarget.parentNode.insertBefore(this.draggedItem, dropTarget);\r\n                }\r\n    \r\n                // Update current terrain ID if needed\r\n                if (this.currentTerrainId === draggedIndex) {\r\n                    this.currentTerrainId = dropIndex;\r\n                } else if (this.currentTerrainId === dropIndex) {\r\n                    this.currentTerrainId = draggedIndex;\r\n                }\r\n    \r\n                // Force a complete refresh of the rendering pipeline\r\n                // Clear any cached images or renderers\r\n                this.terrainTileMapper = null;\r\n                this.mapRenderer = null;\r\n                this.imageManager = null;\r\n                this.updateTerrainStyles();\r\n                this.setupTerrainTypesUI();\r\n\r\n                await this.initImageManager();\r\n                this.exportMap();\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    \r\n    handleDragOver(e) {\r\n        e.preventDefault();\r\n        e.dataTransfer.dropEffect = 'move';\r\n        return false;\r\n    }\r\n    \r\n    // Add visual feedback when dragging over items\r\n    handleDragEnter(e) {\r\n        e.preventDefault();\r\n        // Only add highlight if dragging over another terrain item (not itself)\r\n        if (e.currentTarget !== this.draggedItem) {\r\n            e.currentTarget.classList.add('drag-over');\r\n            this.dragOverItem = e.currentTarget;\r\n        }\r\n    }\r\n    \r\n    handleDragLeave(e) {\r\n        e.preventDefault();\r\n        e.currentTarget.classList.remove('drag-over');\r\n        if (this.dragOverItem === e.currentTarget) {\r\n            this.dragOverItem = null;\r\n        }\r\n    }\r\n   \r\n    \r\n    handleDragEnd(e) {\r\n        // Clean up all drag-related classes\r\n        this.draggedItem.classList.remove('dragging');\r\n        document.querySelectorAll('.terrain-item').forEach(item => {\r\n            item.classList.remove('drag-over');\r\n        });\r\n        this.draggedItem = null;\r\n        this.dragOverItem = null;\r\n    }\r\n\r\n    showAddTerrainForm() {\r\n        const form = document.getElementById(this.modalId);\r\n        form.classList.add('show');\r\n        document.getElementById('formTitle').textContent = 'Add Terrain Type';\r\n        document.getElementById('editingId').value = ''; // New form field for ID\r\n        document.getElementById('terrainType').value = '';\r\n        document.getElementById('terrainColor').value = '#cccccc';\r\n        document.getElementById('terrainColorText').value = '#cccccc';  \r\n        document.getElementById('terrainImage').value = '[]';        \r\n        document.getElementById('terrainBuildable').checked = false;         \r\n    }\r\n\r\n    showTerrainEditForm(index) {\r\n        const terrain = this.tileMap.terrainTypes[index];\r\n        this.currentTerrainId = index; // Set current terrain ID for later use\r\n        const form = document.getElementById(this.modalId);\r\n        form.classList.add('show');\r\n        document.getElementById('formTitle').textContent = 'Edit Terrain Type';\r\n        document.getElementById('terrainType').value = terrain.type;\r\n        document.getElementById('terrainColor').value = terrain.color;\r\n        document.getElementById('terrainColorText').value = terrain.color;\r\n        document.getElementById('terrainImage').value = JSON.stringify(terrain.image || []);   \r\n        document.getElementById('terrainBuildable').checked = terrain.buildable;\r\n        const terrainTextureEl = document.getElementById('terrainTexture');\r\n        terrainTextureEl.innerHTML = ''; // Clear existing options\r\n\r\n        for(let textureName in this.gameEditor.getCollections().textures){\r\n            const texture = this.gameEditor.getCollections().textures[textureName];\r\n            const option = document.createElement('option');\r\n            option.value = textureName;\r\n            option.textContent = texture.title;\r\n\r\n            if( textureName === terrain.texture) {\r\n                option.selected = true; // Set the current terrain texture as selected\r\n            }\r\n            terrainTextureEl.appendChild(option);\r\n        }\r\n        // Create a custom event with data\r\n        const myCustomEvent = new CustomEvent('editTerrainImage', {\r\n            bubbles: true,\r\n            cancelable: true\r\n        });\r\n\r\n        // Dispatch the event\r\n        document.body.dispatchEvent(myCustomEvent);\r\n    }\r\n\r\n    hideTerrainForm() {\r\n        document.getElementById(this.modalId).classList.remove('show');\r\n    }\r\n\r\n    saveTerrainType() {\r\n        const newType = document.getElementById('terrainType').value.trim();\r\n        const newColor = document.getElementById('terrainColorText').value;\r\n        const newTexture = document.getElementById('terrainTexture').value;\r\n        const newImage = JSON.parse(document.getElementById('terrainImage').value);\r\n        const newBuildable = document.getElementById('terrainBuildable').checked;\r\n    \r\n        if (!newType) {\r\n            alert('Terrain type cannot be empty');\r\n            return;\r\n        }\r\n    \r\n        if (this.currentTerrainId !== '') {\r\n            // Editing existing terrain (using index as identifier)\r\n            const index = this.currentTerrainId;\r\n            if (index >= 0 && index < this.tileMap.terrainTypes.length) {\r\n                if (this.tileMap.terrainTypes.some((t, i) => t.type === newType && i !== index)) {\r\n                    alert('A terrain type with this name already exists');\r\n                    return;\r\n                }\r\n                this.tileMap.terrainTypes[index] = { type: newType, texture: newTexture, color: newColor, image: newImage, buildable: newBuildable };\r\n            }\r\n        } else {\r\n            // Adding new terrain\r\n            if (this.tileMap.terrainTypes.some(t => t.type === newType)) {\r\n                alert('A terrain type with this name already exists');\r\n                return;\r\n            }\r\n            this.tileMap.terrainTypes.push({ type: newType, texture: newTexture, color: newColor, image: newImage, buildable: newBuildable });\r\n        }\r\n    \r\n        this.updateTerrainStyles();\r\n        this.setupTerrainTypesUI();\r\n        this.hideTerrainForm();\r\n        this.initGridCanvas();\r\n        this.exportMap();\r\n    }\r\n\r\n    deleteTerrain(indexToDelete) {\r\n        if (this.tileMap.terrainTypes.length <= 1) {\r\n            alert('Cannot delete the last terrain type');\r\n            return;\r\n        }\r\n    \r\n        const terrainToDelete = this.tileMap.terrainTypes[indexToDelete];\r\n        if (!terrainToDelete) return;\r\n    \r\n        if (!confirm(`Are you sure you want to delete the \"${terrainToDelete.type}\" terrain type? All instances will be converted to the default terrain.`)) {\r\n            return;\r\n        }\r\n    \r\n        const defaultTerrainIndex = this.tileMap.terrainTypes.findIndex(t => t.type === 'grass') || 0;\r\n    \r\n        // Remove from terrainTypes array\r\n        this.tileMap.terrainTypes.splice(indexToDelete, 1);\r\n    \r\n        // Update terrainMap - replace all instances with defaultTerrainIndex\r\n        for (let y = 0; y < this.tileMap.terrainMap.length; y++) {\r\n            for (let x = 0; x < this.tileMap.terrainMap[y].length; x++) {\r\n                if (this.tileMap.terrainMap[y][x] === indexToDelete) {\r\n                    this.tileMap.terrainMap[y][x] = defaultTerrainIndex;\r\n                } else if (this.tileMap.terrainMap[y][x] > indexToDelete) {\r\n                    this.tileMap.terrainMap[y][x]--; // Adjust indices after deleted item\r\n                }\r\n            }\r\n        }\r\n    \r\n        if (this.currentTerrainId === indexToDelete) {\r\n            this.currentTerrainId = defaultTerrainIndex;\r\n        } else if (this.currentTerrainId > indexToDelete) {\r\n            this.currentTerrainId--;\r\n        }\r\n    \r\n        this.updateTerrainStyles();\r\n        this.setupTerrainTypesUI();\r\n        this.initGridCanvas();\r\n        this.exportMap();\r\n    }\r\n\r\n    updateTerrainStyles() {\r\n        let styleElem = document.getElementById('terrainStyles');\r\n        if (!styleElem) {\r\n            styleElem = document.createElement('style');\r\n            styleElem.id = 'terrainStyles';\r\n            document.head.appendChild(styleElem);\r\n        }\r\n    \r\n        let css = '';\r\n        this.tileMap.terrainTypes.forEach((terrain, index) => {\r\n            css += `#level-editor-container .color-option[data-index=\"${index}\"] { background-color: ${terrain.color}; }\\n`;\r\n        });\r\n    \r\n        css += `\r\n            .terrain-item.dragging { opacity: 0.4; }\r\n            .terrain-item.drag-over { border: 2px dashed #666; background-color: rgba(0,0,0,0.1); }\r\n        `;\r\n    \r\n        styleElem.textContent = css;\r\n    }\r\n\r\n    translateMap(deltaX, deltaY) {\r\n        const gridSize = this.tileMap.size;\r\n        \r\n        // Create a new map to hold the translated terrain\r\n        const newTerrainMap = [];\r\n        for (let i = 0; i < gridSize; i++) {\r\n            newTerrainMap.push(new Array(gridSize));\r\n        }\r\n        \r\n        // Fill the new map\r\n        for (let i = 0; i < gridSize; i++) {\r\n            for (let j = 0; j < gridSize; j++) {\r\n                // Calculate source coordinates in old map\r\n                const oldI = i - deltaY;\r\n                const oldJ = j - deltaX;\r\n                \r\n                // Check if source coordinates are within map boundaries\r\n                if (oldI >= 0 && oldI < gridSize && oldJ >= 0 && oldJ < gridSize) {\r\n                    // Copy existing terrain\r\n                    newTerrainMap[i][j] = this.tileMap.terrainMap[oldI][oldJ];\r\n                } else {\r\n                    // For areas that would be outside the original map,\r\n                    // use the nearest edge value (wrap around)\r\n                    const clampedI = Math.max(0, Math.min(gridSize - 1, oldI));\r\n                    const clampedJ = Math.max(0, Math.min(gridSize - 1, oldJ));\r\n                    newTerrainMap[i][j] = this.tileMap.terrainMap[clampedI][clampedJ];\r\n                }\r\n            }\r\n        }\r\n        \r\n        // Update tileMap with new terrain\r\n        this.tileMap.terrainMap = newTerrainMap;\r\n        \r\n        // Update UI and export\r\n        this.updateCanvasWithData();\r\n        this.exportMap();\r\n    }\r\n\r\n    async initGridCanvas() {\r\n        // Initialize the canvas with our map renderer\r\n\r\n        await this.initImageManager();\r\n\r\n        // Render the initial map\r\n        this.updateCanvasWithData();\r\n        \r\n        // Clean up resources\r\n        this.imageManager.dispose();\r\n    }\r\n\r\n    handleCanvasInteraction(event) {\r\n        // Get mouse position relative to canvas\r\n        const rect = this.canvasEl.getBoundingClientRect();\r\n        let mouseX = event.clientX - rect.left;\r\n        const mouseY = event.clientY - rect.top;\r\n        \r\n        if(!this.gameEditor.getCollections().configs.game.isIsometric) {\r\n            mouseX -= (this.canvasEl.width - this.mapSize * this.config.gridSize) / 2;\r\n        }\r\n        \r\n        if (this.placementMode === 'terrain') {\r\n            // Original terrain placement logic\r\n            const gridPos = this.translator.isoToGrid(mouseX, mouseY);\r\n            const snappedGrid = this.translator.snapToGrid(gridPos.x, gridPos.y);\r\n            \r\n            // Check if coordinates are within bounds\r\n            if (snappedGrid.x >= 0 && snappedGrid.x < this.mapSize && \r\n                snappedGrid.y >= 0 && snappedGrid.y < this.mapSize) {\r\n                \r\n                // Update terrain map with selected terrain ID\r\n                this.tileMap.terrainMap[snappedGrid.y][snappedGrid.x] = this.currentTerrainId;\r\n                \r\n                // Update the map rendering\r\n                this.updateCanvasWithData();\r\n                \r\n                // Export the updated map\r\n                this.exportMap();\r\n            }\r\n        } else if (this.placementMode === 'environment' && this.selectedEnvironmentType && \r\n                   this.selectedEnvironmentItem !== null) {\r\n            // Environment object placement logic\r\n            const isoPos = { x: mouseX, y: mouseY };\r\n            const pixelPos = this.translator.isoToPixel(isoPos.x, isoPos.y);\r\n            \r\n            // Get the image to calculate its size\r\n            const images = this.imageManager.getImages(\"environment\", this.selectedEnvironmentType);\r\n            const image = images.idle[0][this.selectedEnvironmentItem];\r\n            \r\n            // Create new environment object\r\n            const newObject = {\r\n                type: this.selectedEnvironmentType,\r\n                imageIndex: this.selectedEnvironmentItem,\r\n                x: pixelPos.x,\r\n                y: pixelPos.y\r\n            };\r\n            \r\n            // Add to environment objects array\r\n            if (!this.tileMap.environmentObjects) {\r\n                this.tileMap.environmentObjects = [];\r\n            }\r\n            this.tileMap.environmentObjects.push(newObject);\r\n            \r\n            // Update the map rendering\r\n            this.updateCanvasWithData();\r\n            \r\n            // Export the updated map\r\n            this.exportMap();\r\n        }\r\n    }\r\n\r\n    async updateCanvasWithData() {\r\n        if(this.tileMap.terrainMap.length > 0){\r\n            this.mapRenderer.isMapCached = false;\r\n            this.mapRenderer.renderBG(this.tileMap, []);\r\n            this.mapRenderer.renderFG();\r\n        }\r\n    }\r\n\r\n    exportMap() {\r\n        // Create a custom event with data\r\n        const myCustomEvent = new CustomEvent('saveTileMap', {\r\n            detail: { data: this.tileMap, propertyName: this.savePropertyName, refresh: false },\r\n            bubbles: true,\r\n            cancelable: true\r\n        });\r\n\r\n        // Dispatch the event\r\n        document.body.dispatchEvent(myCustomEvent);\r\n    }\r\n}\r\n                   "
      },
      "audioEditor": {
        "fileName": "audioEditor",
        "script": "class AudioEditor {\r\n    constructor(gameEditor) {\r\n        this.gameEditor = gameEditor;\r\n        let configObj = { state: {}, config: this.gameEditor.getCollections() };\r\n        this.audioManager = new (this.gameEditor.scriptContext.getComponent(\"AudioManager\"))(configObj, null, {} );\r\n        this.audioManager.init();\r\n        this.volume = 1;\r\n        this.setupEventListeners();\r\n        this.updateNoiseUI(); \r\n    }\r\n\r\n    setupEventListeners() {\r\n        const updateStatus = (message, type = 'default') => {\r\n            const status = document.getElementById('status-message');\r\n            if (status) {\r\n                status.textContent = message;\r\n                status.className = type === 'success' ? 'success' : type === 'error' ? 'error' : '';\r\n            }\r\n        };\r\n\r\n        const updateSliderDisplay = (sliderId, formatFn) => {\r\n            const slider = document.getElementById(sliderId);\r\n            if (slider) {\r\n                const updateDisplayValue = () => {\r\n                    const display = slider.nextElementSibling;\r\n                    if (display && display.classList.contains('value-display')) {\r\n                        display.textContent = formatFn(parseFloat(slider.value));\r\n                    }\r\n                };\r\n                \r\n                slider.addEventListener('input', updateDisplayValue);\r\n                updateDisplayValue();\r\n            }\r\n        };\r\n\r\n        document.body.addEventListener('editAudio', (event) => {\r\n            try {\r\n                const settings = event.detail.data;\r\n                this.updateUIFromSettings(settings);                \r\n                updateStatus('Audio settings imported', 'success');\r\n            } catch (err) {\r\n                updateStatus('Error importing audio settings: ' + err.message, 'error');\r\n            }\r\n        });\r\n\r\n        const playBtn = document.getElementById('playBtn');\r\n        \r\n        playBtn?.addEventListener('click', () => {\r\n            this.playCurrentSound();\r\n        });\r\n\r\n        document.getElementById('exportBtn')?.addEventListener('click', () => {\r\n            const settings = this.getUISettings();\r\n            this.saveAudio(settings);\r\n            updateStatus('Audio settings exported', 'success');\r\n        });\r\n\r\n        this.setupUIControls(updateSliderDisplay);\r\n\r\n\r\n\r\n    }\r\n    setVolume(value) {\r\n        this.volume = value;\r\n    }\r\n    setupUIControls(updateSliderDisplay) {\r\n        updateSliderDisplay('volume', (val) => `${Math.round(val * 100)}%`);\r\n        document.getElementById('volume')?.addEventListener('input', (e) => {\r\n            const volume = parseFloat(e.target.value);\r\n            this.setVolume(volume, e);\r\n        });\r\n\r\n        updateSliderDisplay('frequency', (val) => `${val} Hz`);\r\n        updateSliderDisplay('duration', (val) => `${val.toFixed(2)} s`);\r\n        \r\n        updateSliderDisplay('attack', (val) => `${val.toFixed(3)} s`);\r\n        updateSliderDisplay('decay', (val) => `${val.toFixed(2)} s`);\r\n        updateSliderDisplay('sustain', (val) => `${Math.round(val * 100)}%`);\r\n        updateSliderDisplay('release', (val) => `${val.toFixed(2)} s`);\r\n        \r\n        updateSliderDisplay('pitchEnvStart', (val) => `${val.toFixed(2)}x`);\r\n        updateSliderDisplay('pitchEnvEnd', (val) => `${val.toFixed(2)}x`);\r\n        \r\n\r\n        updateSliderDisplay('filterFreq', (val) => `${val} Hz`);\r\n\r\n        \r\n        updateSliderDisplay('filterQ', (val) => `Q: ${val.toFixed(1)}`);\r\n        \r\n        updateSliderDisplay('distortion', (val) => `${Math.round(val)}%`);\r\n\r\n        \r\n        updateSliderDisplay('delayTime', (val) => `${val.toFixed(2)} s`);\r\n \r\n        \r\n        updateSliderDisplay('delayFeedback', (val) => `${Math.round(val * 100)}%`);\r\n\r\n        \r\n        updateSliderDisplay('reverbAmount', (val) => `${Math.round(val * 100)}%`);\r\n   \r\n        \r\n        updateSliderDisplay('bitcrusher', (val) => `${Math.round(val * 100)}%`);\r\n\r\n        \r\n        updateSliderDisplay('panning', (val) => {\r\n            if (val === 0) return \"Center\";\r\n            return val < 0 ? `${Math.abs(Math.round(val * 100))}% Left` : `${Math.round(val * 100)}% Right`;\r\n        });\r\n\r\n    }\r\n\r\n    getUISettings() {\r\n        return {\r\n            waveform: document.getElementById('waveform')?.value || 'sine',\r\n            frequency: parseFloat(document.getElementById('frequency')?.value || 440),\r\n            duration: parseFloat(document.getElementById('duration')?.value || 1),\r\n            noise: {\r\n                type: document.getElementById('noiseType')?.value || 'white',\r\n                amount: parseFloat(document.getElementById('noiseAmount')?.value || 0),\r\n                filter: {\r\n                    type: document.getElementById('noiseFilterType')?.value || 'none',\r\n                    frequency: parseFloat(document.getElementById('noiseFilterFreq')?.value || 2000)\r\n                }\r\n            },\r\n            envelope: {\r\n                attack: parseFloat(document.getElementById('attack')?.value || 0.01),\r\n                decay: parseFloat(document.getElementById('decay')?.value || 0.1),\r\n                sustain: parseFloat(document.getElementById('sustain')?.value || 0.7),\r\n                release: parseFloat(document.getElementById('release')?.value || 0.3),\r\n            },\r\n            pitchEnvelope: {\r\n                start: parseFloat(document.getElementById('pitchEnvStart')?.value || 1),\r\n                end: parseFloat(document.getElementById('pitchEnvEnd')?.value || 1),\r\n                time: parseFloat(document.getElementById('duration')?.value || 1)\r\n            },\r\n            effects: {\r\n                filter: {\r\n                    type: document.getElementById('filterType')?.value || 'lowpass',\r\n                    frequency: parseFloat(document.getElementById('filterFreq')?.value || 1000),\r\n                    Q: parseFloat(document.getElementById('filterQ')?.value || 1)\r\n                },\r\n                distortion: parseFloat(document.getElementById('distortion')?.value || 0),\r\n                delay: {\r\n                    time: parseFloat(document.getElementById('delayTime')?.value || 0.3),\r\n                    feedback: parseFloat(document.getElementById('delayFeedback')?.value || 0)\r\n                },\r\n                reverb: parseFloat(document.getElementById('reverbAmount')?.value || 0),\r\n                bitcrusher: parseFloat(document.getElementById('bitcrusher')?.value || 0),\r\n                pan: parseFloat(document.getElementById('panning')?.value || 0)\r\n            }\r\n        };\r\n    }\r\n\r\n    updateUIFromSettings(settings) {\r\n        if (!settings) return;\r\n        \r\n        this.setElementValue('waveform', settings.waveform);\r\n        this.setElementValue('frequency', settings.frequency);\r\n        this.setElementValue('duration', settings.duration);\r\n        \r\n        if (settings.envelope) {\r\n            this.setElementValue('attack', settings.envelope.attack);\r\n            this.setElementValue('decay', settings.envelope.decay);\r\n            this.setElementValue('sustain', settings.envelope.sustain);\r\n            this.setElementValue('release', settings.envelope.release);\r\n        }\r\n        \r\n        if (settings.pitchEnvelope) {\r\n            this.setElementValue('pitchEnvStart', settings.pitchEnvelope.start);\r\n            this.setElementValue('pitchEnvEnd', settings.pitchEnvelope.end);\r\n        }\r\n        \r\n        if (settings.effects) {\r\n            if (settings.effects.filter) {\r\n                this.setElementValue('filterType', settings.effects.filter.type);\r\n                this.setElementValue('filterFreq', settings.effects.filter.frequency);\r\n                this.setElementValue('filterQ', settings.effects.filter.Q);\r\n                \r\n            }\r\n            \r\n            this.setElementValue('distortion', settings.effects.distortion);\r\n            \r\n            if (settings.effects.delay) {\r\n                this.setElementValue('delayTime', settings.effects.delay.time);\r\n                this.setElementValue('delayFeedback', settings.effects.delay.feedback);\r\n            }\r\n            \r\n            this.setElementValue('reverbAmount', settings.effects.reverb);\r\n            \r\n            this.setElementValue('bitcrusher', settings.effects.bitcrusher);\r\n\r\n            this.setElementValue('panning', settings.effects.pan);\r\n        }\r\n        if (settings.noise) {\r\n            this.setElementValue('noiseType', settings.noise.type);\r\n            this.setElementValue('noiseAmount', settings.noise.amount);\r\n            \r\n            if (settings.noise.filter) {\r\n                this.setElementValue('noiseFilterType', settings.noise.filter.type);\r\n                this.setElementValue('noiseFilterFreq', settings.noise.filter.frequency);\r\n            }\r\n        }\r\n        document.querySelectorAll('input[type=\"range\"]').forEach(el => {\r\n            el.dispatchEvent(new Event('input'));\r\n        });\r\n        document.getElementById('randomSoundBtn')?.addEventListener('click', () => {\r\n            this.generateRandomSound();\r\n            this.playCurrentSound();\r\n        });\r\n    }\r\n    generateRandomSound() {\r\n        // Waveform options (including noise)\r\n        const waveforms = ['sine', 'square', 'sawtooth', 'triangle', 'noise'];\r\n        \r\n        // Noise types\r\n        const noiseTypes = ['white', 'pink', 'brown'];\r\n        \r\n        // Filter types\r\n        const filterTypes = ['lowpass', 'highpass', 'bandpass', 'none'];\r\n        \r\n        // Random helpers\r\n        const random = (min, max) => Math.random() * (max - min) + min;\r\n        const randomInt = (min, max) => Math.floor(random(min, max + 1));\r\n        const randomItem = (arr) => arr[randomInt(0, arr.length - 1)];\r\n        \r\n        // Generate random settings\r\n        const settings = {\r\n            waveform: randomItem(waveforms),\r\n            frequency: random(50, 2000),\r\n            duration: random(0.1, 3),\r\n            noise: {\r\n                type: randomItem(noiseTypes),\r\n                amount: random(0, 0), // Keep below 1.0 to avoid overpowering\r\n                filter: {\r\n                    type: randomItem(filterTypes),\r\n                    frequency: random(100, 10000),\r\n                    Q: random(0.5, 5)\r\n                }\r\n            },\r\n            envelope: {\r\n                attack: random(0.001, 0.5),\r\n                decay: random(0.01, 1),\r\n                sustain: random(0, 1),\r\n                release: random(0.01, 2)\r\n            },\r\n            pitchEnvelope: {\r\n                start: random(0.5, 2),\r\n                end: random(0.5, 2),\r\n                time: random(0.1, 2)\r\n            },\r\n            effects: {\r\n                filter: {\r\n                    type: randomItem(filterTypes),\r\n                    frequency: random(50, 10000),\r\n                    Q: random(0.5, 5)\r\n                },\r\n                distortion: random(0, 0.8),\r\n                delay: {\r\n                    time: random(0, 1),\r\n                    feedback: random(0, 0.7) // Avoid infinite feedback\r\n                },\r\n                reverb: random(0, 0.7),\r\n                bitcrusher: random(0, 0.5),\r\n                pan: random(-1, 1)\r\n            }\r\n        };\r\n\r\n        // Special case: If waveform is noise, disable oscillator frequency\r\n        if (settings.waveform === 'noise') {\r\n            settings.noise.amount = 1.0; // Full noise when selected\r\n            settings.frequency = 440; // Dummy value (unused)\r\n        }\r\n\r\n        // Ensure noise filter isn't \"none\" if noise is active\r\n        if (settings.noise.amount > 0 && settings.noise.filter.type === 'none') {\r\n            settings.noise.filter.type = randomItem(filterTypes.filter(t => t !== 'none'));\r\n        }\r\n\r\n        // Update UI with the new random sound\r\n        this.updateUIFromSettings(settings);\r\n        return settings;\r\n    }\r\n\r\n    updateNoiseUI() {\r\n    \r\n        // Setup the slider display update\r\n        this.setupNoiseControls();\r\n    }\r\n    \r\n    setupNoiseControls() {\r\n        const updateSliderDisplay = (sliderId, formatFn) => {\r\n            const slider = document.getElementById(sliderId);\r\n            if (slider) {\r\n                const updateDisplayValue = () => {\r\n                    const display = slider.nextElementSibling;\r\n                    if (display && display.classList.contains('value-display')) {\r\n                        display.textContent = formatFn(parseFloat(slider.value));\r\n                    }\r\n                };\r\n                \r\n                slider.addEventListener('input', updateDisplayValue);\r\n                updateDisplayValue();\r\n            }\r\n        };\r\n    \r\n        updateSliderDisplay('noiseAmount', (val) => `${Math.round(val * 100)}%`);\r\n        updateSliderDisplay('noiseFilterFreq', (val) => `${val} Hz`);\r\n    }\r\n\r\n    setElementValue(id, value) {\r\n        const element = document.getElementById(id);\r\n        if (element) element.value = value;\r\n    }\r\n\r\n\r\n    saveAudio(settingsObj) {\r\n        document.body.dispatchEvent(new CustomEvent('saveAudio', {   \r\n            detail: { data: settingsObj, propertyName: 'audio' },\r\n        }));\r\n    }\r\n\r\n    playCurrentSound() {\r\n        const settings = this.getUISettings();\r\n        this.audioManager.playSynthSound('audioEditorSound', settings);\r\n    }\r\n    \r\n}\r\n\r\n// setupKeyboard() {\r\n//     const keyboard = document.getElementById('keyboard');\r\n//     if (!keyboard) return;\r\n    \r\n//     keyboard.innerHTML = '';\r\n    \r\n//     const keyboardLayout = [\r\n//         { note: 'C4', key: 'a', frequency: 261.63, type: 'white' },\r\n//         { note: 'C#4', key: 'w', frequency: 277.18, type: 'black' },\r\n//         { note: 'D4', key: 's', frequency: 293.66, type: 'white' },\r\n//         { note: 'D#4', key: 'e', frequency: 311.13, type: 'black' },\r\n//         { note: 'E4', key: 'd', frequency: 329.63, type: 'white' },\r\n//         { note: 'F4', key: 'f', frequency: 349.23, type: 'white' },\r\n//         { note: 'F#4', key: 't', frequency: 369.99, type: 'black' },\r\n//         { note: 'G4', key: 'g', frequency: 392.00, type: 'white' },\r\n//         { note: 'G#4', key: 'y', frequency: 415.30, type: 'black' },\r\n//         { note: 'A4', key: 'h', frequency: 440.00, type: 'white' },\r\n//         { note: 'A#4', key: 'u', frequency: 466.16, type: 'black' },\r\n//         { note: 'B4', key: 'j', frequency: 493.88, type: 'white' },\r\n//         { note: 'C5', key: 'k', frequency: 523.25, type: 'white' }\r\n//     ];\r\n    \r\n//     keyboardLayout.forEach(note => {\r\n//         const key = document.createElement('div');\r\n//         key.className = `key ${note.type}`;\r\n//         key.dataset.note = note.note;\r\n//         key.dataset.frequency = note.frequency;\r\n//         key.innerHTML = `<span>${note.note}</span><span class=\"key-label\">${note.key}</span>`;\r\n        \r\n//         key.addEventListener('mousedown', () => {\r\n//             key.classList.add('active');\r\n//             this.playNote(note.frequency);\r\n//         });\r\n//         key.addEventListener('mouseup', () => {\r\n//             key.classList.remove('active');\r\n//             this.stopNote(note.frequency);\r\n//         });\r\n//         key.addEventListener('mouseleave', () => {\r\n//             if (key.classList.contains('active')) {\r\n//                 key.classList.remove('active');\r\n//                 this.stopNote(note.frequency);\r\n//             }\r\n//         });\r\n        \r\n//         keyboard.appendChild(key);\r\n//     });\r\n    \r\n//     const keyToNote = {};\r\n//     keyboardLayout.forEach(note => {\r\n//         keyToNote[note.key] = note.frequency;\r\n//     });\r\n    \r\n//     window.addEventListener('keydown', (e) => {\r\n//         if (e.repeat) return;\r\n//         const key = e.key.toLowerCase();\r\n//         if (keyToNote[key]) {\r\n//             this.playNote(keyToNote[key]);\r\n//             const keyElement = Array.from(keyboard.children).find(\r\n//                 k => k.dataset.frequency == keyToNote[key]\r\n//             );\r\n//             if (keyElement) keyElement.classList.add('active');\r\n//         }\r\n//     });\r\n    \r\n//     window.addEventListener('keyup', (e) => {\r\n//         const key = e.key.toLowerCase();\r\n//         if (keyToNote[key]) {\r\n//             this.stopNote(keyToNote[key]);\r\n//             const keyElement = Array.from(keyboard.children).find(\r\n//                 k => k.dataset.frequency == keyToNote[key]\r\n//             );\r\n//             if (keyElement) keyElement.classList.remove('active');\r\n//         }\r\n//     });\r\n// }\r\n\r\n// stopNote(frequency) {\r\n//     if (!this.activeNotes.has(frequency)) return;\r\n    \r\n//     const note = this.activeNotes.get(frequency);\r\n//     const now = this.audioContext.currentTime;\r\n//     const settings = this.getUISettings();\r\n//     const release = settings.envelope.release;\r\n    \r\n//     note.envelopeGain.gain.cancelScheduledValues(now);\r\n//     note.envelopeGain.gain.setValueAtTime(note.envelopeGain.gain.value, now);\r\n//     note.envelopeGain.gain.linearRampToValueAtTime(0, now + release);\r\n    \r\n//     note.oscillator.stop(now + release + 0.1);\r\n    \r\n//     setTimeout(() => {\r\n//         this.activeNotes.delete(frequency);\r\n//     }, (release + 0.2) * 1000);\r\n// }\r\n// playNote(frequency) {\r\n//     if (this.activeNotes.has(frequency)) {\r\n//         this.stopNote(frequency);\r\n//     }\r\n    \r\n//     const settings = this.getUISettings();\r\n//     settings.frequency = frequency;\r\n    \r\n//     const now = this.audioContext.currentTime;\r\n//     const oscillator = this.createOscillator(settings);\r\n//     oscillator.connect(this.filter);\r\n//     oscillator.start(now);\r\n    \r\n//     this.activeNotes.set(frequency, {\r\n//         oscillator,\r\n//         envelopeGain: this.masterGainNode,\r\n//         startTime: now\r\n//     });\r\n    \r\n//     this.connectVisualizer(oscillator);\r\n// }\r\n// Audio Visualizer class\r\nclass AudioVisualizer {\r\n    constructor(canvas, audioContext) {\r\n        this.canvas = canvas;\r\n        this.ctx = canvas.getContext('2d');\r\n        this.audioContext = audioContext;\r\n        this.analyzer = audioContext.createAnalyser();\r\n        this.analyzer.fftSize = 2048;\r\n        this.bufferLength = this.analyzer.frequencyBinCount;\r\n        this.dataArray = new Uint8Array(this.bufferLength);\r\n        this.analyzer.connect(audioContext.destination);\r\n        \r\n      \r\n        \r\n        // Start visualization loop\r\n        this.visualize();\r\n    }\r\n    \r\n    connectSource(source) {\r\n        source.connect(this.analyzer);\r\n    }\r\n    \r\n    drawWaveform(audioBuffer) {\r\n        const data = audioBuffer.getChannelData(0);\r\n        const step = Math.ceil(data.length / this.canvas.width);\r\n        const amp = this.canvas.height / 2;\r\n        \r\n        this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(0, amp);\r\n        \r\n        for (let i = 0; i < this.canvas.width; i++) {\r\n            const idx = Math.floor(i * step);\r\n            const y = amp + data[idx] * amp;\r\n            this.ctx.lineTo(i, y);\r\n        }\r\n        \r\n        this.ctx.strokeStyle = '#2196F3';\r\n        this.ctx.stroke();\r\n    }\r\n    \r\n    visualize() {\r\n        requestAnimationFrame(() => this.visualize());\r\n        \r\n        this.analyzer.getByteTimeDomainData(this.dataArray);\r\n        \r\n        this.ctx.fillStyle = 'rgb(200, 200, 200)';\r\n        this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);\r\n        \r\n        this.ctx.lineWidth = 2;\r\n        this.ctx.strokeStyle = 'rgb(0, 0, 0)';\r\n        this.ctx.beginPath();\r\n        \r\n        const sliceWidth = this.canvas.width * 1.0 / this.bufferLength;\r\n        let x = 0;\r\n        \r\n        for (let i = 0; i < this.bufferLength; i++) {\r\n            const v = this.dataArray[i] / 128.0;\r\n            const y = v * this.canvas.height / 2;\r\n            \r\n            if (i === 0) {\r\n                this.ctx.moveTo(x, y);\r\n            } else {\r\n                this.ctx.lineTo(x, y);\r\n            }\r\n            \r\n            x += sliceWidth;\r\n        }\r\n        \r\n        this.ctx.lineTo(this.canvas.width, this.canvas.height / 2);\r\n        this.ctx.stroke();\r\n    }\r\n    \r\n}"
      },
      "TerrainImageProcessor": {
        "fileName": "TerrainImageProcessor",
        "script": "class TerrainImageProcessor {\r\n  //Utility function to convert terrain tile spritesheets to and from base64 encoding\r\n    constructor(app, options = {}) {\r\n        this.app = app;\r\n        // Configurable tile dimensions with defaults\r\n        this.tileWidth = options.tileWidth || 24;\r\n        this.tileHeight = options.tileHeight || 24;\r\n        this.tilesX = options.tilesX || 4;\r\n        this.tilesY = options.tilesY || 1;\r\n\r\n        // Bind methods to ensure correct context\r\n        this.convertCanvasToBase64Tiles = this.convertCanvasToBase64Tiles.bind(this);\r\n        this.displayStoredBase64Tiles = this.displayStoredBase64Tiles.bind(this);\r\n\r\n        // Element references\r\n        this.output = null;\r\n        this.displayImage = null;\r\n    }\r\n\r\n    // Initialize the processor with DOM elements\r\n    initialize(outputElement, displayImageElement) {\r\n        this.output = outputElement;\r\n        this.displayImage = displayImageElement;\r\n\r\n        // Optional: Add custom event listener\r\n        document.body.addEventListener('editTerrainImage', this.displayStoredBase64Tiles);\r\n    }\r\n\r\n    processImage(imageUrl) {\r\n        const img = new Image();\r\n        img.onload = () => {\r\n            // Create a temporary canvas to process the image\r\n            const canvas = document.createElement('canvas');\r\n            canvas.width = this.tileWidth * this.tilesX;\r\n            canvas.height = this.tileHeight * this.tilesY;\r\n\r\n            const ctx = canvas.getContext('2d');\r\n            \r\n            // Set transparent background\r\n            ctx.globalCompositeOperation = 'source-over';\r\n            ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n            \r\n            // Draw the uploaded image, scaling to fit the canvas\r\n            ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\r\n\r\n            // Convert to base64 tiles with vertical flips\r\n            const base64Tiles = this.convertCanvasToBase64Tiles(canvas);\r\n            \r\n            // Save base64 tiles to output\r\n            this.output.value = JSON.stringify(base64Tiles);\r\n\r\n            // Display the original uploaded image\r\n            this.displayImage.src = imageUrl;\r\n        };\r\n        img.src = imageUrl;\r\n    }\r\n\r\n\r\n\r\n    // Convert canvas to array of base64 tiles with vertical flips\r\n    convertCanvasToBase64Tiles(canvas, format = 'png', quality = 1.0) {\r\n        const base64Tiles = [];\r\n\r\n        // First, process the first row of tiles normally\r\n        for (let x = 0; x < this.tilesX; x++) {\r\n            const tileCanvas = document.createElement('canvas');\r\n            tileCanvas.width = this.tileWidth;\r\n            tileCanvas.height = this.tileHeight;\r\n            const tileCtx = tileCanvas.getContext('2d');\r\n\r\n            // Calculate the source position on the main canvas\r\n            const srcX = x * this.tileWidth;\r\n            const srcY = 0;\r\n\r\n            // Get the image data for this tile\r\n            const imageData = canvas.getContext('2d').getImageData(\r\n                srcX, srcY, this.tileWidth, this.tileHeight\r\n            );\r\n\r\n            // Put the image data on the tile canvas\r\n            tileCtx.putImageData(imageData, 0, 0);\r\n\r\n            // Convert the tile canvas to a data URL\r\n            const dataUrl = tileCanvas.toDataURL(`image/${format}`, quality);\r\n\r\n            // Extract the Base64 string (remove the prefix)\r\n            const base64String = dataUrl.split(',')[1];\r\n\r\n            // Add to the array\r\n            base64Tiles.push(base64String);\r\n        }\r\n\r\n        // Now create vertically flipped versions of the first row\r\n        for (let x = 0; x < this.tilesX; x++) {\r\n            const tileCanvas = document.createElement('canvas');\r\n            tileCanvas.width = this.tileWidth;\r\n            tileCanvas.height = this.tileHeight;\r\n            const tileCtx = tileCanvas.getContext('2d');\r\n\r\n            // Calculate the source position on the main canvas\r\n            const srcX = x * this.tileWidth;\r\n            const srcY = 0;\r\n\r\n            // Get the image data for this tile\r\n            const imageData = canvas.getContext('2d').getImageData(\r\n                srcX, srcY, this.tileWidth, this.tileHeight\r\n            );\r\n\r\n            // Create a new ImageData for the flipped tile\r\n            const flippedImageData = new ImageData(this.tileWidth, this.tileHeight);\r\n            for (let y = 0; y < this.tileHeight; y++) {\r\n                for (let x = 0; x < this.tileWidth; x++) {\r\n                    const srcIndex = (y * this.tileWidth + x) * 4;\r\n                    const destIndex = ((this.tileHeight - 1 - y) * this.tileWidth + x) * 4;\r\n                    \r\n                    flippedImageData.data[destIndex] = imageData.data[srcIndex];     // R\r\n                    flippedImageData.data[destIndex + 1] = imageData.data[srcIndex + 1]; // G\r\n                    flippedImageData.data[destIndex + 2] = imageData.data[srcIndex + 2]; // B\r\n                    flippedImageData.data[destIndex + 3] = imageData.data[srcIndex + 3]; // A\r\n                }\r\n            }\r\n\r\n            // Put the flipped image data on the tile canvas\r\n            tileCtx.putImageData(flippedImageData, 0, 0);\r\n\r\n            // Convert the tile canvas to a data URL\r\n            const dataUrl = tileCanvas.toDataURL(`image/${format}`, quality);\r\n\r\n            // Extract the Base64 string (remove the prefix)\r\n            const base64String = dataUrl.split(',')[1];\r\n\r\n            // Add to the array\r\n            base64Tiles.push(base64String);\r\n        }\r\n\r\n        return base64Tiles;\r\n    }\r\n\r\n    // Display stored base64 tiles\r\n    displayStoredBase64Tiles() {\r\n        // Check if there are stored base64 tiles\r\n        if (!this.output.value) return;\r\n\r\n        try {\r\n            // Parse the stored base64 tiles\r\n            const base64Tiles = JSON.parse(this.output.value);\r\n\r\n            // Validate the number of tiles\r\n            if (!Array.isArray(base64Tiles) || base64Tiles.length !== 8) {\r\n                console.error('Invalid base64 tiles array');\r\n                return;\r\n            }\r\n\r\n            const img = new Image();\r\n            const canvas = document.createElement('canvas');\r\n            canvas.width = this.tileWidth * this.tilesX;\r\n            canvas.height = this.tileHeight * this.tilesY;\r\n            const ctx = canvas.getContext('2d');\r\n\r\n            let loadedImages = 0;\r\n            const tileImages = new Array(8).fill(null);\r\n\r\n            base64Tiles.forEach((base64String, index) => {\r\n                const tileImg = new Image();\r\n                tileImg.onload = () => {\r\n                    tileImages[index] = tileImg;\r\n                    loadedImages++;\r\n\r\n                    // Once all images are loaded, draw them\r\n                    if (loadedImages === base64Tiles.length) {\r\n                        // Draw first row of tiles\r\n                        for (let x = 0; x < this.tilesX; x++) {\r\n                            ctx.drawImage(tileImages[x], x * this.tileWidth, 0);\r\n                        }\r\n\r\n                        // Set the final image\r\n                        this.displayImage.src = canvas.toDataURL('image/png');\r\n                    }\r\n                };\r\n\r\n                // Ensure the base64 string has the correct data URL prefix\r\n                if (!base64String.startsWith('data:image/')) {\r\n                    base64String = 'data:image/png;base64,' + base64String;\r\n                }\r\n                tileImg.src = base64String;\r\n            });\r\n        } catch (error) {\r\n            console.error('Error parsing stored base64 tiles:', error);\r\n        }\r\n    }\r\n\r\n    // Method to clean up event listeners if needed\r\n    destroy() {\r\n        document.body.removeEventListener('editTerrainImage', this.displayStoredBase64Tiles);\r\n    }\r\n}"
      },
      "TextureEditor": {
        "title": "TextureEditor",
        "fileName": "TextureEditor",
        "script": "class TextureEditor {\n    constructor(gameEditor) {\n        this.gameEditor = gameEditor;\n        this.canvas = null;\n        this.ctx = null;\n        this.currentColor = '#000000FF'; // Added alpha component (FF = fully opaque)\n        this.brushSize = 1;\n        this.isDrawing = false;\n        this.history = [];\n        this.historyIndex = -1;\n        this.colorPalette = [];\n        if (this.gameEditor.getCollections().palettes && this.gameEditor.getCollections().configs.game.palette) {\n            const palette = this.gameEditor.getCollections().palettes[this.gameEditor.getCollections().configs.game.palette];\n\n            if (palette) {\n                for(let key in palette) {\n                    if(key.toLowerCase().endsWith('color')){\n                        this.colorPalette.push(palette[key]);\n                    }\n                }\n            }\n        }\n        this.activeTool = 'brush'; // Default active tool\n        \n        // Transparency checker pattern properties\n        this.transparencyCheckerSize = 10;\n        this.transparencyCheckerColors = ['#DDDDDD', '#FFFFFF'];\n        \n        // Zoom related properties\n        this.zoomLevel = 1;\n        this.maxZoomLevel = 16;\n        this.minZoomLevel = 0.25;\n        this.imageWidth = 0;\n        this.imageHeight = 0;\n        \n        this.setupUI();\n        this.setupEventListeners();\n    }\n\n    setupUI() {\n        const container = document.getElementById('texture-editor-container');\n        if (!container) return;\n        \n        // Setup color palette\n        const paletteEl = container.querySelector('#color-palette');\n        this.colorPalette.forEach(color => {\n            const colorBtn = document.createElement('div');\n            colorBtn.className = 'color-btn';\n            colorBtn.style.backgroundColor = this.hexToRgbaString(color);\n            colorBtn.dataset.color = color;\n            paletteEl.appendChild(colorBtn);\n        });\n\n        // Initialize canvas\n        this.canvas = document.getElementById('texture-canvas');\n        this.ctx = this.canvas.getContext('2d', { willReadFrequently: true });\n        \n        // Set initial UI state\n        document.getElementById('noTextureMessage').style.display = 'block';\n        this.canvas.style.display = 'none';\n                \n        // Add zoom controls to the UI\n        this.addZoomControls(container);\n        // Create a container for the canvas if it doesn't exist\n        let canvasContainer = this.canvas.parentElement;\n\n        if (canvasContainer) {\n            \n            // Add transparency checker pattern background to container\n            this.setupTransparencyChecker(canvasContainer);\n\n        }\n    }\n    \n    addZoomControls(container) {\n        // Create zoom controls container\n        const zoomControlsContainer = document.createElement('div');\n        zoomControlsContainer.className = 'zoom-controls';\n        zoomControlsContainer.style.display = 'flex';\n        zoomControlsContainer.style.alignItems = 'center';\n        zoomControlsContainer.style.marginTop = '10px';\n        \n        // Zoom out button\n        const zoomOutBtn = document.createElement('button');\n        zoomOutBtn.id = 'zoom-out-btn';\n        zoomOutBtn.innerText = '-';\n        zoomOutBtn.className = 'zoom-btn';\n        \n        // Zoom display\n        const zoomDisplay = document.createElement('span');\n        zoomDisplay.id = 'zoom-display';\n        zoomDisplay.innerText = '100%';\n        zoomDisplay.style.margin = '0 10px';\n        \n        // Zoom in button\n        const zoomInBtn = document.createElement('button');\n        zoomInBtn.id = 'zoom-in-btn';\n        zoomInBtn.innerText = '+';\n        zoomInBtn.className = 'zoom-btn';\n        \n        // Reset zoom button\n        const resetZoomBtn = document.createElement('button');\n        resetZoomBtn.id = 'reset-zoom-btn';\n        resetZoomBtn.innerText = 'Reset Zoom';\n        resetZoomBtn.className = 'zoom-btn';\n        resetZoomBtn.style.marginLeft = '10px';\n        \n        // Dimensions display\n        const dimensionsDisplay = document.createElement('span');\n        dimensionsDisplay.id = 'dimensions-display';\n        dimensionsDisplay.innerText = 'Dimensions: 0 x 0';\n        dimensionsDisplay.style.marginLeft = '15px';\n        \n        // Add all controls to container\n        zoomControlsContainer.appendChild(zoomOutBtn);\n        zoomControlsContainer.appendChild(zoomDisplay);\n        zoomControlsContainer.appendChild(zoomInBtn);\n        zoomControlsContainer.appendChild(resetZoomBtn);\n        zoomControlsContainer.appendChild(dimensionsDisplay);\n        \n        // Add container to the editor UI\n        container.appendChild(zoomControlsContainer);\n    }\n\n    setupEventListeners() {\n        const container = document.getElementById('texture-editor-container');\n        if (!container) return;\n\n        // Global events\n        document.body.addEventListener('editTexture', (event) => {\n            this.updateUIFromSettings(event.detail.data);\n        });\n\n        // Tool selection\n        container.querySelectorAll('.tool-btn').forEach(btn => {\n            btn.addEventListener('click', (e) => {\n                container.querySelectorAll('.tool-btn').forEach(b => b.classList.remove('active'));\n                e.target.classList.add('active');\n                this.setActiveTool(e.target.id);\n            });\n        });\n\n        // Brush size\n        const brushSizeInput = container.querySelector('#brush-size');\n        const brushSizeDisplay = container.querySelector('#brush-size-display');\n        brushSizeInput.addEventListener('input', (e) => {\n            this.brushSize = parseInt(e.target.value);\n            brushSizeDisplay.textContent = `${this.brushSize}px`;\n        });\n\n        // Color palette\n        container.querySelectorAll('.color-btn').forEach(btn => {\n            btn.addEventListener('click', (e) => {\n                container.querySelectorAll('.color-btn').forEach(b => b.classList.remove('active'));\n                e.target.classList.add('active');\n                this.currentColor = e.target.dataset.color;\n                // Update both color and transparency inputs\n                const colorValue = this.currentColor.substring(0, 7);\n                const alphaValue = parseInt(this.currentColor.substring(7, 9), 16) || 255;\n                \n                container.querySelector('#custom-color-picker').value = colorValue;\n                const transparencySlider = container.querySelector('#transparency-slider');\n                if (transparencySlider) {\n                    transparencySlider.value = alphaValue;\n                    document.getElementById('transparency-display').textContent = \n                        `${Math.round((alphaValue / 255) * 100)}%`;\n                }\n            });\n        });\n\n        // Custom color picker\n        const customColorPicker = container.querySelector('#custom-color-picker');\n        customColorPicker.addEventListener('input', (e) => {\n            // Preserve alpha when changing color\n            const alpha = this.currentColor.substring(7, 9) || 'FF';\n            this.currentColor = e.target.value + alpha;\n            container.querySelectorAll('.color-btn').forEach(b => b.classList.remove('active'));\n        });\n        \n        // Transparency slider\n        const transparencySlider = container.querySelector('#transparency-slider');\n        transparencySlider.addEventListener('input', (e) => {\n            const alphaValue = parseInt(e.target.value);\n            const alphaHex = alphaValue.toString(16).padStart(2, '0').toUpperCase();\n            \n            // Update alpha in the current color\n            this.currentColor = this.currentColor.substring(0, 7) + alphaHex;\n            \n            // Update display\n            document.getElementById('transparency-display').textContent = \n                `${Math.round((alphaValue / 255) * 100)}%`;\n        });\n\n        // Canvas drawing events\n        this.canvas.addEventListener('mousedown', (e) => {\n            if (e.button === 0) { // Left click                \n                this.startDrawing(e);\n            }\n        });\n        \n        this.canvas.addEventListener('mousemove', (e) => {\n            if (this.isDrawing) {\n                this.draw(e);\n            }\n        });\n        \n        this.canvas.addEventListener('mouseup', (e) => {\n            if (e.button === 0) { // Left click\n                if (this.isDrawing) {\n                    this.stopDrawing();\n                }\n            } \n        });\n        \n        this.canvas.addEventListener('mouseleave', () => {\n            this.stopDrawing();\n        });\n        \n        // Zoom with mouse wheel\n        this.canvas.addEventListener('wheel', (e) => {\n            e.preventDefault();\n            \n            // Calculate zoom point relative to canvas\n            const rect = this.canvas.getBoundingClientRect();\n            const mouseX = e.clientX - rect.left;\n            const mouseY = e.clientY - rect.top;\n            \n            // Calculate zoom direction\n            const zoomFactor = e.deltaY < 0 ? 1.1 : 0.9;\n            \n            // Calculate new zoom level\n            let newZoom = this.zoomLevel * zoomFactor;\n            \n            // Constrain zoom level\n            newZoom = Math.max(this.minZoomLevel, Math.min(this.maxZoomLevel, newZoom));\n            \n            // Calculate zoom point in image coordinates\n            const imageX = mouseX / this.zoomLevel;\n            const imageY = mouseY / this.zoomLevel;\n            \n            // Update zoom level\n            this.zoomLevel = newZoom;            \n            \n            // Update display\n            this.updateZoomDisplay();\n            this.renderCanvas();\n        });\n        \n        // Zoom control buttons\n        container.querySelector('#zoom-in-btn').addEventListener('click', () => {\n            this.zoom(1.25);\n        });\n        \n        container.querySelector('#zoom-out-btn').addEventListener('click', () => {\n            this.zoom(0.8);\n        });\n        \n        container.querySelector('#reset-zoom-btn').addEventListener('click', () => {\n            this.resetZoom();\n        });\n\n        // Action buttons\n        container.querySelector('#new-btn').addEventListener('click', () => this.newImage());\n        container.querySelector('#undo-btn').addEventListener('click', () => this.undo());\n        container.querySelector('#redo-btn').addEventListener('click', () => this.redo());\n        container.querySelector('#clear-btn').addEventListener('click', () => this.clear());\n        container.querySelector('.export-btn').addEventListener('click', () => {\n            this.saveTexture(this.getCurrentTexture());\n        });\n\n        // File upload\n        container.querySelector('input[type=\"file\"]').addEventListener('change', (e) => {\n            this.handleImageUpload(e);\n        });\n    }\n\n    zoom(factor) {\n        // Calculate new zoom level\n        let newZoom = this.zoomLevel * factor;\n        \n        // Constrain zoom level\n        newZoom = Math.max(this.minZoomLevel, Math.min(this.maxZoomLevel, newZoom));\n        \n        // Calculate center point of the viewport\n        const viewportWidth = this.canvas.clientWidth;\n        const viewportHeight = this.canvas.clientHeight;\n        const centerX = viewportWidth / 2;\n        const centerY = viewportHeight / 2;\n        \n        // Calculate zoom point in image coordinates\n        const imageX = centerX / this.zoomLevel;\n        const imageY = centerY / this.zoomLevel;\n        \n        // Update zoom level\n        this.zoomLevel = newZoom;\n        \n        // Update display\n        this.updateZoomDisplay();\n        this.renderCanvas();\n        // Update canvas display size\n        this.updateCanvasDisplaySize();\n    }\n    \n    updateCanvasDisplaySize() {\n\n        \n        // Set the canvas display size based on zoom\n        const displayWidth = Math.ceil(this.imageWidth * this.zoomLevel);\n        const displayHeight = Math.ceil(this.imageHeight * this.zoomLevel);\n        \n        this.canvas.style.width = `${displayWidth}px`;\n        this.canvas.style.height = `${displayHeight}px`;\n        this.transparencyChecker.style.width = `${displayWidth}px`;\n        this.transparencyChecker.style.height = `${displayHeight}px`;\n        \n        // Update the cursor based on the active tool\n        this.canvas.style.cursor = this.getToolCursor();\n    }\n    \n    setupTransparencyChecker(container) {\n        const displayWidth = Math.ceil(this.imageWidth * this.zoomLevel);\n        const displayHeight = Math.ceil(this.imageHeight * this.zoomLevel);\n        // Create and add transparency checker background\n        this.transparencyChecker = document.createElement('div');\n        this.transparencyChecker.className = 'transparency-checker';\n        this.transparencyChecker.style.position = 'absolute';\n        this.transparencyChecker.style.top = '0';\n        this.transparencyChecker.style.left = '0';\n        this.transparencyChecker.style.bottom = '0';\n        this.transparencyChecker.style.right = '0';        \n        this.transparencyChecker.style.margin = 'auto';\n        this.transparencyChecker.style.width = `${displayWidth}px`;\n        this.transparencyChecker.style.height = `${displayHeight}px`;\n        this.transparencyChecker.style.backgroundImage = 'linear-gradient(45deg, #ffffff10 25%, transparent 25%), linear-gradient(-45deg, #ffffff10 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #ffffff10 75%), linear-gradient(-45deg, transparent 75%, #ffffff10 75%)';\n        this.transparencyChecker.style.backgroundSize = '10px 10px';\n        this.transparencyChecker.style.backgroundPosition = '0 0, 0 10px, 10px -10px, -10px 0px';\n        this.transparencyChecker.style.pointerEvents = 'none'; // Make it non-interactive\n        this.transparencyChecker.style.zIndex = '-1';\n        \n        container.appendChild(this.transparencyChecker);\n    }\n    \n    resetZoom() {\n        // Reset zoom level\n        this.zoomLevel = 1;\n        \n        // Update display\n        this.updateZoomDisplay();\n        this.renderCanvas();\n    }\n    \n    updateZoomDisplay() {\n        const zoomDisplay = document.getElementById('zoom-display');\n        if (zoomDisplay) {\n            zoomDisplay.innerText = `${Math.round(this.zoomLevel * 100)}%`;\n        }\n    }\n    \n    getToolCursor() {\n        switch (this.activeTool) {\n            case 'brush': return 'crosshair';\n            case 'eraser': return 'cell';\n            case 'fill': return 'pointer';\n            case 'eyedropper': return 'copy';\n            default: return 'crosshair';\n        }\n    }\n\n    setActiveTool(toolId) {\n        switch (toolId) {\n            case 'brush-tool':\n                this.activeTool = 'brush';\n                this.canvas.style.cursor = 'crosshair';\n                break;\n            case 'eraser-tool':\n                this.activeTool = 'eraser';\n                this.canvas.style.cursor = 'cell';\n                break;\n            case 'fill-tool':\n                this.activeTool = 'fill';\n                this.canvas.style.cursor = 'pointer';\n                break;\n            case 'eyedropper-tool':\n                this.activeTool = 'eyedropper';\n                this.canvas.style.cursor = 'copy';\n                break;\n            default:\n                this.activeTool = 'brush';\n                this.canvas.style.cursor = 'crosshair';\n        }\n    }\n\n    updateUIFromSettings(imageSrc) {\n        if (!imageSrc) {\n            document.getElementById('noTextureMessage').style.display = 'block';\n            this.canvas.style.display = 'none';\n            return;\n        }\n\n        // Load image onto canvas\n        const img = new Image();\n        img.onload = () => {\n            // Set canvas dimensions to match image dimensions\n            this.imageWidth = img.width;\n            this.imageHeight = img.height;\n            \n            // Update canvas size to match image size\n            this.canvas.width = this.imageWidth;\n            this.canvas.height = this.imageHeight;\n            \n            // Update dimensions display\n            this.updateDimensionsDisplay();\n            \n            // Show canvas and hide message\n            document.getElementById('noTextureMessage').style.display = 'none';\n            this.canvas.style.display = 'block';\n            \n            // Draw image on canvas with proper alpha support\n            this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n            this.ctx.drawImage(img, 0, 0, this.imageWidth, this.imageHeight);\n            \n            // Reset zoom\n            this.resetZoom();\n            \n            // Save initial state to history\n            this.saveToHistory();\n            \n            // Apply initial render\n            this.renderCanvas();\n        };\n        img.src = imageSrc;\n    }\n    \n    updateDimensionsDisplay() {\n        const dimensionsDisplay = document.getElementById('dimensions-display');\n        if (dimensionsDisplay) {\n            dimensionsDisplay.innerText = `Dimensions: ${this.imageWidth} x ${this.imageHeight}`;\n        }\n    }\n    \n    renderCanvas() {\n        // Store the current state\n        const currentState = this.ctx.getImageData(0, 0, this.canvas.width, this.canvas.height);\n        \n        // Clear the canvas\n        this.ctx.setTransform(1, 0, 0, 1, 0, 0);\n        this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n        \n        // Set up the transformation for zoom\n        this.ctx.setTransform(\n            this.zoomLevel, 0, \n            0, this.zoomLevel, \n            this.zoomLevel, \n            this.zoomLevel\n        );\n        \n        // Draw the image data\n        this.ctx.putImageData(currentState, 0, 0);\n        \n        // Reset the transformation for UI elements\n        this.ctx.setTransform(1, 0, 0, 1, 0, 0);\n    }\n\n    startDrawing(e) {\n        this.isDrawing = true;\n        \n        // Save state before drawing\n        this.saveToHistory();\n        \n        const pos = this.getCanvasCoordinates(e);\n        \n        switch (this.activeTool) {\n            case 'brush':\n                this.drawPixel(pos.x, pos.y);\n                break;\n            case 'eraser':\n                this.erasePixel(pos.x, pos.y);\n                break;\n            case 'fill':\n                this.fillArea(pos.x, pos.y);\n                break;\n            case 'eyedropper':\n                this.pickColor(pos.x, pos.y);\n                break;\n        }\n    }\n\n    draw(e) {\n        if (!this.isDrawing) return;\n        \n        const pos = this.getCanvasCoordinates(e);\n        \n        switch (this.activeTool) {\n            case 'brush':\n                this.drawPixel(pos.x, pos.y);\n                break;\n            case 'eraser':\n                this.erasePixel(pos.x, pos.y);\n                break;\n        }\n    }\n\n    stopDrawing() {\n        this.isDrawing = false;\n    }\n\n    getCanvasCoordinates(e) {\n        const rect = this.canvas.getBoundingClientRect();\n        \n        // Calculate the mouse position relative to the canvas\n        const mouseX = e.clientX - rect.left;\n        const mouseY = e.clientY - rect.top;\n        \n        // Convert to image coordinates considering zoom\n        const x = Math.floor(mouseX / this.zoomLevel);\n        const y = Math.floor(mouseY / this.zoomLevel);\n        \n        return { x, y };\n    }\n\n    drawPixel(x, y) {\n        // Save current transform\n        this.ctx.save();\n        \n        // Reset transform for accurate drawing\n        this.ctx.setTransform(1, 0, 0, 1, 0, 0);\n        \n        // Use RGBA for colors with transparency\n        this.ctx.fillStyle = this.hexToRgbaString(this.currentColor);\n        \n        if (this.brushSize === 1) {\n            this.ctx.fillRect(x, y, 1, 1);\n        } else {\n            const offset = Math.floor(this.brushSize / 2);\n            for (let i = -offset; i < this.brushSize - offset; i++) {\n                for (let j = -offset; j < this.brushSize - offset; j++) {\n                    const posX = x + i;\n                    const posY = y + j;\n                    if (posX >= 0 && posX < this.canvas.width && posY >= 0 && posY < this.canvas.height) {\n                        this.ctx.fillRect(posX, posY, 1, 1);\n                    }\n                }\n            }\n        }\n        \n        // Restore transform\n        this.ctx.restore();\n        \n        // Reapply zoom\n        this.renderCanvas();\n    }\n    erasePixel(x, y) {\n        // Save current transform\n        this.ctx.save();\n        \n        // Reset transform for accurate erasing\n        this.ctx.setTransform(1, 0, 0, 1, 0, 0);\n        \n        // Get current image data\n        const imageData = this.ctx.getImageData(0, 0, this.canvas.width, this.canvas.height);\n        const data = imageData.data;\n        \n        // Apply eraser to pixels\n        if (this.brushSize === 1) {\n            const index = (y * this.canvas.width + x) * 4;\n            // Set all channels (RGB and Alpha) to 0 for full transparency\n            data[index] = 0;     // R\n            data[index + 1] = 0; // G\n            data[index + 2] = 0; // B\n            data[index + 3] = 0; // A\n        } else {\n            const offset = Math.floor(this.brushSize / 2);\n            for (let i = -offset; i < this.brushSize - offset; i++) {\n                for (let j = -offset; j < this.brushSize - offset; j++) {\n                    const posX = x + i;\n                    const posY = y + j;\n                    if (posX >= 0 && posX < this.canvas.width && posY >= 0 && posY < this.canvas.height) {\n                        const index = (posY * this.canvas.width + posX) * 4;\n                        // Set all channels to 0\n                        data[index] = 0;     // R\n                        data[index + 1] = 0; // G\n                        data[index + 2] = 0; // B\n                        data[index + 3] = 0; // A\n                    }\n                }\n            }\n        }\n        \n        // Put the modified image data back\n        this.ctx.putImageData(imageData, 0, 0);\n        \n        // Restore transform\n        this.ctx.restore();\n        \n        // Reapply zoom\n        this.renderCanvas();\n    }\n\n    fillArea(x, y) {\n        if (x < 0 || x >= this.imageWidth || y < 0 || y >= this.imageHeight) {\n            return; // Out of bounds\n        }\n        \n        // Save current transform\n        this.ctx.save();\n        \n        // Reset transform for accurate fill\n        this.ctx.setTransform(1, 0, 0, 1, 0, 0);\n        \n        // Get the pixel color at the clicked position\n        const imageData = this.ctx.getImageData(0, 0, this.canvas.width, this.canvas.height);\n        const data = imageData.data;\n        \n        // Get the index of the clicked pixel\n        const index = (y * this.canvas.width + x) * 4;\n        const targetR = data[index];\n        const targetG = data[index + 1];\n        const targetB = data[index + 2];\n        const targetA = data[index + 3];\n        \n        // Don't fill if clicking on the same color\n        const fillColor = this.hexToRgba(this.currentColor);\n        if (targetR === fillColor.r && targetG === fillColor.g && targetB === fillColor.b && targetA === fillColor.a) {\n            this.ctx.restore();\n            return;\n        }\n        \n        // Flood fill algorithm\n        const stack = [{x, y}];\n        const visited = new Set();\n        \n        while (stack.length > 0) {\n            const pixel = stack.pop();\n            const px = pixel.x;\n            const py = pixel.y;\n            \n            // Skip if outside canvas or already visited\n            if (px < 0 || px >= this.canvas.width || py < 0 || py >= this.canvas.height ||\n                visited.has(`${px},${py}`)) {\n                continue;\n            }\n            \n            // Get current pixel index\n            const currentIndex = (py * this.canvas.width + px) * 4;\n            \n            // Check if the pixel has the target color\n            if (data[currentIndex] === targetR && \n                data[currentIndex + 1] === targetG && \n                data[currentIndex + 2] === targetB && \n                data[currentIndex + 3] === targetA) {\n                \n                // Set the new color\n                data[currentIndex] = fillColor.r;\n                data[currentIndex + 1] = fillColor.g;\n                data[currentIndex + 2] = fillColor.b;\n                data[currentIndex + 3] = fillColor.a;\n                \n                // Mark as visited\n                visited.add(`${px},${py}`);\n                \n                // Add neighbors to stack\n                stack.push({x: px + 1, y: py});\n                stack.push({x: px - 1, y: py});\n                stack.push({x: px, y: py + 1});\n                stack.push({x: px, y: py - 1});\n            }\n        }\n        \n        // Update the canvas with the new image data\n        this.ctx.putImageData(imageData, 0, 0);\n        \n        // Restore transform\n        this.ctx.restore();\n        \n        // Reapply zoom\n        this.renderCanvas();\n    }\n\n    pickColor(x, y) {\n        if (x < 0 || x >= this.imageWidth || y < 0 || y >= this.imageHeight) {\n            return; // Out of bounds\n        }\n        \n        // Save current transform\n        this.ctx.save();\n        \n        // Reset transform for accurate color picking\n        this.ctx.setTransform(1, 0, 0, 1, 0, 0);\n        \n        const pixel = this.ctx.getImageData(x, y, 1, 1).data;\n        \n        // Create hex color including alpha\n        const hexColor = `#${pixel[0].toString(16).padStart(2, '0')}${pixel[1].toString(16).padStart(2, '0')}${pixel[2].toString(16).padStart(2, '0')}${pixel[3].toString(16).padStart(2, '0')}`;\n        \n        this.currentColor = hexColor;\n        \n        // Update UI to show selected color\n        const customColorPicker = document.querySelector('#custom-color-picker');\n        if (customColorPicker) {\n            customColorPicker.value = hexColor.substring(0, 7);\n        }\n        \n        // Update transparency slider\n        const transparencySlider = document.querySelector('#transparency-slider');\n        if (transparencySlider) {\n            transparencySlider.value = pixel[3];\n            document.getElementById('transparency-display').textContent = \n                `${Math.round((pixel[3] / 255) * 100)}%`;\n        }\n        \n        // Deselect any color in the palette\n        document.querySelectorAll('.color-btn').forEach(btn => {\n            btn.classList.remove('active');\n            if (btn.dataset.color === hexColor) {\n                btn.classList.add('active');\n            }\n        });\n        \n        // Restore transform\n        this.ctx.restore();\n    }\n\n    hexToRgba(hex) {\n        const r = parseInt(hex.slice(1, 3), 16);\n        const g = parseInt(hex.slice(3, 5), 16);\n        const b = parseInt(hex.slice(5, 7), 16);\n        const a = parseInt(hex.slice(7, 9) || 'FF', 16);\n        return { r, g, b, a };\n    }\n    \n    hexToRgbaString(hex) {\n        const { r, g, b, a } = this.hexToRgba(hex);\n        return `rgba(${r}, ${g}, ${b}, ${a / 255})`;\n    }\n\n    saveToHistory() {\n        // Trim history if we're not at the end\n        if (this.historyIndex < this.history.length - 1) {\n            this.history = this.history.slice(0, this.historyIndex + 1);\n        }\n        \n        // Save current state - we need to reset transform to get the actual image data\n        this.ctx.save();\n        this.ctx.setTransform(1, 0, 0, 1, 0, 0);\n        const imageData = this.ctx.getImageData(0, 0, this.canvas.width, this.canvas.height);\n        this.ctx.restore();\n        \n        // Save to history\n        this.history.push(imageData);\n        this.historyIndex = this.history.length - 1;\n        \n        // Update undo/redo buttons\n        this.updateUndoRedoButtons();\n    }\n\n    updateUndoRedoButtons() {\n        const undoBtn = document.getElementById('undo-btn');\n        const redoBtn = document.getElementById('redo-btn');\n        \n        if (undoBtn) {\n            undoBtn.disabled = this.historyIndex <= 0;\n        }\n        \n        if (redoBtn) {\n            redoBtn.disabled = this.historyIndex >= this.history.length - 1;\n        }\n    }\n\n    newImage() {\n        // Prompt user for dimensions\n        const width = prompt('Enter width for new texture (1-2048):', '64');\n        const height = prompt('Enter height for new texture (1-2048):', '64');\n    \n        // Validate input\n        const newWidth = parseInt(width);\n        const newHeight = parseInt(height);\n    \n        if (isNaN(newWidth) || isNaN(newHeight) || newWidth < 1 || newWidth > 2048 || newHeight < 1 || newHeight > 2048) {\n            alert('Invalid dimensions. Please enter values between 1 and 2048.');\n            return;\n        }\n    \n        // Save current state before creating a new texture\n        this.saveToHistory();\n    \n        // Set canvas dimensions\n        this.imageWidth = newWidth;\n        this.imageHeight = newHeight;\n        this.canvas.width = this.imageWidth;\n        this.canvas.height = this.imageHeight;\n    \n        // Clear canvas with full transparency\n        this.ctx.setTransform(1, 0, 0, 1, 0, 0);\n        this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n    \n        // Update dimensions display\n        this.updateDimensionsDisplay();\n    \n        // Show canvas and hide no texture message\n        document.getElementById('noTextureMessage').style.display = 'none';\n        this.canvas.style.display = 'block';\n    \n        // Reset zoom\n        this.resetZoom();\n    \n        // Save initial state to history\n        this.saveToHistory();\n    \n        // Render canvas with zoom\n        this.renderCanvas();\n    }\n\n    undo() {\n        if (this.historyIndex > 0) {\n            this.historyIndex--;\n            \n            // Reset transform to apply image data\n            this.ctx.setTransform(1, 0, 0, 1, 0, 0);\n            this.ctx.putImageData(this.history[this.historyIndex], 0, 0);\n            \n            // Update buttons and rerender\n            this.updateUndoRedoButtons();\n            this.renderCanvas();\n        }\n    }\n\n    redo() {\n        if (this.historyIndex < this.history.length - 1) {\n            this.historyIndex++;\n            \n            // Reset transform to apply image data\n            this.ctx.setTransform(1, 0, 0, 1, 0, 0);\n            this.ctx.putImageData(this.history[this.historyIndex], 0, 0);\n            \n            // Update buttons and rerender\n            this.updateUndoRedoButtons();\n            this.renderCanvas();\n        }\n    }\n\n    clear() {\n        // Save state before clearing\n        this.saveToHistory();\n        \n        // Clear canvas with full transparency\n        this.ctx.setTransform(1, 0, 0, 1, 0, 0);\n        this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n        \n        // Reapply zoom\n        this.renderCanvas();\n    }\n\n    getCurrentTexture() {\n        // Save current state\n        this.ctx.save();\n        \n        // Reset transform to get the actual image data\n        this.ctx.setTransform(1, 0, 0, 1, 0, 0);\n        \n        // Make sure to use PNG format to preserve transparency\n        const dataURL = this.canvas.toDataURL('image/png');\n        \n        // Restore transform\n        this.ctx.restore();\n        \n        return dataURL;\n    }\n\n    saveTexture(data) {\n        document.body.dispatchEvent(new CustomEvent('saveTexture', {\n            detail: { data: data, propertyName: 'image' },\n        }));\n    }\n\n    handleImageUpload(event) {\n        const file = event.target.files[0];\n        if (!file) return;\n        \n        const reader = new FileReader();\n        reader.onload = (e) => {\n            const img = new Image();\n            img.onload = () => {\n                // Set canvas dimensions to match image dimensions\n                this.imageWidth = img.width;\n                this.imageHeight = img.height;\n                this.canvas.width = this.imageWidth;\n                this.canvas.height = this.imageHeight;\n                \n                // Update dimensions display\n                this.updateDimensionsDisplay();\n                \n                // Clear canvas\n                this.ctx.setTransform(1, 0, 0, 1, 0, 0);\n                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n                \n                // Draw image on canvas - this will preserve transparency\n                this.ctx.drawImage(img, 0, 0, this.imageWidth, this.imageHeight);\n                \n                // Show canvas\n                document.getElementById('noTextureMessage').style.display = 'none';\n                this.canvas.style.display = 'block';\n                \n                // Reset zoom\n                this.resetZoom();\n                \n                // Save state to history\n                this.saveToHistory();\n                \n                // Render canvas with zoom\n                this.renderCanvas();\n            };\n            img.src = e.target.result;\n        };\n        reader.readAsDataURL(file);\n    }\n}\n"
      },
      "GE_UIManager": {
        "title": "GE_UIManager",
        "fileName": "GE_UIManager",
        "script": "class GE_UIManager {\r\n    constructor(gameEditor, graphicsEditor) {\r\n        this.gameEditor = gameEditor;\r\n        this.graphicsEditor = graphicsEditor;\r\n        this.mouse = new window.THREE.Vector2();\r\n        this.raycaster = new window.THREE.Raycaster();\r\n        this.isDragging = false;\r\n        this.clickStartTime = 0;\r\n    }    \r\n     \r\n\r\n    init() {   \r\n        this.initEventListeners();\r\n    }\r\n    \r\n    \r\n    \r\n    initEventListeners() {\r\n        // Button event listeners\r\n        const buttonMappings = {\r\n            'generate-isometric': this.showIsometricModal.bind(this),\r\n        };\r\n        Object.entries(buttonMappings).forEach(([id, handler]) => {\r\n            const button = document.getElementById(id);\r\n            if (button) button.addEventListener('click', handler);\r\n        });\r\n\r\n        // Canvas interaction\r\n        this.graphicsEditor.canvas.addEventListener('mousedown', this.handleMouseDown.bind(this));\r\n        this.graphicsEditor.canvas.addEventListener('mousemove', this.handleMouseMove.bind(this));\r\n        this.graphicsEditor.canvas.addEventListener('mouseup', this.handleMouseUp.bind(this));\r\n\r\n        // Additional event listeners\r\n\r\n        \r\n        // Move modal listeners\r\n\r\n        // Isometric modal listeners\r\n        document.getElementById('iso-cancel').addEventListener('click', () => {\r\n            document.getElementById('modal-generateIsoSprites').classList.remove('show');\r\n        });\r\n    }\r\n    handleMouseDown(event) {\r\n        this.isDragging = false;\r\n        this.clickStartTime = Date.now();\r\n    }\r\n\r\n    handleMouseMove() {\r\n        if (Date.now() - this.clickStartTime > 100) {\r\n            this.isDragging = true;\r\n        }\r\n    }\r\n\r\n    handleMouseUp(event) {\r\n        if (this.isDragging) return;\r\n    \r\n        const rect = this.graphicsEditor.canvas.getBoundingClientRect();\r\n        this.mouse.x = ((event.clientX - rect.left) / this.graphicsEditor.canvas.clientWidth) * 2 - 1;\r\n        this.mouse.y = -((event.clientY - rect.top) / this.graphicsEditor.canvas.clientHeight) * 2 + 1;\r\n    \r\n        this.raycaster.setFromCamera(this.mouse, this.graphicsEditor.sceneRenderer.camera);\r\n    \r\n        // Instead of looking only at scene.children, search through all descendant meshes\r\n        const meshes = [];\r\n        this.graphicsEditor.rootGroup.traverse(obj => {\r\n            if (obj.isMesh && obj.userData.isShape) {\r\n                meshes.push(obj);\r\n            }\r\n        });\r\n    \r\n        const intersects = this.raycaster.intersectObjects(meshes, true);\r\n    \r\n        if (intersects.length > 0) {\r\n            // Find the parent mesh with the isShape flag if we've hit a child mesh\r\n            let hitObject = intersects[0].object;\r\n            while (hitObject && !hitObject.userData.isShape) {\r\n                hitObject = hitObject.parent;\r\n            }\r\n            \r\n            if (hitObject && hitObject.userData.index !== undefined) {\r\n                this.graphicsEditor.selectShape(hitObject.userData.index);\r\n            }\r\n        }\r\n    }\r\n    \r\n\r\n    showIsometricModal() {\r\n        document.getElementById('modal-generateIsoSprites').classList.add('show');\r\n    }\r\n    displayIsometricSprites(sprites) {\r\n        const modal = document.createElement('div');\r\n        modal.style.cssText = `\r\n            position: fixed; top: 0; left: 0; width: 100%; height: 100%; \r\n            background-color: rgba(0, 0, 0, 0.7); z-index: 1000; \r\n            display: flex; align-items: center; justify-content: center;\r\n        `;\r\n        const content = document.createElement('div');\r\n        content.style.cssText = `\r\n            background: #333; padding: 20px; border-radius: 8px; \r\n            max-width: 80%; max-height: 80%; overflow: auto;\r\n        `;\r\n    \r\n        const angleLabels = ['NE', 'N', 'NW', 'W', 'SW', 'S', 'SE', 'E']; // Labels for 8 angles\r\n    \r\n        for (const animType in sprites) {\r\n            const animSection = document.createElement('div');\r\n            const title = document.createElement('h3');\r\n            title.textContent = `${animType} Animation`;\r\n            title.style.color = '#e0e0e0';\r\n            animSection.appendChild(title);\r\n    \r\n            // Create a container for all angles\r\n            const anglesContainer = document.createElement('div');\r\n            anglesContainer.style.cssText = `margin: 10px 0;`;\r\n    \r\n            // For each angle (0-7)\r\n            for (let angle = 0; angle < 8; angle++) {\r\n                const angleSection = document.createElement('div');\r\n    \r\n                const grid = document.createElement('div');\r\n                grid.style.cssText = `\r\n                    display: grid; \r\n                    grid-template-columns: repeat(${Math.min(sprites[animType].length, 4)}, 1fr); \r\n                    gap: 5px; \r\n                    margin-bottom: 15px;\r\n                `;\r\n    \r\n                // Add all frames for this specific angle\r\n                sprites[animType].forEach(frame => {\r\n                    const img = document.createElement('img');\r\n                    img.src = frame[angle]; // Get the specific angle's sprite\r\n                    img.style.maxWidth = '100%';\r\n                    grid.appendChild(img);\r\n                });\r\n    \r\n                angleSection.appendChild(grid);\r\n                anglesContainer.appendChild(angleSection);\r\n            }\r\n    \r\n            animSection.appendChild(anglesContainer);\r\n            content.appendChild(animSection);\r\n        }\r\n    \r\n        const closeButton = document.createElement('button');\r\n        closeButton.textContent = 'Close';\r\n        closeButton.style.cssText = `\r\n            margin-top: 20px; padding: 8px 16px; background-color: #4CAF50; \r\n            color: #fff; border: none; border-radius: 6px; cursor: pointer;\r\n        `;\r\n        closeButton.addEventListener('click', () => document.body.removeChild(modal));\r\n        content.appendChild(closeButton);\r\n        modal.appendChild(content);\r\n        document.body.appendChild(modal);\r\n    }\r\n    \r\n    createGroupInspector(group) {\r\n        console.log('create group inspector', group);\r\n        const inspector = document.getElementById('inspector');\r\n        inspector.innerHTML = \"\";\r\n        inspector.className = 'inspector';\r\n\r\n        \r\n        this.addFormRow(inspector, 'X Scale', 'number', 'scaleX', group.scale?.x || 1, { min: 0.1, step: 0.1 });\r\n        this.addFormRow(inspector, 'Y Scale', 'number', 'scaleY', group.scale?.y || 1, { min: 0.1, step: 0.1 });\r\n        this.addFormRow(inspector, 'Z Scale', 'number', 'scaleZ', group.scale?.z || 1, { min: 0.1, step: 0.1 });\r\n        // Position inputs\r\n        this.addFormRow(inspector, 'X Position', 'number', 'x', group.position?.x || 0, { step: 0.1 });\r\n        this.addFormRow(inspector, 'Y Position', 'number', 'y', group.position?.y || 0, { step: 0.1 });\r\n        this.addFormRow(inspector, 'Z Position', 'number', 'z', group.position?.z || 0, { step: 0.1 });\r\n        \r\n        // Rotation inputs\r\n        this.addFormRow(inspector, 'X Rotation', 'number', 'rotationX', group.rotation?.x || 0, { step: 5 });\r\n        this.addFormRow(inspector, 'Y Rotation', 'number', 'rotationY', group.rotation?.y || 0, { step: 5 });\r\n        this.addFormRow(inspector, 'Z Rotation', 'number', 'rotationZ', group.rotation?.z || 0, { step: 5 });\r\n        \r\n    }\r\n\r\n    createInspector(shape) {\r\n        console.log('create shape inspector', shape);\r\n        const inspector = document.getElementById('inspector');\r\n        inspector.innerHTML = \"\";\r\n        inspector.className = 'inspector';\r\n\r\n        this.addFormRow(inspector, 'Name', 'text', 'name', shape.name || \"\");\r\n        \r\n        // Type selector\r\n        this.addFormRow(inspector, 'Type', 'select', 'type', shape.type, {\r\n            options: ['cube', 'sphere', 'box', 'cylinder', 'cone', 'torus', 'tetrahedron', 'gltf'],\r\n            change: (e) => {\r\n                let currentShape = this.graphicsEditor.getFrameShape();\r\n                let newValue = e.target.value;\r\n                if (newValue != 'gltf') {\r\n                    delete currentShape.url\r\n                }                 \r\n                currentShape.type = newValue;\r\n                this.graphicsEditor.refreshShapes(false);\r\n            }\r\n        });\r\n        \r\n        if (shape.type === 'gltf') {            \r\n            let input = this.addFormRow(inspector, 'Model', 'file', 'url', shape.url, { 'change' :  async (e) => {\r\n                e.preventDefault();\r\n\r\n                // Get the file from the input element\r\n                const file = e.target.files[0]; // Access the file object\r\n                if (!file) {\r\n                    console.error('No file selected');\r\n                    return;\r\n                }\r\n                // // Create FormData and append the file\r\n                 const formData = new FormData();\r\n                 formData.append('gltfFile', file); // 'gltfFile' matches the multer.single('gltfFile') on the server\r\n\r\n                try {\r\n                     const response = await fetch('/upload-model', {\r\n                         method: 'POST',\r\n                         body: formData // Send the FormData with the file\r\n                     });\r\n\r\n                     const result = await response.json();\r\n                     shape.url = result.filePath; \r\n                     this.graphicsEditor.getFrameShape().url = result.filePath;\r\n                     this.graphicsEditor.refreshShapes(false);\r\n                } catch (error) {\r\n                     console.error('Error uploading file:', error);\r\n                }\r\n            }});\r\n            input.setAttribute(\"accept\",\".gltf\");\r\n        }\r\n        // Color picker\r\n        this.addFormRow(inspector, 'Color', 'color', 'color', shape.color);\r\n        this.addFormRow(inspector, 'Texture', 'texture', 'texture', shape.texture);\r\n        \r\n        this.addFormRow(inspector, 'X Scale', 'number', 'scaleX', shape.scaleX || 1, { min: 0.1, step: 0.1 });\r\n        this.addFormRow(inspector, 'Y Scale', 'number', 'scaleY', shape.scaleY || 1, { min: 0.1, step: 0.1 });\r\n        this.addFormRow(inspector, 'Z Scale', 'number', 'scaleZ', shape.scaleZ || 1, { min: 0.1, step: 0.1 });\r\n        // Position inputs\r\n        this.addFormRow(inspector, 'X Position', 'number', 'x', shape.x || 0, { step: 0.1 });\r\n        this.addFormRow(inspector, 'Y Position', 'number', 'y', shape.y || 0, { step: 0.1 });\r\n        this.addFormRow(inspector, 'Z Position', 'number', 'z', shape.z || 0, { step: 0.1 });\r\n        \r\n        // Rotation inputs\r\n        this.addFormRow(inspector, 'X Rotation', 'number', 'rotationX', shape.rotationX || 0, { step: 5 });\r\n        this.addFormRow(inspector, 'Y Rotation', 'number', 'rotationY', shape.rotationY || 0, { step: 5 });\r\n        this.addFormRow(inspector, 'Z Rotation', 'number', 'rotationZ', shape.rotationZ || 0, { step: 5 });\r\n        \r\n        // Size inputs\r\n        if (['cube', 'sphere', 'tetrahedron', 'torus'].includes(shape.type)) {\r\n            this.addFormRow(inspector, 'Size', 'number', 'size', shape.size || 2, { min: 0.1, step: 0.1 });\r\n        }\r\n        \r\n        if (shape.type === 'box') {\r\n            this.addFormRow(inspector, 'Width', 'number', 'width', shape.width || 2, { min: 0.1, step: 0.1 });\r\n            this.addFormRow(inspector, 'Height', 'number', 'height', shape.height || 2, { min: 0.1, step: 0.1 });\r\n            this.addFormRow(inspector, 'Depth', 'number', 'depth', shape.depth || 2, { min: 0.1, step: 0.1 });\r\n        }\r\n        \r\n        if (['cylinder', 'cone'].includes(shape.type)) {\r\n            this.addFormRow(inspector, 'Size', 'number', 'size', shape.size || 2, { min: 0.1, step: 0.1 });\r\n            this.addFormRow(inspector, 'Height', 'number', 'height', shape.height || 3, { min: 0.1, step: 0.1 });\r\n        }\r\n        \r\n        if (shape.type === 'torus') {\r\n            this.addFormRow(inspector, 'Tube Size', 'number', 'tubeSize', shape.tubeSize || shape.size / 6, { min: 0.1, step: 0.1 });\r\n        }\r\n    }\r\n\r\n\r\n    addFormRow(container, label, type, property, value, options = {}) {\r\n        const row = document.createElement('div');\r\n        row.className = 'form-row';\r\n        \r\n        const labelElement = document.createElement('label');\r\n        labelElement.textContent = label;\r\n        row.appendChild(labelElement);\r\n        \r\n        let input;\r\n        \r\n        if (type === 'select') {\r\n            input = document.createElement('select');\r\n            input.setAttribute('data-property', property);\r\n            (options.options || []).forEach(optionValue => {\r\n                const option = document.createElement('option');\r\n                option.value = optionValue;\r\n                option.textContent = optionValue;\r\n                if (value === optionValue) {\r\n                    option.selected = true;\r\n                }\r\n                input.appendChild(option);\r\n            });\r\n        } else if(type === \"color\") {\r\n            input = this.gameEditor.createColorInputGroup(value, 'data-property', property, row, (val, colorName) => {\r\n                if(colorName){\r\n                    this.graphicsEditor.getFrameShape()[property] = { paletteColor: colorName };\r\n                } else {\r\n                    this.graphicsEditor.getFrameShape()[property] = val;\r\n                }\r\n                this.graphicsEditor.refreshShapes(false);\r\n            });            \r\n        } else if(type === \"texture\") {\r\n            input = this.gameEditor.createTextureInputGroup(value, 'data-property', property, row, (val) => {\r\n                if(val){\r\n                    this.graphicsEditor.getFrameShape()[property] = val;\r\n                }\r\n                this.graphicsEditor.refreshShapes(false);\r\n            });            \r\n        } else if(type === \"file\") {\r\n            let inputContainer = document.createElement('div');\r\n            inputContainer.style = \"flex: 1; display: flex; flex-direction: column; font-size: .75em;\";\r\n            input = document.createElement('input');\r\n            input.style = \"width: calc(100% - 18px);\"\r\n            input.type = type;\r\n            input.setAttribute('data-property', property);\r\n            inputContainer.appendChild(input);\r\n            if( value ) {\r\n                let urlName = document.createElement('span');\r\n                urlName.innerText = value;            \r\n                inputContainer.appendChild(urlName);\r\n            }\r\n            row.appendChild(inputContainer);\r\n            container.appendChild(row);\r\n            input.addEventListener('change', options.change );\r\n            return input;\r\n        } else {\r\n            input = document.createElement('input');\r\n            input.type = type;\r\n            input.value = value;\r\n            input.setAttribute('data-property', property);\r\n            \r\n            if (type === 'number') {\r\n                input.min = options.min !== undefined ? options.min : -64;\r\n                input.max = options.max !== undefined ? options.max : 64;\r\n                input.step = options.step || 1;\r\n            }\r\n        }\r\n        \r\n        input.addEventListener('change', options.change || ((e) => {\r\n            let newValue = e.target.value;\r\n            if (type === 'number') {\r\n                newValue = parseFloat(newValue);\r\n                console.log('change', this.graphicsEditor.shapeManager.currentTransformTarget);\r\n                // If we're editing a transform property, also update the transform target\r\n                if (this.graphicsEditor.shapeManager.currentTransformTarget && ['x', 'y', 'z', 'rotationX', 'rotationY', 'rotationZ', 'scaleX', 'scaleY', 'scaleZ'].includes(property)) {\r\n                    if (property === 'x') this.graphicsEditor.shapeManager.currentTransformTarget.position.x = newValue;\r\n                    if (property === 'y') this.graphicsEditor.shapeManager.currentTransformTarget.position.y = newValue;\r\n                    if (property === 'z') this.graphicsEditor.shapeManager.currentTransformTarget.position.z = newValue;\r\n                    \r\n                    if (property === 'rotationX') this.graphicsEditor.shapeManager.currentTransformTarget.rotation.x = this.graphicsEditor.rotationUtils.degToRad(newValue);\r\n                    if (property === 'rotationY') this.graphicsEditor.shapeManager.currentTransformTarget.rotation.y = this.graphicsEditor.rotationUtils.degToRad(newValue);\r\n                    if (property === 'rotationZ') this.graphicsEditor.shapeManager.currentTransformTarget.rotation.z = this.graphicsEditor.rotationUtils.degToRad(newValue);\r\n                    \r\n                    if (property === 'scaleX') this.graphicsEditor.shapeManager.currentTransformTarget.scale.x = newValue;\r\n                    if (property === 'scaleY') this.graphicsEditor.shapeManager.currentTransformTarget.scale.y = newValue;\r\n                    if (property === 'scaleZ') this.graphicsEditor.shapeManager.currentTransformTarget.scale.z = newValue;\r\n                    \r\n                    // Update gizmo position after directly changing values\r\n                }\r\n            } else if(type === 'file') {\r\n                return;\r\n            }\r\n            \r\n            this.updatePropertyValue(property, newValue);\r\n            this.graphicsEditor.refreshShapes(false);\r\n        }));\r\n        \r\n        row.appendChild(input);\r\n        container.appendChild(row);\r\n        return input;\r\n    }\r\n    updatePropertyValue(property, value) {\r\n        const shapeData = this.graphicsEditor.getFrameShape();\r\n        if (shapeData) {\r\n            shapeData[property] = value;\r\n            return;\r\n        }\r\n        let groupData = this.graphicsEditor.getCurrentGroup();\r\n        if(!groupData){\r\n            groupData = {};\r\n            let currentFrame = this.graphicsEditor.getCurrentFrame();\r\n            if(currentFrame) {\r\n                currentFrame[this.graphicsEditor.state.currentGroup] = groupData;\r\n            }\r\n        }\r\n        \r\n        // Handle transform properties\r\n        if (property.startsWith('scale')) {\r\n            if(!groupData.scale) groupData.scale = {};\r\n            const axis = property.charAt(property.length - 1).toLowerCase();\r\n            groupData.scale[axis] = value;\r\n        } else if (property.startsWith('rotation')) {\r\n            if(!groupData.rotation) groupData.rotation = {};\r\n            const axis = property.charAt(property.length - 1).toLowerCase();\r\n            groupData.rotation[axis] = value;\r\n        } else if (['x', 'y', 'z'].includes(property)) {\r\n            if(!groupData.position) groupData.position = {};\r\n            groupData.position[property] = value;\r\n        }\r\n    }\r\n\r\n  \r\n\r\n    updateList() {\r\n        const frameList = document.getElementById('frame-list');\r\n        frameList.innerHTML = '';\r\n        const groupList = document.getElementById('group-list');\r\n        groupList.innerHTML = '';\r\n        const shapeList = document.getElementById('shape-list');\r\n        shapeList.innerHTML = '';\r\n        this.updateFrameList();\r\n        this.graphicsEditor.groupManager.updateGroupList();\r\n        this.updateShapeList();\r\n    }\r\n\r\n    updateFrameList() {\r\n        const list = document.getElementById('frame-list');\r\n        // Animation selector\r\n        const animSelector = document.createElement('select');\r\n        animSelector.style.marginBottom = '10px';\r\n\r\n        const option = document.createElement('option');\r\n        option.value = '__model__';\r\n        option.textContent = 'model';\r\n        if (this.graphicsEditor.state.editingModel) option.selected = true;\r\n        animSelector.appendChild(option);\r\n\r\n\r\n        Object.keys(this.graphicsEditor.state.renderData.animations).forEach(anim => {\r\n            const option = document.createElement('option');\r\n            option.value = anim;\r\n            option.textContent = anim;\r\n            if (anim === this.graphicsEditor.state.currentAnimation) option.selected = true;\r\n            animSelector.appendChild(option);\r\n        });\r\n        animSelector.addEventListener('change', (e) => {\r\n            this.graphicsEditor.setPreviewAnimationState(false);\r\n            if(e.target.value == '__model__'){\r\n                this.graphicsEditor.state.editingModel = true;\r\n                this.graphicsEditor.state.currentAnimation = \"\";                \r\n            } else {\r\n                this.graphicsEditor.state.editingModel = false;\r\n                this.graphicsEditor.state.currentAnimation = animSelector.value;                \r\n            }\r\n            this.graphicsEditor.state.currentFrame = 0;\r\n            this.graphicsEditor.refreshShapes(false);\r\n            requestAnimationFrame(() => {\r\n                this.graphicsEditor.state.selectedShapeIndex = -1;\r\n                this.graphicsEditor.shapeManager.selectShape(0);\r\n            })\r\n        });\r\n        list.appendChild(animSelector);\r\n        if(this.graphicsEditor.state.editingModel) return;\r\n        // Frame list\r\n        const frameList = document.createElement('div');\r\n        frameList.style.marginBottom = '10px';\r\n        this.graphicsEditor.getCurrentAnimation().forEach((frame, index) => {\r\n            const frameItem = document.createElement('div');\r\n            frameItem.textContent = `Frame ${index + 1}`;\r\n            frameItem.style.padding = '5px';\r\n            frameItem.style.cursor = 'pointer';\r\n            if (index === this.graphicsEditor.state.currentFrame) frameItem.style.backgroundColor = '#555';\r\n            frameItem.addEventListener('click', () => {\r\n                this.graphicsEditor.setPreviewAnimationState(false);\r\n                this.graphicsEditor.state.currentFrame = index;  \r\n                this.graphicsEditor.refreshShapes(false);\r\n                requestAnimationFrame(() => {  \r\n                    this.graphicsEditor.state.selectedShapeIndex = -1;\r\n                    this.graphicsEditor.shapeManager.selectShape(0);\r\n                })\r\n            });\r\n            frameList.appendChild(frameItem);\r\n        });\r\n        list.appendChild(frameList);\r\n    }\r\n\r\n\r\n    updateShapeList() {\r\n        const list = document.getElementById('shape-list');\r\n        if (!list) return;\r\n        \r\n\r\n        // Get shapes from the currently selected group\r\n        const currentGroup = this.graphicsEditor.state.currentGroup;\r\n        const selectedGroup = this.graphicsEditor.getMergedGroup(currentGroup);\r\n        const shapes = selectedGroup && selectedGroup.shapes ? selectedGroup.shapes : selectedGroup || [];\r\n       \r\n        // Create shape list items\r\n        for (let i = 0; i < shapes.length; i++) {\r\n            const shape = shapes[i];\r\n            if (!shape) continue;\r\n           \r\n            const shapeItem = document.createElement('div');\r\n            shapeItem.classList.add('shape-item');\r\n           \r\n            // Mark as selected if this shape is the selected one and we're in the right group\r\n            if (i === this.graphicsEditor.state.selectedShapeIndex) {\r\n                shapeItem.classList.add('selected');\r\n            }\r\n           \r\n            shapeItem.textContent = `${shape.name} - ${shape.type || 'Shape'}`;\r\n            shapeItem.addEventListener('click', (e) => {               \r\n                this.graphicsEditor.shapeManager.selectShape(parseInt(e.target.dataset.index));\r\n            });\r\n           \r\n            // Make the shape draggable\r\n            shapeItem.draggable = true;\r\n            shapeItem.dataset.index = i;\r\n            shapeItem.dataset.group = currentGroup;\r\n            \r\n            // Add dragstart event to set the drag data\r\n            shapeItem.addEventListener('dragstart', (e) => {\r\n                // Store only the selected shape's index and source group\r\n                const data = {\r\n                    shapeIndex: i,\r\n                    sourceGroup: currentGroup\r\n                };\r\n                \r\n                // Set the drag data\r\n                e.dataTransfer.setData('text/plain', JSON.stringify(data));\r\n                \r\n                // Add a visual indicator\r\n                shapeItem.classList.add('dragging');\r\n                \r\n                // Set drag effect\r\n                e.dataTransfer.effectAllowed = 'move';\r\n            });\r\n            \r\n            // Add dragend event to clean up\r\n            shapeItem.addEventListener('dragend', () => {\r\n                shapeItem.classList.remove('dragging');\r\n            });\r\n           \r\n            list.appendChild(shapeItem);\r\n        }\r\n        \r\n        // Set up the shape list container as a drop target\r\n        list.addEventListener('dragover', (e) => {\r\n            // Only respond if we're dragging over the shape list itself, not an individual shape\r\n            if (e.target === list) {\r\n                e.preventDefault();\r\n                e.dataTransfer.dropEffect = 'move';\r\n                list.classList.add('drag-over');\r\n            }\r\n        });\r\n        \r\n        list.addEventListener('dragleave', (e) => {\r\n            // Only respond if we're leaving the shape list\r\n            if (e.target === list) {\r\n                list.classList.remove('drag-over');\r\n            }\r\n        });\r\n        \r\n        list.addEventListener('drop', (e) => {\r\n            e.preventDefault();\r\n            list.classList.remove('drag-over');\r\n            \r\n            const data = e.dataTransfer.getData('text/plain');\r\n            if (!data) return;\r\n            \r\n            try {\r\n                const dragData = JSON.parse(data);\r\n                const { shapeIndex, sourceGroup } = dragData;\r\n                \r\n                // Only process if this is a different group\r\n                if (sourceGroup && sourceGroup !== currentGroup) {\r\n                    this.graphicsEditor.groupManager.moveToGroup(\r\n                        parseInt(shapeIndex),\r\n                        sourceGroup,\r\n                        currentGroup\r\n                    );\r\n                }\r\n            } catch (err) {\r\n                console.error('Error processing drop in shape list:', err);\r\n            }\r\n        });\r\n    }\r\n\r\n}"
      },
      "ShapeFactory": {
        "fileName": "ShapeFactory",
        "script": "class ShapeFactory {\n    constructor(palette, textures) {\n        this.gltfCache = new Map();\n        this.gltfLoader = new THREE.GLTFLoader();\n        this.palette = palette;\n        this.textures = textures;\n    }\n    async createMergedGroupFromJSON(model, frameData, groupName) {\n        let mergedGroup = this.getMergedGroup(model, frameData, groupName);\n        if( mergedGroup){\n            return await this.createGroupFromJSON(groupName, mergedGroup);\n        } else {\n            return null;\n        }\n    }\n    async createGroupFromJSON(groupName, groupData) {\n        const group = new THREE.Group();\n        group.name = groupName;\n        group.userData = { isGroup: true };\n        // Use Promise.all with map instead of forEach to properly await all shapes\n        await Promise.all(groupData.shapes.map(async (shape, index) => {\n            if (shape.type === 'gltf') {\n                await this.handleGLTFShape(shape, index, group);\n            } else {\n                await this.handlePrimitiveShape(shape, index, group);\n            }\n        }));\n        group.position.x = groupData.position.x;\n        group.position.y = groupData.position.y;\n        group.position.z = groupData.position.z;\n        \n        group.rotation.x = groupData.rotation.x;\n        group.rotation.y = groupData.rotation.y;\n        group.rotation.z = groupData.rotation.z;\n\n        group.scale.x = groupData.scale.x;\n        group.scale.y = groupData.scale.y;\n        group.scale.z = groupData.scale.z;\n        return group;\n    }\n\n    async handleGLTFShape(shape, index, group) {\n        const applyTransformations = (model) => {\n            model.position.set(shape.x || 0, shape.y || 0, shape.z || 0);\n            model.scale.set(\n                shape.scaleX || 1,\n                shape.scaleY || 1,\n                shape.scaleZ || 1\n            );\n            model.rotation.set(\n                (shape.rotationX || 0) * Math.PI / 180,\n                (shape.rotationY || 0) * Math.PI / 180,\n                (shape.rotationZ || 0) * Math.PI / 180\n            );\n            \n            model.traverse(child => {\n                if (child.isMesh) {\n                    child.userData = {\n                        isShape: true,\n                        index: index,\n                        isGLTFChild: true\n                    };\n                }\n            });\n            \n            model.userData = {\n                isShape: true,\n                index: index,\n                isGLTFRoot: true,\n                castShadow: true\n            };\n            \n            group.add(model);\n        };\n\n        const cached = this.gltfCache.get(shape.url);\n        if (cached) {\n            applyTransformations(cached.scene.clone());\n        } else if (shape.url && location.hostname !== \"\") {\n            // Wrap gltfLoader.load in a Promise to properly await it\n            await new Promise((resolve, reject) => {\n                this.gltfLoader.load(\n                    shape.url,\n                    (gltf) => {\n                        this.gltfCache.set(shape.url, gltf);\n                        applyTransformations(gltf.scene.clone());\n                        resolve();\n                    },\n                    undefined, // onProgress callback (optional)\n                    (error) => {\n                        console.error(`Failed to load GLTF model at ${shape.url}:`, error);\n                        reject(error);\n                    }\n                );\n            });\n        } else {\n            shape.type = \"sphere\";\n            return await this.handlePrimitiveShape(shape, index, group);\n        }\n    }\n\n    async handlePrimitiveShape(shape, index, group) {\n        let geometry, material;\n\n        let colorToUse = shape.color;\n        if(shape.color.paletteColor){\n            colorToUse = \"#ffffff\";\n            if(this.palette && this.palette[shape.color.paletteColor]){\n                colorToUse = this.palette[shape.color.paletteColor];\n            }\n        }\n        if(shape.texture){\n            // If a texture is specified, use it instead of the color\n            // If a texture is specified, use it instead of the color\n            const textureLoader = new THREE.TextureLoader();\n                \n            const textureData = this.textures[shape.texture];\n            \n            if( textureData ) {\n                const texture = await new Promise((resolve, reject) => {\n                    textureLoader.load(\n                        textureData.image,\n                        (loadedTexture) => {\n                            loadedTexture.wrapS = THREE.RepeatWrapping; // Use ClampToEdge instead of RepeatWrapping\n                            loadedTexture.wrapT = THREE.RepeatWrapping; // Use RepeatWrapping for vertical repeat\n                            loadedTexture.magFilter = THREE.NearestFilter;\n                            loadedTexture.minFilter = THREE.NearestFilter;\n                            loadedTexture.generateMipmaps = false;\n                            loadedTexture.anisotropy = 1;\n                            loadedTexture.needsUpdate = true;\n\n                            const meshWidth = shape.width || 1; // Mesh width in world units\n                            const meshHeight = shape.height || 1; // Mesh height in world units\n            \n                            const textureWidth = loadedTexture.image.width;\n                            const textureHeight = loadedTexture.image.height;\n                            const pixelsPerUnit = 2;\n                            const repeatX = Math.ceil((meshWidth * pixelsPerUnit) / textureWidth);\n                            const repeatY = Math.ceil((meshHeight * pixelsPerUnit) / textureHeight);\n                            loadedTexture.repeat.set(repeatX, repeatY);\n \n                            resolve(loadedTexture);\n                        },\n                        undefined,\n                        (error) => reject(error)\n                    );\n                });\n                material = new THREE.MeshStandardMaterial({ map: texture });\n            } else {                \n                material = new THREE.MeshStandardMaterial({ color: colorToUse });\n            }\n        } else {            \n            // Create material with specified color\n            material = new THREE.MeshStandardMaterial({ color: colorToUse });\n        }\n\n        switch (shape.type) {\n            case 'sphere':\n                geometry = new THREE.SphereGeometry(shape.size / 2, 32, 32);\n                break;\n            case 'cube':\n                geometry = new THREE.BoxGeometry(shape.size, shape.size, shape.size);\n                break;\n            case 'box':\n                geometry = new THREE.BoxGeometry(shape.width, shape.height, shape.depth || shape.width);\n                break;\n            case 'cylinder':\n                geometry = new THREE.CylinderGeometry(shape.size / 2, shape.size / 2, shape.height, 32);\n                break;\n            case 'cone':\n                geometry = new THREE.ConeGeometry(shape.size / 2, shape.height, 32);\n                break;\n            case 'torus':\n                geometry = new THREE.TorusGeometry(shape.size / 2, shape.tubeSize || shape.size / 6, 16, 100);\n                break;\n            case 'tetrahedron':\n                geometry = new THREE.TetrahedronGeometry(shape.size / 2);\n                break;\n            default:\n                return;\n        }\n\n        const mesh = new THREE.Mesh(geometry, material);\n        mesh.userData = { isShape: true, castShadow: true, index: index };\n        \n        // Position and rotation\n        mesh.position.set(shape.x || 0, shape.y || 0, shape.z || 0);\n        mesh.rotation.set(\n            (shape.rotationX || 0) * Math.PI / 180,\n            (shape.rotationY || 0) * Math.PI / 180,\n            (shape.rotationZ || 0) * Math.PI / 180\n        );\n        mesh.scale.set(\n            shape.scaleX || 1,\n            shape.scaleY || 1,\n            shape.scaleZ || 1\n        );\n        group.add(mesh);\n    }\n\n    disposeObject(object) {\n        object.traverse(child => {\n            if (child.geometry) child.geometry.dispose();\n            if (child.material) {\n                if (Array.isArray(child.material)) {\n                    child.material.forEach(m => m.dispose());\n                } else {\n                    child.material.dispose();\n                }\n            }\n        });\n    }\n\n    getMergedGroup(model, frameData, groupName) {\n        const modelGroup = model[groupName];\n        if (!modelGroup) {\n            delete frameData?.[groupName];\n            return null;\n        }\n    \n        frameData = frameData || {};\n        let frameGroup = this.initializeFrameGroup(frameData, modelGroup, groupName);\n        \n        this.cleanupMatchingTransforms(modelGroup, frameGroup);\n        const mergedShapes = this.mergeShapes(modelGroup, frameGroup);\n        \n        this.cleanupEmptyShapes(frameGroup);\n        \n        const mergedGroup = {\n            ...modelGroup,\n            ...frameGroup,\n            shapes: mergedShapes\n        };\n    \n        if (modelGroup.shapes.length === 0) {\n            frameGroup.shapes = [];\n        }\n    \n        const returnVal = JSON.parse(JSON.stringify(mergedGroup));\n        this.cleanupFrameData(frameData, frameGroup, groupName);\n        \n        return returnVal;\n    }\n    \n    initializeFrameGroup(frameData, modelGroup, groupName) {\n        if (!frameData[groupName]) {\n            frameData[groupName] = JSON.parse(JSON.stringify(modelGroup));\n            const frameGroup = frameData[groupName];\n            frameGroup.shapes.forEach((shape, index) => {\n                shape.id = index;\n            });\n            return frameGroup;\n        }\n        return frameData[groupName];\n    }\n    \n    cleanupMatchingTransforms(modelGroup, frameGroup) {\n        const properties = ['position', 'rotation', 'scale'];\n        properties.forEach(prop => {\n            if (JSON.stringify(modelGroup[prop]) === JSON.stringify(frameGroup[prop])) {\n                delete frameGroup[prop];\n            }\n        });\n    }\n    \n    mergeShapes(modelGroup, frameGroup) {\n        return modelGroup.shapes.map((modelShape, i) => {\n            if (!frameGroup.shapes) {\n                return JSON.parse(JSON.stringify(modelShape));\n            }\n    \n            let frameShape = frameGroup.shapes.find(shape => shape.id === i) || { id: i };\n            if (!frameGroup.shapes.includes(frameShape)) {\n                frameGroup.shapes.push(frameShape);\n            }\n    \n            const mergedShape = this.mergeShapeProperties(modelShape, frameShape);\n            this.cleanupMatchingShapeTransforms(modelShape, frameShape);\n            \n            return JSON.parse(JSON.stringify(mergedShape));\n        });\n    }\n    \n    mergeShapeProperties(modelShape, frameShape) {\n        const mergedShape = {};\n        \n        for (const key in modelShape) {\n            if (key === 'id') continue;\n            \n            if (frameShape && frameShape[key] !== undefined && modelShape[key] === frameShape[key]) {\n                delete frameShape[key];\n                mergedShape[key] = modelShape[key];\n            } else if (!frameShape || frameShape[key] === undefined) {\n                mergedShape[key] = modelShape[key];\n            } else {\n                mergedShape[key] = frameShape[key];\n            }\n        }\n    \n        return { ...mergedShape, ...frameShape };\n    }\n    \n    cleanupMatchingShapeTransforms(modelShape, frameShape) {\n        const transforms = [\n            { prop: 'scale', defaultVal: 1, axes: ['X', 'Y', 'Z'] },\n            { prop: 'rotation', defaultVal: 0, axes: ['X', 'Y', 'Z'] }\n        ];\n    \n        transforms.forEach(({ prop, defaultVal, axes }) => {\n            axes.forEach(axis => {\n                const propName = `${prop}${axis}`;\n                if (frameShape[propName] === modelShape[propName] || \n                   (frameShape[propName] === defaultVal && modelShape[propName] === undefined)) {\n                    delete frameShape[propName];\n                }\n            });\n        });\n    }\n    \n    cleanupEmptyShapes(frameGroup) {\n        if (frameGroup.shapes) {\n            frameGroup.shapes = frameGroup.shapes.filter(shape => \n                Object.keys(shape).length > 0\n            );\n            \n            if (frameGroup.shapes.length === 0) {\n                delete frameGroup.shapes;\n            }\n        }\n    }\n    \n    cleanupFrameData(frameData, frameGroup, groupName) {\n        if (Object.keys(frameGroup).length === 0) {\n            delete frameData[groupName];\n        }\n    }\n\n}"
      },
      "ZipExporter": {
        "fileName": "ZipExporter",
        "script": "class ZipExporter {\r\n    constructor(gameEditor) {\r\n        this.gameEditor = gameEditor;\r\n        this.elements = {};\r\n        if(window.location.hostname != \"localhost\") {\r\n            this.init();\r\n        }\r\n    }\r\n\r\n    init(aiConfig) {\r\n        this.setupHooks();\r\n        const modal = document.getElementById('modal-ZipExporterPanel');\r\n        this.config = aiConfig;\r\n        this.elements = { modal: modal };\r\n        this.setupEventListeners();\r\n    }\r\n\r\n    setCurrentObjectValues(data) {\r\n        const { selectedType, selectedObject } = this.gameEditor.model.getCurrentObjectContext();\r\n        this.gameEditor.getCollections()[selectedType][selectedObject] = data;\r\n    }\r\n\r\n    setupEventListeners() {\r\n        // Placeholder for future listeners\r\n    }\r\n\r\n    setupHooks() {\r\n        document.body.addEventListener('renderEditor', () => {\r\n      \r\n            // Export Current Object Button\r\n            if (this.elements.exportCurrentObjectBtn) this.elements.exportCurrentObjectBtn.remove();\r\n            this.elements.exportCurrentObjectBtn = document.createElement('button');\r\n            this.elements.exportCurrentObjectBtn.innerHTML = \"Export Object\";\r\n            this.elements.exportCurrentObjectBtn.id = 'save-object-btn';\r\n            this.gameEditor.elements.editor.querySelector(\".actions>div\")?.appendChild(this.elements.exportCurrentObjectBtn);\r\n            this.elements.exportCurrentObjectBtn.addEventListener('click', () => {\r\n                this.exportCurrentObject();\r\n            });\r\n\r\n            // Import Current Object Button\r\n            if (this.elements.importCurrentObjectBtn) this.elements.importCurrentObjectBtn.remove();\r\n            this.elements.importCurrentObjectBtn = document.createElement('button');\r\n            this.elements.importCurrentObjectBtn.innerHTML = \"Import Object\";\r\n            this.elements.importCurrentObjectBtn.id = 'import-object-btn';\r\n            this.gameEditor.elements.editor.querySelector(\".actions>div\")?.appendChild(this.elements.importCurrentObjectBtn);\r\n            this.elements.importCurrentObjectBtn.addEventListener('click', () => {\r\n                this.triggerImportJson();\r\n            });\r\n        });\r\n\r\n        document.body.addEventListener('selectObject', () => {\r\n            const { selectedType } = this.gameEditor.model.getCurrentObjectContext();\r\n            const category = this.gameEditor.model.getCategoryByType(selectedType);\r\n\r\n            requestAnimationFrame(() => {\r\n                // Export Project Button\r\n                if (this.elements.exportProjectBtn) this.elements.exportProjectBtn.remove();\r\n                this.elements.exportProjectBtn = document.createElement('button');\r\n                this.elements.exportProjectBtn.innerHTML = \"Export Project\";\r\n                this.elements.exportProjectBtn.id = 'export-project-btn';\r\n                this.gameEditor.elements.sidebar.querySelector(\".sidebar-actions>.primary\")?.after(this.elements.exportProjectBtn);\r\n                this.elements.exportProjectBtn.addEventListener('click', () => {\r\n                    this.exportFullProject();\r\n                });\r\n                // Import Project Button\r\n                if (this.elements.importProjectBtn) this.elements.importProjectBtn.remove();\r\n                this.elements.importProjectBtn = document.createElement('button');\r\n                this.elements.importProjectBtn.innerHTML = \"Import Project\";\r\n                this.elements.importProjectBtn.id = 'import-project-btn';\r\n                this.gameEditor.elements.sidebar.querySelector(\".sidebar-actions>.primary\")?.after(this.elements.importProjectBtn);\r\n                this.elements.importProjectBtn.addEventListener('click', () => {\r\n                    this.triggerImportProject();\r\n                });\r\n                // Export All in Category Button\r\n                if (this.elements.exportAllBtn) this.elements.exportAllBtn.remove();\r\n                this.elements.exportAllBtn = document.createElement('button');\r\n                this.elements.exportAllBtn.innerHTML = `Export All ${category}`;\r\n                this.elements.exportAllBtn.id = 'export-all-btn';\r\n                this.gameEditor.elements.sidebar.querySelector(\".sidebar-actions>.primary\")?.after(this.elements.exportAllBtn);\r\n                this.elements.exportAllBtn.addEventListener('click', () => {\r\n                    this.exportCategory(category);\r\n                });\r\n            });\r\n        });\r\n    }\r\n\r\n    // Export a JSON file\r\n    exportJSON(fileName, jsonObj) {\r\n        const blob = new Blob([JSON.stringify(jsonObj, null, 2)], { type: 'application/json' });\r\n        const url = window.URL.createObjectURL(blob);\r\n        const link = document.createElement('a');\r\n        link.href = url;\r\n        link.download = `${fileName}.json`;\r\n        document.body.appendChild(link);\r\n        link.click();\r\n        document.body.removeChild(link);\r\n        window.URL.revokeObjectURL(url);\r\n    }\r\n\r\n    // Export current object as JSON\r\n    exportCurrentObject() {\r\n        const selectedObject = this.gameEditor.model.getCurrentObject();   \r\n        this.exportJSON(selectedObject, this.gameEditor.getCurrentObject());\r\n    }\r\n\r\n    // Export a category as a zip\r\n    exportCategory(category) {\r\n        const scripts = this.gameEditor.model.getCollectionsByCategory(category);\r\n        this.exportZip(category, scripts);\r\n    }\r\n\r\n    // Export the entire project as a zip\r\n    exportFullProject() {\r\n        const allCollections = {};\r\n        const defs = this.gameEditor.model.getCollectionDefs();\r\n\r\n        defs.forEach(def => {\r\n            const category = def.category;\r\n            const collectionKey = def.id;\r\n            const collectionData = this.gameEditor.model.getCollections()[collectionKey];\r\n            if (collectionData) {\r\n                if (!allCollections[category]) {\r\n                    allCollections[category] = {};\r\n                }\r\n                allCollections[category][collectionKey] = collectionData;\r\n            }\r\n        });\r\n\r\n        this.exportZip(this.gameEditor.model.getCurrentProject(), allCollections);\r\n    }\r\n\r\n    // Generic zip export method\r\n    exportZip(fileName, projectData) {\r\n        const zip = new JSZip();\r\n\r\n        Object.keys(projectData).forEach(category => {\r\n            const collections = projectData[category];\r\n            Object.keys(collections).forEach(collection => {\r\n                const objects = collections[collection];\r\n                const folder = zip.folder(`${category}/${collection}`);\r\n\r\n                Object.keys(objects).forEach(objKey => {\r\n                    const objData = objects[objKey];\r\n                    const scriptContent = objData.script || '';\r\n                    if (scriptContent) {\r\n                        folder.file(`${objKey}.js`, scriptContent);\r\n                    } else {\r\n                        folder.file(`${objKey}.json`, JSON.stringify(objData, null, 2));\r\n                    }\r\n                });\r\n            });\r\n        });\r\n\r\n        zip.generateAsync({ type: 'blob' }).then(blob => {\r\n            const url = window.URL.createObjectURL(blob);\r\n            const link = document.createElement('a');\r\n            link.href = url;\r\n            link.download = `${fileName}.zip`;\r\n            document.body.appendChild(link);\r\n            link.click();\r\n            document.body.removeChild(link);\r\n            window.URL.revokeObjectURL(url);\r\n        }).catch(error => {\r\n            console.error('Error generating zip file:', error);\r\n        });\r\n    }\r\n\r\n    // Trigger JSON import\r\n    triggerImportJson() {\r\n        const input = document.createElement('input');\r\n        input.type = 'file';\r\n        input.accept = '.json';\r\n        input.style.display = 'none';\r\n        input.addEventListener('change', (e) => this.importJson(e));\r\n        document.body.appendChild(input);\r\n        input.click();\r\n        document.body.removeChild(input);\r\n    }\r\n    triggerImportProject() {\r\n        const input = document.createElement('input');\r\n        input.type = 'file';\r\n        input.accept = '.zip';\r\n        input.style.display = 'none';\r\n        input.addEventListener('change', (e) => this.importProject(e));\r\n        document.body.appendChild(input);\r\n        input.click();\r\n        document.body.removeChild(input);\r\n    }\r\n    // Import a single JSON file\r\n    async importJson(event) {\r\n        const file = event.target.files[0];\r\n        if (!file) return;\r\n\r\n        try {\r\n            const reader = new FileReader();\r\n            reader.onload = (e) => {\r\n                const jsonContent = JSON.parse(e.target.result);\r\n                this.setCurrentObjectValues(jsonContent);\r\n                const myCustomEvent = new CustomEvent('updateCurrentObject', { cancelable: true });\r\n                document.body.dispatchEvent(myCustomEvent);\r\n            };\r\n            reader.onerror = (error) => {\r\n                console.error('Error reading JSON file:', error);\r\n            };\r\n            reader.readAsText(file);\r\n        } catch (error) {\r\n            console.error('Error importing JSON:', error);\r\n        }\r\n    }\r\n  \r\n  \t// Import a project zip file\r\n    async importProject(event) {\r\n        const file = event.target.files[0];\r\n        if (!file) return;\r\n\r\n        try {\r\n            const jsZip = new JSZip();\r\n            const zipContent = await jsZip.loadAsync(file);\r\n\r\n            const projectData = {};\r\n\r\n            // Process all files in the zip\r\n            const fileProcessingPromises = [];\r\n\r\n            zipContent.forEach((relativePath, zipEntry) => {\r\n                if (!zipEntry.dir) {\r\n                    const promise = zipEntry.async('string').then(content => {\r\n                        // Parse path: category/collection/objectKey.ext\r\n                        const pathParts = relativePath.split('/');\r\n                        if (pathParts.length >= 3) {\r\n                            const category = pathParts[0];\r\n                            const collection = pathParts[1];\r\n                            const fileName = pathParts[2];\r\n                            const objectKey = fileName.substring(0, fileName.lastIndexOf('.'));\r\n                            const fileExt = fileName.substring(fileName.lastIndexOf('.') + 1);\r\n\r\n                            // Initialize the data structure if needed\r\n                            if (!projectData[category]) projectData[category] = {};\r\n                            if (!projectData[category][collection]) projectData[category][collection] = {};\r\n\r\n                            // Parse content based on file extension\r\n                            if (fileExt === 'js') {\r\n                                projectData[category][collection][objectKey] = { script: content };\r\n                            } else if (fileExt === 'json') {\r\n                                projectData[category][collection][objectKey] = JSON.parse(content);\r\n                            }\r\n                        }\r\n                    });\r\n                    fileProcessingPromises.push(promise);\r\n                }\r\n            });\r\n\r\n            // Wait for all files to be processed\r\n            await Promise.all(fileProcessingPromises);\r\n\r\n            // Update game editor state with imported data\r\n            const defs = this.gameEditor.model.getCollectionDefs();\r\n            defs.forEach(def => {\r\n                const category = def.category;\r\n                const collectionKey = def.id;\r\n\r\n                if (projectData[category] && projectData[category][collectionKey]) {\r\n                    if (!this.gameEditor.model.state.project.objectTypes[collectionKey]) {\r\n                        this.gameEditor.model.state.project.objectTypes[collectionKey] = {};\r\n                    }\r\n\r\n                    // Merge imported objects with existing\r\n                    Object.keys(projectData[category][collectionKey]).forEach(objKey => {\r\n                        this.gameEditor.model.state.project.objectTypes[collectionKey][objKey] = \r\n                            projectData[category][collectionKey][objKey];\r\n                    });\r\n                }\r\n            });\r\n\r\n            // Trigger UI update\r\n            const updateEvent = new CustomEvent('projectUpdated', { cancelable: true });\r\n            document.body.dispatchEvent(updateEvent);\r\n\r\n            alert('Project imported successfully');\r\n        } catch (error) {\r\n            console.error('Error importing project:', error);\r\n            alert('Error importing project. See console for details.');\r\n        }\r\n    }\r\n}"
      }
    },
    "modals": {
      "aiPromptPanel": {
        "title": "AI Prompt Panel",
        "fileName": "aiPromptPanel",
        "html": "<h2>AI Object Generator</h2>\r\n                <div class=\"form-group\">\r\n                    <label for=\"ai-prompt-textarea\">Prompt:</label>\r\n                    <textarea id=\"ai-prompt-textarea\" rows=\"6\" placeholder=\"Enter your AI generation prompt\"></textarea>\r\n                    <textarea id=\"ai-pre-prompt-textarea\" rows=\"6\" placeholder=\"context\"></textarea>\r\n                </div>\r\n                <div class=\"actions\">\r\n                    <button id=\"send-ai-prompt-btn\" class=\"primary\">Send to AI</button>\r\n                    <button id=\"close-ai-prompt-modal\">Cancel</button>\r\n                </div>\r\n                <div class=\"preview-section\">\r\n                    <h3>AI Response Preview</h3>\r\n                    <textarea id=\"ai-response-preview\" rows=\"6\"></textarea>\r\n                    <div class=\"preview-actions\">\r\n                        <button id=\"apply-ai-response-btn\" class=\"primary\" style=\"display:none;\">Apply Response</button>\r\n                    </div>\r\n                </div>"
      },
      "rotateShapes": {
        "title": "Rotate Shapes",
        "fileName": "rotateShapes",
        "html": "\r\n                <h3>Rotate All Shapes</h3>\r\n                <div class=\"form-row\">\r\n                    <label for=\"rotate-angle\">Angle (degrees):</label>\r\n                    <input type=\"number\" id=\"rotate-angle\" value=\"0\" step=\"1\">\r\n                </div>\r\n                <div class=\"form-row\">\r\n                    <label for=\"rotate-axis\">Axis:</label>\r\n                    <select id=\"rotate-axis\">\r\n                        <option value=\"x\">X</option>\r\n                        <option value=\"y\" selected>Y</option>\r\n                        <option value=\"z\">Z</option>\r\n                    </select>\r\n                </div>\r\n                <div style=\"display: flex; gap: 10px; margin-top: 20px;\">\r\n                    <button id=\"rotate-cancel\">Cancel</button>\r\n                    <button id=\"rotate-apply\">Apply</button>\r\n                </div>\r\n"
      },
      "generateIsoSprites": {
        "title": "Generate Spritesheet",
        "fileName": "generateIsoSprites",
        "html": "\r\n                <h3 style=\"margin-bottom: 20px; color: #e0e0e0; font-size: 18px;\">Generate Isometric Sprites</h3>\r\n                <div class=\"form-row\">\r\n                    <label for=\"iso-frustum\">Frustum Size:</label>\r\n                    <input type=\"number\" id=\"iso-frustum\" value=\"48\" step=\"1\" min=\"1\">\r\n                </div>\r\n                <div class=\"form-row\">\r\n                    <label for=\"iso-distance\">Distance:</label>\r\n                    <input type=\"number\" id=\"iso-distance\" value=\"100\" step=\"1\" min=\"1\">\r\n                </div>\r\n                <div class=\"form-row\">\r\n                    <label for=\"iso-size\">Sprite Size:</label>\r\n                    <input type=\"number\" id=\"iso-size\" value=\"64\" step=\"1\" min=\"1\">\r\n                </div>\r\n                <div style=\"display: flex; gap: 10px; margin-top: 20px;\">\r\n                    <button id=\"iso-cancel\">Cancel</button>\r\n                    <button id=\"iso-generate\">Generate</button>\r\n                </div>\r\n"
      },
      "moveAllShapes": {
        "title": "Move All Shapes",
        "fileName": "moveAllShapes",
        "html": "\r\n<h3>Move All Shapes</h3>\r\n<div class=\"form-row\">\r\n    <label for=\"move-x\">X Offset:</label>\r\n    <input type=\"number\" id=\"move-x\" value=\"0\" step=\"0.5\">\r\n</div>\r\n<div class=\"form-row\">\r\n    <label for=\"move-y\">Y Offset:</label>\r\n    <input type=\"number\" id=\"move-y\" value=\"0\" step=\"0.5\">\r\n</div>\r\n<div class=\"form-row\">\r\n    <label for=\"move-z\">Z Offset:</label>\r\n    <input type=\"number\" id=\"move-z\" value=\"0\" step=\"0.5\">\r\n</div>\r\n<div style=\"display: flex; gap: 10px; margin-top: 20px;\">\r\n    <button id=\"move-cancel\">Cancel</button>\r\n    <button id=\"move-apply\">Apply</button>\r\n</div>\r\n"
      },
      "addTerrainType": {
        "title": "Add Terrain Type",
        "fileName": "addTerrainType",
        "html": "\r\n<h4 id=\"formTitle\">Add Terrain Type</h4>\r\n<input type=\"hidden\" id=\"editingType\" value=\"\">\r\n<div class=\"form-group\">\r\n    <label for=\"terrainType\">Type:</label>\r\n    <input type=\"text\" id=\"terrainType\" placeholder=\"grass, water, etc.\">\r\n</div>\r\n<div class=\"form-group\">\r\n    <label for=\"terrainColor\">Color:</label>\r\n    <input type=\"text\" id=\"terrainColorText\">\r\n    <input type=\"color\" id=\"terrainColor\">\r\n</div>\r\n<div class=\"form-group\">\r\n    <label for=\"terrainImage\">Sprite Sheet:</label>\r\n    <input type=\"textarea\" id=\"terrainImage\">\r\n</div>\r\n<div class=\"form-group\">\r\n    <label for=\"terrainTexture\">Texture:</label>\r\n    <select id=\"terrainTexture\"></select>\r\n</div>\r\n<div class=\"form-group\">\r\n    <img id=\"terrain-image-display\" alt=\"Terrain Image\">\r\n</div>\r\n<div class=\"form-group\">\r\n    <label for=\"terrainBuildable\">Buildable:</label>\r\n    <input type=\"checkbox\" id=\"terrainBuildable\">\r\n</div>\r\n<div class=\"form-actions\">\r\n    <button id=\"saveTerrainBtn\" class=\"primary\">Save</button>\r\n    <button id=\"cancelTerrainBtn\">Cancel</button>\r\n</div>\r\n<input type=\"hidden\" id=\"editingId\">\r\n"
      },
      "generateIsometric": {
        "title": "Generate Isometric Sprites",
        "fileName": "generateIsometric",
        "html": " <h3 style=\"margin-bottom: 20px; color: #e0e0e0; font-size: 18px;\">Generate Isometric Sprites</h3>                 <div class=\"form-row\">                     <label for=\"iso-frustum\">Frustum Size:</label>                     <input type=\"number\" id=\"iso-frustum\" value=\"48\" step=\"1\" min=\"1\">                 </div>                 <div class=\"form-row\">                     <label for=\"iso-distance\">Distance:</label>                     <input type=\"number\" id=\"iso-distance\" value=\"100\" step=\"1\" min=\"1\">                 </div>                 <div class=\"form-row\">                     <label for=\"iso-size\">Sprite Size:</label>                     <input type=\"number\" id=\"iso-size\" value=\"64\" step=\"1\" min=\"1\">                 </div>                 <div style=\"display: flex; gap: 10px; margin-top: 20px;\">                     <button id=\"iso-cancel\">Cancel</button>                     <button id=\"iso-generate\">Generate</button>                 </div>           "
      }
    },
    "renderers": {
      "EnergyShield": {
        "fileName": "EnergyShield",
        "script": "class EnergyShield extends engine.Component {\r\n    \r\n    constructor(game, parent, params) {\r\n        super(game, parent, params);\r\n    }\r\n    \r\n    \r\n init(){\r\n        // Get stats component for reference\r\n        let statsComp = this.parent.getComponent('stats');\r\n        \r\n        // Shield configuration with defaults\r\n        this.maxEnergyShield = statsComp.stats.energyShield || 0;\r\n        this.energyShield = this.maxEnergyShield || 0;\r\n        this.rechargeRate = statsComp.stats.rechargeRate || 10; // Shield points per second\r\n        this.rechargeDelay = statsComp.stats.rechargeDelay || 2000; // Milliseconds before recharge starts\r\n        this.lastDamageTime = 0; // Timestamp of last damage taken\r\n        \r\n        // Add relevant stats to the stats component\r\n        statsComp.addStat('maxEnergyShield', this.maxEnergyShield);\r\n        statsComp.addStat('shieldRechargeRate', this.rechargeRate);\r\n        statsComp.addStat('shieldRechargeDelay', this.rechargeDelay);\r\n        \r\n        // Visual settings\r\n        this.shieldColor = 'rgba(77, 166, 255, 0.6)'; // Light blue default\r\n        this.shieldEmptyColor = 'rgba(77, 166, 255, 0.2)';\r\n        this.barWidth = 30;\r\n        this.barHeight = 5;\r\n        this.barOffset = 8; // Distance above health bar\r\n    }\r\n    \r\n    /**\r\n     * Handle incoming damage\r\n     * @param {number} damage - Amount of incoming damage\r\n     * @returns {Object} - Damage breakdown\r\n     */\r\n    absorbDamage(damage) {\r\n        const result = {\r\n            absorbedByShield: 0,\r\n            remainingDamage: 0\r\n        };\r\n        \r\n        // Reset recharge timer when taking damage\r\n        this.lastDamageTime = this.game.currentTime;\r\n        \r\n        if (this.energyShield > 0) {\r\n            if (damage <= this.energyShield) {\r\n                // Shield absorbs all damage\r\n                result.absorbedByShield = damage;\r\n                this.energyShield -= damage;\r\n            } else {\r\n                // Shield is depleted, remaining damage goes through\r\n                result.absorbedByShield = this.energyShield;\r\n                result.remainingDamage = damage - this.energyShield;\r\n                this.energyShield = 0;\r\n            }\r\n        } else {\r\n            // No shield available\r\n            result.remainingDamage = damage;\r\n        }\r\n        \r\n        return result;\r\n    }\r\n    \r\n    /**\r\n     * Update shield state (recharging)\r\n     */\r\n    update() {\r\n        let statsComp = this.parent.getComponent('stats');\r\n        this.maxEnergyShield = statsComp.stats.energyShield || 0;\r\n        // Check if enough time has passed since last damage\r\n        const timeSinceLastDamage = this.game.currentTime - this.lastDamageTime;\r\n        \r\n        if (timeSinceLastDamage >= this.rechargeDelay && this.energyShield < this.maxEnergyShield) {\r\n            // Calculate recharge amount based on time elapsed and rate\r\n            const deltaTime = this.game.deltaTime || 16; // Fallback to 60fps if deltaTime not available\r\n            const rechargeAmount = (this.rechargeRate * deltaTime) / 1000; // Convert to per-frame amount\r\n            \r\n            // Apply recharge\r\n            this.energyShield = Math.min(this.maxEnergyShield, this.energyShield + rechargeAmount);\r\n        }\r\n    }\r\n    \r\n    /**\r\n     * Draw shield bar\r\n     */\r\n    draw() {\r\n        if (this.maxEnergyShield <= 0) return; // Don't draw if no shield capacity\r\n        \r\n        const shieldPercentage = this.energyShield / this.maxEnergyShield;        \r\n        \r\n        // Shield bar will be slightly above that\r\n        const barY = this.parent.drawPosition.y - this.game.config.configs.game.imageSize * .3 - this.barOffset;\r\n        \r\n        // Draw shield background/empty bar\r\n        this.game.ctx.fillStyle = this.shieldEmptyColor;\r\n        this.game.ctx.fillRect(this.parent.drawPosition.x - this.barWidth/2, barY, this.barWidth, this.barHeight);\r\n        \r\n        // Draw current shield level\r\n        if (shieldPercentage > 0) {\r\n            this.game.ctx.fillStyle = this.shieldColor;\r\n            this.game.ctx.fillRect(\r\n                this.parent.drawPosition.x - this.barWidth/2, \r\n                barY, \r\n                this.barWidth * shieldPercentage, \r\n                this.barHeight\r\n            );\r\n        }\r\n        \r\n        // Draw recharge indicator if currently recharging\r\n        const timeSinceLastDamage = this.game.currentTime - this.lastDamageTime;\r\n        if (timeSinceLastDamage < this.rechargeDelay && this.energyShield < this.maxEnergyShield) {\r\n            const rechargePercentage = timeSinceLastDamage / this.rechargeDelay;\r\n            \r\n            // Draw a small indicator below the shield bar\r\n            this.game.ctx.fillStyle = 'rgba(255, 255, 255, 0.5)';\r\n            this.game.ctx.fillRect(\r\n                this.parent.drawPosition.x - this.barWidth/2, \r\n                barY + this.barHeight + 1, \r\n                this.barWidth * rechargePercentage, \r\n                2\r\n            );\r\n        }\r\n    }\r\n    \r\n    /**\r\n     * Get current shield value\r\n     * @returns {number} Current shield amount\r\n     */\r\n    getShieldValue() {\r\n        return this.energyShield;\r\n    }\r\n    \r\n    /**\r\n     * Reset shield to full\r\n     */\r\n    resetShield() {\r\n        this.energyShield = this.maxEnergyShield;\r\n    }\r\n    \r\n    /**\r\n     * Temporarily boost shield capacity\r\n     * @param {number} amount - Amount to boost by\r\n     * @param {number} duration - Duration in milliseconds\r\n     */\r\n    boostShield(amount, duration) {\r\n        const originalMax = this.maxEnergyShield;\r\n        this.maxEnergyShield += amount;\r\n        this.energyShield += amount;\r\n        \r\n        // Reset after duration\r\n        setTimeout(() => {\r\n            this.maxEnergyShield = originalMax;\r\n            this.energyShield = Math.min(this.energyShield, this.maxEnergyShield);\r\n        }, duration);\r\n    }\r\n}"
      },
      "Health": {
        "fileName": "Health",
        "script": "class Health extends engine.Component {\r\n    \r\n    constructor(game, parent, params) {\r\n        super(game, parent, params);\r\n    }\r\n    \r\n    \r\n  init(){\r\n        let statsComp = this.parent.getComponent('stats');\r\n        this.hp = statsComp.stats.hp;\r\n        \r\n        statsComp.addStat('maxHp', this.hp);\r\n    }\r\n    update() {        \r\n        if (this.hp <= 0){            \r\n            this.parent.destroy();\r\n        }\r\n    }\r\n\r\n    draw() {\r\n        let imageSize = this.game.config.configs.game.imageSize;\r\n        let statsComp = this.parent.getComponent('stats');\r\n        const healthPercentage = this.hp / statsComp.stats.maxHp;\r\n        const barWidth = 30;\r\n        this.game.ctx.fillStyle = 'rgba(0, 0, 0, 0.2)';\r\n\r\n        const isoPos = this.game.translator.pixelToIso(this.parent.position.x, this.parent.position.y)\r\n\r\n        this.game.ctx.fillRect(isoPos.x - barWidth/2, isoPos.y - imageSize * .3, barWidth, 5);\r\n        if( healthPercentage >= 0 ) {\r\n            this.game.ctx.fillStyle = healthPercentage > 0.5 ? 'rgba(0, 255, 0, 0.5)' : healthPercentage > 0.25 ? 'rgba(255, 255, 0, 0.5)' : 'rgba(255, 0, 0, 0.5)';\r\n            this.game.ctx.fillRect(isoPos.x - barWidth/2, isoPos.y - imageSize * .3, barWidth * healthPercentage, 5);\r\n        }\r\n    }\r\n}"
      },
      "Renderer": {
        "fileName": "Renderer",
        "script": "class Renderer extends engine.Component {\r\n    \r\n    constructor(game, parent, params) {\r\n        super(game, parent, params);\r\n    }\r\n    \r\n    \r\n  init( { objectType, spawnType, setDirection = -2}) {\r\n        if(this.game.config.configs.game.is3D) {\r\n            return;\r\n        }\r\n        this.images = this.game.imageManager.getImages(objectType, spawnType);  \r\n        this.setDirection = setDirection;\r\n        this.currentDirection = 0; // Default direction (will be 0-7 now)\r\n        // Rotated direction zones 45 degrees counter-clockwise\r\n        // Each zone covers a 45-degree arc (/4 radians)\r\n        this.directionZones = [\r\n            { min: Math.PI/8, max: 3*Math.PI/8 },     // 0: Down-Right (Southeast)\r\n            { min: 3*Math.PI/8, max: 5*Math.PI/8 },   // 1: Down\r\n            { min: 5*Math.PI/8, max: 7*Math.PI/8 },   // 2: Down-Left (Southwest)\r\n            { min: 7*Math.PI/8, max: -7*Math.PI/8 },  // 3: Left (West)\r\n            { min: -7*Math.PI/8, max: -5*Math.PI/8 }, // 4: Up-Left (Northwest)\r\n            { min: -5*Math.PI/8, max: -3*Math.PI/8 }, // 5: Up\r\n            { min: -3*Math.PI/8, max: -Math.PI/8 },   // 6: Up-Right (Northeast)\r\n            { min: -Math.PI/8, max: Math.PI/8 }       // 7: Right (East)\r\n        ];\r\n        this.isometric = this.game.config.configs.game.isIsometric;\r\n    }\r\n\r\n    draw() {\r\n        if(this.game.config.configs.game.is3D) {\r\n            return;\r\n        }\r\n        if( this.setDirection < 0 ) {\r\n            const dx = this.parent.position.x - this.parent.lastPosition.x; // Change in x\r\n            const dy = this.parent.position.y - this.parent.lastPosition.y; // Change in y\r\n            \r\n            // Only update direction if there's movement\r\n            if (Math.abs(dx) > 0.001 || Math.abs(dy) > 0.001) {\r\n                // Calculate angle of movement in radians\r\n                const angle = Math.atan2(dy, dx);\r\n                \r\n                // Determine which of the 8 directional zones the angle falls into\r\n                for (let i = 0; i < this.directionZones.length; i++) {\r\n                    const zone = this.directionZones[i];\r\n                    \r\n                    // Special handling for the West zone which wraps around from PI to -PI\r\n                    if (i === 3) {\r\n                        if (angle >= zone.min || angle <= zone.max) {\r\n                            this.currentDirection = i;\r\n                            break;\r\n                        }\r\n                    } \r\n                    // Normal zone check\r\n                    else if (angle >= zone.min && angle < zone.max) {\r\n                        this.currentDirection = i;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            this.currentDirection = this.setDirection;\r\n        }\r\n        let direction = this.currentDirection + (this.isometric ? 0 : -1);\r\n        if(direction == -1 ) direction = this.images.length - 1;//wrap around\r\n        // Draw the image for the current direction\r\n        if (this.images && this.images.length > direction) {\r\n            const image = this.images[direction];\r\n            if (image) {\r\n                const imgWidth = image.width;\r\n                const imgHeight = image.height;\r\n                \r\n                const drawX = this.parent.drawPosition.x - imgWidth / 2;\r\n                let drawY = this.parent.drawPosition.y - imgHeight / 2;\r\n                if( this.parent.position.z ) {\r\n                   drawY -= this.parent.position.z;                   \r\n                }\r\n                this.game.ctx.drawImage(image, drawX, drawY);\r\n            }\r\n        }\r\n    }\r\n}"
      },
      "LightningRenderer": {
        "fileName": "LightningRenderer",
        "script": "class LightningRenderer extends engine.Component {\r\n    \r\n    constructor(game, parent, params) {\r\n        super(game, parent, params);\r\n    }\r\n    \r\n    \r\n  init( {owner}) {\r\n        this.ctx = this.game.ctx;\r\n        const ownerStats = owner.getComponent(\"stats\").stats;\r\n        this.startOffsetY = ownerStats.projectileStartOffsetY || this.game.config.configs.game.gridSize / 2;\r\n    }\r\n\r\n    draw() {\r\n        const projectile = this.parent.getComponent(\"ChainProjectile\");\r\n        if (!projectile || !projectile.chainTargets.length) return;\r\n\r\n        this.ctx.strokeStyle = \"rgba(0, 255, 255, 0.8)\"; // Cyan lightning\r\n        this.ctx.lineWidth = 2;\r\n        let stats = this.parent.getComponent('stats').stats;\r\n        // Start from Tesla Coil (parent position)\r\n        let startPos = this.game.translator.pixelToIso(this.parent.position.x, this.parent.position.y);\r\n        startPos.y -= this.startOffsetY;//dont shoot off the ground\r\n        for (let i = 0; i < projectile.chainTargets.length; i++) {\r\n            const target = projectile.chainTargets[i];\r\n            if (!target || target.destroyed) continue;\r\n\r\n            const endPos = this.game.translator.pixelToIso(target.position.x, target.position.y);\r\n            this.drawLightning(startPos, endPos);\r\n\r\n            // Next arc starts from this target\r\n            startPos = endPos;\r\n        }\r\n    }\r\n\r\n    drawLightning(startPos, endPos) {\r\n        this.ctx.beginPath();            \r\n        this.ctx.moveTo(startPos.x, startPos.y);\r\n\r\n        const segments = 8; // Number of zigzag points\r\n        const dx = (endPos.x - startPos.x) / segments;\r\n        const dy = (endPos.y - startPos.y) / segments;\r\n\r\n        let currentX = startPos.x;\r\n        let currentY = startPos.y;\r\n\r\n        for (let i = 1; i < segments; i++) {\r\n            currentX += dx;\r\n            currentY += dy;\r\n\r\n            // Add random offset for jagged effect\r\n            const offsetX = (Math.random() - 0.5) * 10; // Max 10px jitter\r\n            const offsetY = (Math.random() - 0.5) * 10;\r\n\r\n            this.ctx.lineTo(currentX + offsetX, currentY + offsetY);\r\n        }\r\n\r\n        this.ctx.lineTo(endPos.x, endPos.y);\r\n        this.ctx.stroke();\r\n    }\r\n}"
      },
      "ModelRenderer": {
        "title": "Model Renderer",
        "fileName": "ModelRenderer",
        "script": "class ModelRenderer extends engine.Component {\n    init({ objectType, spawnType, frameDuration }) {\n        if(!this.game.config.configs.game.is3D) {\n            return;\n        }\n        this.animationState = 'idle';\n        this.currentFrameIndex = 0;\n        this.frameTime = 0;\n        this.frameDuration = frameDuration || 0.17;\n        this.lastDirection = -1;\n        \n        // Load animation and model data\n        this.animationData = this.game.config[objectType]?.[spawnType]?.render?.animations;\n        this.modelData = this.game.config[objectType]?.[spawnType]?.render?.model;\n\n        // Get the model\n        this.model = this.game.modelManager.getModel(objectType, spawnType);\n        \n        if (!this.model || !this.animationData || !this.modelData) {\n            console.error(`No model or data found for ${objectType}_${spawnType}`);\n            return;\n        }\n        \n        // Create the initial model instance\n        this.modelGroup = this.model.clone();  \n        // Add the model group to the scene\n        this.game.scene.add(this.modelGroup);\n\n        this.modelGroup.position.set(0, -10000, 0);\n        \n        // Set initial animation\n        this.setAnimation('idle');\n    }\n    \n    setAnimation(animationName) {\n        if (!this.animationData[animationName]) {\n            console.warn(`Animation '${animationName}' not found, defaulting to 'idle'`);\n            animationName = 'idle';\n            \n            if (!this.animationData[animationName]) {\n                const availableAnims = Object.keys(this.animationData);\n                animationName = availableAnims.length > 0 ? availableAnims[0] : null;\n                \n                if (!animationName) {\n                    console.error('No animations available for this model');\n                    return;\n                }\n            }\n        }\n        \n        if (this.animationState !== animationName) {\n            this.animationState = animationName;\n            this.currentFrameIndex = 0;\n            this.frameTime = 0;\n            this.updateModelFrame();\n        }\n    }\n    \n    draw() {\n        if(!this.game.config.configs.game.is3D) {\n            return;\n        }\n        // Update animation frames\n        this.frameTime += this.game.deltaTime;\n        if (this.frameTime >= this.frameDuration) {\n            this.frameTime -= this.frameDuration;\n            this.advanceFrame();\n        }\n        // Update position of model to match entity position\n        if (this.parent && this.parent.position) {\n            this.modelGroup.position.set(\n                this.parent.position.x,\n                this.parent.position.z,\n                this.parent.position.y\n            );\n            \n            // Handle rotation based on movement direction\n            this.updateDirection();\n        }\n        \n   \n    }\n    \n    updateDirection() {\n        // Calculate direction based on movement\n        if (this.parent && this.parent.lastPosition) {\n            const dx = this.parent.position.x - this.parent.lastPosition.x;\n            const dy = this.parent.position.y - this.parent.lastPosition.y;\n            \n            // Only update direction if there's significant movement\n            if (Math.abs(dx) > 0.001 || Math.abs(dy) > 0.001) {\n                // Calculate angle in radians\n                let angle = Math.atan2(dy, dx);\n            \n                // Rotate model to face movement direction\n                this.modelGroup.rotation.y = -angle + Math.PI / 2;\n                \n                // Set walking animation when moving\n                if (this.animationData['walk']) {\n                    this.setAnimation('walk');\n                    return;\n                }\n            } else {\n                // Entity is stationary, use idle animation\n                this.setAnimation('idle');\n            }\n        }\n    }\n    \n    advanceFrame() {\n        const frames = this.animationData[this.animationState];\n        if (!frames || frames.length === 0) return;\n        \n        this.currentFrameIndex = (this.currentFrameIndex + 1) % frames.length;\n        this.updateModelFrame();\n    }\n    \n    updateModelFrame() {\n        // Get current animation and frame\n        const frames = this.animationData[this.animationState];\n        if (!frames?.length) return;\n        \n        const frameData = frames[this.currentFrameIndex] || {};\n        \n        // Traverse the modelGroup to apply transformations\n        this.modelGroup.traverse((obj) => {\n          // Handle group-level transformations (apply to group objects)\n            if (!obj.isMesh && obj.name && this.modelData[obj.name]) {\n                const groupName = obj.name;\n                const groupData = frameData[groupName];\n                const modelGroupData = this.modelData[groupName];\n                this.updateObjectTransforms(obj, groupData, modelGroupData);\n            }\n            \n            // Handle shape-level transformations (apply to meshes)\n            if (obj.isMesh && obj.userData?.index >= 0 && obj.parent?.name) {\n                const groupName = obj.parent.name;\n                const index = obj.userData.index;\n                const groupData = frameData[groupName];\n                const modelGroupData = this.modelData[groupName];\n                // Find shape in animationData by id (id: 1 maps to index 0)\n                let shape;\n                if (groupData?.shapes) {\n                    shape = groupData.shapes.find(s => s.id === index);\n                }\n                const modelShape = modelGroupData?.shapes?.[index];\n                \n                if (shape || modelShape) {\n                    this.updateShapeTransforms(obj, shape, modelShape);\n                }\n            }\n        });\n    }\n    \n    updateObjectTransforms(obj, groupData, modelGroupData) {\n        if (!modelGroupData) return;\n        \n        // Position\n        const pos = groupData?.position || modelGroupData.position || { x: 0, y: 0, z: 0 };\n        obj.position.set(\n            pos.x ?? modelGroupData.position?.x ?? 0,\n            pos.y ?? modelGroupData.position?.y ?? 0,\n            pos.z ?? modelGroupData.position?.z ?? 0\n        );\n        \n        // Rotation\n        const rot = groupData?.rotation || modelGroupData.rotation || { x: 0, y: 0, z: 0 };\n        obj.rotation.set(\n            rot.x ?? modelGroupData.rotation?.x ?? 0,\n            rot.y ?? modelGroupData.rotation?.y ?? 0,\n            rot.z ?? modelGroupData.rotation?.z ?? 0\n        );\n        \n        // Scale\n        const scale = groupData?.scale || modelGroupData.scale || { x: 1, y: 1, z: 1 };\n        obj.scale.set(\n            scale.x ?? modelGroupData.scale?.x ?? 1,\n            scale.y ?? modelGroupData.scale?.y ?? 1,\n            scale.z ?? modelGroupData.scale?.z ?? 1\n        );\n    }\n    updateShapeTransforms(obj, shape, modelShape) {\n        if (!modelShape) return;\n\n        // Position (local to group)\n        obj.position.set(\n            shape?.x ?? modelShape.x ?? 0,\n            shape?.y ?? modelShape.y ?? 0,\n            shape?.z ?? modelShape.z ?? 0\n        );\n        \n        // Rotation (local to group, convert degrees to radians)\n        obj.rotation.set(\n            ((shape?.rotationX ?? modelShape.rotationX) || 0) * Math.PI / 180,\n            ((shape?.rotationY ?? modelShape.rotationY) || 0) * Math.PI / 180,\n            ((shape?.rotationZ ?? modelShape.rotationZ) || 0) * Math.PI / 180\n        );\n        \n        // Scale (local to group)\n        obj.scale.set(\n            shape?.scaleX ?? modelShape.scaleX ?? 1,\n            shape?.scaleY ?? modelShape.scaleY ?? 1,\n            shape?.scaleZ ?? modelShape.scaleZ ?? 1\n        );\n\n    }\n    destroy() {\n        if(this.modelGroup){\n            // Remove model from scene\n            if (this.modelGroup && this.game.scene) {\n                this.game.scene.remove(this.modelGroup);\n            }\n            \n            // Clear all children\n            while (this.modelGroup.children.length > 0) {\n                const child = this.modelGroup.children[0];\n                this.modelGroup.remove(child);\n            }\n            \n            this.modelGroup = null;\n        }\n    }\n}"
      },
      "UiManager": {
        "fileName": "UiManager",
        "script": "class UiManager extends engine.Component {\r\n    \r\n    constructor(game, parent, params) {\r\n        super(game, parent, params);\r\n    }\r\n    \r\n    \r\n    init({ canvas, canvasBuffer, terrainCanvasBuffer }) {\r\n        this.canvas = canvas;\r\n        this.canvasBuffer = canvasBuffer;\r\n        if(this.game.config.configs.game.is3D) {\r\n            this.finalCtx = this.canvas.getContext(\"webgl2\");\r\n            this.ctx = this.canvasBuffer.getContext(\"webgl2\");\r\n        } else {\r\n            this.finalCtx = this.canvas.getContext(\"2d\");\r\n            this.ctx = this.canvasBuffer.getContext(\"2d\");\r\n        }\r\n        this.terrainCanvasBuffer = terrainCanvasBuffer;\r\n        this.projectConfig = this.game.config.configs.game;\r\n        this.gridSize = this.projectConfig.gridSize;\r\n        this.isometric = this.projectConfig.isIsometric || false;\r\n        this.upgradeMenu = document.getElementById('upgradeMenu');\r\n        this.upgradeOptionsDiv = document.getElementById('upgradeOptions');\r\n        this.overlay = document.getElementById('overlay');\r\n        this.tooltip = document.getElementById('tooltip');\r\n        this.gameOverMenu = document.getElementById('gameOverMenu');\r\n        this.victoryMenu = document.getElementById('victoryMenu');\r\n\r\n        // Stats displays\r\n        this.shardsDisplay = document.getElementById('shardsDisplay');\r\n        this.essenceDisplay = document.getElementById('essenceDisplay');\r\n        this.essenceNeededDisplay = document.getElementById('essenceNeededDisplay');\r\n        this.populationDisplay = document.getElementById('populationDisplay');\r\n        this.maxPopulationDisplay = document.getElementById('maxPopulationDisplay');\r\n        this.hpDisplay = document.getElementById('hpDisplay');\r\n        this.waveDisplay = document.getElementById('waveDisplay');\r\n        this.waveProgress = document.getElementById('waveProgress');\r\n        this.gameOverWave = document.getElementById('gameOverWave');\r\n        this.towerMenu = document.getElementById('towerMenu');\r\n        let towerMenuOptions = '';\r\n        for(let type in this.game.config.towers) {\r\n            if(this.game.config.towers[type].cost > 0){\r\n                towerMenuOptions += `<button class=\"tower-option\" data-type=\"${type}\">${this.game.config.towers[type].title} (${this.game.config.towers[type].cost})</button>`;\r\n            }\r\n        }\r\n        this.towerMenu.innerHTML = towerMenuOptions;\r\n        this.setupTowerPlacement();\r\n        this.setupEventListeners();\r\n        this.game.uiManager = this;\r\n       \r\n    }\r\n    clearCanvas() {\r\n        this.ctx.clearRect(0, 0, this.canvasBuffer.width, this.canvasBuffer.height);\r\n        this.finalCtx.clearRect(0, 0, this.canvas.width, this.canvas.height);    \r\n    }\r\n    renderCanvas() {      \r\n        this.finalCtx.drawImage(this.canvasBuffer, 0, 0);\r\n    }\r\n\r\n    setMousePosition(clientX, clientY) {\r\n        if(!this.game.config.configs.game.is3D) {\r\n            const rect = this.canvas.getBoundingClientRect();\r\n                \r\n            // Account for canvas scaling and offset\r\n            const scaleX = this.canvas.width / rect.width;   // Ratio of canvas pixel width to CSS width\r\n            const scaleY = this.canvas.height / rect.height; // Ratio of canvas pixel height to CSS height\r\n            \r\n            const mapGridWidth = this.game.state.tileMap.length;\r\n            // Calculate mouse position relative to canvas with scaling\r\n            const mouseX = (clientX - rect.left) * scaleX + (this.isometric ? 0 : -( this.canvas.width - mapGridWidth * this.game.config.configs.game.gridSize) / 2);\r\n            const mouseY = (clientY - rect.top) * scaleY + (this.isometric ? 0 : -( this.canvas.height - mapGridWidth * this.game.config.configs.game.gridSize) / 2);\r\n\r\n            // Convert to isometric and grid coordinates\r\n            const gridPos = this.game.translator.isoToGrid(mouseX, mouseY);\r\n            const snappedGrid = this.game.translator.snapToGrid(gridPos.x, gridPos.y);\r\n            const pixelIsoPos = this.game.translator.pixelToIso(mouseX, mouseY);\r\n\r\n            // Update state with corrected coordinates\r\n            this.game.state.mousePosition = { \r\n                x: mouseX, \r\n                y: mouseY, \r\n                isoX: pixelIsoPos.x, \r\n                isoY: pixelIsoPos.y, \r\n                gridX: snappedGrid.x, \r\n                gridY: snappedGrid.y \r\n            };\r\n        } else {\r\n            const rect = this.canvas.getBoundingClientRect();\r\n            \r\n            // Calculate normalized device coordinates (-1 to +1)\r\n            const mouseX = ((clientX - rect.left) / rect.width) * 2 - 1;\r\n            const mouseY = -((clientY - rect.top) / rect.height) * 2 + 1;\r\n            \r\n            // Setup the raycaster\r\n            const raycaster = new THREE.Raycaster();\r\n            const mouse = new THREE.Vector2(mouseX, mouseY);\r\n            \r\n            // Update the picking ray with the camera and mouse position\r\n            raycaster.setFromCamera(mouse, this.game.camera);\r\n            \r\n            // Create a plane at y=0 to represent our terrain\r\n            const groundPlane = new THREE.Plane(new THREE.Vector3(0, 1, 0), 0);\r\n            \r\n            // Calculate the point where the ray intersects the ground plane\r\n            const intersectPoint = new THREE.Vector3();\r\n            raycaster.ray.intersectPlane(groundPlane, intersectPoint);\r\n            \r\n            if (intersectPoint) {\r\n                // Convert to grid coordinates\r\n                const gridX = Math.floor(intersectPoint.x / this.game.config.configs.game.gridSize);\r\n                const gridY = Math.floor(intersectPoint.z / this.game.config.configs.game.gridSize);\r\n                \r\n                // Update state with world and grid coordinates\r\n                this.game.state.mousePosition = {\r\n                    x: intersectPoint.x,                    \r\n                    y: intersectPoint.z,\r\n                    gridX: gridX,\r\n                    gridY: gridY,\r\n                    worldX: intersectPoint.x,\r\n                    worldY: intersectPoint.z\r\n                };\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n  setupEventListeners() {\r\n        document.getElementById('startGameBtn').removeAttribute('style');\r\n        document.getElementById('startGameBtn').addEventListener('click', (e) => {    \r\n            this.game.state.isPaused = false;\r\n            e.target.setAttribute('style','display:none;');\r\n        });\r\n        document.querySelector(\"#gameOverMenu .menu-button\").addEventListener(\"click\", (e) => {\r\n            this.game.reset();\r\n        });\r\n        \r\n        document.querySelector(\"#victoryMenu .menu-button\").addEventListener(\"click\", (e) => {\r\n            this.game.reset();\r\n        });\r\n        this.canvas.addEventListener('mousemove', (e) => {\r\n            this.setMousePosition(e.clientX, e.clientY);\r\n\r\n            if (!this.game.state.selectedTowerType && !this.game.state.towers.length) return;\r\n\r\n            if (this.game.state.selectedTowerType && this.game.state.previewTower) {\r\n                this.game.state.previewTower.position.x = this.game.state.mousePosition.gridX * this.gridSize + this.gridSize / 2;\r\n                this.game.state.previewTower.position.y = this.game.state.mousePosition.gridY * this.gridSize + this.gridSize / 2;\r\n                this.game.state.previewTower.position.z = this.game.state.previewTower.getCurrentTerrainHeight();\r\n                const isValidPosition = this.checkValidTowerPosition(this.game.state.mousePosition.gridX, this.game.state.mousePosition.gridY);\r\n                this.canvas.style.cursor = isValidPosition ? 'pointer' : 'not-allowed';\r\n            }\r\n\r\n            let hoveredTower = null;\r\n            for (const tower of this.game.state.towers) {\r\n                const dist = Math.hypot(tower.gridPosition.x - this.game.state.mousePosition.gridX, tower.gridPosition.y + this.game.translator.tileHeight / 2 - this.game.state.mousePosition.gridY);\r\n                if (dist < 20) {\r\n                    hoveredTower = tower;\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if (hoveredTower && hoveredTower.stats) {\r\n                let info = `${hoveredTower.type} (Level ${hoveredTower.level})\\n`;\r\n                info += `Damage: ${Math.round(hoveredTower.stats.damage * this.game.state.stats.damageMultiplier * 10) / 10}\\n`;\r\n                info += `Attack Speed: ${Math.round(1000 / hoveredTower.stats.attackSpeed)} per sec\\n`;\r\n                info += `Range: ${hoveredTower.stats.range}\\n`;\r\n                info += `Crit Chance: ${Math.round(hoveredTower.stats.critChance * 100)}%\\n`;\r\n                if (hoveredTower.stats.leech > 0) {\r\n                    info += `Life Leech: ${Math.round(hoveredTower.stats.leech * 100 * this.game.state.stats.healingMultiplier) / 100} HP per hit\\n`;\r\n                }\r\n                if (hoveredTower.stats.piercing > 0) {\r\n                    info += `Piercing: ${hoveredTower.stats.piercing} enemies\\n`;\r\n                }\r\n                if (hoveredTower.stats.summonChance > 0) {\r\n                    info += `Summon Chance: ${Math.round(hoveredTower.stats.summonChance * 100)}%\\n`;\r\n                }\r\n\r\n                this.showTooltip(e.clientX, e.clientY, info);\r\n                hoveredTower.showRange = true;\r\n            } else {\r\n                this.hideTooltip();\r\n                this.game.state.towers.forEach(t => t.showRange = false);\r\n            }\r\n        });\r\n\r\n        this.canvas.addEventListener('mouseout', () => {\r\n            this.hideTooltip();\r\n        });\r\n        \r\n        this.canvas.addEventListener('click', (e) => {\r\n            if (!this.game.state.selectedTowerType) return;\r\n            \r\n\r\n            if (this.checkValidTowerPosition(this.game.state.mousePosition.gridX, this.game.state.mousePosition.gridY)) {\r\n                // Create the tower\r\n                let cost = this.game.config.towers[this.game.state.selectedTowerType].cost;\r\n                let populationCost = this.game.config.towers[this.game.state.selectedTowerType].population || 0;\r\n                \r\n                const finalCost = Math.floor(cost * this.game.state.stats.towerCostMod);\r\n                \r\n                if (this.game.state.bloodShards >= finalCost && this.game.state.stats.population + populationCost <= this.game.state.stats.maxPopulation) {\r\n          \r\n                    const tower = this.game.spawn(this.game.state.mousePosition.gridX * this.gridSize + this.gridSize / 2, \r\n                                                 this.game.state.mousePosition.gridY * this.gridSize + this.gridSize / 2, \"tower\", { objectType: \"towers\", spawnType: this.game.state.selectedTowerType, setDirection: 1});\r\n                    tower.placed = true;\r\n                    this.game.state.tileMap[this.game.state.mousePosition.gridY][this.game.state.mousePosition.gridX].buildable = false;\r\n                    this.game.state.tileMap[this.game.state.mousePosition.gridY][this.game.state.mousePosition.gridX].tower = tower;\r\n                    this.game.state.bloodShards -= finalCost;\r\n                    this.game.state.previewTower.destroy();\r\n                    this.game.state.previewTower = null;\r\n                    const gameEventData = this.game.config.gameEvents['placeTower'];\r\n                    const audioData = this.game.config.sounds[gameEventData.sound].audio;\r\n                    this.game.audioManager.playSynthSound('placeTower', audioData);\r\n                    // Clear selection\r\n                    this.game.state.selectedTowerType = null;\r\n                    this.canvas.style.cursor = 'default';\r\n                }\r\n            }\r\n        });\r\n        \r\n        // Cancel tower placement with right click\r\n        this.canvas.addEventListener('contextmenu', (e) => {\r\n            e.preventDefault();\r\n            if (this.game.state.selectedTowerType) {\r\n                this.game.state.selectedTowerType = null;\r\n                this.canvas.style.cursor = 'default';\r\n            }\r\n        });\r\n}\r\n\r\n  setupTowerPlacement() {\r\n\r\n        \r\n        const towerButtons = document.querySelectorAll('.tower-option');\r\n        towerButtons.forEach(button => {\r\n            button.addEventListener('click', () => {\r\n\r\n                if(this.game.state.isPaused) return;\r\n                \r\n                const type = button.getAttribute('data-type');\r\n                let cost = this.game.config.towers[type].cost;\r\n                const finalCost = Math.floor(cost * this.game.state.stats.towerCostMod);\r\n                \r\n                let populationCost = this.game.config.towers[type].population || 0;\r\n                if (this.game.state.bloodShards >= finalCost && this.game.state.stats.population + populationCost <= this.game.state.stats.maxPopulation) {\r\n                    this.game.state.selectedTowerType = type;\r\n                    if(this.game.state.previewTower) {\r\n                        this.game.state.previewTower.destroy();\r\n                    }\r\n                    this.game.state.previewTower = this.game.spawn(-100, -100, 'previewTower', { objectType: \"towers\", spawnType: this.game.state.selectedTowerType});\r\n                }\r\n            });\r\n            \r\n            // Show tooltip with info\r\n            button.addEventListener('mouseover', (e) => {\r\n                const type = button.getAttribute('data-type');\r\n                let info = this.game.config.towers[type].info;\r\n                \r\n                this.showTooltip(e.clientX, e.clientY, info);\r\n            });\r\n            \r\n            button.addEventListener('mouseout', () => {\r\n                this.hideTooltip();\r\n            });\r\n        });\r\n        \r\n        \r\n    }\r\n\r\n    checkValidTowerPosition(posX, posY) {\r\n        if(posX >= 0 && posY >= 0 && this.game.state.tileMap.length > posY && this.game.state.tileMap[posY].length > posX){\r\n            return this.game.state.tileMap[posY][posX].buildable;            \r\n        }\r\n        return false;\r\n    }\r\n\r\n    reset() {\r\n        this.gameOverMenu.style.display = 'none';\r\n        this.victoryMenu.style.display = 'none';\r\n        this.overlay.style.display = 'none';\r\n        this.waveDisplay.textContent = '1';\r\n        this.waveProgress.style.width = '0%';        \r\n\r\n\r\n    }\r\n\r\n\r\n    draw() {\r\n        this.shardsDisplay.textContent = Math.floor(this.game.state.bloodShards);\r\n        this.essenceDisplay.textContent = Math.floor(this.game.state.essence);\r\n        this.essenceNeededDisplay.textContent = Math.floor(this.game.state.essenceToNextLevel);\r\n        this.hpDisplay.textContent = Math.floor(this.game.state.bloodCoreHP);\r\n        this.populationDisplay.textContent = Math.floor(this.game.state.stats.population);\r\n        this.maxPopulationDisplay.textContent = Math.floor(this.game.state.stats.maxPopulation);  \r\n        if (this.game.state.enemies.length === 0 && this.game.state.enemiesSpawned >= this.game.state.numEnemiesInWave && !this.game.state.victory) {\r\n            const countdown = Math.ceil((this.game.state.waveDelay - this.game.state.waveTimer) / 60);\r\n            this.ctx.fillStyle = 'white';\r\n            this.ctx.font = '20px Arial';\r\n            this.ctx.textAlign = 'center';\r\n            this.ctx.fillText(`Next Wave in ${countdown}...`, this.canvas.width / 2, 50);\r\n        }  \r\n        if(!this.game.config.configs.game.is3D) {\r\n            this.renderCanvas();\r\n        }\r\n}\r\n\r\n    updateWaveDisplay(waveNumber) {\r\n        this.waveDisplay.textContent = waveNumber;\r\n    }\r\n\r\n\r\n    showTooltip(x, y, text) {\r\n        const tooltip = document.getElementById('tooltip');\r\n        tooltip.style.display = 'block';\r\n        tooltip.style.left = (x + 10) + 'px';\r\n        tooltip.style.top = (y + 10) + 'px';\r\n        tooltip.textContent = text;\r\n    }\r\n\r\n    hideTooltip() {\r\n        const tooltip = document.getElementById('tooltip');\r\n        tooltip.style.display = 'none';\r\n    }\r\n}"
      },
      "HitEffectRenderer": {
        "fileName": "HitEffectRenderer",
        "script": "class HitEffectRenderer extends engine.Component {\r\n    \r\n    constructor(game, parent, params) {\r\n        super(game, parent, params);\r\n    }\r\n    \r\n    \r\n init( ) {\r\n        this.ctx = this.game.ctx;\r\n    }\r\n\r\n    draw() {\r\n        const particleComp = this.parent.getComponent(\"HitEffectParticle\");\r\n        if (!particleComp || !particleComp.particles.length) return;\r\n\r\n        const basePos = this.game.translator.pixelToIso(this.parent.position.x, this.parent.position.y);\r\n\r\n        for (let particle of particleComp.particles) {\r\n            this.ctx.fillStyle = `${particle.color}${particle.alpha})`;\r\n            this.ctx.beginPath();\r\n            const drawX = basePos.x + particle.x;\r\n            const drawY = basePos.y + particle.y;\r\n            this.ctx.arc(drawX, drawY, particle.size, 0, Math.PI * 2);\r\n            this.ctx.fill();\r\n        }\r\n    }\r\n}"
      },
      "Explosion": {
        "fileName": "Explosion",
        "script": "class Explosion extends engine.Component {\r\n    \r\n    constructor(game, parent, params) {\r\n        super(game, parent, params);\r\n    }\r\n    \r\n    \r\n   init( {radius}) {\r\n        this.maxRadius = radius * this.game.config.configs.game.gridSize / 2;\r\n        this.currentRadius = 0;\r\n        this.alpha = 1;\r\n    }\r\n\r\n    update() {\r\n        this.currentRadius += this.maxRadius * 0.1;\r\n        this.alpha -= 0.05;\r\n        if( this.alpha < 0 ) {\r\n            this.parent.destroy();\r\n        }\r\n    }\r\n\r\n    draw() {\r\n        const pixelX = this.parent.position.x;\r\n        const pixelY = this.parent.position.y;\r\n\r\n        // Convert pixel to isometric\r\n        const isoPos = this.game.translator.pixelToIso(pixelX, pixelY);\r\n        const isoRadiusX = this.currentRadius;         // X-axis range remains roughly the same in isometric space\r\n        const isoRadiusY = this.currentRadius * 0.5;   // Y-axis range is halved due to isometric compression\r\n\r\n        this.game.ctx.beginPath();\r\n        this.game.ctx.ellipse(\r\n                isoPos.x,           // Center x in isometric coords\r\n                isoPos.y,           // Center y in isometric coords\r\n                isoRadiusX,          // X radius (wider due to isometric projection)\r\n                isoRadiusY,          // Y radius (shorter due to flattening)\r\n                0,                  // Rotation (none needed for isometric)\r\n                0,                  // Start angle\r\n                2 * Math.PI         // End angle (full circle)\r\n            );\r\n        this.game.ctx.fillStyle = `rgba(255, 200, 0, ${this.alpha * 0.5})`;\r\n        this.game.ctx.fill();\r\n\r\n        this.game.ctx.beginPath();\r\n        this.game.ctx.ellipse(\r\n                isoPos.x,           // Center x in isometric coords\r\n                isoPos.y,           // Center y in isometric coords\r\n                isoRadiusX * .7,          // X radius (wider due to isometric projection)\r\n                isoRadiusY * .7,          // Y radius (shorter due to flattening)\r\n                0,                  // Rotation (none needed for isometric)\r\n                0,                  // Start angle\r\n                2 * Math.PI         // End angle (full circle)\r\n            );\r\n        this.game.ctx.fillStyle = `rgba(255, 100, 0, ${this.alpha})`;\r\n        this.game.ctx.fill();\r\n    \r\n    }\r\n}"
      },
      "RangeIndicator": {
        "fileName": "RangeIndicator",
        "script": "class RangeIndicator extends engine.Component {\r\n    \r\n    constructor(game, parent, params) {\r\n        super(game, parent, params);\r\n    }\r\n    \r\n    \r\n    init() {\r\n        this.ctx = this.game.ctx;\r\n        this.translator = this.game.translator; // Access translator for tileWidth\r\n    }\r\n\r\n    draw() {\r\n        let statsComp = this.getComponent('stats');\r\n        if (!statsComp || !statsComp.stats || !statsComp.stats.range) {\r\n            return;\r\n        }\r\n        this.drawRangeIndicator(statsComp.stats.range);\r\n    }\r\n\r\n    drawRangeIndicator(range) {    \r\n        const drawRage = range;        \r\n        const pixelX = this.parent.position.x;\r\n        const pixelY = this.parent.position.y;\r\n        let gridPos = this.translator.pixelToGrid(pixelX, pixelY);\r\n        gridPos = this.translator.snapToGrid(gridPos.x, gridPos.y);\r\n        const isoPos = this.translator.pixelToIso(pixelX, pixelY);\r\n    \r\n        let isoRangeX = drawRage * this.game.config.configs.game.gridSize;  // Matches gridToIso X scaling\r\n        let isoRangeY = drawRage * this.game.config.configs.game.gridSize * (this.game.state.isometric ? 0.5 : 1); // Matches gridToIso Y scaling\r\n    \r\n        if( this.game.state.isometric ) {\r\n            isoRangeX *= .56;\r\n            isoRangeY *= .56;\r\n        }\r\n\r\n        if (gridPos.x === this.game.state.mousePosition.gridX && gridPos.y === this.game.state.mousePosition.gridY) {\r\n            this.ctx.save();\r\n            this.ctx.beginPath();\r\n            this.ctx.strokeStyle = 'rgba(255, 0, 0, 0.5)';\r\n            this.ctx.lineWidth = 2;\r\n    \r\n            this.ctx.ellipse(\r\n                isoPos.x,\r\n                isoPos.y,\r\n                isoRangeX,\r\n                isoRangeY,\r\n                0,\r\n                0,\r\n                2 * Math.PI\r\n            );\r\n    \r\n            this.ctx.stroke();\r\n            this.ctx.closePath();\r\n            this.ctx.restore();\r\n        }    \r\n      \r\n    }\r\n}"
      },
      "MapRenderer": {
        "fileName": "MapRenderer",
        "script": "class MapRenderer extends engine.Component {\r\n    \r\n    constructor(game, parent, params) {\r\n        super(game, parent, params);\r\n    }\r\n    \r\n    \r\n    init({canvasBuffer, terrainCanvasBuffer, worldObjects, imageManager, levelName, gameConfig, level, isEditor, palette}) {   \r\n\r\n        this.config = gameConfig;\r\n        this.imageManager = imageManager;\r\n        this.worldObjects = worldObjects;\r\n        this.selectedTowerType = null;\r\n        this.hoverCell = { x: -1, y: -1 };\r\n        this.showRange = false;\r\n        this.isMapCached = false; // Flag to track if map needs redrawing\r\n        this.currentLevel = levelName;\r\n        this.level = level;\r\n        this.tileMap = level.tileMap;\r\n        this.palette = palette;\r\n\r\n        // Create off-screen canvas for caching\r\n        if(!this.config.is3D || isEditor) {\r\n            this.ctx = canvasBuffer.getContext('2d');\r\n            this.mapCacheCanvas = document.createElement('canvas');\r\n            this.mapCacheCanvas.width = this.config.canvasWidth;\r\n            this.mapCacheCanvas.height = this.config.canvasHeight;\r\n            this.mapCacheCtx = this.mapCacheCanvas.getContext('2d');\r\n\r\n            \r\n            this.envCacheCanvasBG = document.createElement('canvas');\r\n            this.envCacheCanvasBG.width = this.config.canvasWidth;\r\n            this.envCacheCanvasBG.height = this.config.canvasHeight / 2;\r\n            this.envCacheCtxBG = this.envCacheCanvasBG.getContext('2d');\r\n\r\n            this.envCacheCanvasFG = document.createElement('canvas');\r\n            this.envCacheCanvasFG.width = this.config.canvasWidth;\r\n            this.envCacheCanvasFG.height = this.config.canvasHeight / 2;\r\n            this.envCacheCtxFG = this.envCacheCanvasFG.getContext('2d');\r\n        }\r\n        this.terrainCanvas = terrainCanvasBuffer;\r\n        this.terrainCanvas.width = this.tileMap.size * this.config.gridSize;\r\n        this.terrainCanvas.height = this.tileMap.size * this.config.gridSize;\r\n        this.terrainCtx = this.terrainCanvas.getContext('2d');\r\n        \r\n        this.terrainTileMapper = this.game.terrainTileMapper;\r\n        this.game.mapRenderer = this;\r\n        this.isometric = this.game.config.configs.game.isIsometric;\r\n    }\r\n\r\n    draw(){}\r\n    render(tileMapData) {\r\n        if(!this.isMapCached){\r\n            this.terrainCtx.clearRect(0, 0, this.terrainCanvas.width, this.terrainCanvas.height);\r\n                \r\n            // Draw the map onto the cache canvas\r\n            this.drawTileMap(tileMapData);\r\n            this.renderEnvironment();\r\n            \r\n            //this.drawPaths(this.terrainCacheCtx, paths);\r\n        }\r\n        // Mark cache as valid\r\n        this.isMapCached = true;\r\n    }\r\n    renderEnvironment() {\r\n        if (this.tileMap.environmentObjects.length === 0) return;\r\n    \r\n        // Group environment objects by type\r\n        const objectsByType = {};\r\n        this.tileMap.environmentObjects.forEach(obj => {\r\n            if (!objectsByType[obj.type]) {\r\n                objectsByType[obj.type] = [];\r\n            }\r\n            objectsByType[obj.type].push(obj);\r\n        });\r\n    \r\n        // Process each type separately\r\n        Object.entries(objectsByType).forEach(([type, objects]) => {\r\n            // Load the model for this type\r\n            const referenceModel = this.game.modelManager.getModel(\"worldObjects\", type);\r\n            if (!referenceModel) return;\r\n    \r\n            // Find all meshes and store their complete transform data\r\n            const meshData = [];\r\n            referenceModel.updateMatrixWorld(true); // Ensure world matrices are up to date\r\n    \r\n            referenceModel.traverse(node => {\r\n                if (node.isMesh) {\r\n                    const parent = node.parent;\r\n                    const parentWorldMatrix = parent.matrixWorld.clone();\r\n                    const localMatrix = node.matrix.clone();\r\n    \r\n                    // Get transform relative to model root\r\n                    const relativeMatrix = new THREE.Matrix4();\r\n                    relativeMatrix.copy(parentWorldMatrix);\r\n                    relativeMatrix.multiply(localMatrix);\r\n    \r\n                    meshData.push({\r\n                        mesh: node,\r\n                        relativeMatrix: relativeMatrix\r\n                    });\r\n                }\r\n            });\r\n            if (meshData.length === 0) return;\r\n    \r\n            // Create instanced meshes for this type\r\n            const instancedMeshes = meshData.map(({ mesh, relativeMatrix }) => {\r\n                const instancedMesh = new THREE.InstancedMesh(\r\n                    mesh.geometry,\r\n                    mesh.material,\r\n                    objects.length // Number of instances for this type\r\n                );\r\n                instancedMesh.userData.relativeMatrix = relativeMatrix;\r\n                instancedMesh.castShadow = true;\r\n                instancedMesh.receiveShadow = true;\r\n                return instancedMesh;\r\n            });\r\n    \r\n            // Set positions for all instances of this type\r\n            const matrix = new THREE.Matrix4();\r\n            const dummy = new THREE.Object3D();\r\n    \r\n            objects.forEach((obj, index) => {\r\n                // Get pixel color at object position\r\n                let hexColor = this.tileMap.terrainTypes[this.tileMap.extensionTerrainType].color.slice(1);\r\n                let numColor = parseInt(hexColor, 16); // Convert hex string to number, e.g., 0xaa3311\r\n\r\n                let r = (numColor >> 16) & 0xff; // Red channel\r\n                let g = (numColor >> 8) & 0xff;  // Green channel   \r\n                let b = numColor & 0xff;         // Blue channel\r\n                if (g > r && g > b) {\r\n                    dummy.position.set(\r\n                        obj.x, \r\n                        this.game.config.heightMaps[this.game.config.worlds[this.level.world].heightMap].heightStep * this.tileMap.extensionTerrainType, \r\n                        obj.y\r\n                    );\r\n                    dummy.rotation.y = Math.random() * Math.PI * 2;\r\n                    const scale = 0.8 + Math.random() * 0.4;\r\n                    dummy.scale.set(scale, scale, scale);\r\n                    dummy.updateMatrix();\r\n            \r\n                    // Apply transforms while preserving mesh relationships\r\n                    instancedMeshes.forEach(instancedMesh => {\r\n                        matrix.copy(dummy.matrix);\r\n                        matrix.multiply(instancedMesh.userData.relativeMatrix);\r\n                        instancedMesh.setMatrixAt(index, matrix);\r\n                    });\r\n                }\r\n            });\r\n    \r\n            // Add instanced meshes to the scene\r\n            instancedMeshes.forEach(instancedMesh => {\r\n                instancedMesh.instanceMatrix.needsUpdate = true;\r\n                this.game.scene.add(instancedMesh);\r\n            });\r\n        });\r\n    }\r\n    renderBG(tileMapData, paths) {\r\n        this.clearMap(tileMapData);\r\n        // Generate cache if not already done\r\n        if (!this.isMapCached) {\r\n            this.cacheMap(tileMapData, paths, this.isometric);            \r\n        }        \r\n  \r\n        // Draw cached map image to main canvas\r\n      \r\n       this.ctx.drawImage( this.terrainCanvas, ( this.config.canvasWidth - this.terrainCanvas.width) / 2, ( this.config.canvasHeight - this.terrainCanvas.height) / 2 );\r\n\r\n       //this.ctx.drawImage(this.terrainCanvas, 0, 0);\r\n        //this.ctx.drawImage(this.mapCacheCanvas, 0,  -this.config.canvasHeight / 2);\r\n        this.ctx.drawImage(this.envCacheCanvasBG, 0, 0);\r\n    }\r\n    renderFG() {  \r\n        this.ctx.drawImage(this.envCacheCanvasFG, 0, this.config.canvasHeight / 2);\r\n    }    \r\n    setLevel(level) {\r\n        this.currentLevel = level;\r\n        this.terrainImages = this.imageManager.getImages(\"levels\", level);\r\n\r\n    }\r\n\r\n    drawTileMap(tileMapData) {\r\n        this.terrainTileMapper.draw(tileMapData.terrainMap);\r\n    }\r\n    clearMap(tileMapData) {\r\n        this.ctx.clearRect(0, 0, this.config.canvasWidth, this.config.canvasHeight);\r\n        this.ctx.fillStyle = tileMapData.terrainTypes[tileMapData.extensionTerrainType].color;       \r\n        this.ctx.fillRect(0, 0, this.config.canvasWidth, this.config.canvasHeight);\r\n    }\r\n    // Call this when map data changes or on initialization\r\n    cacheMap(tileMapData, paths, isometric) {\r\n        this.terrainCtx.clearRect(0, 0, this.config.canvasWidth, this.config.canvasHeight);\r\n                   \r\n        // Clear the cache canvas\r\n        this.mapCacheCtx.clearRect(0, 0, this.config.canvasWidth, this.config.canvasHeight);\r\n        \r\n        // Draw the map onto the cache canvas\r\n        this.drawTileMap(tileMapData, isometric);\r\n        this.drawPaths(this.mapCacheCtx, paths);\r\n        this.drawEnvironment(tileMapData.terrainMap.length, tileMapData.terrainMap.length * tileMapData.terrainMap.length);\r\n        \r\n        // Mark cache as valid\r\n        this.isMapCached = true;\r\n    }\r\n\r\n    drawMap(tileMap) {\r\n\r\n        this.mapCacheCtx.fillStyle = '#4a7c59';\r\n        this.mapCacheCtx.fillRect(0, 0, this.config.canvasWidth, this.config.canvasHeight);\r\n        const tileWidth = this.config.gridSize;\r\n        const tileHeight = this.config.gridSize * 0.5;\r\n        \r\n        for (let y = 0; y < tileMap.length; y++) {\r\n            for (let x = 0; x < tileMap[y].length; x++) {\r\n                const tile = tileMap[y][x];\r\n                \r\n                // Use translator to get iso coordinates\r\n                const isoCoords = this.game.translator.gridToIso(x, y);\r\n                const isoX = isoCoords.x;\r\n                const isoY = isoCoords.y;\r\n                \r\n                this.mapCacheCtx.fillStyle = tile.color;\r\n                this.mapCacheCtx.beginPath();\r\n                this.mapCacheCtx.moveTo(isoX, isoY);\r\n                this.mapCacheCtx.lineTo(isoX + tileWidth / 2, isoY + tileHeight / 2);\r\n                this.mapCacheCtx.lineTo(isoX, isoY + tileHeight);\r\n                this.mapCacheCtx.lineTo(isoX - tileWidth / 2, isoY + tileHeight / 2);\r\n                this.mapCacheCtx.closePath();\r\n                this.mapCacheCtx.fill();\r\n                this.mapCacheCtx.strokeStyle = 'rgba(0, 0, 0, 0.1)';\r\n                this.mapCacheCtx.stroke();\r\n            }\r\n        }\r\n        \r\n       \r\n        this.drawEnvironment(tileMap.length);\r\n    }\r\n\r\n    drawPaths(ctx, paths) {\r\n        const tileHeight = this.config.gridSize * 0.5;\r\n        ctx.strokeStyle = '#ffd166';\r\n        ctx.lineWidth = 2;\r\n        ctx.beginPath();\r\n        \r\n        paths.forEach(path => {\r\n            // First point in path\r\n            const firstIsoCoords = this.game.translator.gridToIso(path[0].x, path[0].y);\r\n            const firstIsoX = firstIsoCoords.x;\r\n            const firstIsoY = firstIsoCoords.y + tileHeight / 2; // Add half tile height for center of tile\r\n            \r\n            ctx.moveTo(firstIsoX, firstIsoY);\r\n            \r\n            // Remaining points in path\r\n            path.forEach(location => {\r\n                const isoCoords = this.game.translator.gridToIso(location.x, location.y);\r\n                const isoX = isoCoords.x;\r\n                const isoY = isoCoords.y + tileHeight / 2; // Add half tile height for center of tile\r\n                \r\n                ctx.lineTo(isoX, isoY);\r\n            });\r\n        });\r\n        \r\n        ctx.stroke();\r\n    }\r\n\r\n    drawEnvironment(boardSize, amountToDraw) {\r\n\r\n        let itemAmt = amountToDraw;\r\n        let environmentTypes = [];\r\n        for(let envType in this.worldObjects){\r\n            environmentTypes.push(envType);\r\n        }\r\n        this.envCacheCtxBG.clearRect(0, 0, this.config.canvasWidth, this.config.canvasHeight);\r\n        this.envCacheCtxFG.clearRect(0, 0, this.config.canvasWidth, this.config.canvasHeight);\r\n        \r\n        let items = [];\r\n        \r\n        // Check if we have stored environment objects\r\n        if (this.tileMap.environmentObjects && this.tileMap.environmentObjects.length > 0) {\r\n            // Use the stored objects\r\n            this.tileMap.environmentObjects.forEach(obj => {\r\n                const images = this.imageManager.getImages(\"environment\", obj.type);\r\n                if (images && images.idle && images.idle[0] && images.idle[0][obj.imageIndex]) {\r\n                    items.push({\r\n                        img: images.idle[0][obj.imageIndex],\r\n                        x: obj.x,\r\n                        y: obj.y\r\n                    });\r\n                }\r\n            });\r\n        } else {       \r\n            // for(let i = 0; i < itemAmt; i++) {\r\n            //     // Define the game board boundaries\r\n            //     const boardMinX = 0;\r\n            //     const boardMaxX = boardSize * this.config.gridSize;\r\n            //     const boardMinY = 0;\r\n            //     const boardMaxY = boardSize * this.config.gridSize;\r\n                \r\n            //     // Generate a random position that's outside the board but within a reasonable distance\r\n            //     let x, y;\r\n                \r\n            //     // Expand the area where we can place objects\r\n            //     const expandAmount = boardSize * this.config.gridSize; // Adjust this value as needed\r\n                \r\n            //     // Randomly choose whether to place on x-axis or y-axis outside the board\r\n            //     if (Math.random() < 0.5) {\r\n            //         // Place on the left or right of the board\r\n            //         x = Math.random() < 0.5 ?\r\n            //             boardMinX - Math.random() * expandAmount : // Left side\r\n            //             boardMaxX + Math.random() * expandAmount;  // Right side\r\n                    \r\n            //         // Allow y to be anywhere, including outside the board\r\n            //         y = boardMinY - expandAmount + Math.random() * (boardMaxY - boardMinY + 2 * expandAmount);\r\n            //     } else {\r\n            //         // Place on the top or bottom of the board\r\n            //         y = Math.random() < 0.5 ?\r\n            //             boardMinY - Math.random() * expandAmount : // Top side\r\n            //             boardMaxY + Math.random() * expandAmount;  // Bottom side\r\n                    \r\n            //         // Allow x to be anywhere, including outside the board\r\n            //         x = boardMinX - expandAmount + Math.random() * (boardMaxX - boardMinX + 2 * expandAmount);\r\n            //     }\r\n                \r\n            //     // Double-check that the position is actually outside the board\r\n            //     if (x < boardMinX || x > boardMaxX || y < boardMinY || y > boardMaxY) {\r\n            //         const type = environmentTypes[Math.floor(Math.random() * environmentTypes.length)];\r\n            //         const images = this.imageManager.getImages(\"environment\", type);\r\n            //         if(images){\r\n            //             items.push( { img: images.idle[0][parseInt(Math.random()*images.idle[0].length)], x: x, y: y});\r\n            //         }\r\n            //     } else {\r\n            //         i--; // Position inside board, try again\r\n            //     }\r\n            // }\r\n        }\r\n\r\n        items.sort((a, b) => {\r\n            return (a.y * boardSize + a.x) - (b.y * boardSize + b.x)\r\n        });\r\n\r\n        items.forEach((item) => {            \r\n            // Convert pixel to isometric\r\n            const isoPos = this.game.translator.pixelToIso(item.x, item.y);\r\n            const image = item.img;\r\n            const imgWidth = image.width;\r\n            const imgHeight = image.height;\r\n            \r\n            const drawX = isoPos.x;\r\n            const drawY = isoPos.y;\r\n            if( drawY < this.config.canvasHeight / 2 ) {\r\n                this.envCacheCtxBG.drawImage(image, drawX - imgWidth / 2, drawY - imgHeight / 2);\r\n            } else if(drawY - this.config.canvasHeight / 2 - imgHeight / 2 > 0) {//prevent trees in FG from getting chopped off at the top if they are too close to the middle of the frame.\r\n  \r\n                this.envCacheCtxFG.drawImage(image, drawX - imgWidth / 2, drawY - this.config.canvasHeight / 2 - imgHeight / 2);\r\n            }\r\n        });\r\n    }\r\n\r\n}"
      }
    },
    "configs": {
      "game": {
        "gridSize": 48,
        "imageSize": 128,
        "title": "Default Project",
        "isIsometric": false,
        "libraries": [
          "threejs",
          "ShapeFactory",
          "ImageManager",
          "SpatialGrid",
          "CoordinateTranslator",
          "CanvasUtility",
          "TerrainImageProcessor",
          "TileMap",
          "Entity",
          "Component",
          "GameState",
          "ModelManager",
          "three.OrbitControls",
          "GLTFLoader"
        ],
        "fileName": "game",
        "interface": "main",
        "loaderComponent": "GameLoader",
        "loaderEntity": "GameLoader",
        "canvasWidth": 1600,
        "canvasHeight": 1000,
        "is3D": true,
        "palette": "main"
      },
      "state": {
        "level": "level1",
        "enemies": [],
        "bloodShards": 200,
        "essence": 0,
        "essenceToNextLevel": 100,
        "bloodCoreHP": 1000,
        "mousePosition": "{ x: 0, y: 0, isoX: 0, isoY: 0, gridX: 0, gridY: 0 }",
        "towers": [],
        "projectiles": [],
        "summons": "[]",
        "others": "[]",
        "waveSets": [],
        "currentWaveIds": "[]",
        "currentWaveEnemies": "[]",
        "enemiesSpawned": "[]",
        "wave": "",
        "isPaused": true,
        "isLevelingUp": false,
        "timeScale": 1,
        "gameOver": false,
        "victory": false,
        "round": 0,
        "waveDelay": 1,
        "modifierSet": "global",
        "fileName": "state",
        "population": 0
      },
      "codeMirror": {
        "title": "Code Mirror",
        "theme": "codeMirrorTheme",
        "fileName": "codeMirror"
      },
      "editor": {
        "title": "Editor Config",
        "editorCategories": "",
        "theme": "claude2",
        "editorModules": [
          "terrainModule",
          "graphicsModule",
          "scriptModule",
          "aiPromptModule",
          "audioModule",
          "exportScriptModule",
          "textureEditor"
        ],
        "path": "/",
        "fileName": "editor"
      },
      "ai": {
        "title": "AI",
        "aiEndPoint": "http://localhost:11434/api/generate",
        "aiModel": "deepseek-r1:32b",
        "defaultPrompt": "I am developing a tower defense game featuring a simple 3d art style.  Generate a new object based on the following context.    Please provide ONLY a valid JSON object with keys MATCHING EXACTLY to the context above. It absolutely MUST have an appropriate 'id' field. Ensure all existing key types are maintained. Do not wrap the json object with any other text.",
        "fileName": "ai"
      }
    },
    "editorModules": {
      "aiPromptModule": {
        "title": "AI Prompt Modal",
        "library": "aiPromptPanel",
        "interface": "aiPromptPanel"
      },
      "audioModule": {
        "title": "Audio Editor",
        "container": "audio-editor-container",
        "propertyName": "audio",
        "interface": "audioEditor",
        "inputElement": "textarea",
        "inputDataType": "json",
        "loadHook": "editAudio",
        "saveHook": "saveAudio",
        "libraries": [
          "Component",
          "audioEditor"
        ]
      },
      "terrainModule": {
        "title": "Terrain Editor",
        "container": "level-editor-container",
        "libraries": [
          "threejs",
          "ShapeFactory",
          "CoordinateTranslator",
          "ImageManager",
          "CanvasUtility",
          "TerrainImageProcessor",
          "TileMap",
          "GE_GroupManager",
          "terrainMapEditor"
        ],
        "propertyName": "tileMap",
        "interface": "terrainEditor",
        "inputElement": "textarea",
        "inputDataType": "json",
        "loadHook": "editTileMap",
        "saveHook": "saveTileMap"
      },
      "graphicsModule": {
        "title": "Graphics Editor",
        "container": "graphics-editor-container",
        "libraries": [
          "threejs",
          "three.OrbitControls",
          "GLTFLoader",
          "ShapeFactory",
          "GE_AnimationManager",
          "GE_EventManager",
          "GE_GizmoManager",
          "GE_GroupManager",
          "GE_ShapeManager",
          "GE_RotationUtils",
          "GE_SceneRenderer",
          "GE_UIManager",
          "GraphicsEditor"
        ],
        "propertyName": "render",
        "interface": "graphicsEditor",
        "inputElement": "textarea",
        "inputDataType": "json",
        "loadHook": "renderGraphicsObject",
        "saveHook": "saveGraphicsObject"
      },
      "exportScriptModule": {
        "title": "Export Scripts Module",
        "library": "ZipExporter"
      },
      "textureEditor": {
        "title": "Texture Editor",
        "container": "texture-editor-container",
        "library": "TextureEditor",
        "propertyName": "image",
        "interface": "TextureEditor",
        "inputElement": "textarea",
        "inputDataType": "string",
        "loadHook": "editTexture",
        "saveHook": "saveTexture"
      },
      "scriptModule": {
        "title": "Script Editor",
        "container": "script-editor-container",
        "interface": "scriptEditor",
        "inputElement": "textarea",
        "inputDataType": "string",
        "libraries": [
          "scriptEditor"
        ],
        "propertyNames": "[\"script\", \"html\", \"css\"]",
        "loadHook": "editScript",
        "saveHook": "saveScript"
      }
    },
    "inputDataTypes": {
      "json": {
        "title": "JSON"
      },
      "string": {
        "title": "String"
      }
    },
    "inputElementTypes": {
      "text": {
        "title": "text",
        "tag": "input"
      },
      "textarea": {
        "title": "Text Area",
        "tag": "textarea"
      }
    },
    "themes": {
      "professional": {
        "title": "Professional",
        "fileName": "professional",
        "css": "/* Professional Theme */ @import url('https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;500;600&family=Inter:wght@300;400;500;600&display=swap');  body {     font-family: 'Inter', 'Roboto Mono', sans-serif;     background-color: #1a1a2e;     color: #e6e6fa;     line-height: 1.6; }  .sidebar {     background-color: rgba(34, 34, 54, 0.95);     border: 1px solid #4b5e87;     box-shadow: 0 4px 12px rgba(75, 94, 135, 0.2); }  .object-item {     background-color: rgba(34, 34, 54, 0.8);     border-left: 2px solid #8a4af0;     text-transform: uppercase;     letter-spacing: 0.5px;     transition: all 0.3s ease; }  .object-item:hover {     background-color: rgba(138, 74, 240, 0.15);     transform: translateX(3px); }  .object-item.selected {     background-color: rgba(138, 74, 240, 0.25);     border-left: 3px solid #8a4af0;     box-shadow: 0 0 6px rgba(138, 74, 240, 0.4); }  .editor {     background-color: rgba(34, 34, 54, 0.95);     border: 1px solid #4b5e87;     box-shadow: 0 4px 12px rgba(75, 94, 135, 0.15); }  #three-js-container {     border: 1px solid rgba(75, 94, 135, 0.6); }  .preview-canvas-container {     border: 1px solid #8a4af0;     box-shadow: 0 4px 12px rgba(138, 74, 240, 0.1); }  .preview {     background-color: rgba(34, 34, 54, 0.9);     border: 1px solid #4b5e87;     box-shadow: 0 4px 12px rgba(75, 94, 135, 0.15); }  #preview-canvas {     background-color: transparent;     border: 1px solid rgba(75, 94, 135, 0.5); }  .camera-controls {     background: rgba(26, 26, 46, 0.9);     border: 1px solid #4b5e87; }  .camera-controls button {     background-color: rgba(75, 94, 135, 0.3);     border: 1px solid #4b5e87;     color: #e6e6fa;     transition: all 0.3s ease; }  .camera-controls button:hover {     background-color: rgba(75, 94, 135, 0.5);     box-shadow: 0 2px 8px rgba(75, 94, 135, 0.3); }  .camera-controls .color-picker {     border: 1px solid #4b5e87; }  .camera-controls .size-slider {     background: #2a2a42;     border: 1px solid #4b5e87; }  label {     font-weight: 500;     text-transform: uppercase;     letter-spacing: 0.5px;     color: #8a4af0; }  input, textarea, select {     border: 1px solid #4b5e87;     background-color: rgba(34, 34, 54, 0.8);     color: #e6e6fa;     box-shadow: 0 2px 6px rgba(75, 94, 135, 0.1);     transition: all 0.3s ease; }  input:focus, textarea:focus, select:focus {     outline: none;     border-color: #8a4af0;     box-shadow: 0 0 8px rgba(138, 74, 240, 0.3); }  button {     background-color: rgba(75, 94, 135, 0.3);     border: 1px solid #4b5e87;     color: #e6e6fa;     text-transform: uppercase;     letter-spacing: 0.5px;     transition: all 0.3s ease; }  button:hover {     background-color: rgba(75, 94, 135, 0.5);     box-shadow: 0 2px 8px rgba(75, 94, 135, 0.3);     transform: translateY(-1px); }  button.primary {     background-color: rgba(138, 74, 240, 0.3);     border: 1px solid #8a4af0;     color: #e6e6fa; }  button.primary:hover {     background-color: rgba(138, 74, 240, 0.5);     box-shadow: 0 2px 8px rgba(138, 74, 240, 0.3); }  button.danger {     background-color: rgba(240, 74, 74, 0.3);     border: 1px solid #f04a4a;     color: #e6e6fa; }  button.danger:hover {     background-color: rgba(240, 74, 74, 0.5);     box-shadow: 0 2px 8px rgba(240, 74, 74, 0.3); }  button.active {     border: 1px solid #00cc99;     box-shadow: 0 0 8px rgba(0, 204, 153, 0.4);     color: #00cc99; }  .modal {     background-color: rgba(26, 26, 46, 0.9);     backdrop-filter: blur(3px); }  .modal-content {     background-color: rgba(34, 34, 54, 0.95);     border: 1px solid #4b5e87;     box-shadow: 0 8px 24px rgba(75, 94, 135, 0.2); }  .property-list {     border: 1px solid #4b5e87;     background-color: rgba(34, 34, 54, 0.8); }  .tab-navigation {     border-bottom: 1px solid #4b5e87; }  .tab {     text-transform: uppercase;     letter-spacing: 0.5px;     transition: all 0.3s ease; }  .tab:hover {     background-color: rgba(75, 94, 135, 0.2); }  .tab.active {     border-bottom: 2px solid #8a4af0;     box-shadow: 0 4px 8px -4px rgba(138, 74, 240, 0.4);     font-weight: 600; }  .instructions {     background-color: rgba(34, 34, 54, 0.8);     border-left: 3px solid #8a4af0;     box-shadow: 0 2px 6px rgba(138, 74, 240, 0.1); }  #grid-display {     background-color: rgba(26, 26, 46, 0.9);     border: 1px solid #4b5e87;     box-shadow: 0 4px 12px rgba(75, 94, 135, 0.15); }  .success-message {     color: #00cc99;     text-transform: uppercase;     letter-spacing: 0.5px;     animation: fadeOut 2s forwards;     animation-delay: 1s; }  .warning {     background-color: rgba(240, 74, 74, 0.15);     border-left: 3px solid #f04a4a;     box-shadow: 0 2px 6px rgba(240, 74, 74, 0.1); }  .main-content-container {     background-color: #1f1f38;     color: #e6e6fa; }  .content-sidebar {     background: linear-gradient(180deg, rgba(34, 34, 54, 0.95), rgba(26, 26, 46, 0.95));     border-right: 1px solid #4b5e87;     box-shadow: 0 4px 12px rgba(75, 94, 135, 0.15); }  #graphics-rightbar {     background: linear-gradient(180deg, rgba(34, 34, 54, 0.95), rgba(26, 26, 46, 0.95));     border-left: 1px solid #4b5e87;     box-shadow: 0 4px 12px rgba(75, 94, 135, 0.15); }  .grid-background {     background: #1a1a2e;     background-image: radial-gradient(rgba(75, 94, 135, 0.15) 1px, transparent 1px);     background-size: 30px 30px; }  .toolbar {     background: linear-gradient(90deg, rgba(34, 34, 54, 0.95), rgba(26, 26, 46, 0.95));     border-bottom: 1px solid #4b5e87; }  .btn {     border: 1px solid #4b5e87;     background-color: rgba(75, 94, 135, 0.3);     color: #e6e6fa;     text-transform: uppercase;     transition: all 0.3s ease; }  .btn:hover {     background-color: rgba(75, 94, 135, 0.5);     box-shadow: 0 2px 8px rgba(75, 94, 135, 0.3);     transform: translateY(-1px); }  .btn-primary {     background-color: rgba(138, 74, 240, 0.3);     border: 1px solid #8a4af0;     color: #e6e6fa; }  .btn-primary:hover {     background-color: rgba(138, 74, 240, 0.5);     box-shadow: 0 2px 8px rgba(138, 74, 240, 0.3); }  .btn-danger {     background-color: rgba(240, 74, 74, 0.3);     border: 1px solid #f04a4a;     color: #e6e6fa; }  .btn-danger:hover {     background-color: rgba(240, 74, 74, 0.5);     box-shadow: 0 2px 8px rgba(240, 74, 74, 0.3); }  .btn-secondary {     background-color: rgba(75, 94, 135, 0.25);     border: 1px solid #4b5e87; }  .btn-secondary:hover {     background-color: rgba(75, 94, 135, 0.4);     box-shadow: 0 2px 8px rgba(75, 94, 135, 0.3); }  .btn-special {     background-color: rgba(0, 204, 153, 0.3);     border: 1px solid #00cc99;     color: #e6e6fa; }  .btn-special:hover {     background-color: rgba(0, 204, 153, 0.5);     box-shadow: 0 2px 8px rgba(0, 204, 153, 0.3); }  #shape-list {     border-bottom: 1px solid rgba(75, 94, 135, 0.3); }  .shape-item {     background-color: rgba(34, 34, 54, 0.8);     border: 1px solid #4b5e87;     transition: all 0.3s ease; }  .shape-item:hover {     background-color: rgba(75, 94, 135, 0.2);     transform: translateX(3px); }  .shape-item.active {     background-color: rgba(0, 204, 153, 0.15);     border-color: #00cc99;     color: #00cc99;     box-shadow: 0 0 8px rgba(0, 204, 153, 0.3); }  #inspector {     background: rgba(34, 34, 54, 0.95);     border-top: 1px solid #4b5e87; }  .form-row label {     color: #8a4af0; }  .form-row input, .form-row select {     border: 1px solid #4b5e87;     background-color: rgba(34, 34, 54, 0.8);     color: #e6e6fa;     box-shadow: 0 2px 6px rgba(75, 94, 135, 0.1); }  .scene-info {     background: rgba(26, 26, 46, 0.9);     color: #e6e6fa;     box-shadow: 0 4px 12px rgba(75, 94, 135, 0.15);     border: 1px solid #4b5e87; }  .button-danger {     background-color: rgba(240, 74, 74, 0.3);     border: 1px solid #f04a4a;     color: #e6e6fa; }  .button-danger:hover {     background-color: rgba(240, 74, 74, 0.5);     box-shadow: 0 2px 8px rgba(240, 74, 74, 0.3); }  h2, h3 {     color: #8a4af0;     text-transform: uppercase;     letter-spacing: 1px;     margin-bottom: 12px;     padding-bottom: 4px;     border-bottom: 1px solid #4b5e87;     text-shadow: 0 0 4px rgba(138, 74, 240, 0.3); }  ::-webkit-scrollbar {     width: 6px;     height: 6px; }  ::-webkit-scrollbar-track {     background: rgba(34, 34, 54, 0.8); }  ::-webkit-scrollbar-thumb {     background: #4b5e87;     border-radius: 3px; }  ::-webkit-scrollbar-thumb:hover {     background: #8a4af0; }"
      },
      "claude2": {
        "title": "Claude 2",
        "fileName": "claude2",
        "css": "/* Professional Theme - Clean UI */ @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=IBM+Plex+Mono:wght@400;500&display=swap');  :root {   --bg-primary: #16192e;   --bg-secondary: #1d2035;   --bg-tertiary: #252a43;   --accent-primary: #4d7cff;   --accent-muted: rgba(77, 124, 255, 0.15);   --text-primary: #e9edf5;   --text-secondary: #a9b1c3;   --border-color: rgba(108, 123, 163, 0.25);   --shadow-sm: 0 2px 6px rgba(0, 0, 0, 0.2);   --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.25); }  body {   font-family: 'Inter', sans-serif;   background-color: var(--bg-primary);   color: var(--text-primary);   line-height: 1.6; }  /* Sidebar styling */ .sidebar {   background-color: var(--bg-secondary);   border-right: 1px solid var(--border-color);   box-shadow: var(--shadow-sm); }  .object-item {   background-color: transparent;   border-left: 2px solid transparent;   text-transform: none;   letter-spacing: 0.2px;   color: var(--text-secondary);   font-weight: 400;   transition: all 0.2s ease;   padding: 10px 14px;   margin-bottom: 2px; }  .object-item:hover {   background-color: var(--bg-tertiary);   border-left: 2px solid var(--accent-primary);   color: var(--text-primary); }  .object-item.selected {   background-color: var(--accent-muted);   border-left: 2px solid var(--accent-primary);   color: var(--text-primary);   font-weight: 500; }  /* Editor area */ .editor {   background-color: var(--bg-secondary);   border: 1px solid var(--border-color);   box-shadow: var(--shadow-sm);   border-radius: 4px; }  #three-js-container {   border: 1px solid var(--border-color);   border-radius: 4px;   background: var(--bg-primary); }  .preview-canvas-container {   border: 1px solid var(--border-color);   box-shadow: var(--shadow-sm);   border-radius: 4px; }  .preview {   background-color: var(--bg-secondary);   border: 1px solid var(--border-color);   box-shadow: var(--shadow-sm);   border-radius: 4px; }  #preview-canvas {   background-color: transparent;   border: 1px solid var(--border-color);   border-radius: 2px; }  /* Camera controls */ .camera-controls {   background: var(--bg-tertiary);   border: 1px solid var(--border-color);   border-radius: 4px;   padding: 12px; }  .camera-controls button {   background-color: var(--bg-secondary);   border: 1px solid var(--border-color);   color: var(--text-primary);   border-radius: 3px;   padding: 8px 12px;   transition: all 0.2s ease; }  .camera-controls button:hover {   background-color: var(--accent-muted);   border-color: var(--accent-primary); }  .camera-controls .color-picker {   border: 1px solid var(--border-color);   border-radius: 3px; }  .camera-controls .size-slider {   background: var(--bg-secondary);   border: 1px solid var(--border-color);   border-radius: 3px;   height: 5px; }  .camera-controls .size-slider::-webkit-slider-thumb {   background: var(--accent-primary);   border-radius: 50%;   cursor: pointer; }  /* Form elements */ label {   font-weight: 500;   color: var(--text-primary);   margin-bottom: 6px;   display: block;   font-size: 0.875rem; }  input, textarea, select {   border: 1px solid var(--border-color);   background-color: var(--bg-secondary);   color: var(--text-primary);   border-radius: 3px;   width: calc(100% - 24px);  padding: 8px 12px;   transition: all 0.2s ease;   font-family: 'IBM Plex Mono', monospace; }  input:focus, textarea:focus, select:focus {   outline: none;   border-color: var(--accent-primary);   box-shadow: 0 0 0 2px var(--accent-muted); }  /* Button styles */ button {   background-color: var(--bg-tertiary);   border: 1px solid var(--border-color);   color: var(--text-primary);   font-weight: 500;   padding: 8px 14px;   border-radius: 3px;   transition: all 0.2s ease; }  button:hover {   background-color: var(--accent-muted);   border-color: var(--accent-primary); }  button.primary {   background-color: var(--accent-primary);   border: 1px solid var(--accent-primary);   color: white; }  button.primary:hover {   background-color: #3a6ae6;   border-color: #3a6ae6;   box-shadow: var(--shadow-sm); }  button.danger {   background-color: rgba(235, 68, 68, 0.15);   border: 1px solid #eb4444;   color: #eb4444; }  button.danger:hover {   background-color: rgba(235, 68, 68, 0.25);   box-shadow: var(--shadow-sm); }  button.active {   background-color: rgba(52, 199, 154, 0.15);   border: 1px solid #34c79a;   color: #34c79a; }  /* Modal styling */ .modal {   background-color: rgba(22, 25, 46, 0.8); }  .modal-content {   background-color: var(--bg-secondary);   border: 1px solid var(--border-color);   box-shadow: var(--shadow-md);   border-radius: 4px; }  .property-list {   border: 1px solid var(--border-color);   background-color: var(--bg-tertiary);   border-radius: 4px; }  /* Tab navigation */ .tab-navigation {   border-bottom: 1px solid var(--border-color);   display: flex;   padding: 0 4px; }  .tab {   padding: 10px 16px;   color: var(--text-secondary);   transition: all 0.2s ease; }  .tab:hover {   background-color: var(--bg-tertiary);   color: var(--text-primary); }  .tab.active {   color: var(--accent-primary);   font-weight: 500;   border-bottom: 2px solid var(--accent-primary); }  /* Info and warning boxes */ .instructions {   background-color: var(--bg-tertiary);   border-left: 3px solid var(--accent-primary);   border-radius: 0 4px 4px 0;   padding: 12px 16px;   margin: 16px 0; }  #grid-display {   background-color: var(--bg-secondary);   border: 1px solid var(--border-color);   box-shadow: var(--shadow-sm);   border-radius: 4px; }  .success-message {   color: #34c79a;   font-weight: 500;   animation: fadeOut 2s forwards;   animation-delay: 1.5s;   padding: 8px 12px; }  @keyframes fadeOut {   from { opacity: 1; }   to { opacity: 0; } }  .warning {   background-color: rgba(235, 68, 68, 0.1);   border-left: 3px solid #eb4444;   border-radius: 0 4px 4px 0;   padding: 12px 16px;   margin: 16px 0; }  /* Main containers */ .main-content-container {   background-color: var(--bg-primary);   color: var(--text-primary); }  .content-sidebar {   background: var(--bg-secondary);   border-right: 1px solid var(--border-color);   box-shadow: var(--shadow-sm); }  #graphics-rightbar {   background: var(--bg-secondary);   border-left: 1px solid var(--border-color);   box-shadow: var(--shadow-sm); }  /* Subtle grid background */ .grid-background {   background: var(--bg-primary);   background-image:      linear-gradient(rgba(108, 123, 163, 0.05) 1px, transparent 1px),     linear-gradient(90deg, rgba(108, 123, 163, 0.05) 1px, transparent 1px);   background-size: 20px 20px; }  /* Toolbar */ .toolbar {   background: var(--bg-secondary);   border-bottom: 1px solid var(--border-color);   box-shadow: var(--shadow-sm);   padding: 8px 16px;   display: flex;   align-items: center;   gap: 8px; }  /* Button variations */ .btn {   border: 1px solid var(--border-color);   background-color: var(--bg-tertiary);   color: var(--text-primary);   font-weight: 500;   padding: 8px 14px;   border-radius: 3px;   transition: all 0.2s ease;   font-size: 0.875rem; }  .btn:hover {   background-color: var(--accent-muted);   border-color: var(--accent-primary); }  .btn-primary {   background-color: var(--accent-primary);   border: 1px solid var(--accent-primary);   color: white; }  .btn-primary:hover {   background-color: #3a6ae6;   border-color: #3a6ae6; }  .btn-danger {   background-color: rgba(235, 68, 68, 0.15);   border: 1px solid #eb4444;   color: #eb4444; }  .btn-danger:hover {   background-color: rgba(235, 68, 68, 0.25); }  .btn-secondary {   background-color: var(--bg-tertiary);   border: 1px solid var(--border-color); }  .btn-secondary:hover {   background-color: var(--accent-muted);   border-color: var(--accent-primary); }  .btn-special {   background-color: rgba(52, 199, 154, 0.15);   border: 1px solid #34c79a;   color: #34c79a; }  .btn-special:hover {   background-color: rgba(52, 199, 154, 0.25); }  /* Shape list */ #shape-list {   border-bottom: 1px solid var(--border-color);   padding-bottom: 16px;   margin-bottom: 16px; }  .shape-item {   background-color: var(--bg-tertiary);   border: 1px solid var(--border-color);   border-radius: 3px;   padding: 10px 14px;   margin-bottom: 6px;   transition: all 0.2s ease;   display: flex;   align-items: center;   gap: 8px; }  .shape-item:hover {   background-color: var(--accent-muted);   border-color: var(--accent-primary); }  .shape-item.active {   background-color: rgba(52, 199, 154, 0.1);   border-color: #34c79a;   color: #34c79a;   font-weight: 500; }  /* Inspector panel */ #inspector {   background: var(--bg-secondary);   border-top: 1px solid var(--border-color);   padding: 16px; }  .form-row {   margin-bottom: 12px; }  .form-row label {   color: var(--text-primary);   margin-bottom: 6px; }  .form-row input, .form-row select {   width: 100%;   border: 1px solid var(--border-color);   background-color: var(--bg-secondary);   color: var(--text-primary);   padding: 8px 12px;   border-radius: 3px; }  /* Scene info */ .scene-info {   background: var(--bg-tertiary);   color: var(--text-primary);   border: 1px solid var(--border-color);   border-radius: 4px;   padding: 12px 16px;   margin-bottom: 16px; }  .button-danger {   background-color: rgba(235, 68, 68, 0.15);   border: 1px solid #eb4444;   color: #eb4444;   padding: 8px 14px;   border-radius: 3px;   font-weight: 500;   transition: all 0.2s ease; }  .button-danger:hover {   background-color: rgba(235, 68, 68, 0.25); }  /* Typography */ h2, h3 {   color: var(--text-primary);   margin-bottom: 16px;   padding-bottom: 8px;   border-bottom: 1px solid var(--border-color);   font-weight: 600; }  /* Scrollbars */ ::-webkit-scrollbar {   width: 6px;   height: 6px; }  ::-webkit-scrollbar-track {   background: var(--bg-tertiary);   border-radius: 3px; }  ::-webkit-scrollbar-thumb {   background: rgba(108, 123, 163, 0.5);   border-radius: 3px; }  ::-webkit-scrollbar-thumb:hover {   background: rgba(108, 123, 163, 0.7); }"
      },
      "professional3": {
        "title": "Claude",
        "fileName": "professional3",
        "css": "/* Eclipse Theme - A premium dark UI experience */ @import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600&family=JetBrains+Mono:wght@400;500;600&display=swap');  :root {   --bg-primary: #0f111a;   --bg-secondary: #141725;   --bg-tertiary: #1a1d2d;   --accent-primary: #7c4dff;   --accent-secondary: #00bcd4;   --accent-tertiary: #ff4081;   --text-primary: #eceff1;   --text-secondary: #b0bec5;   --border-light: rgba(99, 114, 166, 0.25);   --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.3);   --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.4);   --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.5);   --gradient-bg: linear-gradient(135deg, rgba(20, 23, 37, 0.95), rgba(15, 17, 26, 0.95));   --gradient-accent: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); }  body {   font-family: 'Space Grotesk', sans-serif;   background-color: var(--bg-primary);   color: var(--text-primary);   line-height: 1.6;   transition: background-color 0.3s ease;   background-image:      radial-gradient(circle at 15% 15%, rgba(124, 77, 255, 0.08) 0%, transparent 25%),     radial-gradient(circle at 85% 85%, rgba(0, 188, 212, 0.08) 0%, transparent 25%); }  /* Modern sidebar with glassmorphism effect */ .sidebar {   background: var(--gradient-bg);   border-right: 1px solid var(--border-light);   box-shadow: var(--shadow-md);   backdrop-filter: blur(10px);   -webkit-backdrop-filter: blur(10px); }  .object-item {   background-color: transparent;   border-left: 2px solid transparent;   text-transform: uppercase;   letter-spacing: 0.5px;   color: var(--text-secondary);   font-weight: 500;   transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);   margin-bottom: 4px;   border-radius: 0 4px 4px 0; }  .object-item:hover {   background-color: rgba(124, 77, 255, 0.1);   border-left: 2px solid var(--accent-primary);   color: var(--text-primary);   transform: translateX(2px); }  .object-item.selected {   background: linear-gradient(90deg, rgba(124, 77, 255, 0.15), rgba(124, 77, 255, 0.05));   border-left: 3px solid var(--accent-primary);   color: var(--accent-primary);   box-shadow: 0 0 12px rgba(124, 77, 255, 0.2);   font-weight: 600; }  /* Editor area with polished look */ .editor {   background-color: var(--bg-secondary);   border: 1px solid var(--border-light);   box-shadow: var(--shadow-md);   border-radius: 6px;   overflow: hidden; }  #three-js-container {   border: 1px solid var(--border-light);   border-radius: 6px;   box-shadow: inset 0 0 16px rgba(0, 0, 0, 0.2);   background: rgba(15, 17, 26, 0.5); }  .preview-canvas-container {   border: 1px solid var(--accent-primary);   box-shadow: 0 0 16px rgba(124, 77, 255, 0.15);   border-radius: 6px;   overflow: hidden; }  .preview {   background-color: var(--bg-secondary);   border: 1px solid var(--border-light);   box-shadow: var(--shadow-md);   border-radius: 6px; }  #preview-canvas {   background-color: transparent;   border: 1px solid var(--border-light);   border-radius: 4px; }  /* Enhanced camera controls with dynamic hover effects */ .camera-controls {   background: var(--bg-tertiary);   border: 1px solid var(--border-light);   border-radius: 6px;   padding: 12px;   box-shadow: var(--shadow-sm); }  .camera-controls button {   background-color: rgba(99, 114, 166, 0.15);   border: 1px solid var(--border-light);   color: var(--text-primary);   border-radius: 4px;   padding: 8px 12px;   font-weight: 500;   transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1); }  .camera-controls button:hover {   background-color: rgba(124, 77, 255, 0.15);   border-color: var(--accent-primary);   box-shadow: 0 0 12px rgba(124, 77, 255, 0.2);   transform: translateY(-2px) scale(1.02); }  .camera-controls button:active {   transform: translateY(1px); }  .camera-controls .color-picker {   border: 1px solid var(--border-light);   border-radius: 4px;   overflow: hidden;   box-shadow: var(--shadow-sm); }  .camera-controls .size-slider {   background: var(--bg-secondary);   border: 1px solid var(--border-light);   border-radius: 4px;   height: 6px;   box-shadow: inset 0 0 4px rgba(0, 0, 0, 0.2); }  .camera-controls .size-slider::-webkit-slider-thumb {   background: var(--accent-primary);   box-shadow: 0 0 8px rgba(124, 77, 255, 0.4);   border-radius: 50%;   cursor: pointer;   transition: all 0.2s ease; }  .camera-controls .size-slider::-webkit-slider-thumb:hover {   transform: scale(1.2); }  /* Form elements with attractive focus states */ label {   font-weight: 500;   text-transform: uppercase;   letter-spacing: 0.5px;   color: var(--accent-primary);   margin-bottom: 6px;   display: block;   font-size: 0.85rem; }  input, textarea, select {   border: 1px solid var(--border-light);   background-color: rgba(15, 17, 26, 0.6);   color: var(--text-primary);   border-radius: 4px;   padding: 10px 12px;   box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);   transition: all 0.3s ease;   font-family: 'JetBrains Mono', monospace; }  input:focus, textarea:focus, select:focus {   outline: none;   border-color: var(--accent-primary);   box-shadow: 0 0 0 3px rgba(124, 77, 255, 0.2), inset 0 2px 4px rgba(0, 0, 0, 0.1);   background-color: rgba(20, 23, 37, 0.8); }  /* Modern button styles with micro-interactions */ button {   background-color: var(--bg-tertiary);   border: 1px solid var(--border-light);   color: var(--text-primary);   text-transform: uppercase;   letter-spacing: 0.5px;   font-weight: 500;   padding: 10px 16px;   border-radius: 4px;   transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);   position: relative;   overflow: hidden; }  button:hover {   background-color: rgba(99, 114, 166, 0.2);   border-color: var(--border-light);   box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);   transform: translateY(-2px); }  button:active {   transform: translateY(1px); }  button::after {   content: '';   position: absolute;   top: 50%;   left: 50%;   width: 100%;   height: 100%;   background: radial-gradient(circle, rgba(255, 255, 255, 0.2) 0%, transparent 50%);   transform: scale(0);   opacity: 0;   transition: transform 0.5s, opacity 0.3s;   pointer-events: none; }  button:active::after {   transform: scale(2);   opacity: 1;   transition: 0s; }  button.primary {   background: linear-gradient(135deg, rgba(124, 77, 255, 0.2), rgba(0, 188, 212, 0.2));   border: 1px solid var(--accent-primary);   color: var(--text-primary);   position: relative;   z-index: 1; }  button.primary:hover {   background: linear-gradient(135deg, rgba(124, 77, 255, 0.3), rgba(0, 188, 212, 0.3));   box-shadow: 0 4px 16px rgba(124, 77, 255, 0.3); }  button.primary::before {   content: '';   position: absolute;   top: 0;   left: 0;   right: 0;   bottom: 0;   background: var(--gradient-accent);   opacity: 0;   z-index: -1;   transition: opacity 0.3s ease;   border-radius: 3px; }  button.primary:hover::before {   opacity: 0.1; }  button.danger {   background-color: rgba(244, 67, 54, 0.15);   border: 1px solid #f44336;   color: #f44336; }  button.danger:hover {   background-color: rgba(244, 67, 54, 0.25);   box-shadow: 0 4px 16px rgba(244, 67, 54, 0.2); }  button.active {   border: 1px solid var(--accent-secondary);   box-shadow: 0 0 12px rgba(0, 188, 212, 0.3);   color: var(--accent-secondary);   background-color: rgba(0, 188, 212, 0.15); }  /* Modal with glassmorphism effect */ .modal {   background-color: rgba(15, 17, 26, 0.7);   backdrop-filter: blur(8px);   -webkit-backdrop-filter: blur(8px); }  .modal-content {   background-color: var(--bg-secondary);   border: 1px solid var(--border-light);   box-shadow: var(--shadow-lg);   border-radius: 8px;   overflow: hidden;   animation: modalAppear 0.3s ease; }  @keyframes modalAppear {   from {     opacity: 0;     transform: scale(0.95) translateY(-10px);   }   to {     opacity: 1;     transform: scale(1) translateY(0);   } }  .property-list {   border: 1px solid var(--border-light);   background-color: var(--bg-tertiary);   border-radius: 6px;   overflow: hidden; }  /* Tab navigation with smooth transitions */ .tab-navigation {   border-bottom: 1px solid var(--border-light);   display: flex;   gap: 4px;   padding: 0 6px; }  .tab {   text-transform: uppercase;   letter-spacing: 0.5px;   font-weight: 500;   padding: 10px 16px;   color: var(--text-secondary);   position: relative;   transition: all 0.3s ease;   border-radius: 4px 4px 0 0; }  .tab:hover {   background-color: rgba(99, 114, 166, 0.1);   color: var(--text-primary); }  .tab.active {   color: var(--accent-primary);   font-weight: 600;   background-color: rgba(124, 77, 255, 0.05); }  .tab.active::after {   content: '';   position: absolute;   bottom: -1px;   left: 0;   right: 0;   height: 2px;   background: var(--gradient-accent);   box-shadow: 0 0 8px rgba(124, 77, 255, 0.5); }  /* Stylized instructions and warnings */ .instructions {   background-color: rgba(124, 77, 255, 0.05);   border-left: 3px solid var(--accent-primary);   border-radius: 0 4px 4px 0;   padding: 12px 16px;   margin: 16px 0;   box-shadow: var(--shadow-sm);   position: relative; }  .instructions::before {   content: 'i';   position: absolute;   left: -12px;   top: 10px;   width: 20px;   height: 20px;   background: var(--accent-primary);   border-radius: 50%;   display: flex;   align-items: center;   justify-content: center;   font-weight: bold;   font-style: italic;   color: white;   font-size: 14px; }  #grid-display {   background-color: var(--bg-secondary);   border: 1px solid var(--border-light);   box-shadow: var(--shadow-md);   border-radius: 6px;   overflow: hidden; }  .success-message {   color: #4caf50;   text-transform: uppercase;   letter-spacing: 0.5px;   font-weight: 500;   animation: fadeOut 2s forwards;   animation-delay: 1.5s;   padding: 8px 12px;   background-color: rgba(76, 175, 80, 0.1);   border-radius: 4px;   display: inline-block; }  @keyframes fadeOut {   from { opacity: 1; }   to { opacity: 0; } }  .warning {   background-color: rgba(244, 67, 54, 0.1);   border-left: 3px solid #f44336;   border-radius: 0 4px 4px 0;   padding: 12px 16px;   margin: 16px 0;   box-shadow: var(--shadow-sm);   position: relative; }  .warning::before {   content: '!';   position: absolute;   left: -12px;   top: 10px;   width: 20px;   height: 20px;   background: #f44336;   border-radius: 50%;   display: flex;   align-items: center;   justify-content: center;   font-weight: bold;   color: white;   font-size: 14px; }  /* Content containers with subtle gradients */ .main-content-container {   background-color: var(--bg-primary);   color: var(--text-primary); }  .content-sidebar {   background: var(--gradient-bg);   border-right: 1px solid var(--border-light);   box-shadow: var(--shadow-md);   backdrop-filter: blur(10px);   -webkit-backdrop-filter: blur(10px); }  #graphics-rightbar {   background: var(--gradient-bg);   border-left: 1px solid var(--border-light);   box-shadow: var(--shadow-md);   backdrop-filter: blur(10px);   -webkit-backdrop-filter: blur(10px); }  /* Subtle grid background */ .grid-background {   background: var(--bg-primary);   background-image:      linear-gradient(rgba(99, 114, 166, 0.05) 1px, transparent 1px),     linear-gradient(90deg, rgba(99, 114, 166, 0.05) 1px, transparent 1px);   background-size: 20px 20px; }  /* Toolbar with subtle glassmorphism */ .toolbar {   background: var(--gradient-bg);   border-bottom: 1px solid var(--border-light);   box-shadow: var(--shadow-sm);   backdrop-filter: blur(10px);   -webkit-backdrop-filter: blur(10px);   padding: 8px 16px;   display: flex;   align-items: center;   gap: 8px; }  /* Button variations with consistent styling */ .btn {   border: 1px solid var(--border-light);   background-color: rgba(99, 114, 166, 0.1);   color: var(--text-primary);   text-transform: uppercase;   letter-spacing: 0.5px;   font-weight: 500;   padding: 8px 14px;   border-radius: 4px;   transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);   position: relative;   overflow: hidden;   font-size: 0.85rem; }  .btn:hover {   background-color: rgba(99, 114, 166, 0.2);   box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);   transform: translateY(-2px); }  .btn:active {   transform: translateY(1px); }  .btn-primary {   background: linear-gradient(135deg, rgba(124, 77, 255, 0.2), rgba(0, 188, 212, 0.2));   border: 1px solid var(--accent-primary);   color: var(--text-primary);   position: relative;   z-index: 1; }  .btn-primary:hover {   background: linear-gradient(135deg, rgba(124, 77, 255, 0.3), rgba(0, 188, 212, 0.3));   box-shadow: 0 4px 16px rgba(124, 77, 255, 0.2); }  .btn-primary::before {   content: '';   position: absolute;   top: 0;   left: 0;   right: 0;   bottom: 0;   background: var(--gradient-accent);   opacity: 0;   z-index: -1;   transition: opacity 0.3s ease;   border-radius: 3px; }  .btn-primary:hover::before {   opacity: 0.1; }  .btn-danger {   background-color: rgba(244, 67, 54, 0.15);   border: 1px solid #f44336;   color: #f44336; }  .btn-danger:hover {   background-color: rgba(244, 67, 54, 0.25);   box-shadow: 0 4px 16px rgba(244, 67, 54, 0.2); }  .btn-secondary {   background-color: rgba(99, 114, 166, 0.1);   border: 1px solid var(--border-light); }  .btn-secondary:hover {   background-color: rgba(99, 114, 166, 0.2);   box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15); }  .btn-special {   background-color: rgba(0, 188, 212, 0.15);   border: 1px solid var(--accent-secondary);   color: var(--accent-secondary); }  .btn-special:hover {   background-color: rgba(0, 188, 212, 0.25);   box-shadow: 0 4px 16px rgba(0, 188, 212, 0.2); }  /* Shape list with improved visual hierarchy */ #shape-list {   border-bottom: 1px solid var(--border-light);   padding-bottom: 16px;   margin-bottom: 16px; }  .shape-item {   background-color: var(--bg-tertiary);   border: 1px solid var(--border-light);   border-radius: 4px;   padding: 10px 14px;   margin-bottom: 6px;   transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);   display: flex;   align-items: center;   gap: 8px; }  .shape-item:hover {   background-color: rgba(99, 114, 166, 0.15);   transform: translateX(3px);   border-color: var(--border-light); }  .shape-item.active {   background-color: rgba(0, 188, 212, 0.1);   border-color: var(--accent-secondary);   color: var(--accent-secondary);   box-shadow: 0 0 12px rgba(0, 188, 212, 0.15);   font-weight: 500; }  /* Inspector panel with clean design */ #inspector {   background: var(--bg-secondary);   border-top: 1px solid var(--border-light);   padding: 16px; }  .form-row {   margin-bottom: 12px; }  .form-row label {   color: var(--accent-primary);   margin-bottom: 6px; }  .form-row input, .form-row select {   width: 100%;   border: 1px solid var(--border-light);   background-color: rgba(15, 17, 26, 0.6);   color: var(--text-primary);   padding: 10px 12px;   border-radius: 4px; }  /* Scene info with modern styling */ .scene-info {   background: var(--bg-tertiary);   color: var(--text-primary);   border: 1px solid var(--border-light);   border-radius: 6px;   padding: 12px 16px;   margin-bottom: 16px;   box-shadow: var(--shadow-sm); }  .button-danger {   background-color: rgba(244, 67, 54, 0.15);   border: 1px solid #f44336;   color: #f44336;   padding: 10px 16px;   border-radius: 4px;   font-weight: 500;   transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1); }  .button-danger:hover {   background-color: rgba(244, 67, 54, 0.25);   box-shadow: 0 4px 16px rgba(244, 67, 54, 0.2);   transform: translateY(-2px); }  /* Typography improvements */ h2, h3 {   color: var(--accent-primary);   text-transform: uppercase;   letter-spacing: 1px;   margin-bottom: 16px;   padding-bottom: 8px;   border-bottom: 1px solid var(--border-light);   font-weight: 600;   text-shadow: 0 0 20px rgba(124, 77, 255, 0.3);   position: relative; }  h2::after, h3::after {   content: '';   position: absolute;   bottom: -1px;   left: 0;   width: 50px;   height: 2px;   background: var(--gradient-accent);   box-shadow: 0 0 8px rgba(124, 77, 255, 0.5); }  /* Sleek scrollbars */ ::-webkit-scrollbar {   width: 6px;   height: 6px; }  ::-webkit-scrollbar-track {   background: var(--bg-tertiary);   border-radius: 3px; }  ::-webkit-scrollbar-thumb {   background: rgba(124, 77, 255, 0.3);   border-radius: 3px;   border: 1px solid var(--bg-tertiary); }  ::-webkit-scrollbar-thumb:hover {   background: var(--accent-primary); }  /* Animations and transitions */ @keyframes pulse {   0% { box-shadow: 0 0 0 0 rgba(124, 77, 255, 0.4); }   70% { box-shadow: 0 0 0 10px rgba(124, 77, 255, 0); }   100% { box-shadow: 0 0 0 0 rgba(124, 77, 255, 0); } }  .pulse-animation {   animation: pulse 2s infinite; }  /* Tooltips */ [data-tooltip] {   position: relative; }  [data-tooltip]::after {   content: attr(data-tooltip);   position: absolute;   bottom: 125%;   left: 50%;   transform: translateX(-50%);   padding: 6px 10px;   background: var(--bg-tertiary);   color: var(--text-primary);   border-radius: 4px;   font-size: 0.75rem;   white-space: nowrap;   opacity: 0;   visibility: hidden;   transition: all 0.3s ease;   z-index: 100;   box-shadow: var(--shadow-md);   border: 1px solid var(--border-light); }  [data-tooltip]:hover::after {   opacity: 1;   visibility: visible; }"
      },
      "medieval": {
        "title": "Medieval",
        "fileName": "medieval",
        "css": "/* Medieval Theme */ @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=IM+Fell+English&display=swap');  body {     font-family: 'Cinzel', 'IM Fell English', serif;     background-color: #2b1e12; /* Dark brown, earthy tone */     color: #d4b98a; /* Parchment-like beige */ }  .sidebar {     background-color: rgba(50, 40, 30, 0.8); /* Dark wood */     border: 1px solid #8a5c2e; /* Bronze */     box-shadow: 0 0 10px rgba(138, 92, 46, 0.5), inset 0 0 20px rgba(50, 40, 30, 0.3); }  .object-item {     background-color: rgba(60, 50, 40, 0.6); /* Aged wood */     border-left: 2px solid #b8860b; /* Gold accent */     text-transform: uppercase;     letter-spacing: 1px; }  .object-item:hover {     background-color: rgba(184, 134, 11, 0.2); /* Golden hover */     transform: translateX(5px); }  .object-item.selected {     background-color: rgba(184, 134, 11, 0.3);     border-left: 4px solid #b8860b;     box-shadow: 0 0 8px rgba(184, 134, 11, 0.5); }  .editor {     background-color: rgba(50, 40, 30, 0.7);     border: 1px solid #b8860b;     box-shadow: 0 0 15px rgba(184, 134, 11, 0.3); }  #three-js-container {     border: 1px solid rgba(138, 92, 46, 0.5); /* Bronze edge */ }  .preview-canvas-container {     border: 1px solid #b8860b;     box-shadow: 0 0 10px rgba(184, 134, 11, 0.3); }  .preview {     background-color: rgba(50, 40, 30, 0.7);     border: 1px solid #8a5c2e;     box-shadow: 0 0 15px rgba(138, 92, 46, 0.3); }  #preview-canvas {     background-color: transparent;     border: 1px solid rgba(138, 92, 46, 0.5); }  .camera-controls {     background: rgba(40, 30, 20, 0.7); /* Dark stone */     border: 1px solid #8a5c2e; }  .camera-controls button {     background-color: rgba(138, 92, 46, 0.2);     border: 1px solid #8a5c2e;     color: #d4b98a; }  .camera-controls .color-picker {     border: 1px solid #8a5c2e; }  .camera-controls .size-slider {     background: #3c2f1e; /* Darker wood */     border: 1px solid #8a5c2e; }  label {     font-weight: bold;     text-transform: uppercase;     letter-spacing: 1px;     color: #b8860b; /* Gold text */ }  input, textarea, select {     border: 1px solid #8a5c2e;     background-color: rgba(60, 50, 40, 0.6);     color: #d4b98a;     box-shadow: 0 0 5px rgba(138, 92, 46, 0.3); }  input:focus, textarea:focus, select:focus {     outline: none;     border-color: #b8860b;     box-shadow: 0 0 10px rgba(184, 134, 11, 0.5); }  button {     background-color: rgba(138, 92, 46, 0.2);     border: 1px solid #8a5c2e;     color: #d4b98a;     text-transform: uppercase;     letter-spacing: 1px; }  button:hover {     background-color: rgba(138, 92, 46, 0.3);     box-shadow: 0 0 10px rgba(138, 92, 46, 0.5), 0 0 20px rgba(138, 92, 46, 0.2);     transform: translateY(-2px); }  button.primary {     background-color: rgba(184, 134, 11, 0.2);     border: 1px solid #b8860b;     color: #b8860b; }  button.primary:hover {     background-color: rgba(184, 134, 11, 0.3);     box-shadow: 0 0 10px rgba(184, 134, 11, 0.5), 0 0 20px rgba(184, 134, 11, 0.2); }  button.danger {     background-color: rgba(139, 0, 0, 0.2); /* Crimson */     border: 1px solid #8b0000;     color: #ff4040; }  button.danger:hover {     background-color: rgba(139, 0, 0, 0.3);     box-shadow: 0 0 10px rgba(139, 0, 0, 0.5), 0 0 20px rgba(139, 0, 0, 0.2); }  button.active {     border: 1px solid #228b22; /* Forest green */     box-shadow: 0 0 10px rgba(34, 139, 34, 0.5);     color: #228b22; }  .modal {     background-color: rgba(40, 30, 20, 0.85); /* Stone texture */     backdrop-filter: blur(5px); }  .modal-content {     background-color: rgba(50, 40, 30, 0.9);     border: 1px solid #8a5c2e;     box-shadow: 0 0 30px rgba(138, 92, 46, 0.3), 0 0 60px rgba(138, 92, 46, 0.1); }  .property-list {     border: 1px solid #8a5c2e;     background-color: rgba(60, 50, 40, 0.6); }  .tab-navigation {     border-bottom: 1px solid #8a5c2e; }  .tab {     text-transform: uppercase;     letter-spacing: 1px; }  .tab:hover {     background-color: rgba(138, 92, 46, 0.1); }  .tab.active {     border-bottom: 3px solid #b8860b;     box-shadow: 0 5px 10px -5px rgba(184, 134, 11, 0.5);     font-weight: bold; }  .instructions {     background-color: rgba(60, 50, 40, 0.6);     border-left: 4px solid #b8860b;     box-shadow: 0 0 10px rgba(184, 134, 11, 0.2); }  #grid-display {     background-color: rgba(40, 30, 20, 0.7);     border: 1px solid #8a5c2e;     box-shadow: 0 0 10px rgba(138, 92, 46, 0.3); }  .success-message {     color: #228b22; /* Forest green */     text-transform: uppercase;     letter-spacing: 1px;     animation: fadeOut 2s forwards;     animation-delay: 1s; }  .warning {     background-color: rgba(139, 0, 0, 0.1);     border-left: 4px solid #8b0000;     box-shadow: 0 0 10px rgba(139, 0, 0, 0.2); }  .main-content-container {     background-color: #251a10; /* Darker brown */     color: #d4b98a; }  .content-sidebar {     background: linear-gradient(180deg, rgba(60, 50, 40, 0.8), rgba(40, 30, 20, 0.8));     border-right: 1px solid #8a5c2e;     box-shadow: 0 0 20px rgba(138, 92, 46, 0.2); }  #graphics-rightbar {     background: linear-gradient(180deg, rgba(60, 50, 40, 0.8), rgba(40, 30, 20, 0.8));     border-left: 1px solid #8a5c2e;     box-shadow: 0 0 20px rgba(138, 92, 46, 0.2); }  .grid-background {     background: #1e150d;     background-image: radial-gradient(rgba(138, 92, 46, 0.1) 1px, transparent 1px);     background-size: 20px 20px; }  .toolbar {     background: linear-gradient(90deg, rgba(60, 50, 40, 0.8), rgba(40, 30, 20, 0.8));     border-bottom: 1px solid #8a5c2e; }  .btn {     border: 1px solid #8a5c2e;     background-color: rgba(138, 92, 46, 0.1);     color: #d4b98a;     text-transform: uppercase; }  .btn:hover {     background-color: rgba(138, 92, 46, 0.2);     box-shadow: 0 0 10px rgba(138, 92, 46, 0.5);     transform: translateY(-2px); }  .btn-primary {     background-color: rgba(184, 134, 11, 0.2);     border: 1px solid #b8860b;     color: #b8860b; }  .btn-primary:hover {     background-color: rgba(184, 134, 11, 0.3);     box-shadow: 0 0 10px rgba(184, 134, 11, 0.5); }  .btn-danger {     background-color: rgba(139, 0, 0, 0.2);     border: 1px solid #8b0000;     color: #ff4040; }  .btn-danger:hover {     background-color: rgba(139, 0, 0, 0.3);     box-shadow: 0 0 10px rgba(139, 0, 0, 0.5); }  .btn-secondary {     background-color: rgba(138, 92, 46, 0.15);     border: 1px solid #8a5c2e; }  .btn-secondary:hover {     background-color: rgba(138, 92, 46, 0.25);     box-shadow: 0 0 10px rgba(138, 92, 46, 0.5); }  .btn-special {     background-color: rgba(34, 139, 34, 0.2); /* Forest green */     border: 1px solid #228b22;     color: #228b22; }  .btn-special:hover {     background-color: rgba(34, 139, 34, 0.3);     box-shadow: 0 0 10px rgba(34, 139, 34, 0.5); }  #shape-list {     border-bottom: 1px solid rgba(138, 92, 46, 0.2); }  .shape-item {     background-color: rgba(60, 50, 40, 0.6);     border: 1px solid #8a5c2e; }  .shape-item:hover {     background-color: rgba(138, 92, 46, 0.1);     transform: translateX(5px); }  .shape-item.active {     background-color: rgba(34, 139, 34, 0.1);     border-color: #228b22;     color: #228b22;     box-shadow: 0 0 10px rgba(34, 139, 34, 0.3); }  #inspector {     background: rgba(60, 50, 40, 0.8);     border-top: 1px solid #8a5c2e; }  .form-row label {     color: #b8860b; }  .form-row input, .form-row select {     border: 1px solid #8a5c2e;     background-color: rgba(60, 50, 40, 0.6);     color: #d4b98a;     box-shadow: 0 0 5px rgba(138, 92, 46, 0.3); }  .scene-info {     background: rgba(40, 30, 20, 0.8);     color: #d4b98a;     box-shadow: 0 0 15px rgba(138, 92, 46, 0.3);     border: 1px solid #8a5c2e; }  .button-danger {     background-color: rgba(139, 0, 0, 0.2);     border: 1px solid #8b0000;     color: #ff4040; }  .button-danger:hover {     background-color: rgba(139, 0, 0, 0.3);     box-shadow: 0 0 10px rgba(139, 0, 0, 0.5); }  h2, h3 {     color: #b8860b;     text-transform: uppercase;     letter-spacing: 3px;     margin-bottom: 15px;     padding-bottom: 5px;     border-bottom: 1px solid #8a5c2e;     text-shadow: 0 0 5px rgba(184, 134, 11, 0.7); }   .container::before {     content: '';     position: fixed;     top: 0;     left: 0;     right: 0;     bottom: 0;     background:          linear-gradient(rgba(138, 92, 46, 0.07) 1px, transparent 1px),         linear-gradient(90deg, rgba(138, 92, 46, 0.07) 1px, transparent 1px);     background-size: 40px 40px;     background-position: center center;     z-index: -1;     perspective: 1000px;     transform-style: preserve-3d;     transform: rotateX(75deg) translateZ(-100px);     pointer-events: none; }  #json-content {     background-color: rgba(60, 50, 40, 0.8);     border: 1px solid #8a5c2e;     color: #228b22; /* Green ink */     font-family: 'IM Fell English', serif;     padding: 15px;     box-shadow: 0 0 15px rgba(138, 92, 46, 0.2), inset 0 0 30px rgba(60, 50, 40, 0.5); }  .ref-value-item {     background-color: #4a3a2a; /* Darker wood */ }  .remove-ref-btn {     background: none;     border: none;     color: #ff4040;     cursor: pointer; }  ::-webkit-scrollbar {     width: 8px;     height: 8px; }  ::-webkit-scrollbar-track {     background: rgba(60, 50, 40, 0.6); }  ::-webkit-scrollbar-thumb {     background: #8a5c2e;     border-radius: 0; }  ::-webkit-scrollbar-thumb:hover {     background: #b8860b; }  /* Category Styling for Medieval Theme */ .type-selector {     background-color: rgba(50, 40, 30, 0.7); /* Dark wood */     border: 1px solid #8a5c2e; /* Bronze */     box-shadow: inset 0 0 10px rgba(138, 92, 46, 0.3); }  .category-header {     background-color: rgba(60, 50, 40, 0.8); /* Aged wood */     border: 1px solid #8a5c2e;     color: #d4b98a; /* Parchment beige */     text-transform: uppercase;     letter-spacing: 1px;     font-weight: bold; }  .category-header:hover {     background-color: rgba(138, 92, 46, 0.2); /* Bronze hover */     box-shadow: 0 0 10px rgba(138, 92, 46, 0.5); }  .category-types {     background-color: rgba(40, 30, 20, 0.6); /* Dark stone */ }  .object-type-item {     background-color: rgba(60, 50, 40, 0.6); /* Aged wood */     border-left: 2px solid #b8860b; /* Gold accent */     color: #d4b98a;     text-transform: uppercase;     letter-spacing: 1px; }  .object-type-item:hover {     background-color: rgba(184, 134, 11, 0.2); /* Golden hover */     transform: translateX(5px); }  .object-type-item.selected {     background-color: rgba(184, 134, 11, 0.3);     border-left: 4px solid #b8860b;     box-shadow: 0 0 8px rgba(184, 134, 11, 0.5); }  .object-list {     background-color: rgba(50, 40, 30, 0.5); /* Slightly lighter wood */ }"
      },
      "scifi2": {
        "title": "SciFi2.0",
        "fileName": "scifi2",
        "css": "@import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700&display=swap'); :root {     --primary-bg: #0a0a1a;     --secondary-bg: #121228;     --accent-color: #00ffff;     --text-color: #e0e7ff;     --border-color: #2a2a4a;     --highlight-color: #ff00ff;     --hover-color: rgba(0, 255, 255, 0.2); }  body {     background-color: var(--primary-bg);     color: var(--text-color);     font-family: 'Orbitron', 'Arial', sans-serif;     line-height: 1.6; }  .container {     background-color: var(--secondary-bg);     border: 2px solid var(--border-color);     box-shadow: 0 0 20px rgba(0, 255, 255, 0.1); }  /* Sidebar Styling */ .sidebar {     background-color: #0f0f2a;     border-right: 1px solid var(--border-color); }  .object-item, .object-type-item {     background-color: var(--secondary-bg);     border: 1px solid var(--border-color);     color: var(--text-color);     transition: all 0.3s ease; }  .object-item:hover, .object-type-item:hover {     background-color: var(--hover-color);     border-color: var(--accent-color); }  .object-item.selected, .object-type-item.selected {     background-color: var(--accent-color);     color: var(--primary-bg); }  /* Button Styling */ button {     background-color: var(--secondary-bg);     color: var(--accent-color);     border: 2px solid var(--accent-color);     transition: all 0.3s ease;     position: relative;     overflow: hidden; }  button:before {     content: '';     position: absolute;     top: 0;     left: -100%;     width: 100%;     height: 100%;     background: linear-gradient(120deg, transparent, var(--highlight-color), transparent);     transition: all 0.5s ease; }  button:hover:before {     left: 100%; }  button:hover {     background-color: var(--accent-color);     color: var(--primary-bg); }  .primary {     background-color: var(--accent-color);     color: var(--primary-bg); }  .danger {     border-color: #ff4444;     color: #ff4444; }  /* Input Styling */ input, textarea, select {     background-color: var(--secondary-bg);     color: var(--text-color);     border: 1px solid var(--border-color);     transition: border-color 0.3s ease; }  input:focus, textarea:focus, select:focus {     border-color: var(--accent-color);     outline: none;     box-shadow: 0 0 10px rgba(0, 255, 255, 0.2); }  /* Modal Styling */ .modal {     background-color: rgba(10, 10, 26, 0.9); }  .modal-content {     background-color: var(--secondary-bg);     border: 2px solid var(--border-color);     box-shadow: 0 0 30px rgba(0, 255, 255, 0.1); }  /* Graphics Editor Enhancements */ #canvas-container {     background:          linear-gradient(45deg, rgba(0,255,255,0.05) 25%, transparent 25%) 0 0,         linear-gradient(-45deg, rgba(0,255,255,0.05) 25%, transparent 25%) 0 0,         linear-gradient(45deg, transparent 75%, rgba(0,255,255,0.05) 75%) 0 0,         linear-gradient(-45deg, transparent 75%, rgba(0,255,255,0.05) 75%) 0 0;     background-size: 20px 20px;     background-color: var(--primary-bg); }  .scene-info {     background-color: rgba(18, 18, 40, 0.8);     border: 1px solid var(--border-color);     color: var(--accent-color); }  /* Toolbar Styling */ .toolbar .btn {     background-color: var(--secondary-bg);     border-color: var(--border-color);     color: var(--accent-color); }  .toolbar .btn:hover {     background-color: var(--accent-color);     color: var(--primary-bg); }  /* Tab and Category Styling */ .tab, .category-header {     color: var(--text-color);     transition: color 0.3s ease; }  .tab:hover, .category-header:hover {     color: var(--accent-color); }  .tab.active {     border-bottom-color: var(--accent-color); }  /* Scrollbar (for browsers that support) */ ::-webkit-scrollbar {     width: 10px; }  ::-webkit-scrollbar-track {     background: var(--secondary-bg); }  ::-webkit-scrollbar-thumb {     background: var(--accent-color);     border-radius: 5px; }  ::-webkit-scrollbar-thumb:hover {     background: var(--highlight-color); }  /* Subtle Sci-Fi Animations */ @keyframes pulse-border {     0%, 100% { box-shadow: 0 0 10px rgba(0, 255, 255, 0.3); }     50% { box-shadow: 0 0 20px rgba(0, 255, 255, 0.6); } }  @keyframes grid-pulse {     0%, 100% { opacity: 0.1; }     50% { opacity: 0.3; } }  /* Additional Futuristic Effects */ body::before {     content: '';     position: fixed;     top: 0;     left: 0;     width: 100%;     height: 100%;     pointer-events: none;     background:          repeating-linear-gradient(             0deg,             rgba(0, 0, 0, 0.15),             rgba(0, 0, 0, 0.15) 1px,             transparent 1px,             transparent 2px         );     opacity: 0.3;     z-index: 9999; }"
      },
      "videogame": {
        "title": "Video Game",
        "fileName": "videogame",
        "css": "@import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Share+Tech+Mono&display=swap');  body {     font-family: 'Orbitron', 'Share Tech Mono', sans-serif;     background-color: #0a0a0a; /* Deep black */     color: #00d4ff; /* Neon blue */     overflow: hidden; }  .sidebar {     background: linear-gradient(135deg, rgba(10, 10, 10, 0.9), rgba(155, 0, 255, 0.1)); /* Black to purple fade */     border: 1px solid #ff007a; /* Hot pink */     box-shadow: 0 0 15px rgba(0, 212, 255, 0.5), inset 0 0 10px rgba(155, 0, 255, 0.3); }  .inventory-item {     background-color: rgba(12, 12, 12, 0.7);     border-left: 3px solid #9b00ff; /* Electric purple */     text-transform: uppercase;     letter-spacing: 2px;     transition: all 0.2s ease; }  .inventory-item:hover {     background-color: rgba(0, 212, 255, 0.2);     transform: scale(1.03);     box-shadow: 0 0 10px rgba(0, 212, 255, 0.7); }  .inventory-item.active {     background-color: rgba(255, 0, 122, 0.3); /* Pink glow */     border-left: 5px solid #ff007a;     box-shadow: 0 0 15px rgba(255, 0, 122, 0.8); }  .hud {     background: rgba(10, 10, 10, 0.8);     border: 1px solid #00d4ff;     box-shadow: 0 0 20px rgba(0, 212, 255, 0.4); }  #game-canvas {     border: 1px dashed #c0c0c0; /* Silver dashed */     background: radial-gradient(circle, rgba(155, 0, 255, 0.1), transparent); }  .hologram-display {     border: 2px solid #9b00ff;     box-shadow: 0 0 25px rgba(155, 0, 255, 0.6);     animation: pulseGlow 2s infinite alternate; }  @keyframes pulseGlow {     0% { box-shadow: 0 0 25px rgba(155, 0, 255, 0.6); }     100% { box-shadow: 0 0 35px rgba(155, 0, 255, 0.9); } }  .control-panel {     background: rgba(0, 0, 0, 0.85);     border: 1px solid #c0c0c0; }  .control-panel button {     background-color: rgba(0, 212, 255, 0.2);     border: 1px solid #00d4ff;     color: #fff;     text-transform: uppercase;     transition: all 0.3s ease; }  .control-panel button:hover {     background-color: rgba(0, 212, 255, 0.4);     box-shadow: 0 0 15px rgba(0, 212, 255, 0.8);     transform: translateY(-3px); }  label {     color: #ff007a; /* Hot pink */     font-weight: bold;     text-transform: uppercase;     letter-spacing: 1.5px; }  input, textarea, select {     border: 1px solid #9b00ff;     background-color: rgba(10, 10, 10, 0.7);     color: #00d4ff;     box-shadow: 0 0 8px rgba(155, 0, 255, 0.4); }  input:focus, textarea:focus, select:focus {     outline: none;     border-color: #ff007a;     box-shadow: 0 0 12px rgba(255, 0, 122, 0.7); }  button {     background-color: rgba(155, 0, 255, 0.2);     border: 1px solid #9b00ff;     color: #fff;     text-transform: uppercase;     letter-spacing: 1px;     transition: all 0.3s ease; }  button:hover {     background-color: rgba(155, 0, 255, 0.4);     box-shadow: 0 0 15px rgba(155, 0, 255, 0.7);     transform: translateY(-2px) scale(1.05); }  button.primary {     background-color: rgba(0, 212, 255, 0.3);     border: 1px solid #00d4ff;     color: #fff; }  button.primary:hover {     background-color: rgba(0, 212, 255, 0.5);     box-shadow: 0 0 20px rgba(0, 212, 255, 0.9); }  button.alert {     background-color: rgba(255, 0, 122, 0.2);     border: 1px solid #ff007a;     color: #fff; }  button.alert:hover {     background-color: rgba(255, 0, 122, 0.4);     box-shadow: 0 0 15px rgba(255, 0, 122, 0.7); }  .modal {     background: rgba(0, 0, 0, 0.9);     backdrop-filter: blur(3px); }  .modal-content {     background: linear-gradient(45deg, rgba(10, 10, 10, 0.9), rgba(0, 212, 255, 0.1));     border: 1px solid #00d4ff;     box-shadow: 0 0 30px rgba(0, 212, 255, 0.5); }  .notification {     background-color: rgba(155, 0, 255, 0.3);     border-left: 4px solid #9b00ff;     color: #fff;     animation: slideIn 0.5s ease-out; }  @keyframes slideIn {     0% { transform: translateX(100%); opacity: 0; }     100% { transform: translateX(0); opacity: 1; } }  .main-content {     background: #0a0a0a;     animation: glitch 4s infinite; }   .grid-overlay {     background: repeating-linear-gradient(45deg, rgba(155, 0, 255, 0.05), rgba(155, 0, 255, 0.05) 10px, transparent 10px, transparent 20px); }  .btn {     border: 1px solid #c0c0c0;     background-color: rgba(0, 212, 255, 0.15);     color: #fff; }  .btn:hover {     background-color: rgba(0, 212, 255, 0.3);     box-shadow: 0 0 10px rgba(0, 212, 255, 0.6); }  .btn-primary {     background-color: rgba(9b, 0, 255, 0.25);     border: 1px solid #9b00ff; }  .btn-primary:hover {     background-color: rgba(155, 0, 255, 0.45);     box-shadow: 0 0 15px rgba(155, 0, 255, 0.8); }  ::-webkit-scrollbar {     width: 6px; }  ::-webkit-scrollbar-track {     background: #0a0a0a; }  ::-webkit-scrollbar-thumb {     background: #00d4ff;     border-radius: 3px; }  ::-webkit-scrollbar-thumb:hover {     background: #ff007a; }"
      },
      "videoGame2": {
        "title": "Video Game 2",
        "fileName": "videoGame2",
        "css": "/* retro-theme.css - Pixel Art Retro Video Game Theme */\r\n\r\n/* Import pixel font from Google Fonts */\r\n@import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');\r\n\r\n/* Base Styles */\r\nbody {\r\n    background-color: #1a1a1a; /* Dark retro background */\r\n    font-family: 'Press Start 2P', cursive; /* Pixelated font */\r\n    image-rendering: pixelated; /* Ensures crisp pixel art rendering */\r\n    color: #fff; /* Default text color */\r\n}\r\n\r\n/* Container */\r\n.container {\r\n    background: #2b2b2b; /* Retro gray */\r\n    border: 4px solid #000; /* Thick black border */\r\n    padding: .5em;\r\n}\r\n\r\n/* Sidebar */\r\n.sidebar {\r\n    background: #3c3c3c; /* Mid-gray retro */\r\n    border: 4px solid #000;\r\n}\r\n\r\n.sidebar img {\r\n    image-rendering: pixelated;\r\n    border-bottom: 2px solid #000;\r\n}\r\n\r\n/* Object List */\r\n.object-item {\r\n    background: #5a5a5a; /* Darker gray */\r\n    border: 2px solid #000;\r\n    color: #fff;\r\n    font-size: 10px; /* Smaller for pixel readability */\r\n}\r\n\r\n.object-item:hover, .object-item.selected {\r\n    background: #ffcc00; /* Bright retro yellow */\r\n    color: #000;\r\n}\r\n.object-type-item.selected {\r\n    color: #ffcc00;\r\n}\r\n\r\n/* Buttons */\r\nbutton {\r\n    background: #ff3333; /* Retro red */\r\n    color: #fff;\r\n    border: 2px solid #000;\r\n    font-family: 'Press Start 2P', cursive;\r\n    font-size: 10px;\r\n    text-transform: uppercase; /* Retro game style */\r\n    transition: background 0.1s ease;\r\n}\r\n\r\nbutton:hover {\r\n    background: #33cc33; /* Retro green */\r\n}\r\n\r\nbutton.primary {\r\n    background: #33cc33; /* Green for primary actions */\r\n}\r\n\r\nbutton.primary:hover {\r\n    background: #ffcc00; /* Yellow on hover */\r\n}\r\n\r\n/* Main Content */\r\n.main-content {\r\n    background: #2b2b2b;\r\n}\r\n\r\n/* Editor */\r\n.editor {\r\n    background: #3c3c3c;\r\n    border: 4px solid #000;\r\n    color: #fff;\r\n    font-size: 10px;\r\n}\r\n\r\n/* Canvas and Grid Containers */\r\n#canvas-container, .grid-container {\r\n    background: #000; /* Black canvas background */\r\n    border: 4px solid #fff;\r\n}\r\n\r\n#canvas, #grid {\r\n    image-rendering: pixelated;\r\n    background: repeating-linear-gradient(\r\n        45deg,\r\n        #333 0px,\r\n        #333 10px,\r\n        #000 10px,\r\n        #000 20px\r\n    ); /* Retro checkerboard grid */\r\n}\r\n\r\n.scene-info {\r\n    background: rgba(0, 0, 0, 0.8);\r\n    border: 2px solid #fff;\r\n    color: #00ff00; /* Neon green */\r\n    font-size: 8px;\r\n}\r\n\r\n/* Toolbar */\r\n.toolbar {\r\n    background: #5a5a5a;\r\n    border-bottom: 2px solid #000;\r\n}\r\n\r\n.btn {\r\n    background: #ff3333; /* Retro red */\r\n    color: #fff;\r\n    border: 2px solid #000;\r\n    font-family: 'Press Start 2P', cursive;\r\n    font-size: 10px;\r\n    transition: background 0.1s ease;\r\n}\r\n\r\n.btn:hover {\r\n    background: #33cc33; /* Retro green */\r\n}\r\n\r\n.btn.btn-danger {\r\n    background: #ff0000; /* Bright red */\r\n}\r\n\r\n.btn.btn-danger:hover {\r\n    background: #cc0000; /* Darker red */\r\n}\r\n\r\n.btn.btn-secondary {\r\n    background: #6666ff; /* Retro blue */\r\n}\r\n\r\n.btn.btn-secondary:hover {\r\n    background: #9999ff; /* Lighter blue */\r\n}\r\n\r\n.btn.btn-special {\r\n    background: #ff00ff; /* Retro magenta */\r\n}\r\n\r\n.btn.btn-special:hover {\r\n    background: #cc00cc; /* Darker magenta */\r\n}\r\n\r\n/* Modals */\r\n.modal {\r\n    background: rgba(0, 0, 0, 0.8);\r\n}\r\n\r\n.modal-content {\r\n    background: #3c3c3c;\r\n    border: 4px solid #fff;\r\n    color: #fff;\r\n    font-size: 10px;\r\n}\r\n\r\n/* Form Elements */\r\n.form-group label {\r\n    color: #00ff00; /* Neon green */\r\n    font-size: 10px;\r\n}\r\n\r\ninput, textarea, select {\r\n    background: #000;\r\n    border: 2px solid #fff;\r\n    color: #ffcc00; /* Retro yellow */\r\n    font-family: 'Press Start 2P', cursive;\r\n    font-size: 10px;\r\n}\r\n\r\ninput[type=\"color\"] {\r\n    padding: 0; /* Fix color picker padding */\r\n    height: 20px; /* Consistent height */\r\n}\r\n\r\n/* Tabs */\r\n.tab-navigation {\r\n    border-bottom: 2px solid #000;\r\n}\r\n\r\n.tab {\r\n    background: #5a5a5a;\r\n    border: 2px solid #000;\r\n    color: #fff;\r\n    font-size: 10px;\r\n}\r\n\r\n.tab.active {\r\n    background: #ffcc00; /* Yellow for active tab */\r\n    color: #000;\r\n}\r\n\r\n/* Inspector and JSON Editor */\r\n#inspector, #json-editor {\r\n    background: #3c3c3c;\r\n    border: 2px solid #000;\r\n}\r\n\r\n#json-content {\r\n    background: #000;\r\n    color: #00ff00; /* Green for code-like text */\r\n}\r\n\r\n/* Translation Controls */\r\n.translation-controls button {\r\n    background: #6666ff; /* Retro blue */\r\n}\r\n\r\n.translation-controls button:hover {\r\n    background: #9999ff;\r\n}\r\n\r\n/* Shape List */\r\n.shape-item {\r\n    background: #5a5a5a;\r\n    border: 2px solid #000;\r\n    color: #fff;\r\n    font-size: 10px;\r\n}\r\n\r\n.shape-item:hover {\r\n    background: #ffcc00;\r\n    color: #000;\r\n}\r\n\r\n.type-selector .object-item {\r\n  font-size: .6em;\r\n}\r\n\r\n/* codemirror-retro.css - Retro Pixel Art Theme for CodeMirror */\r\n\r\n/* Import pixel font from Google Fonts */\r\n@import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');\r\n\r\n/* Base CodeMirror Styles */\r\n.CodeMirror {\r\n    height: 100% !important;\r\n    font-family: 'Press Start 2P', cursive !important;\r\n    font-size: 10px !important; /* Small size for pixel readability */\r\n    background: #000 !important; /* Black background like a CRT screen */\r\n    color: #00ff00 !important; /* Neon green default text */\r\n    border: 4px solid #fff !important; /* Thick white border */\r\n    image-rendering: pixelated; /* Crisp rendering */\r\n}\r\n.CodeMirror-gutters {\r\n background-color: #000;\r\n}\r\n\r\n/* Retro Theme Definition */\r\n.cm-s-retro .CodeMirror-gutters {\r\n    background: #1a1a1a !important; /* Dark gray gutter */\r\n    border-right: 2px solid #fff !important; /* White separator */\r\n    color: #ffcc00 !important; /* Yellow line numbers */\r\n}\r\n\r\n.cm-s-retro .CodeMirror-linenumber {\r\n    color: #ffcc00 !important; /* Yellow line numbers */\r\n    padding: 0 5px !important;\r\n}\r\n\r\n.cm-s-retro .CodeMirror-cursor {\r\n    border-left: 2px solid #ff3333 !important; /* Red blinking cursor */\r\n    animation: blink 1s step-end infinite; /* Retro blink effect */\r\n}\r\n\r\n.cm-s-retro .CodeMirror-selected {\r\n    background: #ff3333 !important; /* Red selection highlight */\r\n    opacity: 0.5; /* Slightly transparent for retro effect */\r\n}\r\n\r\n.cm-s-retro .CodeMirror-focused .CodeMirror-selected {\r\n    background: #ff3333 !important;\r\n}\r\n\r\n/* Syntax Highlighting */\r\n.cm-s-retro .cm-comment {\r\n    color: #6666ff !important; /* Blue for comments */\r\n    font-style: italic; /* Slight retro flair */\r\n}\r\n\r\n.cm-s-retro .cm-string {\r\n    color: #ffcc00 !important; /* Yellow for strings */\r\n}\r\n\r\n.cm-s-retro .cm-number {\r\n    color: #33cc33 !important; /* Green for numbers */\r\n}\r\n\r\n.cm-s-retro .cm-keyword {\r\n    color: #ff00ff !important; /* Magenta for keywords */\r\n    font-weight: bold; /* Bold for emphasis */\r\n}\r\n\r\n.cm-s-retro .cm-operator {\r\n    color: #fff !important; /* White for operators */\r\n}\r\n\r\n.cm-s-retro .cm-variable {\r\n    color: #00ff00 !important; /* Green for variables */\r\n}\r\n\r\n.cm-s-retro .cm-variable-2 {\r\n    color: #33cc33 !important; /* Lighter green for secondary variables */\r\n}\r\n\r\n.cm-s-retro .cm-def {\r\n    color: #ff00ff !important; /* Magenta for definitions */\r\n}\r\n\r\n.cm-s-retro .cm-property {\r\n    color: #ffcc00 !important; /* Yellow for properties */\r\n}\r\n\r\n.cm-s-retro .cm-function {\r\n    color: #ff00ff !important; /* Magenta for functions */\r\n}\r\n\r\n.cm-s-retro .cm-builtin {\r\n    color: #33cc33 !important; /* Green for built-ins */\r\n}\r\n\r\n.cm-s-retro .cm-tag {\r\n    color: #ff3333 !important; /* Red for tags (if HTML mode is used) */\r\n}\r\n\r\n.cm-s-retro .cm-attribute {\r\n    color: #ffcc00 !important; /* Yellow for attributes */\r\n}\r\n\r\n/* Matching Brackets */\r\n.cm-s-retro .CodeMirror-matchingbracket {\r\n    color: #33cc33 !important; /* Green for matching brackets */\r\n    border-bottom: 2px solid #33cc33 !important;\r\n    background: none !important;\r\n}\r\n\r\n.cm-s-retro .CodeMirror-nonmatchingbracket {\r\n    color: #ff3333 !important; /* Red for non-matching brackets */\r\n    border-bottom: 2px solid #ff3333 !important;\r\n}\r\n\r\n/* Autocomplete Hints */\r\n.CodeMirror-hints {\r\n    background: #2b2b2b !important; /* Dark retro gray */\r\n    border: 2px solid #fff !important; /* White border */\r\n    color: #fff !important;\r\n    font-family: 'Press Start 2P', cursive !important;\r\n    font-size: 10px !important;\r\n    box-shadow: 4px 4px 0 #000; /* Retro shadow effect */\r\n}\r\n\r\n.CodeMirror-hints .CodeMirror-hint {\r\n    color: #ffcc00 !important; /* Yellow for hint items */\r\n    padding: 5px !important;\r\n}\r\n\r\n.CodeMirror-hints .CodeMirror-hint-active {\r\n    background: #ff3333 !important; /* Red for selected hint */\r\n    color: #000 !important;\r\n}\r\n\r\n/* Scrollbars (minimal retro style) */\r\n.CodeMirror-vscrollbar, .CodeMirror-hscrollbar {\r\n    background: #3c3c3c !important;\r\n}\r\n\r\n.CodeMirror-scrollbar-filler {\r\n    background: #000 !important;\r\n}\r\n\r\n/* Animations */\r\n@keyframes blink {\r\n    50% { opacity: 0; }\r\n}"
      },
      "Neon Dune": {
        "title": "Neon Dune",
        "fileName": "Neon Dune",
        "css": "body { background-color: #1a0f05; color: #ffffff; font-family: 'Arial', sans-serif; }\r\n\r\nh1, h2, h3 { color: #00ffbf; }\r\n\r\n.button-primary { background-color: #00ffbf; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; transition: all 0.3s ease; }\r\n.button-primary:hover { transform: scale(1.05); box-shadow: 0 0 15px #00ffbf; }\r\n\r\n.link { color: #00ffbf; text-decoration: none; }\r\n.link:hover { text-decoration: underline; }\r\n\r\n.card { background-color: #2d1e13; border-radius: 10px; padding: 20px; margin: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }\r\n\r\ninput, textarea { background-color: #2d1e13; color: #ffffff; border: 1px solid #00ffbf; padding: 8px; border-radius: 5px; }\r\n\r\nheader { background-color: #00ffbf; padding: 20px; text-align: center; box-shadow: 0 4px 6px rgba(0,255,191,0.3); }\r\n\r\nfooter { background-color: #2d1e13; color: #ffffff; padding: 20px; text-align: center; border-top: 1px solid #00ffbf; }\r\n"
      },
      "codeMirrorTheme": {
        "title": "Code - Ez On Eyes",
        "fileName": "codeMirrorTheme",
        "css": ".CodeMirror {    background: #1e1e1e;    color: #d4d4d4;    font-size: 14px; } .CodeMirror-gutters {    background: #252525;  border-right: 1px solid #444; } .CodeMirror-linenumber {    color: #888; }.CodeMirror-cursor {    border-left: 1px solid #d4d4d4; } .CodeMirror-selected {    background: #3a3a3a; }.CodeMirror-focused .CodeMirror-selected {    background: #404040; /* Slightly lighter when focused */}.CodeMirror-activeline-background {    background: #2a2a2a; /* Subtle active line highlight */}.CodeMirror-matchingbracket {    color: #b5cea8; /* Muted green for matching brackets */}.CodeMirror-nonmatchingbracket {    color: #d16969; /* Soft red for non-matching */}/* Override default theme's syntax highlighting */.cm-s-default .cm-header { color: #dcdcaa; } /* Soft yellow (overrides #00f blue) */.cm-s-default .cm-quote { color: #b5cea8; } /* Muted green (overrides #090) */.cm-negative { color: #d16969; } /* Soft red */.cm-positive { color: #6a9955; } /* Muted green */.cm-header, .cm-strong { font-weight: 700; }.cm-em { font-style: italic; }.cm-s-default .cm-link { color: #d7ba7d; text-decoration: underline; } /* Muted yellow (overrides #00c blue) */.cm-strikethrough { text-decoration: line-through; }.cm-s-default .cm-keyword { color: #ce9178; } /* Soft orange (overrides #708 purple) */.cm-s-default .cm-atom { color: #d4d4d4; } /* Light gray (overrides #219 blue) */.cm-s-default .cm-number { color: #b5cea8; } /* Muted green (overrides #164) */.cm-s-default .cm-def { color: #dcdcaa; } /* Soft yellow (overrides #00f blue) */.cm-s-default .cm-variable-2 { color: #d4d4d4; } /* Light gray (overrides #05a blue) */.cm-s-default .cm-variable-3, .cm-s-default .cm-type { color: #dcdcaa; } /* Soft yellow (overrides #085 blue) */.cm-s-default .cm-comment { color: #6a9955; } /* Muted green (overrides #a50) */.cm-s-default .cm-string { color: #ce9178; } /* Soft orange (overrides #a11) */.cm-s-default .cm-string-2 { color: #d7ba7d; } /* Muted yellow (overrides #f50) */.cm-s-default .cm-meta { color: #d4d4d4; } /* Light gray (overrides #555) */.cm-s-default .cm-qualifier { color: #d4d4d4; } /* Light gray (overrides #555) */.cm-s-default .cm-builtin { color: #dcdcaa; } /* Soft yellow (overrides #30a) */.cm-s-default .cm-bracket { color: #d4d4d4; } /* Light gray (overrides #997) */.cm-s-default .cm-tag { color: #dcdcaa; } /* Soft yellow (overrides #170) */.cm-s-default .cm-attribute { color: #d4d4d4; } /* Light gray (overrides #00c blue) */.cm-s-default .cm-hr { color: #888; } /* Muted gray (overrides #999) */.cm-s-default .cm-link { color: #d7ba7d; } /* Muted yellow (overrides #00c blue) */.cm-s-default .cm-error { color: #d16969; } /* Soft red (overrides red) */.cm-invalidchar { color: #d16969; } /* Soft red *//* Search highlight */.cm-searching {    background-color: rgba(255, 255, 0, 0.2); /* Subtle yellow */}"
      },
      "professional2": {
        "title": "Professional Warm",
        "fileName": "professional2",
        "css": "/* Professional Cyberpunk Variation - Warm Edition */ @import url('https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;500;600&family=Inter:wght@300;400;500;600&display=swap');  body {     font-family: 'Inter', 'Roboto Mono', sans-serif;     background-color: #2b1e1e; /* Deep reddish-brown */     color: #f4e1d2; /* Soft cream for text */     line-height: 1.6; }  .sidebar {     background-color: rgba(54, 36, 36, 0.95); /* Muted dark red */     border: 1px solid #7a4e4e; /* Subtle reddish-gray */     box-shadow: 0 4px 12px rgba(122, 78, 78, 0.2); }  .object-item {     background-color: rgba(54, 36, 36, 0.8);     border-left: 2px solid #d97706; /* Warm amber */     text-transform: uppercase;     letter-spacing: 0.5px;     transition: all 0.3s ease; }  .object-item:hover {     background-color: rgba(217, 119, 6, 0.15);     transform: translateX(3px); }  .object-item.selected {     background-color: rgba(217, 119, 6, 0.25);     border-left: 3px solid #d97706;     box-shadow: 0 0 6px rgba(217, 119, 6, 0.4); }  .editor {     background-color: rgba(54, 36, 36, 0.95);     border: 1px solid #7a4e4e;     box-shadow: 0 4px 12px rgba(122, 78, 78, 0.15); }  #three-js-container {     border: 1px solid rgba(122, 78, 78, 0.6); }  .preview-canvas-container {     border: 1px solid #d97706;     box-shadow: 0 4px 12px rgba(217, 119, 6, 0.1); }  .preview {     background-color: rgba(54, 36, 36, 0.9);     border: 1px solid #7a4e4e;     box-shadow: 0 4px 12px rgba(122, 78, 78, 0.15); }  #preview-canvas {     background-color: transparent;     border: 1px solid rgba(122, 78, 78, 0.5); }  .camera-controls {     background: rgba(46, 28, 28, 0.9); /* Darker reddish tint */     border: 1px solid #7a4e4e; }  .camera-controls button {     background-color: rgba(122, 78, 78, 0.3);     border: 1px solid #7a4e4e;     color: #f4e1d2;     transition: all 0.3s ease; }  .camera-controls button:hover {     background-color: rgba(122, 78, 78, 0.5);     box-shadow: 0 2px 8px rgba(122, 78, 78, 0.3); }  .camera-controls .color-picker {     border: 1px solid #7a4e4e; }  .camera-controls .size-slider {     background: #3a2424;     border: 1px solid #7a4e4e; }  label {     font-weight: 500;     text-transform: uppercase;     letter-spacing: 0.5px;     color: #d97706; /* Amber for labels */ }  input, textarea, select {     border: 1px solid #7a4e4e;     background-color: rgba(54, 36, 36, 0.8);     color: #f4e1d2;     box-shadow: 0 2px 6px rgba(122, 78, 78, 0.1);     transition: all 0.3s ease; }  input:focus, textarea:focus, select:focus {     outline: none;     border-color: #d97706;     box-shadow: 0 0 8px rgba(217, 119, 6, 0.3); }  button {     background-color: rgba(122, 78, 78, 0.3);     border: 1px solid #7a4e4e;     color: #f4e1d2;     text-transform: uppercase;     letter-spacing: 0.5px;     transition: all 0.3s ease; }  button:hover {     background-color: rgba(122, 78, 78, 0.5);     box-shadow: 0 2px 8px rgba(122, 78, 78, 0.3);     transform: translateY(-1px); }  button.primary {     background-color: rgba(217, 119, 6, 0.3);     border: 1px solid #d97706;     color: #f4e1d2; }  button.primary:hover {     background-color: rgba(217, 119, 6, 0.5);     box-shadow: 0 2px 8px rgba(217, 119, 6, 0.3); }  button.danger {     background-color: rgba(220, 38, 38, 0.3); /* Softer red */     border: 1px solid #dc2626;     color: #f4e1d2; }  button.danger:hover {     background-color: rgba(220, 38, 38, 0.5);     box-shadow: 0 2px 8px rgba(220, 38, 38, 0.3); }  button.active {     border: 1px solid #10b981; /* Emerald green for active state */     box-shadow: 0 0 8px rgba(16, 185, 129, 0.4);     color: #10b981; }  .modal {     background-color: rgba(46, 28, 28, 0.9);     backdrop-filter: blur(3px); }  .modal-content {     background-color: rgba(54, 36, 36, 0.95);     border: 1px solid #7a4e4e;     box-shadow: 0 8px 24px rgba(122, 78, 78, 0.2); }  .property-list {     border: 1px solid #7a4e4e;     background-color: rgba(54, 36, 36, 0.8); }  .tab-navigation {     border-bottom: 1px solid #7a4e4e; }  .tab {     text-transform: uppercase;     letter-spacing: 0.5px;     transition: all 0.3s ease; }  .tab:hover {     background-color: rgba(122, 78, 78, 0.2); }  .tab.active {     border-bottom: 2px solid #d97706;     box-shadow: 0 4px 8px -4px rgba(217, 119, 6, 0.4);     font-weight: 600; }  .instructions {     background-color: rgba(54, 36, 36, 0.8);     border-left: 3px solid #d97706;     box-shadow: 0 2px 6px rgba(217, 119, 6, 0.1); }  #grid-display {     background-color: rgba(46, 28, 28, 0.9);     border: 1px solid #7a4e4e;     box-shadow: 0 4px 12px rgba(122, 78, 78, 0.15); }  .success-message {     color: #10b981; /* Emerald green for success */     text-transform: uppercase;     letter-spacing: 0.5px;     animation: fadeOut 2s forwards;     animation-delay: 1s; }  .warning {     background-color: rgba(220, 38, 38, 0.15);     border-left: 3px solid #dc2626;     box-shadow: 0 2px 6px rgba(220, 38, 38, 0.1); }  .main-content-container {     background-color: #332121; /* Slightly lighter reddish-brown */     color: #f4e1d2; }  .content-sidebar {     background: linear-gradient(180deg, rgba(54, 36, 36, 0.95), rgba(46, 28, 28, 0.95));     border-right: 1px solid #7a4e4e;     box-shadow: 0 4px 12px rgba(122, 78, 78, 0.15); }  #graphics-rightbar {     background: linear-gradient(180deg, rgba(54, 36, 36, 0.95), rgba(46, 28, 28, 0.95));     border-left: 1px solid #7a4e4e;     box-shadow: 0 4px 12px rgba(122, 78, 78, 0.15); }  .grid-background {     background: #2b1e1e;     background-image: radial-gradient(rgba(122, 78, 78, 0.15) 1px, transparent 1px);     background-size:30px 30px; }  .toolbar {     background: linear-gradient(90deg, rgba(54, 36, 36, 0.95), rgba(46, 28, 28, 0.95));     border-bottom: 1px solid #7a4e4e; }  .btn {     border: 1px solid #7a4e4e;     background-color: rgba(122, 78, 78, 0.3);     color: #f4e1d2;     text-transform: uppercase;     transition: all 0.3s ease; }  .btn:hover {     background-color: rgba(122, 78, 78, 0.5);     box-shadow: 0 2px 8px rgba(122, 78, 78, 0.3);     transform: translateY(-1px); }  .btn-primary {     background-color: rgba(217, 119, 6, 0.3);     border: 1px solid #d97706;     color: #f4e1d2; }  .btn-primary:hover {     background-color: rgba(217, 119, 6, 0.5);     box-shadow: 0 2px 8px rgba(217, 119, 6, 0.3); }  .btn-danger {     background-color: rgba(220, 38, 38, 0.3);     border: 1px solid #dc2626;     color: #f4e1d2; }  .btn-danger:hover {     background-color: rgba(220, 38, 38, 0.5);     box-shadow: 0 2px 8px rgba(220, 38, 38, 0.3); }  .btn-secondary {     background-color: rgba(122, 78, 78, 0.25);     border: 1px solid #7a4e4e; }  .btn-secondary:hover {     background-color: rgba(122, 78, 78, 0.4);     box-shadow: 0 2px 8px rgba(122, 78, 78, 0.3); }  .btn-special {     background-color: rgba(16, 185, 129, 0.3);     border: 1px solid #10b981;     color: #f4e1d2; }  .btn-special:hover {     background-color: rgba(16, 185, 129, 0.5);     box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3); }  #shape-list {     border-bottom: 1px solid rgba(122, 78, 78, 0.3); }  .shape-item {     background-color: rgba(54, 36, 36, 0.8);     border: 1px solid #7a4e4e;     transition: all 0.3s ease; }  .shape-item:hover {     background-color: rgba(122, 78, 78, 0.2);     transform: translateX(3px); }  .shape-item.active {     background-color: rgba(16, 185, 129, 0.15);     border-color: #10b981;     color: #10b981;     box-shadow: 0 0 8px rgba(16, 185, 129, 0.3); }  #inspector {     background: rgba(54, 36, 36, 0.95);     border-top: 1px solid #7a4e4e; }  .form-row label {     color: #d97706; }  .form-row input, .form-row select {     border: 1px solid #7a4e4e;     background-color: rgba(54, 36, 36, 0.8);     color: #f4e1d2;     box-shadow: 0 2px 6px rgba(122, 78, 78, 0.1); }  .scene-info {     background: rgba(46, 28, 28, 0.9prisma);     color: #f4e1d2;     box-shadow: 0 4px 12px rgba(122, 78, 78, 0.15);     border: 1px solid #7a4e4e; }  .button-danger {     background-color: rgba(220, 38, 38, 0.3);     border: 1px solid #dc2626;     color: #f4e1d2; }  .button-danger:hover {     background-color: rgba(220, 38, 38, 0.5);     box-shadow: 0 2px 8px rgba(220, 38, 38, 0.3); }  h2, h3 {     color: #d97706;     text-transform: uppercase;     letter-spacing: 1px;     margin-bottom: 12px;     padding-bottom: 4px;     border-bottom: 1px solid #7a4e4e;     text-shadow: 0 0 4px rgba(217, 119, 6, 0.3); }  ::-webkit-scrollbar {     width: 6px;     height: 6px; }  ::-webkit-scrollbar-track {     background: rgba(54, 36, 36, 0.8); }  ::-webkit-scrollbar-thumb {     background: #7a4e4e;     border-radius: 3px; }  ::-webkit-scrollbar-thumb:hover {     background: #d97706; }"
      },
      "cyberpunk": {
        "title": "Cyber Punk",
        "fileName": "cyberpunk",
        "css": "/* Default Cyberpunk Theme */ @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700&family=Rajdhani:wght@300;400;500;600;700&display=swap');  body {     font-family: 'Orbitron', 'Rajdhani', sans-serif;     background-color: #0a0a16;     color: #00f0ff; }  .sidebar {     background-color: rgba(15, 15, 35, 0.7);     border: 1px solid #00f0ff;     box-shadow: 0 0 10px #00f0ff, inset 0 0 20px rgba(0, 240, 255, 0.2); }  .object-item {     background-color: rgba(0, 0, 35, 0.6);     border-left: 2px solid #fe01fe;     text-transform: uppercase;     letter-spacing: 1px; }  .object-item:hover {     background-color: rgba(254, 1, 254, 0.2);     transform: translateX(5px); }  .object-item.selected {     background-color: rgba(254, 1, 254, 0.3);     border-left: 4px solid #fe01fe;     box-shadow: 0 0 8px rgba(254, 1, 254, 0.5); }  .editor {     background-color: rgba(15, 15, 35, 0.7);     border: 1px solid #fe01fe;     box-shadow: 0 0 15px rgba(254, 1, 254, 0.3); }  #three-js-container {     border: 1px solid rgba(0, 240, 255, 0.5); }  .preview-canvas-container {     border: 1px solid #fe01fe;     box-shadow: 0 0 10px rgba(254, 1, 254, 0.3); }  .preview {     background-color: rgba(15, 15, 35, 0.7);     border: 1px solid #00f0ff;     box-shadow: 0 0 15px rgba(0, 240, 255, 0.3); }  #preview-canvas {     background-color: transparent;     border: 1px solid rgba(0, 240, 255, 0.5); }  .camera-controls {     background: rgba(0, 0, 20, 0.7);     border: 1px solid #00f0ff; }  .camera-controls button {     background-color: rgba(0, 240, 255, 0.2);     border: 1px solid #00f0ff;     color: #00f0ff; }  .camera-controls .color-picker {     border: 1px solid #00f0ff; }  .camera-controls .size-slider {     background: #101028;     border: 1px solid #00f0ff; }  label {     font-weight: bold;     text-transform: uppercase;     letter-spacing: 1px;     color: #fe01fe; }  input, textarea, select {     border: 1px solid #00f0ff;     background-color: rgba(0, 0, 35, 0.6);     color: #00f0ff;     box-shadow: 0 0 5px rgba(0, 240, 255, 0.3); }  input:focus, textarea:focus, select:focus {     outline: none;     border-color: #fe01fe;     box-shadow: 0 0 10px rgba(254, 1, 254, 0.5); }  button {     background-color: rgba(0, 240, 255, 0.2);     border: 1px solid #00f0ff;     color: #00f0ff;     text-transform: uppercase;     letter-spacing: 1px; }  button:after {     background: linear-gradient(to right, transparent, rgba(0, 240, 255, 0.2), transparent); }  button:hover {     background-color: rgba(0, 240, 255, 0.3);     box-shadow: 0 0 10px rgba(0, 240, 255, 0.5), 0 0 20px rgba(0, 240, 255, 0.2);     transform: translateY(-2px); }  button:hover:after {     transform: translateX(100%) rotate(30deg); }  button.primary {     background-color: rgba(254, 1, 254, 0.2);     border: 1px solid #fe01fe;     color: #fe01fe; }  button.primary:hover {     background-color: rgba(254, 1, 254, 0.3);     box-shadow: 0 0 10px rgba(254, 1, 254, 0.5), 0 0 20px rgba(254, 1, 254, 0.2); }  button.danger {     background-color: rgba(255, 0, 76, 0.2);     border: 1px solid #ff004c;     color: #ff004c; }  button.danger:hover {     background-color: rgba(255, 0, 76, 0.3);     box-shadow: 0 0 10px rgba(255, 0, 76, 0.5), 0 0 20px rgba(255, 0, 76, 0.2); }  button.active {     border: 1px solid #00ff9d;     box-shadow: 0 0 10px rgba(0, 255, 157, 0.5);     color: #00ff9d; }  .modal {     background-color: rgba(0, 0, 20, 0.85);     backdrop-filter: blur(5px); }  .modal-content {     background-color: rgba(15, 15, 35, 0.9);     border: 1px solid #00f0ff;     box-shadow: 0 0 30px rgba(0, 240, 255, 0.3), 0 0 60px rgba(0, 240, 255, 0.1); }  .property-list {     border: 1px solid #00f0ff;     background-color: rgba(0, 0, 35, 0.6); }  .tab-navigation {     border-bottom: 1px solid #00f0ff; }  .tab {     text-transform: uppercase;     letter-spacing: 1px; }  .tab:hover {     background-color: rgba(0, 240, 255, 0.1); }  .tab.active {     border-bottom: 3px solid #fe01fe;     box-shadow: 0 5px 10px -5px rgba(254, 1, 254, 0.5);     font-weight: bold; }  .instructions {     background-color: rgba(0, 0, 35, 0.6);     border-left: 4px solid #fe01fe;     box-shadow: 0 0 10px rgba(254, 1, 254, 0.2); }  #grid-display {     background-color: rgba(0, 0, 20, 0.7);     border: 1px solid #00f0ff;     box-shadow: 0 0 10px rgba(0, 240, 255, 0.3); }  .success-message {     color: #00ff9d;     text-transform: uppercase;     letter-spacing: 1px;     animation: fadeOut 2s forwards;     animation-delay: 1s; }  .warning {     background-color: rgba(255, 0, 76, 0.1);     border-left: 4px solid #ff004c;     box-shadow: 0 0 10px rgba(255, 0, 76, 0.2); }  .main-content-container {     background-color: #080815;     color: #00f0ff; }  .content-sidebar {     background: linear-gradient(180deg, rgba(20, 20, 50, 0.8), rgba(10, 10, 30, 0.8));     border-right: 1px solid #00f0ff;     box-shadow: 0 0 20px rgba(0, 240, 255, 0.2); }  #graphics-rightbar {     background: linear-gradient(180deg, rgba(20, 20, 50, 0.8), rgba(10, 10, 30, 0.8));     border-left: 1px solid #00f0ff;     box-shadow: 0 0 20px rgba(0, 240, 255, 0.2); }  .grid-background {     background: #05051a;     background-image: radial-gradient(rgba(0, 240, 255, 0.1) 1px, transparent 1px);     background-size: 20px 20px; }  .toolbar {     background: linear-gradient(90deg, rgba(20, 20, 50, 0.8), rgba(10, 10, 30, 0.8));     border-bottom: 1px solid #00f0ff; }  .btn {     border: 1px solid #00f0ff;     background-color: rgba(0, 240, 255, 0.1);     color: #00f0ff;     text-transform: uppercase; }  .btn:hover {     background-color: rgba(0, 240, 255, 0.2);     box-shadow: 0 0 10px rgba(0, 240, 255, 0.5);     transform: translateY(-2px); }  .btn-primary {     background-color: rgba(254, 1, 254, 0.2);     border: 1px solid #fe01fe;     color: #fe01fe; }  .btn-primary:hover {     background-color: rgba(254, 1, 254, 0.3);     box-shadow: 0 0 10px rgba(254, 1, 254, 0.5); }  .btn-danger {     background-color: rgba(255, 0, 76, 0.2);     border: 1px solid #ff004c;     color: #ff004c; }  .btn-danger:hover {     background-color: rgba(255, 0, 76, 0.3);     box-shadow: 0 0 10px rgba(255, 0, 76, 0.5); }  .btn-secondary {     background-color: rgba(0, 240, 255, 0.15);     border: 1px solid #00f0ff; }  .btn-secondary:hover {     background-color: rgba(0, 240, 255, 0.25);     box-shadow: 0 0 10px rgba(0, 240, 255, 0.5); }  .btn-special {     background-color: rgba(0, 255, 157, 0.2);     border: 1px solid #00ff9d;     color: #00ff9d; }  .btn-special:hover {     background-color: rgba(0, 255, 157, 0.3);     box-shadow: 0 0 10px rgba(0, 255, 157, 0.5); }  #shape-list {     border-bottom: 1px solid rgba(0, 240, 255, 0.2); }  .shape-item {     background-color: rgba(0, 0, 35, 0.6);     border: 1px solid #00f0ff; }  .shape-item:hover {     background-color: rgba(0, 240, 255, 0.1);     transform: translateX(5px); }  .shape-item.active {     background-color: rgba(0, 255, 157, 0.1);     border-color: #00ff9d;     color: #00ff9d;     box-shadow: 0 0 10px rgba(0, 255, 157, 0.3); }  #inspector {     background: rgba(20, 20, 50, 0.8);     border-top: 1px solid #00f0ff; }  .form-row label {     color: #fe01fe; }  .form-row input, .form-row select {     border: 1px solid #00f0ff;     background-color: rgba(0, 0, 35, 0.6);     color: #00f0ff;     box-shadow: 0 0 5px rgba(0, 240, 255, 0.3); }  .scene-info {     background: rgba(0, 0, 20, 0.8);     color: #00f0ff;     box-shadow: 0 0 15px rgba(0, 240, 255, 0.3);     border: 1px solid #00f0ff; }  .button-danger {     background-color: rgba(255, 0, 76, 0.2);     border: 1px solid #ff004c;     color: #ff004c; }  .button-danger:hover {     background-color: rgba(255, 0, 76, 0.3);     box-shadow: 0 0 10px rgba(255, 0, 76, 0.5); }  h2, h3 {     color: #fe01fe;     text-transform: uppercase;     letter-spacing: 3px;     margin-bottom: 15px;     padding-bottom: 5px;     border-bottom: 1px solid #00f0ff;     text-shadow: 0 0 5px rgba(254, 1, 254, 0.7); }  h2:hover, h3:hover {     text-shadow: -2px 0 #00f0ff, 2px 0 #ff004c; }  .container::before {     content: '';     position: fixed;     top: 0;     left: 0;     right: 0;     bottom: 0;     background:          linear-gradient(rgba(0, 240, 255, 0.07) 1px, transparent 1px),         linear-gradient(90deg, rgba(0, 240, 255, 0.07) 1px, transparent 1px);     background-size: 40px 40px;     background-position: center center;     z-index: -1;     perspective: 1000px;     transform-style: preserve-3d;     transform: rotateX(75deg) translateZ(-100px);     pointer-events: none; }  #json-content {     background-color: rgba(0, 0, 35, 0.8);     border: 1px solid #00f0ff;     color: #00ff9d;     font-family: 'Courier New', monospace;     padding: 15px;     box-shadow: 0 0 15px rgba(0, 240, 255, 0.2), inset 0 0 30px rgba(0, 0, 35, 0.5); }  .ref-value-item {     background-color: #405060; }  .remove-ref-btn {     background: none;     border: none;     color: #ff6b6b;     cursor: pointer; }  ::-webkit-scrollbar {     width: 8px;     height: 8px; }  ::-webkit-scrollbar-track {     background: rgba(0, 0, 35, 0.6); }  ::-webkit-scrollbar-thumb {     background: #00f0ff;     border-radius: 0; }  ::-webkit-scrollbar-thumb:hover {     background: #fe01fe; }  button:active::before {     content: '';     position: absolute;     top: 0;     left: 0;     width: 100%;     height: 100%;     background: linear-gradient(90deg, transparent, rgba(0, 240, 255, 0.4), transparent);     animation: loading 1s infinite; }"
      }
    },
    "levels": {
      "level2": {
        "title": "Level 2",
        "wavesets": [
          "swarm",
          "swarm",
          "swarm"
        ],
        "tileMap": {
          "size": 32,
          "terrainTypes": [
            {
              "type": "water",
              "color": "#2d85c6",
              "image": [
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANklEQVRIS2PUbT32n4GGgHHUAkKhOxpEhEKIYTSIRoOIYAgQVDCaikaDiGAIEFQwmopGQBABAAWoO0FhcUvnAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANklEQVRIS2PUbT32n4GGgHHUAkKhOxpEhEKIYTSIRoOIYAgQVDCaikaDiGAIEFQwmopGQBABAAWoO0FhcUvnAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANklEQVRIS2PUbT32n4GGgHHUAkKhOxpEhEKIYTSIRoOIYAgQVDCaikaDiGAIEFQwmopGQBABAAWoO0FhcUvnAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANklEQVRIS2PUbT32n4GGgHHUAkKhOxpEhEKIYTSIRoOIYAgQVDCaikaDiGAIEFQwmopGQBABAAWoO0FhcUvnAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANklEQVRIS2PUbT32n4GGgHHUAkKhOxpEhEKIYTSIRoOIYAgQVDCaikaDiGAIEFQwmopGQBABAAWoO0FhcUvnAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANklEQVRIS2PUbT32n4GGgHHUAkKhOxpEhEKIYTSIRoOIYAgQVDCaikaDiGAIEFQwmopGQBABAAWoO0FhcUvnAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANklEQVRIS2PUbT32n4GGgHHUAkKhOxpEhEKIYTSIRoOIYAgQVDCaikaDiGAIEFQwmopGQBABAAWoO0FhcUvnAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANklEQVRIS2PUbT32n4GGgHHUAkKhOxpEhEKIYTSIRoOIYAgQVDCaikaDiGAIEFQwmopGQBABAAWoO0FhcUvnAAAAAElFTkSuQmCC"
              ],
              "buildable": false
            },
            {
              "type": "rock",
              "color": "#9e9e9e",
              "image": [
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANklEQVRIS2OcN2/efwYaAsZRCwiF7mgQEQohhtEgGg0igiFAUMFoKhoNIoIhQFDBaCoaAUEEAIf9RHEX0vjVAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAS0lEQVRIS2OcN2/efwYqgqSkJEZk4xipbQHIcGRLaGIBsiU0swBmCU0tAFkyagHBBD4aRKNBRDAECCoYTUWjQUQwBAgqGE1FAx9EAECFSQ0HGbi8AAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAPUlEQVRIS2NkoDFgpLH5DMPAgnnz5v2nZTAxjlpAKHhHg4hQCDGMBtFoEBEMAYIKRlPRaBARDAGCCmieigCFBDkNArgMlAAAAABJRU5ErkJggg==",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAASElEQVRIS2NkoDFgpLH5DMPAgnnz5v2nRjAlJSVhDQ1GalkAciQ2S6hqATZLRi3ASB/o8TAaRKNBRHohMpqKCIbZaBCNwCACAOcCUBnjhUZTAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANklEQVRIS2OcN2/efwYaAsZRCwiF7mgQEQohhtEgGg0igiFAUMFoKhoNIoIhQFDBaCoaAUEEAIf9RHEX0vjVAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAASklEQVRIS2OcN2/efwYaAsZRCwiF7mgQEQohhtEgGg0igiFAUMFoKhoNIoIhQFDB0E5FSUlJjDTzAchwUPjRxAKY4TSxANlwkAUAUEhJDYCk3yoAAAAASUVORK5CYII=",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAQElEQVRIS2OcN2/efwYaAsZRCwiF7mgQEQohhtEgGg0igiFAUMFoKhoNIoIhQFAB7VMRQSdQqICRQv0EtQ99CwDb3jkNHe23xQAAAABJRU5ErkJggg==",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAS0lEQVRIS2OcN2/efwYqgqSkJEZk4xhHLUAP3dEgIpjeRoNoNIgIhgBBBaOpaDSICIYAXgXoKQikmGo1GjbDwRZQ5mbCukctIBhGAC4oUBlpvrH3AAAAAElFTkSuQmCC"
              ],
              "buildable": false
            },
            {
              "type": "grass",
              "color": "#4a7c59",
              "image": [
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANUlEQVRIS2P0qon8z0BDwDhqAaHQHQ0iQiHEMBpEo0FEMAQIKhhNRaNBRDAECCoYTUUjIIgAnCQy6fQdcSIAAAAASUVORK5CYII=",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAATklEQVRIS2P0qon8z0AlsK1lOSO6UYxDygKQ69F9QVUfwIIH2RKaWIDsE5pZAPPNqAUEc9BoEI0GEcEQIKhgNBWNBhHBECCoYDQVEQwiAA75PFN7PN69AAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAPUlEQVRIS2NkoDFgpLH5DKMWEAxhRq+ayP8EVVGgYNQCgoE3GkSjQUQwBAgqGE1Fo0FEMAQIKhhNRQSDCAB4BShTjqMEpwAAAABJRU5ErkJggg==",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAS0lEQVRIS2NkoDFgpLH5DKMWEAxhRq+ayP8EVRFQsK1lOc6gpooFIPtxWUI1C3BZMmoBSvRji4fRIBoNItIKkdFURDC8RoNocAYRADzPTBkQkiUcAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANUlEQVRIS2P0qon8z0BDwDhqAaHQHQ0iQiHEMBpEo0FEMAQIKhhNRaNBRDAECCoYTUUjIIgAnCQy6fQdcSIAAAAASUVORK5CYII=",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAASklEQVRIS2P0qon8z0BDwDhqAaHQHQ0iQiHEMBpEo0FEMAQIKhhNRaNBRDAECCqgWSra1rKcEWQ7TSyAGU4TC5ANp7oF6IbTxQIARN88U7u38m0AAAAASUVORK5CYII=",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAPUlEQVRIS2P0qon8z0BDwDhqAaHQHQ0iQiHEMBpEo0FEMAQIKhhNRaNBRDAECCpgJKiCQgWjFhAMQJoHEQCyWyhTURksDgAAAABJRU5ErkJggg==",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAASklEQVRIS2P0qon8z0AlsK1lOSO6UYyjFiAHyWgQEUxro0E0GkQEQ4CggtFUNMyDCFsEg7xMlQoHl+FgCwgGLIUKRi0gGIA0DyIAQT9MGVwsaTUAAAAASUVORK5CYII="
              ],
              "buildable": true
            },
            {
              "type": "forest",
              "color": "#1c6438",
              "image": [
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANUlEQVRIS2OUSbH4z0BDwDhqAaHQHQ0iQiHEMBpEo0FEMAQIKhhNRaNBRDAECCoYTUUjIIgA71YpQQB/w8QAAAAASUVORK5CYII=",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAATklEQVRIS2OUSbH4z0Al8GTOCUZ0oxiHlAUg16P7gqo+gAUPsiU0sQDZJzSzAOabUQsI5qDRIBoNIoIhQFDBaCoaDSKCIUBQwWgqIhhEAIHMNK76+kj9AAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAPUlEQVRIS2NkoDFgpLH5DKMWEAxhRpkUi/8EVVGgYNQCgoE3GkSjQUQwBAgqGE1Fo0FEMAQIKhhNRQSDCACNcyCuKmmRrQAAAABJRU5ErkJggg==",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAS0lEQVRIS2NkoDFgpLH5DKMWEAxhRpkUi/8EVRFQ8GTOCZxBTRULQPbjsoRqFuCyZNQClOjHFg+jQTQaRKQVIqOpiGB4jQbR4AwiAPx6TBmX9XIXAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANUlEQVRIS2OUSbH4z0BDwDhqAaHQHQ0iQiHEMBpEo0FEMAQIKhhNRaNBRDAECCoYTUUjIIgA71YpQQB/w8QAAAAASUVORK5CYII=",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAASklEQVRIS2OUSbH4z0BDwDhqAaHQHQ0iQiHEMBpEo0FEMAQIKhhNRaNBRDAECCqgWSp6MucEI8h2mlgAM5wmFiAbTnUL0A2niwUAO0c0rkd3ClIAAAAASUVORK5CYII=",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAPUlEQVRIS2OUSbH4z0BDwDhqAaHQHQ0iQiHEMBpEo0FEMAQIKhhNRaNBRDAECCpgJKiCQgWjFhAMQJoHEQBLXiCu2Bx7HwAAAABJRU5ErkJggg==",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAASklEQVRIS2OUSbH4z0Al8GTOCUZ0oxhHLUAOktEgIpjWRoNoNIgIhgBBBaOpaJgHEbYIBnmZKhUOLsPBFhAMWAoVjFpAMABpHkQAAPlMGX+pQM0AAAAASUVORK5CYII="
              ],
              "buildable": true
            },
            {
              "type": "path",
              "color": "#f5d69a",
              "image": [
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANklEQVRIS2P8em3WfwYaAsZRCwiF7mgQEQohhtEgGg0igiFAUMFoKhoNIoIhQFDBaCoaAUEEADJ7UXnV1RQ5AAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAATklEQVRIS2P8em3WfwYqAW6tNEZ0oxiHlAUg16P7gqo+gAUPsiU0sQDZJzSzAOabUQsI5qDRIBoNIoIhQFDBaCoaDSKCIUBQwWgqIhhEAJvSVIWbYGLaAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAPUlEQVRIS2NkoDFgpLH5DKMWEAxhxq/XZv0nqIoCBaMWEAy80SAaDSKCIUBQwWgqGg0igiFAUMFoKiIYRAACV0CFxNTeCQAAAABJRU5ErkJggg==",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAS0lEQVRIS2NkoDFgpLH5DKMWEAxhxq/XZv0nqIqAAm6tNJxBTRULQPbjsoRqFuCyZNQClOjHFg+jQTQaRKQVIqOpiGB4jQbR4AwiAFzITBnELKoVAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANklEQVRIS2P8em3WfwYaAsZRCwiF7mgQEQohhtEgGg0igiFAUMFoKhoNIoIhQFDBaCoaAUEEADJ7UXnV1RQ5AAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAASklEQVRIS2P8em3WfwYaAsZRCwiF7mgQEQohhtEgGg0igiFAUMFoKhoNIoIhQFABzVIRt1YaI8h2mlgAM5wmFiAbTnUL0A2niwUAqyRUhRUUb34AAAAASUVORK5CYII=",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAPUlEQVRIS2P8em3WfwYaAsZRCwiF7mgQEQohhtEgGg0igiFAUMFoKhoNIoIhQFABI0EVFCoYtYBgANI8iAAWGUCFGtCTSgAAAABJRU5ErkJggg==",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAASklEQVRIS2P8em3WfwYqAW6tNEZ0oxhHLUAOktEgIpjWRoNoNIgIhgBBBaOpaJgHEbYIBnmZKhUOLsPBFhAMWAoVjFpAMABpHkQAYThMGX3v4DMAAAAASUVORK5CYII="
              ],
              "buildable": false
            },
            {
              "type": "lava",
              "color": "#cc6315",
              "image": [
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANklEQVRIS2M8kyz6n4GGgHHUAkKhOxpEhEKIYTSIRoOIYAgQVDCaikaDiGAIEFQwmopGQBABABafNmFbBL82AAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANklEQVRIS2M8kyz6n4GGgHHUAkKhOxpEhEKIYTSIRoOIYAgQVDCaikaDiGAIEFQwmopGQBABABafNmFbBL82AAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANklEQVRIS2M8kyz6n4GGgHHUAkKhOxpEhEKIYTSIRoOIYAgQVDCaikaDiGAIEFQwmopGQBABABafNmFbBL82AAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANklEQVRIS2M8kyz6n4GGgHHUAkKhOxpEhEKIYTSIRoOIYAgQVDCaikaDiGAIEFQwmopGQBABABafNmFbBL82AAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANklEQVRIS2M8kyz6n4GGgHHUAkKhOxpEhEKIYTSIRoOIYAgQVDCaikaDiGAIEFQwmopGQBABABafNmFbBL82AAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANklEQVRIS2M8kyz6n4GGgHHUAkKhOxpEhEKIYTSIRoOIYAgQVDCaikaDiGAIEFQwmopGQBABABafNmFbBL82AAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANklEQVRIS2M8kyz6n4GGgHHUAkKhOxpEhEKIYTSIRoOIYAgQVDCaikaDiGAIEFQwmopGQBABABafNmFbBL82AAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANklEQVRIS2M8kyz6n4GGgHHUAkKhOxpEhEKIYTSIRoOIYAgQVDCaikaDiGAIEFQwmopGQBABABafNmFbBL82AAAAAElFTkSuQmCC"
              ],
              "buildable": false
            },
            {
              "type": "end",
              "color": "#ff9999",
              "image": [
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANklEQVRIS2P8P3PmfwYaAsZRCwiF7mgQEQohhtEgGg0igiFAUMFoKhoNIoIhQFDBaCoaAUEEACT6TJlEjUJmAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANklEQVRIS2P8P3PmfwYaAsZRCwiF7mgQEQohhtEgGg0igiFAUMFoKhoNIoIhQFDBaCoaAUEEACT6TJlEjUJmAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANklEQVRIS2P8P3PmfwYaAsZRCwiF7mgQEQohhtEgGg0igiFAUMFoKhoNIoIhQFDBaCoaAUEEACT6TJlEjUJmAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANklEQVRIS2P8P3PmfwYaAsZRCwiF7mgQEQohhtEgGg0igiFAUMFoKhoNIoIhQFDBaCoaAUEEACT6TJlEjUJmAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANklEQVRIS2P8P3PmfwYaAsZRCwiF7mgQEQohhtEgGg0igiFAUMFoKhoNIoIhQFDBaCoaAUEEACT6TJlEjUJmAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANklEQVRIS2P8P3PmfwYaAsZRCwiF7mgQEQohhtEgGg0igiFAUMFoKhoNIoIhQFDBaCoaAUEEACT6TJlEjUJmAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANklEQVRIS2P8P3PmfwYaAsZRCwiF7mgQEQohhtEgGg0igiFAUMFoKhoNIoIhQFDBaCoaAUEEACT6TJlEjUJmAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANklEQVRIS2P8P3PmfwYaAsZRCwiF7mgQEQohhtEgGg0igiFAUMFoKhoNIoIhQFDBaCoaAUEEACT6TJlEjUJmAAAAAElFTkSuQmCC"
              ],
              "buildable": false
            },
            {
              "type": "start",
              "color": "#ffff80",
              "image": [
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANUlEQVRIS+3SsQ0AAAgCQd3czXGEr6x8ahKSC51M6jDtAOlKREIlkUQogAVfJBEKYMEXPSBaS5xT0QJZxg4AAAAASUVORK5CYII=",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANUlEQVRIS+3SsQ0AAAgCQd3czXGEr6x8ahKSC51M6jDtAOlKREIlkUQogAVfJBEKYMEXPSBaS5xT0QJZxg4AAAAASUVORK5CYII=",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANUlEQVRIS+3SsQ0AAAgCQd3czXGEr6x8ahKSC51M6jDtAOlKREIlkUQogAVfJBEKYMEXPSBaS5xT0QJZxg4AAAAASUVORK5CYII=",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANUlEQVRIS+3SsQ0AAAgCQd3czXGEr6x8ahKSC51M6jDtAOlKREIlkUQogAVfJBEKYMEXPSBaS5xT0QJZxg4AAAAASUVORK5CYII=",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANUlEQVRIS+3SsQ0AAAgCQd3czXGEr6x8ahKSC51M6jDtAOlKREIlkUQogAVfJBEKYMEXPSBaS5xT0QJZxg4AAAAASUVORK5CYII=",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANUlEQVRIS+3SsQ0AAAgCQd3czXGEr6x8ahKSC51M6jDtAOlKREIlkUQogAVfJBEKYMEXPSBaS5xT0QJZxg4AAAAASUVORK5CYII=",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANUlEQVRIS+3SsQ0AAAgCQd3czXGEr6x8ahKSC51M6jDtAOlKREIlkUQogAVfJBEKYMEXPSBaS5xT0QJZxg4AAAAASUVORK5CYII=",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANUlEQVRIS+3SsQ0AAAgCQd3czXGEr6x8ahKSC51M6jDtAOlKREIlkUQogAVfJBEKYMEXPSBaS5xT0QJZxg4AAAAASUVORK5CYII="
              ],
              "buildable": false
            }
          ],
          "terrainMap": [
            [
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              7,
              2,
              2,
              2,
              2,
              4,
              4,
              4,
              4,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2
            ],
            [
              2,
              4,
              4,
              4,
              2,
              2,
              2,
              4,
              2,
              2,
              2,
              2,
              4,
              2,
              2,
              4,
              2,
              2,
              2,
              2,
              4,
              4,
              4,
              2,
              4,
              4,
              4,
              2,
              4,
              4,
              4,
              2
            ],
            [
              2,
              4,
              2,
              4,
              2,
              2,
              2,
              4,
              2,
              2,
              2,
              2,
              4,
              2,
              2,
              4,
              4,
              2,
              2,
              4,
              4,
              2,
              4,
              4,
              4,
              2,
              4,
              4,
              4,
              2,
              4,
              2
            ],
            [
              2,
              4,
              2,
              4,
              2,
              2,
              2,
              4,
              2,
              2,
              2,
              2,
              4,
              4,
              4,
              2,
              4,
              4,
              4,
              4,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              4,
              2
            ],
            [
              2,
              4,
              2,
              4,
              2,
              2,
              2,
              4,
              2,
              2,
              2,
              2,
              2,
              2,
              4,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              4,
              2
            ],
            [
              2,
              4,
              2,
              4,
              2,
              2,
              2,
              4,
              4,
              4,
              4,
              4,
              4,
              4,
              4,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              4,
              2
            ],
            [
              2,
              4,
              2,
              4,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              4,
              4,
              4,
              4,
              4,
              4,
              4,
              4,
              4,
              4,
              4,
              4,
              4,
              2
            ],
            [
              2,
              4,
              2,
              4,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              4,
              2,
              2,
              4,
              4,
              4,
              4,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              4,
              2,
              2,
              2,
              2,
              2
            ],
            [
              2,
              4,
              2,
              4,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              4,
              2,
              2,
              4,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              4,
              2,
              2,
              2,
              2,
              2
            ],
            [
              2,
              4,
              2,
              4,
              2,
              2,
              2,
              2,
              2,
              0,
              3,
              2,
              4,
              2,
              2,
              4,
              2,
              3,
              2,
              2,
              1,
              1,
              2,
              2,
              2,
              2,
              4,
              2,
              2,
              2,
              2,
              2
            ],
            [
              2,
              4,
              2,
              4,
              2,
              2,
              2,
              2,
              2,
              3,
              2,
              2,
              4,
              2,
              2,
              4,
              2,
              3,
              2,
              2,
              1,
              1,
              2,
              2,
              4,
              4,
              4,
              2,
              2,
              2,
              2,
              2
            ],
            [
              2,
              4,
              2,
              4,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              4,
              4,
              2,
              2,
              4,
              4,
              4,
              4,
              2,
              2,
              2,
              2,
              2,
              4,
              2,
              2,
              2,
              2,
              2,
              2,
              2
            ],
            [
              2,
              4,
              2,
              4,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              4,
              2,
              2,
              0,
              0,
              0,
              2,
              4,
              2,
              2,
              2,
              2,
              2,
              4,
              2,
              2,
              2,
              2,
              2,
              2,
              2
            ],
            [
              2,
              4,
              2,
              4,
              2,
              2,
              2,
              2,
              2,
              2,
              4,
              4,
              2,
              2,
              0,
              0,
              0,
              2,
              4,
              2,
              3,
              3,
              2,
              2,
              4,
              4,
              2,
              2,
              2,
              2,
              2,
              2
            ],
            [
              2,
              4,
              2,
              4,
              2,
              2,
              2,
              2,
              2,
              2,
              4,
              2,
              2,
              2,
              0,
              0,
              0,
              2,
              4,
              2,
              3,
              2,
              2,
              2,
              2,
              4,
              4,
              2,
              2,
              2,
              2,
              2
            ],
            [
              2,
              4,
              2,
              4,
              2,
              2,
              2,
              2,
              2,
              4,
              4,
              2,
              2,
              2,
              2,
              2,
              4,
              4,
              4,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              4,
              2,
              2,
              2,
              2,
              2
            ],
            [
              2,
              4,
              2,
              4,
              2,
              2,
              2,
              2,
              2,
              4,
              2,
              2,
              2,
              2,
              6,
              2,
              4,
              2,
              4,
              4,
              4,
              4,
              2,
              2,
              2,
              2,
              4,
              4,
              4,
              4,
              4,
              7
            ],
            [
              2,
              4,
              2,
              4,
              2,
              2,
              2,
              2,
              2,
              4,
              2,
              3,
              3,
              2,
              4,
              4,
              4,
              2,
              2,
              2,
              2,
              4,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2
            ],
            [
              2,
              4,
              2,
              4,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              3,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              5,
              5,
              4,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2
            ],
            [
              2,
              4,
              2,
              4,
              4,
              4,
              4,
              4,
              4,
              4,
              4,
              4,
              4,
              2,
              2,
              2,
              2,
              2,
              2,
              5,
              5,
              4,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2
            ],
            [
              2,
              4,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              4,
              2,
              2,
              2,
              2,
              2,
              2,
              5,
              5,
              4,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2
            ],
            [
              0,
              4,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              2,
              2,
              4,
              4,
              4,
              4,
              4,
              4,
              4,
              4,
              4,
              4,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2
            ],
            [
              0,
              4,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2
            ],
            [
              2,
              4,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              4,
              4,
              4,
              4,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2
            ],
            [
              2,
              4,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              4,
              2,
              2,
              4,
              4,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2
            ],
            [
              2,
              4,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              4,
              2,
              2,
              2,
              4,
              4,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2
            ],
            [
              2,
              4,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              4,
              2,
              2,
              2,
              2,
              4,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2
            ],
            [
              2,
              4,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              4,
              2,
              2,
              2,
              2,
              4,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2
            ],
            [
              2,
              4,
              4,
              4,
              4,
              4,
              4,
              4,
              4,
              4,
              4,
              4,
              2,
              2,
              2,
              2,
              4,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2
            ],
            [
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              4,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2
            ],
            [
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              4,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2
            ],
            [
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              7,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2,
              2
            ]
          ],
          "terrainBGColor": "#467554",
          "environmentObjects": []
        },
        "world": "shire"
      },
      "level1": {
        "title": "Level 1",
        "wavesets": [
          "level1_start1",
          "level1_start2"
        ],
        "tileMap": {
          "size": 16,
          "terrainTypes": [
            {
              "type": "water",
              "texture": "water",
              "color": "#0288d1",
              "image": [
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANklEQVRIS2Nk6rj4n4GGgHHUAkKhOxpEhEKIYTSIRoOIYAgQVDCaikaDiGAIEFQwmopGQBABACTJOInljIZYAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAS0lEQVRIS2Nk6rj4n4GK4F+FPiOycYzUtgBkOLIlNLEA2RKaWQCzhKYWgCwZtYBgAh8NotEgIhgCBBWMpqLRICIYAgQVjKaigQ8iAB3DPyFhLWYbAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAPUlEQVRIS2NkoDFgpLH5DMPAAqaOi/9pGUyMoxYQCt7RICIUQgyjQTQaRARDgKCC0VQ0GkQEQ4CgApqnIgAM+S8hyaxkaAAAAABJRU5ErkJggg==",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAASElEQVRIS2NkoDFgpLH5DMPAAqaOi/+pEUz/KvSxhgYjtSwAORKbJVS1AJsloxZgpA/0eBgNotEgIr0QGU1FBMNsNIhGYBABANMJUBkDDfPEAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANklEQVRIS2Nk6rj4n4GGgHHUAkKhOxpEhEKIYTSIRoOIYAgQVDCaikaDiGAIEFQwmopGQBABACTJOInljIZYAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAASklEQVRIS2Nk6rj4n4GGgHHUAkKhOxpEhEKIYTSIRoOIYAgQVDCaikaDiGAIEFQwtFPRvwp9Rpr5AGQ4KPxoYgHMcJpYgGw4yAIAIvU/Ia+PZCwAAAAASUVORK5CYII=",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAQElEQVRIS2Nk6rj4n4GGgHHUAkKhOxpEhEKIYTSIRoOIYAgQVDCaikaDiGAIEFRA+1RE0AkUKmCkUD9B7UPfAgBZQi8hVlOfqgAAAABJRU5ErkJggg==",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAS0lEQVRIS2Nk6rj4n4GK4F+FPiOycYyjFqCH7mgQEUxvo0E0GkQEQ4CggtFUNBpEBEMArwL0FARSTLUaDZvhYAsoczNh3aMWEAwjABovUBkJTyamAAAAAElFTkSuQmCC"
              ],
              "buildable": false
            },
            {
              "type": "lava",
              "texture": "lava",
              "color": "#ff8c00",
              "image": [
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANUlEQVRIS+3SsQ0AAAgCQdzfnXWEr6x8ahKSCzWdyWHKAdKViIQikUQogAVfJBEKYMEXPSBamJQ9CXgfObkAAAAASUVORK5CYII=",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAATElEQVRIS2P838Pwn4GKgLGEgRHZOEZqWwAyHNkSmliAbAnNLIBZQlMLwJbQIg5oHsmjFpCULUcjmWBwjQbRaBARDAGCCkZT0QgIIgCvLT7h9ff/qwAAAABJRU5ErkJggg==",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAPElEQVRIS+3SsQkAMAwDQXn/7OyM8JUa866FBYcm5Zvy/xwo2JdtMo0FxCsRCUUiiVAAA65IIhTAQH1FHxXSMuGNrO/rAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAARklEQVRIS2NkoDFgpLH5DMPAgv89DP+pEUyMJdhDg5FaFoAcic0SqlqAzZJRCzDSB3o8jAbRaBCRXoiMpiKCYTYaRCMwiADWkTwZ+w+X6QAAAABJRU5ErkJggg==",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANUlEQVRIS+3SsQ0AAAgCQdzfnXWEr6x8ahKSCzWdyWHKAdKViIQikUQogAVfJBEKYMEXPSBamJQ9CXgfObkAAAAASUVORK5CYII=",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAASklEQVRIS2P838Pwn4GGgHHUAkKhOxpEhEKIYTSIRoOIYAgQVDCaikaDiGAIEFQwtFMRYwkDI818ADIcFH40sQBmOE0sQDYcZAEAtXs+4XbNSVcAAAAASUVORK5CYII=",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAQElEQVRIS2P838Pwn4GGgHHUAkKhOxpEhEKIYTSIRoOIYAgQVDCaikaDiGAIEFRA+1RE0AkUKmCkUD9B7UPfAgARdTLhxToLvQAAAABJRU5ErkJggg==",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAS0lEQVRIS2P838Pwn4GKgLGEgRHZOMZRC9BDdzSICKa30SAaDSKCIUBQwWgqGg0igiGAVwF6CgIpplqNhs1wsAWUuZmw7lELCIYRAMvmPBmZFN13AAAAAElFTkSuQmCC"
              ],
              "buildable": false
            },
            {
              "type": "start",
              "texture": "start",
              "color": "#e1bee7",
              "image": [
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANklEQVRIS2N8uO/5fwYaAsZRCwiF7mgQEQohhtEgGg0igiFAUMFoKhoNIoIhQFDBaCoaAUEEAMsxVJFoDnaTAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAS0lEQVRIS2N8uO/5fwYqAnknSUZk4xipbQHIcGRLaGIBsiU0swBmCU0tAFkyagHBBD4aRKNBRDAECCoYTUWjQUQwBAgqGE1FAx9EAIWPVn1LfyHzAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAPUlEQVRIS2NkoDFgpLH5DMPAgof7nv+nZTAxjlpAKHhHg4hQCDGMBtFoEBEMAYIKRlPRaBARDAGCCmieigDi30Z9FKHvXgAAAABJRU5ErkJggg==",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAASElEQVRIS2NkoDFgpLH5DMPAgof7nv+nRjDJO0liDQ1GalkAciQ2S6hqATZLRi3ASB/o8TAaRKNBRHohMpqKCIbZaBCNwCACABI9UBlRfiAaAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANklEQVRIS2N8uO/5fwYaAsZRCwiF7mgQEQohhtEgGg0igiFAUMFoKhoNIoIhQFDBaCoaAUEEAMsxVJFoDnaTAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAASklEQVRIS2N8uO/5fwYaAsZRCwiF7mgQEQohhtEgGg0igiFAUMFoKhoNIoIhQFDB0E5F8k6SjDTzAchwUPjRxAKY4TSxANlwkAUA9D5WfW47yLMAAAAASUVORK5CYII=",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAQElEQVRIS2N8uO/5fwYaAsZRCwiF7mgQEQohhtEgGg0igiFAUMFoKhoNIoIhQFAB7VMRQSdQqICRQv0EtQ99CwCYtEZ9mDNQjgAAAABJRU5ErkJggg==",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAS0lEQVRIS2N8uO/5fwYqAnknSUZk4xhHLUAP3dEgIpjeRoNoNIgIhgBBBaOpaDSICIYAXgXoKQikmGo1GjbDwRZQ5mbCukctIBhGAFlUUBlfgMXpAAAAAElFTkSuQmCC"
              ],
              "buildable": false
            },
            {
              "type": "end",
              "texture": "end",
              "color": "#bf360c",
              "image": [
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANklEQVRIS2Pcb8bzn4GGgHHUAkKhOxpEhEKIYTSIRoOIYAgQVDCaikaDiGAIEFQwmopGQBABAGEJMBn8lwDOAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAS0lEQVRIS2Pcb8bzn4GKwPHUF0Zk4xipbQHIcGRLaGIBsiU0swBmCU0tAFkyagHBBD4aRKNBRDAECCoYTUWjQUQwBAgqGE1FAx9EANYEOBntXJF3AAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAPUlEQVRIS2NkoDFgpLH5DMPAgv1mPP9pGUyMoxYQCt7RICIUQgyjQTQaRARDgKCC0VQ0GkQEQ4CgApqnIgA+OSgZFH+JDgAAAABJRU5ErkJggg==",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAASElEQVRIS2NkoDFgpLH5DMPAgv1mPP+pEUyOp75gDQ1GalkAciQ2S6hqATZLRi3ASB/o8TAaRKNBRHohMpqKCIbZaBCNwCACAKSjUBnVc59EAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANklEQVRIS2Pcb8bzn4GGgHHUAkKhOxpEhEKIYTSIRoOIYAgQVDCaikaDiGAIEFQwmopGQBABAGEJMBn8lwDOAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAASklEQVRIS2Pcb8bzn4GGgHHUAkKhOxpEhEKIYTSIRoOIYAgQVDCaikaDiGAIEFQwtFOR46kvjDTzAchwUPjRxAKY4TSxANlwkAUAMoA4GYViOn4AAAAASUVORK5CYII=",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAQElEQVRIS2Pcb8bzn4GGgHHUAkKhOxpEhEKIYTSIRoOIYAgQVDCaikaDiGAIEFRA+1RE0AkUKmCkUD9B7UPfAgDhvSgZWsU86gAAAABJRU5ErkJggg==",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAS0lEQVRIS2Pcb8bzn4GKwPHUF0Zk4xhHLUAP3dEgIpjeRoNoNIgIhgBBBaOpaDSICIYAXgXoKQikmGo1GjbDwRZQ5mbCukctIBhGAOu6UBlo3bmTAAAAAElFTkSuQmCC"
              ],
              "buildable": false
            },
            {
              "type": "path",
              "texture": "path",
              "color": "#ffcc80",
              "image": [
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAY0lEQVRIS2P8f6bhPwMNAePIseDWcx4GNckvJAfm0A0imI8Hpw9IiQ+8PiDFIFyxPziDiJS0OjR8gC+u6OsDclINIT309QEpqYNYtQR9QCgICFlE0AJCBhCSH+EWEBM/Qz+IANm2agm6Nb5uAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAYklEQVRIS2P8f6bhPwMVAaNJAyOycYzUtgBkOLIlNLEA2RK4Bbee8zCoSX6hYmBBfEIzH8BcOmoBwTgbDSLig4gW+QCc4WhRVNC8LBq1gGDKITqIqJGyRlMRwfgYDSKCQQQA625a4Y+giZcAAAAASUVORK5CYII=",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAVklEQVRIS2NkoDFgpLH5DMPAgv9nGv7TMpgYRy0gFLyjQUQohBiGURDdes7DoCb5BcPLuMQJhg1UwTAKImK9TKq6YRJElKYUfMFGchCR6hiSLRh5kQwAnpVN4Zf6kr4AAAAASUVORK5CYII=",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAY0lEQVRIS2NkoDFgpLH5DMPAgv9nGv5TI5gYTRqwhgYjtSwAORKbJVS1AJsloxZgpA/0eBi4ILr1nIdBTfILySl48PiAZKdDNQxTH5ASoYTUDtMgIjfFYNM3uIOIUAQPz+IaAHMAXBkmVDzCAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAdklEQVRIS2P8f6bhPwMNAeOgtuDWcx4GNckveP0/uH1ATNQNvA+ICWd8Phl4HxATzkT7gJzgIKRnaAQRPl8MDR8QHcmUphhs+vEGEaEUQoyDyIoDUiwmywJiXA5TQzMLYL6kmQUk+4CUcEcOwsHjA1Iilq4+AAAqa2oJpPaTtgAAAABJRU5ErkJggg==",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAXklEQVRIS2P8f6bhPwMNAeOoBYRCd5gH0a3nPAxqkl8IhQJe+WEeRBSFDVTzMAoiaqQYbEE6jIKIGilmNIjICkX6pSJa5ANGkwZGmvkAZDgoTGliAcxwmliAbDjIAgBn21rhMB5PBAAAAABJRU5ErkJggg==",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAWElEQVRIS2P8f6bhPwMNAePIs+DWcx4GNckvRAcqOIhI1US06UCFIzAOSAkekNphFES4UhKlKWwYBRGpqYNY9aNBRDCkRoOIcBARVEGhAkYK9RPUPvQtAACMFk3hQ/NGpQAAAABJRU5ErkJggg==",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAaklEQVRIS2P8f6bhPwMVAaNJAyOycYyDyoJbz3kY1CS/4PXv4PYBMVE1TH1ATOTBgoeQ2mEaRMSkDmLVDJ4gIhSZuHw0eHxAbJijqxv1AcGQo2kQoRsOcg3VajRshoMtIOhnChWMWkAwAAGoflwZO+biqwAAAABJRU5ErkJggg=="
              ],
              "buildable": false
            },
            {
              "type": "grass",
              "texture": "grass",
              "color": "#5a8a4f",
              "image": [
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANUlEQVRIS2OM6vL/z0BDwDhqAaHQHQ0iQiHEMBpEo0FEMAQIKhhNRaNBRDAECCoYTUUjIIgAfMs0ycPNloYAAAAASUVORK5CYII=",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAS0lEQVRIS2OM6vL/z0BFsKxsIyOycYzUtgBkOLIlNLEA2RKaWQCzhKYWgCwZtYBgAh8NotEgIhgCBBWMpqLRICIYAgQVjKaigQ8iAI+4PAED+PgWAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAPUlEQVRIS2NkoDFgpLH5DMPAgqgu//+0DCbGUQsIBe9oEBEKIYbRIBoNIoIhQFDBaCoaDSKCIUBQAc1TEQC0riwBPmCHPQAAAABJRU5ErkJggg==",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAASElEQVRIS2NkoDFgpLH5DMPAgqgu///UCKZlZRuxhgYjtSwAORKbJVS1AJsloxZgpA/0eBgNotEgIr0QGU1FBMNsNIhGYBABANraUBnI7elLAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANUlEQVRIS2OM6vL/z0BDwDhqAaHQHQ0iQiHEMBpEo0FEMAQIKhhNRaNBRDAECCoYTUUjIIgAfMs0ycPNloYAAAAASUVORK5CYII=",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAASklEQVRIS2OM6vL/z0BDwDhqAaHQHQ0iQiHEMBpEo0FEMAQIKhhNRaNBRDAECCoY2qloWdlGRpr5AGQ4KPxoYgHMcJpYgGw4yAIA2B88AalS6kAAAAAASUVORK5CYII=",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAQElEQVRIS2OM6vL/z0BDwDhqAaHQHQ0iQiHEMBpEo0FEMAQIKhhNRaNBRDAECCqgfSoi6AQKFTBSqJ+g9qFvAQBEOywBeS2I2QAAAABJRU5ErkJggg==",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAS0lEQVRIS2OM6vL/z0BFsKxsIyOycYyjFqCH7mgQEUxvo0E0GkQEQ4CggtFUNBpEBEMArwL0FARSTLUaDZvhYAsoczNh3aMWEAwjACIAUBkyurStAAAAAElFTkSuQmCC"
              ],
              "buildable": true
            },
            {
              "type": "forest",
              "texture": "forest",
              "color": "#2f4a29",
              "image": [
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANUlEQVRIS2PU99L8z0BDwDhqAaHQHQ0iQiHEMBpEo0FEMAQIKhhNRaNBRDAECCoYTUUjIIgAMVcnMWaCer0AAAAASUVORK5CYII=",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAS0lEQVRIS2PU99L8z0BFcHHbdUZk4xipbQHIcGRLaGIBsiU0swBmCU0tAFkyagHBBD4aRKNBRDAECCoYTUWjQUQwBAgqGE1FAx9EAM7AMK06eeZJAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAPUlEQVRIS2NkoDFgpLH5DMPAAn0vzf+0DCbGUQsIBe9oEBEKIYbRIBoNIoIhQFDBaCoaDSKCIUBQAc1TEQC2nSCt0Vf5ogAAAABJRU5ErkJggg==",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAASElEQVRIS2NkoDFgpLH5DMPAAn0vzf/UCKaL265jDQ1GalkAciQ2S6hqATZLRi3ASB/o8TAaRKNBRHohMpqKCIbZaBCNwCACAFc5UBlc2SShAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANUlEQVRIS2PU99L8z0BDwDhqAaHQHQ0iQiHEMBpEo0FEMAQIKhhNRaNBRDAECCoYTUUjIIgAMVcnMWaCer0AAAAASUVORK5CYII=",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAASklEQVRIS2PU99L8z0BDwDhqAaHQHQ0iQiHEMBpEo0FEMAQIKhhNRaNBRDAECCoY2qno4rbrjDTzAchwUPjRxAKY4TSxANlwkAUA6tgwrW9iQGUAAAAASUVORK5CYII=",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAQElEQVRIS2PU99L8z0BDwDhqAaHQHQ0iQiHEMBpEo0FEMAQIKhhNRaNBRDAECCqgfSoi6AQKFTBSqJ+g9qFvAQAZ2yCt7eMyfAAAAABJRU5ErkJggg==",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAS0lEQVRIS2PU99L8z0BFcHHbdUZk4xhHLUAP3dEgIpjeRoNoNIgIhgBBBaOpaDSICIYAXgXoKQikmGo1GjbDwRZQ5mbCukctIBhGAJ5QUBlAsncEAAAAAElFTkSuQmCC"
              ],
              "buildable": true
            },
            {
              "type": "rock",
              "texture": "rock",
              "color": "#3e4f57",
              "image": [
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAXUlEQVRIS2O08w//z0BDwDhqAaHQHaZBZOXoynBs/25CvidKfnAFETk+G1w+ICrQ0RSN+gBnqMESxGgQEUxYOIOInEyFzbahEwe4fDx0fIArtjF8QK3IhVlI8yACABTaP2GrGczwAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAc0lEQVRIS2O08w//z0BFcGjjSkZk4xipbQHIcGRLaGIBsiU0swBmCU0tAFlCXwusHF0Zju3fTcU0RW8fUNXpUMPoGwejPsAWAqNxwEAoc2INIkKaSElto3FAMLToE0TUjFR0L5HlA2IdBFJHlgUEAx5JAQBSHEWVRFas9wAAAABJRU5ErkJggg==",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAATElEQVRIS2NkoDFgpLH5DMPAAjv/8P+0DCbGUQsIBe9oEBEKIYbRIBoNIoIhQFDBwKciK0dXhmP7dxN0KS4FA+8Dsp0O1TjqA4IhCACSGijVPQJ64AAAAABJRU5ErkJggg==",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAX0lEQVRIS2NkoDFgpLH5DMPAAjv/8P/UCKZDG1diDQ1GalkAciQ2S6hqATZLRi3ASB/o8TAaRKNBRHohMoJSkZWjK8Ox/btJDqMRFEQkhw1UA8VBRChuKLaAkM/QLQAAEzdWGaItYCUAAAAASUVORK5CYII=",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAXklEQVRIS2O08w//z0BDwIhugZWjK8Ox/bupZiWGBVQzGWrQ0LEAV9AOnA+oFdkD5wNqpaah6wNYHA5dH8DicIT5gJzMNzBBRI5LcWXMgfEBtYoJkDmjPiAYmjQPIgB29j9hRLICDQAAAABJRU5ErkJggg==",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAeElEQVRIS2O08w//z0BDwEiOBVaOrgzH9u8m6CyQOrAFxGogaCIWBWT5gBSLRi0gGFpYg4iakU5xHBByDMUWEAqjUQsIhRCkqCCoigIFoxYQDDyUICKUaQiaNlpckxpEhzauZKRZMgUZDnIQTSyAGU4TC5ANB1kAAGFjRZXml4rsAAAAAElFTkSuQmCC",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAATUlEQVRIS2O08w//z0BDwDhqAaHQHfggsnJ0ZTi2fzchh+KUH3gfkO10qMZRHxAMwdEgGg0igiFAUMFoKiIcRARVUKiAkUL9BLUPfQsAjkIo1UAR1E0AAAAASUVORK5CYII=",
                "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAYUlEQVRIS2O08w//z0BFcGjjSkZk4xhJtcDK0ZXh2P7dOJ1EsQWEPDuCLCAU1riCagQFEaHUMhpE5IYQw2gqIhh0o0E0sEGEHv4g15BcoxFbRMDUodSfBP1PhoJRCwgGGgACl1YZGweXngAAAABJRU5ErkJggg=="
              ],
              "buildable": false
            }
          ],
          "terrainMap": [
            [
              5,
              5,
              2,
              5,
              5,
              5,
              5,
              6,
              6,
              6,
              6,
              6,
              6,
              6,
              6,
              6
            ],
            [
              5,
              5,
              4,
              5,
              5,
              5,
              0,
              0,
              6,
              6,
              6,
              4,
              4,
              4,
              6,
              6
            ],
            [
              5,
              5,
              4,
              5,
              5,
              5,
              5,
              6,
              6,
              4,
              4,
              4,
              4,
              4,
              4,
              6
            ],
            [
              5,
              5,
              4,
              7,
              0,
              0,
              0,
              6,
              4,
              4,
              6,
              6,
              4,
              6,
              4,
              6
            ],
            [
              5,
              5,
              4,
              0,
              0,
              0,
              0,
              6,
              4,
              6,
              6,
              6,
              4,
              6,
              4,
              6
            ],
            [
              5,
              4,
              4,
              0,
              0,
              0,
              0,
              6,
              4,
              6,
              6,
              6,
              4,
              6,
              4,
              2
            ],
            [
              5,
              4,
              0,
              0,
              0,
              0,
              0,
              4,
              4,
              6,
              6,
              6,
              4,
              6,
              6,
              6
            ],
            [
              5,
              4,
              0,
              0,
              0,
              0,
              0,
              4,
              6,
              6,
              6,
              6,
              4,
              4,
              6,
              6
            ],
            [
              5,
              4,
              7,
              0,
              0,
              7,
              4,
              4,
              5,
              5,
              5,
              5,
              5,
              4,
              4,
              6
            ],
            [
              5,
              4,
              4,
              4,
              4,
              4,
              4,
              5,
              5,
              5,
              1,
              1,
              1,
              5,
              4,
              5
            ],
            [
              5,
              5,
              5,
              5,
              5,
              5,
              5,
              5,
              5,
              1,
              1,
              1,
              1,
              1,
              4,
              1
            ],
            [
              5,
              5,
              5,
              7,
              7,
              5,
              4,
              4,
              4,
              1,
              1,
              5,
              1,
              1,
              4,
              1
            ],
            [
              5,
              0,
              0,
              7,
              7,
              5,
              4,
              5,
              4,
              1,
              1,
              1,
              1,
              1,
              4,
              1
            ],
            [
              5,
              0,
              0,
              0,
              7,
              5,
              4,
              5,
              4,
              4,
              1,
              1,
              4,
              4,
              4,
              1
            ],
            [
              5,
              0,
              0,
              5,
              5,
              5,
              4,
              5,
              5,
              4,
              4,
              4,
              4,
              1,
              1,
              1
            ],
            [
              5,
              5,
              5,
              5,
              5,
              5,
              3,
              5,
              5,
              1,
              1,
              1,
              1,
              1,
              5,
              1
            ]
          ],
          "terrainBGColor": {
            "paletteColor": "greenMColor"
          },
          "environmentObjects": [
            {
              "type": "tree",
              "imageIndex": 1,
              "x": -348,
              "y": 432
            },
            {
              "type": "tree",
              "imageIndex": 1,
              "x": 515,
              "y": -243
            },
            {
              "type": "tree",
              "imageIndex": 1,
              "x": 1141,
              "y": 339
            },
            {
              "type": "tree",
              "imageIndex": 1,
              "x": 426.0000000000001,
              "y": 1258
            },
            {
              "type": "tree",
              "imageIndex": 1,
              "x": 1058,
              "y": -246
            },
            {
              "type": "tree",
              "imageIndex": 1,
              "x": 1312,
              "y": 872
            },
            {
              "type": "tree",
              "imageIndex": 1,
              "x": 638.9999999999999,
              "y": 1433
            },
            {
              "type": "tree",
              "imageIndex": 1,
              "x": -251.00000000000006,
              "y": 1107
            },
            {
              "type": "tree",
              "imageIndex": 1,
              "x": 747,
              "y": -467.00000000000006
            },
            {
              "type": "tree",
              "imageIndex": 1,
              "x": -864,
              "y": 324
            },
            {
              "type": "tree",
              "imageIndex": 1,
              "x": -25.00000000000003,
              "y": 1133
            },
            {
              "type": "tree",
              "imageIndex": 1,
              "x": -401,
              "y": -146.99999999999997
            },
            {
              "type": "tree",
              "imageIndex": 1,
              "x": 762,
              "y": 978
            },
            {
              "type": "tree",
              "imageIndex": 1,
              "x": -173,
              "y": -411
            },
            {
              "type": "tree",
              "imageIndex": 1,
              "x": 1555,
              "y": 413
            },
            {
              "type": "tree",
              "imageIndex": 1,
              "x": 372.00000000000006,
              "y": 1076
            },
            {
              "type": "tree",
              "imageIndex": 1,
              "x": 231.99999999999994,
              "y": 1611.9999999999998
            },
            {
              "type": "tree",
              "imageIndex": 1,
              "x": 138,
              "y": -586
            },
            {
              "type": "tree",
              "imageIndex": 1,
              "x": 1094,
              "y": -102
            },
            {
              "type": "tree",
              "imageIndex": 1,
              "x": 1149,
              "y": -149.00000000000006
            },
            {
              "type": "tree",
              "imageIndex": 1,
              "x": 855,
              "y": -215
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 228,
              "y": -211.99999999999997
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -297,
              "y": 109.00000000000003
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -619,
              "y": 679
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 861,
              "y": 1203
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 1605,
              "y": 631
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 1278,
              "y": -33.99999999999994
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 278.99999999999994,
              "y": -859
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -319,
              "y": 819
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -691,
              "y": 115.00000000000003
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -165,
              "y": 1305
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 453.99999999999994,
              "y": 1593.9999999999998
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 1124,
              "y": 1096
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 1018,
              "y": 554
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 1901,
              "y": 415
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -155,
              "y": -249
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -177,
              "y": 577
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -151.00000000000003,
              "y": 279
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -500.00000000000006,
              "y": 952
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -966,
              "y": 453.99999999999994
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 984,
              "y": -336
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 372.00000000000006,
              "y": -560
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 1023,
              "y": 132.99999999999994
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 1325,
              "y": 623
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 950,
              "y": 838
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 524,
              "y": 1072
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 747,
              "y": 1477
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 148.99999999999997,
              "y": 1187
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -495,
              "y": 474.99999999999994
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -581,
              "y": -75
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -113.00000000000001,
              "y": -611
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 573,
              "y": -749
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 436,
              "y": 1844
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -90,
              "y": 822
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -793,
              "y": 221
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 1468,
              "y": 207.99999999999994
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 1623,
              "y": 189
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 845,
              "y": -609
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 48,
              "y": -876
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -492.99999999999994,
              "y": 157
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -354,
              "y": 498
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 1109,
              "y": 951
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 1334,
              "y": 386.00000000000006
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 734,
              "y": -162.00000000000006
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 452,
              "y": -48
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 858,
              "y": 294
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 232.00000000000003,
              "y": 1388
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 942,
              "y": 1346
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 1035,
              "y": 733
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -155,
              "y": 83
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -898.0000000000001,
              "y": 70.00000000000003
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -1216,
              "y": 223.99999999999997
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -862.0000000000001,
              "y": 690.0000000000001
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 1775,
              "y": 596.9999999999999
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 1294,
              "y": 1038
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 64,
              "y": -140
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -420.99999999999994,
              "y": -387
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -140,
              "y": 524
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -298,
              "y": 1058
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -76.00000000000003,
              "y": -516
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 305,
              "y": -1121
            },
            {
              "type": "rock",
              "imageIndex": 1,
              "x": 1029,
              "y": 1223
            },
            {
              "type": "rock",
              "imageIndex": 1,
              "x": 1140,
              "y": 140.00000000000006
            },
            {
              "type": "rock",
              "imageIndex": 1,
              "x": 839,
              "y": -39
            },
            {
              "type": "rock",
              "imageIndex": 1,
              "x": 12,
              "y": 932
            },
            {
              "type": "rock",
              "imageIndex": 1,
              "x": -284,
              "y": 304
            },
            {
              "type": "rock",
              "imageIndex": 1,
              "x": -165,
              "y": -83.00000000000001
            },
            {
              "type": "rock",
              "imageIndex": 1,
              "x": -55.99999999999997,
              "y": 916.0000000000001
            },
            {
              "type": "rock",
              "imageIndex": 1,
              "x": -371,
              "y": 623
            },
            {
              "type": "rock",
              "imageIndex": 1,
              "x": 62.00000000000006,
              "y": 1050
            },
            {
              "type": "rock",
              "imageIndex": 1,
              "x": 64.00000000000003,
              "y": 1052
            },
            {
              "type": "rock",
              "imageIndex": 1,
              "x": 397,
              "y": 1395
            },
            {
              "type": "rock",
              "imageIndex": 1,
              "x": 607,
              "y": 1229
            },
            {
              "type": "rock",
              "imageIndex": 1,
              "x": 890,
              "y": -126.00000000000004
            },
            {
              "type": "rock",
              "imageIndex": 1,
              "x": 571,
              "y": -451
            },
            {
              "type": "rock",
              "imageIndex": 1,
              "x": 198,
              "y": -406
            },
            {
              "type": "rock",
              "imageIndex": 1,
              "x": 37.99999999999997,
              "y": 958.0000000000001
            },
            {
              "type": "rock",
              "imageIndex": 1,
              "x": -494.00000000000006,
              "y": 870
            },
            {
              "type": "rock",
              "imageIndex": 1,
              "x": -627,
              "y": 519
            },
            {
              "type": "rock",
              "imageIndex": 1,
              "x": -657,
              "y": 261
            },
            {
              "type": "rock",
              "imageIndex": 1,
              "x": 1355,
              "y": 677
            },
            {
              "type": "rock",
              "imageIndex": 1,
              "x": 1022,
              "y": 366.00000000000006
            },
            {
              "type": "rock",
              "imageIndex": 1,
              "x": 894,
              "y": 994.0000000000001
            },
            {
              "type": "rock",
              "imageIndex": 1,
              "x": 456,
              "y": 940
            },
            {
              "type": "rock",
              "imageIndex": 1,
              "x": 60,
              "y": 916
            },
            {
              "type": "rock",
              "imageIndex": 1,
              "x": -32.00000000000006,
              "y": 1392
            },
            {
              "type": "rock",
              "imageIndex": 1,
              "x": -34.00000000000003,
              "y": 1390
            },
            {
              "type": "rock",
              "imageIndex": 1,
              "x": -115.00000000000003,
              "y": 934.9999999999999
            },
            {
              "type": "rock",
              "imageIndex": 1,
              "x": 557,
              "y": 1607.0000000000002
            },
            {
              "type": "rock",
              "imageIndex": 3,
              "x": 743,
              "y": 1553.0000000000002
            },
            {
              "type": "rock",
              "imageIndex": 3,
              "x": 694,
              "y": 1074
            },
            {
              "type": "rock",
              "imageIndex": 3,
              "x": 1198,
              "y": 54
            },
            {
              "type": "rock",
              "imageIndex": 3,
              "x": -142,
              "y": -134
            },
            {
              "type": "rock",
              "imageIndex": 3,
              "x": -609,
              "y": -179
            },
            {
              "type": "rock",
              "imageIndex": 3,
              "x": -718,
              "y": 390
            },
            {
              "type": "rock",
              "imageIndex": 3,
              "x": -842,
              "y": 538
            },
            {
              "type": "rock",
              "imageIndex": 3,
              "x": -79.99999999999997,
              "y": 1012.0000000000001
            },
            {
              "type": "rock",
              "imageIndex": 3,
              "x": 334,
              "y": -978
            },
            {
              "type": "rock",
              "imageIndex": 3,
              "x": 335,
              "y": -979
            },
            {
              "type": "rock",
              "imageIndex": 3,
              "x": 1142,
              "y": -270
            },
            {
              "type": "rock",
              "imageIndex": 3,
              "x": 64.00000000000003,
              "y": 916.0000000000001
            },
            {
              "type": "rock",
              "imageIndex": 4,
              "x": -169.99999999999997,
              "y": 1210
            },
            {
              "type": "rock",
              "imageIndex": 4,
              "x": -713,
              "y": 713
            },
            {
              "type": "rock",
              "imageIndex": 4,
              "x": 1079,
              "y": 533
            },
            {
              "type": "rock",
              "imageIndex": 4,
              "x": 205,
              "y": 915
            },
            {
              "type": "rock",
              "imageIndex": 4,
              "x": 200,
              "y": -124
            },
            {
              "type": "rock",
              "imageIndex": 5,
              "x": 476.00000000000006,
              "y": -420
            },
            {
              "type": "rock",
              "imageIndex": 5,
              "x": 44.000000000000014,
              "y": -756
            },
            {
              "type": "rock",
              "imageIndex": 5,
              "x": 42.999999999999986,
              "y": -759
            },
            {
              "type": "rock",
              "imageIndex": 5,
              "x": -427,
              "y": -297
            },
            {
              "type": "rock",
              "imageIndex": 5,
              "x": 733.0000000000001,
              "y": 1371
            },
            {
              "type": "rock",
              "imageIndex": 5,
              "x": 542,
              "y": 1694.0000000000002
            },
            {
              "type": "rock",
              "imageIndex": 5,
              "x": 1436,
              "y": 776
            },
            {
              "type": "rock",
              "imageIndex": 5,
              "x": 1151,
              "y": 701
            },
            {
              "type": "rock",
              "imageIndex": 5,
              "x": 1565,
              "y": 278.9999999999999
            },
            {
              "type": "rock",
              "imageIndex": 6,
              "x": -528,
              "y": 568
            },
            {
              "type": "rock",
              "imageIndex": 6,
              "x": 31.99999999999997,
              "y": -456
            },
            {
              "type": "rock",
              "imageIndex": 6,
              "x": -133.00000000000003,
              "y": 309
            },
            {
              "type": "rock",
              "imageIndex": 6,
              "x": 192,
              "y": 1140
            },
            {
              "type": "rock",
              "imageIndex": 6,
              "x": 30.999999999999943,
              "y": 1365
            },
            {
              "type": "rock",
              "imageIndex": 6,
              "x": 30,
              "y": 1366
            },
            {
              "type": "rock",
              "imageIndex": 7,
              "x": 286,
              "y": 1658
            },
            {
              "type": "rock",
              "imageIndex": 7,
              "x": 284,
              "y": 1656
            },
            {
              "type": "rock",
              "imageIndex": 7,
              "x": 43.99999999999997,
              "y": 1444
            },
            {
              "type": "rock",
              "imageIndex": 7,
              "x": -221,
              "y": 973
            },
            {
              "type": "rock",
              "imageIndex": 7,
              "x": -543,
              "y": 603
            },
            {
              "type": "rock",
              "imageIndex": 7,
              "x": 516.0000000000001,
              "y": 1564
            },
            {
              "type": "rock",
              "imageIndex": 7,
              "x": 665.9999999999999,
              "y": 1610
            },
            {
              "type": "rock",
              "imageIndex": 7,
              "x": 1550,
              "y": 682
            },
            {
              "type": "rock",
              "imageIndex": 7,
              "x": 1155,
              "y": -363
            },
            {
              "type": "rock",
              "imageIndex": 7,
              "x": 598,
              "y": -858
            },
            {
              "type": "rock",
              "imageIndex": 7,
              "x": 589,
              "y": -869
            },
            {
              "type": "rock",
              "imageIndex": 7,
              "x": 208.00000000000003,
              "y": -1028
            },
            {
              "type": "rock",
              "imageIndex": 7,
              "x": -377.99999999999994,
              "y": -550
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -250,
              "y": 674
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -236,
              "y": 732
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -218,
              "y": 810
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 631,
              "y": 1021
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 78.99999999999994,
              "y": 909
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 39,
              "y": 905
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 121.00000000000003,
              "y": 1018.9999999999999
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 130.99999999999997,
              "y": 925.0000000000001
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -721,
              "y": 485
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 289,
              "y": -444.99999999999994
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 359,
              "y": -283
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -115,
              "y": 63
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -142,
              "y": 242
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -396,
              "y": 268
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -574,
              "y": 270
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 913,
              "y": 230.99999999999994
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 931,
              "y": -15
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 937.9999999999999,
              "y": -25.99999999999997
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 1033,
              "y": -25.00000000000003
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 1022,
              "y": -18
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 1032,
              "y": -96
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 1033,
              "y": -97.00000000000003
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 1064,
              "y": -48
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 1037,
              "y": -117
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 1086,
              "y": 54
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 882,
              "y": -306
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 643,
              "y": -423
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 452,
              "y": -704
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 1165,
              "y": -269
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 1166,
              "y": -270
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 945,
              "y": -513
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -193.99999999999997,
              "y": 994.0000000000001
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -192,
              "y": 1092
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -508,
              "y": 776
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -645,
              "y": -79.00000000000003
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -783,
              "y": -84.99999999999999
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -786,
              "y": -86.00000000000001
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -595,
              "y": -317
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": -312,
              "y": -211.99999999999997
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 74.00000000000001,
              "y": -338
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 568,
              "y": 1172
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 347.9999999999999,
              "y": 1352
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 49.00000000000003,
              "y": 1571
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 1187,
              "y": 549
            },
            {
              "type": "tree",
              "imageIndex": 0,
              "x": 1363,
              "y": 204.99999999999994
            },
            {
              "type": "rock",
              "imageIndex": 0,
              "x": -193,
              "y": -135
            },
            {
              "type": "rock",
              "imageIndex": 0,
              "x": -140,
              "y": -96
            }
          ],
          "extensionTerrainType": 5
        },
        "world": "shire",
        "grassShader": "grass",
        "waterShader": "water"
      }
    }
  },
  "objectTypeDefinitions": [
    {
      "id": "configs",
      "name": "Configs",
      "singular": "Config",
      "category": "Settings",
      "isCore": true
    },
    {
      "id": "entities",
      "name": "Entities",
      "singular": "Entity",
      "category": "Scripts",
      "isCore": true
    },
    {
      "id": "components",
      "name": "Components",
      "singular": "Component",
      "category": "Scripts",
      "isCore": true
    },
    {
      "id": "renderers",
      "name": "Renderers",
      "singular": "Renderer",
      "category": "Scripts",
      "isCore": true
    },
    {
      "id": "functions",
      "name": "Functions",
      "singular": "Function",
      "category": "Scripts",
      "isCore": true
    },
    {
      "id": "towers",
      "name": "Towers",
      "singular": "Tower",
      "category": "Graphics"
    },
    {
      "id": "enemies",
      "name": "Enemies",
      "singular": "Enemy",
      "category": "Graphics"
    },
    {
      "id": "projectiles",
      "name": "Projectiles",
      "singular": "Projectile",
      "category": "Graphics"
    },
    {
      "id": "upgrades",
      "name": "Upgrades",
      "singular": "Upgrade",
      "category": "Data"
    },
    {
      "id": "effects",
      "name": "Effects",
      "singular": "Effect",
      "category": "Data"
    },
    {
      "id": "waves",
      "name": "Waves",
      "singular": "Wave",
      "category": "Data"
    },
    {
      "id": "levels",
      "name": "Levels",
      "singular": "Level",
      "category": "Terrain",
      "isCore": true
    },
    {
      "id": "wavesets",
      "name": "Wave Sets",
      "singular": "Wave Set",
      "category": "Data"
    },
    {
      "id": "particles",
      "name": "Particles",
      "singular": "Particle",
      "category": "Graphics"
    },
    {
      "id": "themes",
      "name": "Themes",
      "singular": "Theme",
      "category": "Settings",
      "isCore": true
    },
    {
      "id": "sounds",
      "name": "Sounds",
      "singular": "Sound",
      "category": "Audio",
      "isCore": true
    },
    {
      "id": "libraries",
      "name": "Libraries",
      "singular": "Library",
      "category": "Scripts",
      "isCore": true
    },
    {
      "id": "interfaces",
      "name": "Interfaces",
      "singular": "Interface",
      "category": "Scripts"
    },
    {
      "id": "modals",
      "name": "Modals",
      "singular": "Modal",
      "category": "Scripts"
    },
    {
      "id": "palettes",
      "name": "Palettes",
      "singular": "Palette",
      "category": "Resources"
    },
    {
      "id": "shadows",
      "name": "Shadows",
      "singular": "Shadow",
      "category": "Environment"
    },
    {
      "id": "lightings",
      "name": "Lightings",
      "singular": "lighting",
      "category": "Environment"
    },
    {
      "id": "fogs",
      "name": "Fogs",
      "singular": "Fog",
      "category": "Environment"
    },
    {
      "id": "cameras",
      "name": "Cameras",
      "singular": "Camera",
      "category": "Environment"
    },
    {
      "id": "worlds",
      "name": "Worlds",
      "singular": "World",
      "category": "Environment"
    },
    {
      "id": "textures",
      "name": "Textures",
      "singular": "Texture",
      "category": "Resources"
    },
    {
      "id": "materials",
      "name": "Materials",
      "singular": "Material",
      "category": "Resources"
    },
    {
      "id": "shaders",
      "name": "Shaders",
      "singular": "Shader",
      "category": "Resources"
    }
  ]
}; 